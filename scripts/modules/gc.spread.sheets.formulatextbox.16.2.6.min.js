/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var e,i,n;function r(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},e[n].call(t.exports,t,t.exports,r)),t.exports}e={"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js":function(n,t,e){var T,R,M,t,j,e,m,w,x,A;function y(n,t,e,i,r){var t,n,o,u,a,s,f,t=t.Ut,n=n.Qvt(),o=T.SheetArea.viewport;return n===T.SheetArea.colHeader&&r===T.SheetArea.colHeader?e<(u=t.getFreeAreaRowCount(T.SheetArea.colHeader))&&(o=T.SheetArea.colHeader):n===T.SheetArea.rowHeader&&r===T.SheetArea.rowHeader&&i<(s=t.getFreeAreaColumnCount(T.SheetArea.rowHeader))&&(o=T.SheetArea.rowHeader),o}function D(n,t,e,i,r,o,u,a){var s=n.xA(t,e,t,e,u,a),s=(0,T.Ec)(s.row,s.col,1,1);return s=o&&0<=i?n.xA(t,e,i,r,u,a):s}Object.defineProperty(t,"__esModule",{value:!0}),T=e("Core"),R=e("CalcEngine"),M=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),t=e("Common"),j=t.Common.lt.ht,e=T.GC$.extend,m=null,w=void 0,x=Math.max,A=Math.min,e(T.nk.prototype,{Kvt:function(n){var t,e,i,r,r,o,u,a,s,f,c,l,g,h,v,d,I,p,m,x,A,C,b,o,s,u,f,e,c,r,o,s,t=this,e=t.Mf,i=t.Dde(),r=e.parent,r=r&&0!==r.options.pivotAreaReference;i&&(t.jde(),o=e.frozenRowCount(),u=e.frozenColumnCount(),(a=i.XD)&&t.Lvt||(t.Lvt={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),s=e.getRowCount(),f=e.getColumnCount(),c=n.hitTestType,l=n.row,g=n.col,h=t.shift,v=t.ctrl,i&&i.Xvt&&(i.Xvt===T.SelectionUnit.row?c=2:i.Xvt===T.SelectionUnit.column&&(c=1)),I=(d=t.Lvt).anchorRow,p=d.anchorCol,x=m=-1,C=y(i,e,l,g,c),0===c?(m=o?e.N9():e.Tb,x=u?e.k9():e.Ab,A=(0,T.Ec)(-1,-1,-1,-1),i.Gvt((0,M.Uvt)(e,A),h,!v,w,C),t.rb=!0):1===c?(C===T.SheetArea.viewport?(m=o?e.N9():e.Tb,A=e.xA(0,x=g,s-1,g,!0),h&&0<=p&&(A=e.xA(0,g,s-1,p,!0)),A=(0,T.Ec)(-1,A.col,-1,A.colCount)):C===T.SheetArea.colHeader&&(A=D(e,m=l,x=g,I,p,h,!0,C)),(b=n.tableSelectInfo&&n.tableSelectInfo.tableSelection)?t.Dse(b,A,l,g,I,p,h,v,C):i.Gvt((0,M.Uvt)(e,A,w,C),h,!v,w,C),t.rb=!0):2===c?(m=l,x=u?e.k9():e.Ab,A=e.xA(l,0,l,f-1,!0),h&&0<=I&&(A=e.xA(l,0,I,f-1,!0)),A=(0,T.Ec)(A.row,-1,A.rowCount,-1),i.Gvt((0,M.Uvt)(e,A),h,!v,w,C),t.rb=!0):3===c&&(x=g,(m=l)!==w)&&g!==w&&(o=n.row,s=n.col,e=(f=(u=n.pivotTableInfo)&&u.getPivotInfoImp(o,s,!1,!0))&&f.area,b=n.tableSelectInfo&&n.tableSelectInfo.tableSelection,!(r&&R.Functions.findGlobalFunction("GETPIVOTDATA")&&!i.Ivt&&u&&f&&4===e)||(i.Fvt=new T.Range(o,s,1,1),c=f.valueFieldName,r=f.rowInfos,o=f.colInfos,j(c))||!r&&!o?t.Dse(b,A,l,g,I,p,h,v,C):(s=t.Pvt(e,c,r,o,u.position()))&&(i.Gvt(s,h,!v,!0,C),t.rb=!0,t.LD=!0)),t.Wk=t.rb,h&&a||(d.anchorRow=m,d.anchorCol=x,d.leadingRow=m,d.leadingCol=x,d.sheetArea=C),t.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},t.Ok())},Dse:function(n,t,e,i,r,o,u,a,s){var f,c,l,f=this,c=f.Mf,l=this.Dde();delete l.Fvt,t=n||D(c,e,i,r,o,u,!0,s),l.Gvt((0,M.Uvt)(c,t,w,s),u,!a,w,s),f.rb=!0},Pvt:function(n,t,e,i,r){var o,u,n,a,s,f,r,f,c,r,l,g,u,o,u=this.Mf;if(4===n)return a=n=void 0,f=r.row,r=r.col,f=(s="",T.Ec)(f,r,1,1),n=(0,M.Uvt)(u,f,!0),c=[],r=[],r=Array.isArray(e)&&Array.isArray(i)?e.concat(i):Array.isArray(e)&&e||Array.isArray(i)&&i,l=/\"/g,g='""',r&&r.forEach(function(n){"number"==typeof n.fieldName?c.push(n.fieldName):c.push('"'+n.fieldName.replace(l,g)+'"'),"number"==typeof n.itemName?c.push(n.itemName):c.push('"'+n.itemName.replace(l,g)+'"')}),s=c.join(","),u='GETPIVOTDATA("'+(a=t.replace(l,g))+'",'+n,""!==s&&(u+=","+s),u+")"},qvt:function(n){var t=M.Ode.Ede();return!!t&&t.Rde(n)},Qk:function(){var n,t,e,i,e,i,n=this,t=this.Dde(),e=n.Rk,i=n.Lvt;e&&n.rb&&(e=e.Bk,i=i.sheetArea,t&&t.Xvt&&(t.Xvt===T.SelectionUnit.row?e=2:t.Xvt===T.SelectionUnit.column&&(e=1)),e===T.SheetArea.viewport||i===T.SheetArea.colHeader||i===T.SheetArea.rowHeader?n.tmt():2===e?n.nmt():1===e&&n.emt())},tmt:function(){var n,t,e,i,t,r,o,u,r,o,e,n=this,t=n.Lvt,e=t.anchorRow,i=t.anchorCol,t=t.sheetArea,r=n.Q9(w,t,!0),o=n.K9(w,t,!0);0<=e&&0<=i&&0<=r&&0<=o&&(r=(u=n.Mf).xA(r,o,e,i,!0,t),o=(0,M.Uvt)(u,r,w,t))&&(e=n.Dde(),n.LD?r.equals(e.Fvt)||(delete e.Fvt,e.Gvt(o,!0,!0)):e.Gvt(o,!0,!1)),n.a9()},nmt:function(){var n,t,e,i,e,t,r,n=this,t=n.Lvt.anchorRow,e=n.Q9();0<=t&&0<=e&&(e=(i=n.Mf).xA(e,0,t,i.getColumnCount()-1,!0),e=(0,T.Ec)(e.row,-1,e.rowCount,-1),t=(0,M.Uvt)(i,e))&&(r=n.Dde()).Gvt(t,!0,!1),n.a9()},emt:function(){var n,t,e,i,e,t,r,n=this,t=n.Lvt.anchorCol,e=n.K9();0<=t&&0<=e&&(e=(i=n.Mf).xA(0,e,i.getRowCount()-1,t,!0),e=(0,T.Ec)(-1,e.col,-1,e.colCount),t=(0,M.Uvt)(i,e))&&(r=n.Dde()).Gvt(t,!0,!1),n.a9()},_D:function(){var n,n,n=this;n.l9(),n.Rk=m,n.rb=!1,n.Wk=!1,(n=n.Dde()).onRangeAppend&&n.onRangeAppend()},Mk:function(n){var t,e,i,r,i,r,o,r,e,u,a,u,a,t=this,e=t.Mf,i=t.Dde(),r=n.formulaRangeHitInfo;r&&r.inBorder&&i&&(i.XD&&i.qD(),i.close(),r=(i=r.paramRange)&&i.text,o=j(i.sheetArea)?T.SheetArea.viewport:i.sheetArea,r)&&(r=(0,M.Vvt)(e,r))&&(t.jde(),e=e.JS(r,o),u=n.row,a=n.col,(u=u<e.row?e.row:u)>=e.row+e.rowCount&&(u=e.row+e.rowCount-1),(a=a<e.col?e.col:a)>=e.col+e.colCount&&(a=e.col+e.colCount-1),u=u-e.row,a=a-e.col,t.rb=!0,t.Kk=!0,t.imt={paramRange:i,fromRange:r,rowOffset:u,colOffset:a,sheetArea:o},t.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},t.Ok())},Jk:function(){var n,t,e,i,r,o,u,a,s,f,c,l,s,f,l,g,h,v,o,d,I,I,d,I,g,p,n=this;n.rb&&n.Kk&&(e=(t=n.imt).sheetArea,i=n.Q9(w,e,!0),r=n.K9(w,e,!0),0<=i&&0<=r&&(o=t.fromRange,u=t.rowOffset,a=t.colOffset,s=t.toRow,f=t.toCol,l=r,i!==s||l!==f)&&(t.toRow=i,t.toCol=l,f=(s=n.Mf).getRowCount(e),l=s.getColumnCount(e),g=o.row,h=o.col,v=o.rowCount,o=o.colCount,(I=(d=s.Ut).getFreeAreaRowCount(e))<f&&(f=I),(I=d.getFreeAreaColumnCount(e))<l&&(l=I),d=g<0?-1:x(0,A(f-v,i-u)),I=h<0?-1:x(0,A(l-o,r-a)),g=(0,M.Uvt)(s,(0,T.Ec)(d,I,v,o),w,e))&&(p=n.Dde()).Lde(t.paramRange.index,g,!0),n.a9())},ED:function(){var n,n,n=this;n.l9(),n.rb=!1,n.Kk=!1,n.imt=m,(n=n.Dde()).onRangeMoved&&n.onRangeMoved()},Ck:function(n){var t,e,i,r,i,o,u,e,o,a,u,s,f,c,l,t=this,e=t.Mf,i=t.Dde(),r=n.formulaRangeHitInfo;if(r&&i&&(i.XD&&i.qD(),o=(i=r.paramRange)&&i.text,i)&&o&&(u=(0,M.Vvt)(e,o))){if(t.jde(),e=u.row,o=u.row<0?-1:u.row+u.rowCount-1,a=u.col,u=u.col<0?-1:u.col+u.colCount-1,r.inTopLeft)s=o,f=u,c=e,l=a;else if(r.inTopRight)s=o,f=a,c=e,l=u;else if(r.inBottomLeft)s=e,f=u,c=o,l=a;else{if(!r.inBottomRight)return;s=e,f=a,c=o,l=u}t.rb=!0,t.Xk=!0,t.omt={paramRange:i,anchorRow:s,anchorCol:f,toRow:c,toCol:l,sheetArea:n.hitTestType},t.Rk={e9:n.rowViewportIndex,r9:n.colViewportIndex,Bk:n.hitTestType},t.Ok()}},Ik:function(n,t){var e=this.Dde();return!(e&&e.qMi||(e&&e.Dvt()?(this.Kvt(t),0):!this.qvt(n)))},qk:function(){var n,t,e,i,r,o,u,a,s,i,r,a,s,e,o,u,f,c,o,i,u,r,s,n=this;n.rb&&n.Xk&&(t=n.omt,e=T.SheetArea.viewport,t&&!j(t.sheetArea)&&(e=t.sheetArea),i=n.Q9(w,e,!0),r=n.K9(w,e,!0),0<=i&&0<=r&&(o=t.anchorRow,u=t.anchorCol,a=t.toRow,s=t.toCol,r=r,(i=i)!==a||r!==s)&&(t.toRow=i,t.toCol=r,s=(a=n.Mf).getRowCount(e),e=a.getColumnCount(e),u=u<0?e-1:u,f=A(o=o<0?s-1:o,i),c=A(u,r),o=x(o,i)-f+1,i=x(u,r)-c+1,u=n.Dde(),(0===f&&o===s||u&&u.Xvt===T.SelectionUnit.column)&&(o=f=-1),(0===c&&i===e||u&&u.Xvt===T.SelectionUnit.row)&&(i=c=-1),r=t.paramRange,s=(0,M.Uvt)(a,(0,T.Ec)(f,c,o,i),w,r.sheetArea))&&u.Lde(r.index,s,!0),n.a9())},jD:function(){var n,n,t,n=this;n.l9(),n.rb=!1,n.Xk=!1,n.omt=m,(n=n.Dde()).rl&&-(n.umt=1)!==(t=n.text().lastIndexOf(",",n.caret()))&&(n.umt=t+1),n.onRangeResized&&n.onRangeResized()},ZL:function(n,t,e){var i,r,o,u,a,s,f,c,l,g,l,h,h,v,d,I,p,l,i=this.Mf,r=this.Dde(),o=r&&r.smt();if(o&&0!==o.length&&r.cmt&&(u=n.rowViewportIndex,a=n.colViewportIndex,s=n.hitTestType,!this.yD(u,a,t,e)))for(g=o.length-1;0<=g;g--)if(l=(f=o[g]).sheetArea,!1!==f.allowDrag&&(j(l)||l===s)&&!((h=M.Ode.Ede())&&h._text||(c=(0,M.Vvt)(i,f.text),j(c)))){if(j(l)&&(l=T.SheetArea.viewport),(h=i.Ut.findSpan(c.row,c.col,l))&&h.containsRange(c)&&(c=h),d=(l=i.getRangeRect(u,a,c)).x-2,I=l.x+l.width+1-(v=5),p=l.y-2,l=l.y+l.height+1-5,5+d<=t&&t<I&&(1+p<=e&&e<=3+p||1+l<=e&&e<=3+l))return{paramRange:f,inBorder:!0};if(5+p<=e&&e<l&&(1+d<=t&&t<=3+d||1+I<=t&&t<=3+I))return{paramRange:f,inBorder:!0};if(I<=t&&t<5+I&&l<=e&&e<5+l)return{paramRange:f,inBottomRight:!0};if(d<=t&&t<5+d&&l<=e&&e<5+l)return{paramRange:f,inBottomLeft:!0};if(I<=t&&t<5+I&&p<=e&&e<5+p)return{paramRange:f,inTopRight:!0};if(d<=t&&t<5+d&&p<=e&&e<5+p)return{paramRange:f,inTopLeft:!0}}return m},Dde:function(){var n=this.Mf;return n.il||n.mnn||n.Nde},jde:function(){var n=this.Dde();n&&n.mmt()}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js":function(n,t,e){var P,L,F,t,U;function c(n,t,e,i,r,o){var u,a,s,f,c,l,g,h,v,d,I,p,m,x,A,C,b,T,A,R,M,j,j,A,w,w,y,D,N,B,k,E,S,O,G,u=n.Mf,a=u.rt,s=u.C6(e,i),f=o&&o.smt(),c=f&&f.length;if(!(c<=0)&&(l=n.uO(e,i,r))){for(t.save(),t.rect(l.x,l.y,l.width,l.height),t.clip(),t.beginPath(),g=[],h=a.isFormulaRangeHovering,v=a.AD,d=a.Kk,I=a.imt,p=a.Xk,m=a.omt,R=0;R<c;R++)if(("number"!=typeof(A=(x=f[R]).sheetArea)||A===s)&&(A=x.text,C=x.ranges&&0<x.ranges.length?x.ranges:[(0,F.Vvt)(u,A)])){if((M=F.Ode.Ede())&&M.Mf&&void 0!==A)if(U.OS(A,"!")){if(j=U.gmt(A,"!"),u.name()!==j&&"'"+u.name()+"'"!==j)continue}else if(j=U.gmt(A,"["),A=u.tables,w=(w=u.NMi)&&w._gi===P.SheetType.tableSheet&&w.name()===j,!(u.getCustomNames()[j]||A&&A.findByName(j)||w))continue;for(b=n.fO(e,i,C,l),y=0;y<b.length;y++)(D=b[y])&&0<D.width&&0<D.height&&(T=o.pmt(R),o.bmt(x)||x.isPivotClickCell?(h&&v.paramRange.index===R&&(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(D.x+1,D.y+1,D.width-3,D.height-3),t.stroke()),n.wO(t,D,T)):(h&&v.paramRange.index===R||d&&I.paramRange.index===R||p&&m.paramRange.index===R?(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(D.x+1,D.y+1,D.width-3,D.height-3)):(t.beginPath(),t.lineWidth=2,t.strokeStyle=T,t.rect(D.x,D.y,D.width-1,D.height-1)),t.stroke()),o.ymt(x)&&((N=L.Common.ft._(T)).a=.1,t.beginPath(),t.fillStyle=L.Common.ft.j(N),t.fillRect(D.x+1,D.y+1,D.width-3,D.height-3)),g.push({rect:D,color:T,allowDrag:x.allowDrag}))}if(0<g.length&&o.cmt)for(B=g.length,R=0;R<B;R++)D=g[R].rect,T=g[R].color,E=D.x-2,S=D.x+D.width+1-(k=5),O=D.y-2,G=D.y+D.height+1-5,!1===g[R].allowDrag||(M=F.Ode.Ede())&&M._text||(t.beginPath(),t.fillStyle=T,t.fillRect(E,O,5,5),t.fillRect(S,O,5,5),t.fillRect(E,G,5,5),t.fillRect(S,G,5,5));t.beginPath(),t.restore()}}Object.defineProperty(t,"__esModule",{value:!0}),P=e("Core"),L=e("Common"),F=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),t=P.GC$.extend,U=L.Common.zf,t(P.g7.prototype,{kde:function(){var n,t,t,e,n=this,t=n.Mf;0<t.My||(t=t.Fi(),e=n.J(),n.FA(t.x,t.y,t.width,t.height),n.jy(e))}}),P.Worksheet.ch("formulaReferencedRanges",{paintAdornment:function(n){var t,e,i,r,o,u,a,s,f,t=this,e=n.ctx,i=n.clipRect,r=t.Dn,o=t.Fi(),f=t.rt.Dde();if(f)for(a=-1;a<=2;a++)for(s=-1;s<=2;s++)-1===a&&-1===s||(u=-1===a?o.L1(s):-1===s?o.B1(a):o.c9(a,s))&&0!==u.width&&0!==u.height&&c(r,e,a,s,i,f)}})},"./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js":function(n,t,e){var g,i,h,r,v,a,d;function o(){}function u(n,t){var e,e,i,e;if(t){i=(e=(e=d.Ede())&&e.Mf||n).ui,e=e.ci;try{return g.formulaToRange(n,t,i,e)}catch(n){}}return v}function s(n,t,e,i){var r,o,u,a,u,s,s,f,c,c,e,i,l;return void 0===i&&(i=h.SheetArea.viewport),t?(r=n.Nde,a=(u=(o=d.Ede())&&o.Mf||n).ui,u=u.ci,s=(s=n.parent)&&1===s.options.referenceStyle,f=15,(r&&r.Ivt||e)&&(f=0),t.row<0&&t.col<0&&(t=new h.Range(0,-1,n.getRowCount(),-1)),c=(c=n.tables)&&c.find(t.row,t.col),(o&&o.Ivt||e)&&(f=0),r&&!r.rl&&I(c,t,a)?(o&&o._text&&o.Mf!==n&&(u=-1),g.rangeToFormulaWithStructReference(n,t,a,u,f,s,c)):(e=n.NMi,!c&&i===h.SheetArea.viewport&&e&&e._gi===h.SheetType.tableSheet?m(n,t.col,t.colCount,c=e):(i=g.rangeToFormula(t,a,u,f,s),o&&o._text||r&&r.rl&&r.Smt?(l=p(n))+"!"+i:i))):v}function I(n,t,e){if(n){var i=!1,r=!1;if(1===t.rowCount){if(n.hasHeadersRow()&&t.row===n.startRow())return 1;if(n.hasTotalsRow()&&t.row===n.endRow())return 1;if(t.row===e&&t.col>=n.startColumn()&&t.col+t.colCount<=n.startColumn()+n.dataRange().colCount)return 1}else n.hasHeadersRow()&&t.row===n.startRow()&&(t.rowCount===n.dataRange().rowCount+1&&(i=!0),n.hasTotalsRow())&&t.rowCount===n.dataRange().rowCount+1+1&&(i=!0),t.row===n.dataRange().row&&(t.rowCount===n.dataRange().rowCount&&(i=!0),n.hasTotalsRow())&&t.rowCount===n.dataRange().rowCount+1&&(i=!0);return t.col+t.colCount<=n.startColumn()+n.dataRange().colCount&&(r=!0),i&&r}}function f(n){return n.replace(/'/g,"''")}function p(n){var n=n.name();return(0,r.Cmt)(n.split(""),!1)?n:"'"+f(n)+"'"}function c(n){return n&&"["===n[0]&&"]"===n[n.length-1]}function m(n,t,e,i){var r,o,r,i,r,r,e,t,r=l(i),o=r.columns,r=r.groupInfo,i=i.name();if(-1===t&&(t=0),-1===e&&(e=o.length),r){if(r=r.rightGroupColumnIndex,1===e&&t<=r)return"";if(1<e&&t<=r){if(t+e<=r+1)return"";e-=r-t+1,t=r+1}}return 1===e?"".concat(i,"[").concat(o[t].name,"]"):1<e?(r=t+e-1,c(e=o[t].name)||(e="[".concat(e,"]")),c(t=o[r].name)||(t="[".concat(t,"]")),"".concat(i,"[").concat(e,":").concat(t,"]")):""}function l(n){for(var t,e,i,r,o,u,t=[],e=0,i="";i!==v;)i=n.getColumnName(e),o=void 0,n.Mf.NMi&&(o=n.FDi(e))&&(r=e),e++,i!==v&&t.push({name:i,description:"",isGroupColumn:o});return u={columns:t},a(r)||(u.groupInfo={rightGroupColumnIndex:r}),u}function x(n,t,e,i,r){var o,u,i,o,o=n.rowRelative,u=n.columnRelative;i&&(o&&u?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=e):!o&&u?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=e):(n.columnRelative=!0,n.column-=e)),i=n.endRowRelative,o=n.endColumnRelative,r&&(i&&o?(n.endRowRelative=!1,n.endColumnRelative=!1,n.endRow+=t,n.endColumn+=e):!i&&o?(n.endRowRelative=!0,n.endColumnRelative=!1,n.endRow-=t,n.endColumn+=e):(n.endColumnRelative=!0,n.endColumn-=e))}function A(n,t,e){var i=n.rowRelative,r=n.columnRelative;i&&r?(n.rowRelative=!1,n.columnRelative=!1,n.row+=t,n.column+=e):!i&&r?(n.rowRelative=!0,n.columnRelative=!1,n.row-=t,n.column+=e):(n.columnRelative=!0,n.column-=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.dmt=t.lmt=t.Uvt=t.Vvt=t.Ode=void 0,g=e("SheetsCalc"),i=e("Common"),h=e("Core"),r=e("CalcEngine"),v=null,a=i.Common.lt.ht,o.Ede=function(){return o.DJ},d=o,t.Ode=d,t.Vvt=u,t.Uvt=s,t.lmt=x,t.dmt=A,h.GC$.extend(h.Hv.prototype,{C2:function(n){return!n||!n.Nde||!n.Nde.Dvt()},D2:function(n){return!n||!n.Nde||!!n.Nde.xmt}})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(n,t,e){var i,r,o,u,a,i=this&&this.__createBinding||(Object.create?function(n,t,e,i){void 0===i&&(i=e);var r=Object.getOwnPropertyDescriptor(t,e);r&&("get"in r?t.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,r)}:function(n,t,e,i){n[i=void 0===i?e:i]=t[e]}),r=this&&this.__exportStar||function(n,t){for(var e in n)"default"===e||Object.prototype.hasOwnProperty.call(t,e)||i(t,n,e)};Object.defineProperty(t,"__esModule",{value:!0}),t.findControl=void 0,o=e("Core"),r(e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),t),e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-event.js"),e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges-render.js"),r(e("./dist/plugins/formulaTextbox/formulatextbox.js"),t),r(e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),t),e("./dist/plugins/formulaTextbox/formulatextbox-event.js"),e("./dist/plugins/formulaTextbox/formulatextbox-render.js"),e("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),u=e("./dist/plugins/formulaTextbox/formulatextbox.js"),t.findControl=a=function(n){return"string"==typeof n&&(n=document.getElementById(n)),(0,o.GC$)(n).data(u.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(n,t,e){var h,i,v,r,d,I,o,u,a;function s(n){var t,e,t=h.mt.En("textarea"),e;return(0,h.GC$)(t).css({display:"none"}),(0,h.GC$)(n).append(t),t}function f(n,t){var e,n,t,t;n&&n.il&&(e=n.il.Kmt,n=n.il.Jmt,t=t?"addClass":"removeClass",e&&(0,h.GC$)(e)[t](r),n)&&(0,h.GC$)(n)[t](r)}function c(){var n=this;n.bZ=-1,n.mvt=-1,n._text="",n.gvt=-1,n.Mf=null,n.XD=!1,n.pvt=-1,n.bvt=null,n.Vv=null,n.yvt=null}function l(){}Object.defineProperty(t,"__esModule",{value:!0}),t.wvt=t.Mvt=void 0,h=e("Core"),i=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),v=e("./dist/plugins/formulaTextbox/formulatextbox.js"),r="gc-across-sheet-func-popup",d=null,I=void 0,t.Mvt=s,c.prototype.d5=function(){var n=this;n.Cvt(),n.bZ=-1,n.mvt=-1,n._text="",n.gvt=-1,n.XD=!1,n.pvt=-1,n.Mf=null,n.Vv=null,n.yvt=null},c.prototype.Cvt=function(){var n,t,e,n=this;n.Mf.xT||(t=n.Mf.getCellType(n.bZ,n.mvt),e={sheet:n.Mf,row:n.bZ,col:n.mvt,sheetArea:3},n.bvt&&n.bvt.firstChild&&t.deactivateEditor(n.bvt.firstChild.firstChild,e)),(0,h.GC$)(n.bvt).remove(),n.bvt=null},c.prototype.Svt=function(n){var t,e,i,t=this,e=n.il;e&&(i=n.vA,t._text=e.text(),t.bZ=i?i.row:n.getActiveRowIndex(),t.mvt=i?i.col:n.getActiveColumnIndex(),t.nT=i?i.sheetArea:h.SheetArea.viewport,t.gvt=e.caret(),t.XD=e.XD,t.pvt=e.Tvt(),t.rl=e.rl,t.Avt=e.Avt,t.Ivt=e.Ivt,t.Mf=n,t.Vv=n.parent,t.yvt=n.rt.it())},c.prototype._6=function(n){var t=this;n.il&&t.Mf&&(t._text=n.il.text(),t.gvt=n.il.caret(),t.XD=n.il.XD,t.pvt=n.il.Tvt())},c.prototype.xvt=function(n){var t,n,t=this,n=n.il;n&&(n.rl=t.rl,n.Avt=t.Avt,n.Ivt=t.Ivt,n.text(t._text),n.caret(t.gvt),t.XD)&&(n.Nvt(),n.Tvt(t.pvt))},c.prototype.kvt=function(n){var t,e,i,r,t=n.oldSheet,e=this,i=t&&t.il;if(i)if(i.close(),(!e.Mf||e.Mf.xT)&&i.Dvt()||e.Avt!==i.Avt){e.Svt(t),r=t.getValue(e.bZ,e.mvt,e.nT),t.suspendEvent();try{if(!t.endEdit(!0))return}finally{t.resumeEvent()}t.setValue(e.bZ,e.mvt,r,e.nT,!0),t.Di=1,n.needTriggerSheetChange=!1}else e._text&&(e._6(t),i.destroy(),t.il=d,t.Nde=d,n.needTriggerSheetChange=!1)},c.prototype._vt=function(n){var t,n,e,i,i,r,i,r,t=n.oldSheet,n=n.newSheet,e=this;if(n&&!n.xT){if(e.bvt&&""===e._text&&(t&&t.cR(),f(n,!1),e.d5()),e._text&&e.Mf===n)n.Di=0,n.Zg(),n.suspendEvent(),e.rl?(i=s(n.parent.Ti),(0,v.Evt)(n,i,d,n.ui,n.ci,3),n.Di=2,n.Dn.ID()):(r=i=void 0,e.nT===h.SheetArea.rowHeader?r=-(i=1):e.nT===h.SheetArea.colHeader&&(i=-1,r=1),n.f6(n.Dg(),e.bZ,e.mvt,i,r,!1)),n.resumeEvent(),e.xvt(n),e.GG(n,e.bZ,e.mvt,e.nT),t&&t.cR(),f(n,!1),e.d5();else if(e._text&&!e.bvt){if(n.Di=1,t&&(t.Di=1),e.jvt(n),f(n,!0),!e.Mf||e.Mf.xT)return;n.e4()}else if(e._text&&e.Mf!==n){if(n.Di=1,t&&(t.Di=1,t.cR()),e.jvt(n),f(n,!0),!e.Mf||e.Mf.xT)return;n.e4()}(i=e.Mf)&&(r=n.il)&&(r.U6=i!==n)}},c.prototype.jvt=function(n){var t,e,i,r,o,u,a,s,f,c,l,c,l,g,t=this,e=t.Mf;e&&!e.xT&&(i=t.bZ,r=t.mvt,o=t.nT,u=e.getCellType(i,r,o),a={sheet:e,row:i,col:r,sheetArea:o,canvasOffset:this.yvt},(s=u.isImeAware(a))||o!==h.SheetArea.viewport)&&(n.Di=1,f=u.jn(a),t.bvt&&t.Cvt(),l=c=void 0,t.nT===h.SheetArea.rowHeader?l=-(c=1):t.nT===h.SheetArea.colHeader&&(c=-1,l=1),t.bvt=f,(0,h.GC$)(f).css("position","absolute"),(c=e.getCellRect(i,r,c,l)).width===I&&(c.width=0),c.height===I&&(c.height=0),(0,h.GC$)(f).attr("id","across"),(0,h.GC$)(f).addClass("gc-across-sheet-ftb"),l=e.getActualStyle(i,r,o),u.On(f,l,c,a),(g=t.Vv&&t.Vv.getHost()||document.body).insertBefore(f,d),t.rl&&(0,h.GC$)(f).css({display:"none"}),(0,v.Evt)(n,u.getEditingElement(),!0,n.ui,n.ci,3),f.firstChild&&!t.rl&&u.focus(f.firstChild.firstChild),t.xvt(n),u.Rn(f,l,c,a))},c.prototype.GG=function(n,t,e,i){var r,o,u,a,s,f,r,o,c;i===h.SheetArea.rowHeader?o=-1:i===h.SheetArea.colHeader&&(r=-1),u=n.getCellType(t,e,i),a=n.li,s=n.Fi(),f=n.getActualStyle(t,e,i),r=n.getCellRect(t,e,r,o),o=!1,i===h.SheetArea.rowHeader?o=r.x>=s.x&&r.y>=s.y+s.qC&&r.x+r.width<=s.Py&&r.y+r.height<=s.Ay+s.Iy:i===h.SheetArea.colHeader?o=r.x>=s.x+s.XC&&r.y>=s.y&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Cy:i===h.SheetArea.viewport&&(o=r.x>=s.b6&&r.y>=s.T6&&r.x+r.width<=s.Hy+s.zy&&r.y+r.height<=s.Ay+s.Iy),r&&0<r.width&&0<r.height&&o&&a&&a.parentNode&&u.Rn(a.parentNode.parentNode,f,r,c={sheet:n,row:t,col:e,sheetArea:i})},c.prototype.Rde=function(n){var t,e,i,r,t=this;if(!t.bvt)return!1;if(e=!1,i=t.Mf,(r=n.il)&&i.setFormula(t.bZ,t.mvt,r.text()),i!==n){if(h.Commands.VA.Yvt(i),!i.endEdit())return;e=!0}else r&&(r.destroy(),n.il=d,n.Nde=d),t.d5();return e},o=c,l.Ovt=function(n,t){(l.Rvt=l.Rvt?l.Rvt:new o).kvt(t)},l.Bvt=function(n,t){(l.Rvt=l.Rvt?l.Rvt:new o)._vt(t)},t.wvt=u=l,a=i.Ode.Ede,i.Ode.Ede=function(){return a()||u.Rvt}},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(n,t,e){var m,t,r,o,x,u,A,a;function C(n){var t,t,e,t=n.il,e=n.rt,t=t.XD?e.Lvt:e.Lvt={anchorRow:n.ui,anchorCol:n.ci,leadingRow:n.qA,leadingCol:n.hR};return t}function s(n,t,e,i,r){var o,u,u,u,a,s,f,c,a,s,t,l,g,h,u,v,d,I,p,l,g,I,p,l,o=n.il,u=n.parent,u=u&&u.options;if(o&&o.Dvt()&&u&&u.allowUserEditFormula&&u.enableFormulaTextbox){switch(a=(u=C(n)).anchorRow,s=u.anchorCol,f=u.leadingRow,c=u.leadingCol,A(i)&&(i=a),A(r)&&(r=s),a=n.rt,t){case 3:h=n.sI(i,r,e,f);break;case 4:h=n.uI(i,r,e,f);break;case 1:h=n.lR(i,r,e,c);break;case 2:h=n.gR(i,r,e,c);break;case 5:h=n.yR();break;case 6:h=n.bR()}h&&(s=h.row,t=h.col,l=h.leadingCellRow||s,g=h.leadingCellCol||t,n.dR(s,t))&&(u.anchorRow=s,u.anchorCol=t,u.leadingRow=l,u.leadingCol=g,u=n.pivotTables&&n.pivotTables.findPivotTable(l,g),v=o.shift,d=o.ctrl,p=(I=u&&u.getPivotInfoImp(l,g,!1,!0))&&I.area,!o.Ivt&&u&&I&&4===p?(o.Fvt=new m.Range(l,g,1,1),l=I.valueFieldName,g=I.rowInfos,I=I.colInfos,(g||I)&&(p=n.rt.Pvt(p,l,g,I,u.position()))&&(o.Gvt(p,v,!d,!0),o.rb=!1)):(delete o.Fvt,(l=(0,x.Uvt)(a.Mf,(0,m.Ec)(s,t,1,1)))&&o.Gvt(l,!1,!0)),0<=s)&&0<=t&&n.OA(s,t)}}function i(n,t){var e;return!!n&&2!==n.Di&&((e=n.il)&&e.Dvt()?s(n,t,!1):(n=e?a.Hvt(n):n).G5(t,!1),!0)}function f(n,t,e,i){var r;return!!n&&2!==n.Di&&((r=n.il)&&r.Dvt()?s(n,t,!1,e,i):(n=r?a.Hvt(n):n).G5(t,!1,e,i),!0)}function c(n,t,e){var i,r,r,r,o,u,o,a,a,n,a,i=n.il,r=n.parent,r=r&&r.options;i&&i.Dvt()&&r&&r.allowUserEditFormula&&r.enableFormulaTextbox&&(r=n.rt,u=(o=C(n)).anchorRow,o=o.anchorCol,a=i.XD?(a=i.zvt(),(0,x.Vvt)(n,a.text)):(0,m.Ec)(u,o,1,1))&&(n=n.HR(a,t,e,u,o),a=(0,x.Uvt)(r.Mf,n))&&i.Gvt(a,!0,!1)}function l(n,t,e){if(n){if(2===n.Di)return!1;var i=n.il;if(i&&i.Dvt())c(n,t,e);else{if(!(n=i?a.Hvt(n):n).endEdit())return!1;n.HA(t,e)}return!0}return!1}function g(){}Object.defineProperty(t,"__esModule",{value:!0}),m=e("Core"),t=e("Common"),r=e("./dist/plugins/formulaTextbox/formulatextbox.js"),o=e("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),x=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),u=void 0,A=t.Common.lt.ht,m.Commands.B5=i,m.Commands.UA=f,m.Commands.L5=l,g.YA=function(n){return g.Hvt(n)},g.ZA=function(n){return g.Hvt(n)},g.WA=function(n){return g.Hvt(n)},g.Hvt=function(n){var n,t,n=n,t=o.wvt.Rvt;return t&&t._text&&t.Mf&&(n=t.Mf,g.Yvt(n)),n},g.Yvt=function(n,t){var e,i;void 0===t&&(t=!0),e=n.parent,(i=o.wvt.Rvt)&&i._text&&e.e3(n,t)},g.KA=function(n,t,e){var i,r,o,t,i=!1,r=n.il;return r&&r.Dvt()?((o=C(n)).anchorRow=t,o.leadingRow=t,(t=(0,x.Uvt)(n,(0,m.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(t,!1,!0),n.$A(e),i=!0):r&&(n=g.Hvt(n)),{sheet:n,r:i}},g.eI=function(n,t,e){var i,r,o,t,i=!1,r=n.il;return r&&r.Dvt()?((o=C(n)).anchorRow=t,o.leadingRow=t,(t=(0,x.Uvt)(n,(0,m.Ec)(o.anchorRow,o.anchorCol,1,1)))&&r.Gvt(t,!1,!0),n.$A(e),i=!0):r&&(n=g.Hvt(n)),{sheet:n,r:i}},g.Zvt=function(n,t){var e,t,i,r,o,e=!1,t=t?5:6,i=n.il,r=n.ui,o=n.ci;return i&&i.Dvt()?(i.XD||(n.rt.Lvt={anchorRow:r,anchorCol:o,leadingRow:n.qA,leadingCol:n.hR}),s(n,t,!1,r,o),e=!0):i&&(n=g.Hvt(n)),{sheet:n,r:e}},g.iI=function(n){return g.Zvt(n,!0)},g.rI=function(n){return g.Zvt(n,!1)},g.oI=function(n){return g.Hvt(n)},g.aI=function(n){return g.Hvt(n)},g.cI=function(n){var t,e,i,t,t=o.wvt.Rvt;if(t&&t._text&&t.Mf&&(n=t.Mf,e=t.bZ,i=t.mvt,g.Yvt(n,!1),(0,r.Wvt)(n),t.rl||n.t4(e,i,u,u,1),n.isEditing()))return t=n.getValue(e,i,3),!!n.ol(!0,void 0,void 0,!0)&&(n.setValue(e,i,t,3,!0),!0)},a=g,m.Commands.VA=a},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(n,t,e){var t,h,v,d,e,I;Object.defineProperty(t,"__esModule",{value:!0}),t=e("Core"),h=e("CalcEngine"),v=e("SheetsCalc"),d=e("./dist/plugins/formulaTextbox/formulaReferencedRanges/formulaReferencedRanges.js"),e=t.GC$.extend,I=null,e(t.nk.prototype,{hI:function(){var n,t,e,i,r,o,o,u,a,s,f,c,l,t,g,o,n,t=this.Mf,e=t.il;if(e)if(i=t.ui,r=t.ci,o=(o=t.parent)&&1===o.options.referenceStyle,u=new v.SheetParserContext(t,o,(0,h.eV)(i,r)),a=new h.Parser,e.XD)for(c=e.fmt(),l=0;l<c.length;l++){s=c[l];try{f=a.parse(u,s.text)}catch(n){f=I}f&&1===f.type&&((0,d.lmt)(f,i,r,!0,!0),e.Lde(s.index,a.unparse(u,f)))}else if(s=e.zvt()){try{f=a.parse(u,s.text)}catch(n){f=I}f&&1===f.type&&(f.isFullColumn||f.isFullRow?((0,d.lmt)(f,i,r,!0,!0),e.Lde(s.index,a.unparse(u,f))):f.hmt()?((0,d.dmt)(f,i,r),e.Lde(s.index,a.unparse(u,f))):(t=s.textOffset+s.text.lastIndexOf(":"),(g=e.caret()<=t)?((0,d.lmt)(f,i,r,!0,!1),o=a.unparse(u,f),e.Lde(s.index,o),e.caret(s.textOffset+o.lastIndexOf(":"))):((0,d.lmt)(f,i,r,!1,!0),e.Lde(s.index,a.unparse(u,f)))))}}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(n,t,e){var t,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=(t=e("Core")).GC$.extend)(t.g7.prototype,{ID:function(){this.kde()}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(t,a,n){var p,L,h,m,l,x,s,f,F,i,u,g,c,v,d,I,e,A,C,r,b,T,R,o,M,j,w,y,U,Z,z,_,Y,D,N,B,Q,W,V,X,K,H,J,q,$,nn,tn,E,S,O,en,n,rn,on,un;function an(n,t){for(var e,i,e=0,i=0;i<n.length;i++)n[i]===t&&e++;return e}function sn(){var e=[];return m.GC$.each(p.sR().wmt,function(n,t){p.Functions.Mmt[n]&&(t.name=n,e.push(t))}),e}function fn(n){var e=[],i;return m.GC$.each(n,function(n,t){(i=t.description())&&(i.name=n,e.push(i))}),e}function G(n){var t,t,t=p.getMapping()&&p.getMapping().builtInFunctionsMapping,t=t&&t[n]&&t[n].alias||n;return v.j0(t)}function cn(n,t,e){var e;return e?(e=new RegExp(O,"g"),n.replace(e,"")===t.replace(e,"")):n===t}function ln(n){for(var t,e,i,r,o,u,t=[],e=0,i="";i!==x;)i=n.getColumnName(e),o=void 0,n.Mf.NMi&&(o=n.FDi(e))&&(r=e),e++,i!==x&&t.push({name:i,description:"",isGroupColumn:o});return u={columns:t},I(r)||(u.groupInfo={rightGroupColumnIndex:r}),u}function gn(e,n,t,i,r,o){var u,a,t,n,s,f,c,u=e.parent,a=u&&u.options;(n&&a&&a.allowUserEditFormula&&a.enableFormulaTextbox||t)&&(e.il&&e.il.destroy(),e.il=new un(n,null,u),e.Nde=e.il,t=e.il.text(),n=e.getFormulaInformation(i,r,o),t[0]!==en||n&&n.hasFormula||t===en||a.allowInvalidFormula||e.il.text(t="'"+t),s=e.il,f=e.rt,c=e.Dn,s.bind("AppendStarted",function(){s.close();var n=e.Di;1!==n&&(e.Di=1,e._i(n,1))}),s.bind("AppendEnded",function(){c.ID()}),s.bind(w,function(n,t){var t;e.xT||(t&&t.type!==b&&(f.By(t),t=e.getCellType(i,r,o),e.ki(m.Events.EditChange,{sheet:e,sheetName:e.name(),row:i,col:r,editingText:t.getEditorValue(e.li)})),c.ID(),e.ki(m.Events.FormulaTextBoxTextChanged,{sheet:e,sheetName:e.name(),text:s.text(),sheetArea:o}))}),s.bind("CaretChanged",function(){c.ID(),e.ki(m.Events.FormulaTextBoxCaretChanged,{sheet:e,sheetName:e.name(),caret:s.caret()})}),s.add(sn()),s.add(fn(p.Functions.Tmt)),s.add(fn(e.Amt).concat(fn(u.Amt))),c.ID())}function hn(n){n.il&&(n.il.destroy(),n.il=x,n.Nde=x,n.Dn.ID());var t=n.parent&&n.parent.h6;c.activeElement===(t&&t.Ti)&&n.rt.aA()}function vn(n,t){var n,e,i,e,i,r,e,n,o,i,o,n=(0,m.GC$)(n);return n.attr("contenteditable","false"),e=u("table"),(0,m.GC$)(e).css("border-spacing","0"),(0,m.GC$)(e).css("width","100%"),n.append(e),i=u("tbody"),e.appendChild(i),e=document.createElement("tr"),i.appendChild(e),i=document.createElement("td"),(0,m.GC$)(i).css("padding-right","0px"),e.appendChild(i),r=document.createElement("td"),(0,m.GC$)(r).css("width","23px"),(0,m.GC$)(r).css("padding-right","0px"),e.appendChild(r),e=n.width()-(0,m.GC$)(r).width(),n=u("div"),o=u("div"),(0,m.GC$)(o).width(e),(0,m.GC$)(o).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),o.appendChild(n),i.appendChild(o),i=u("div"),r.appendChild(i),(0,m.GC$)(n).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),(0,m.GC$)(n).width(e),(0,m.GC$)(n).attr("contenteditable","true"),(0,m.GC$)(n).attr("spellcheck","false"),(o=(0,m.GC$)(i)).css({display:"block",float:"right",width:"23px",height:"23px",background:q,"background-repeat":"no-repeat"}),o.bind("click",function(){t.Imt?(t.Vv.ki("RangeSelectEnding",t),t.endSelectMode()):t.startSelectMode()}),{contentDiv:n,button:i}}function dn(n){for(var t,e,t=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"],e=0;e<t.length;e++)if(n===t[e])return 1}function k(n,t,e){var i,r,t,t,o,u,i=this,r=n;if(i.rl=!1,i.Ivt=!1,i.xmt=!0,i.Smt=!0,i.Nmt=[],i.kmt=[],i.Dmt=[],i.U6=!1,t&&t.rangeSelectMode&&(!0===t.absoluteReference&&(i.Ivt=!0),!1===t.needSheetName&&(i.Smt=!1),!1===t.acrossSheet&&(i.xmt=!1),i.Lve=t.needFuncHelp,i.Xvt=t.selectionUnit,i.rl=!0,i.Imt=!1,i._mt=!1,r=(t=vn(i.Emt=n,i)).contentDiv,i.jmt=t.button,i.Omt=n,i.Avt=on,on++),i.cmt=!0,i.Hc(e&&e.getHost()||c.body),r&&i.Rmt(r),e&&(i.Bmt=!0,i.Lmt(e),i.Vv._3(m.Events.ActiveSheetChangingInternal+M,l.wvt.Ovt),i.Vv.D3(m.Events.ActiveSheetChangingInternal+M,l.wvt.Ovt),i.Vv._3(m.Events.ActiveSheetChangedInternal+M,l.wvt.Bvt),i.Vv.D3(m.Events.ActiveSheetChangedInternal+M,l.wvt.Bvt),i.Vv._3(m.Events.FormulaTextBoxUpdatePosition+R,void 0),i.Vv.D3(m.Events.FormulaTextBoxUpdatePosition+R,function(n,t){i.u_()})),t=i.text(),i.Fmt=i.Ost(t),o=i.vmt(r)){i.Pmt(i.Fmt);try{(u=g.getSelection()).selectAllChildren(r),0<u.rangeCount&&u.collapseToEnd()}catch(n){}(0,m.GC$)(i.Ti).data(E,t)}(0,m.GC$)(n).data(a.CONST_FORMULATEXTBOX,i)}function In(){var n,t,e,t,n=g.getSelection();0<n.rangeCount&&(t=n.getRangeAt(0),(e=c.createElement("span")).innerHTML="<br/>\u200b",t.insertNode(e),(t=c.createRange()).setStartAfter(e),t.setEndAfter(e),t.collapse(!1),n.removeAllRanges(),n.addRange(t))}function P(n){return"gcAttachedFormulaTextBox"===n.target.getAttribute("gcuielement")}Object.defineProperty(a,"__esModule",{value:!0}),a.FormulaTextBox=a.Wvt=a.Evt=a.CONST_FORMULATEXTBOX=void 0,p=n("CalcEngine"),L=n("SheetsCalc"),h=n("Common"),m=n("Core"),l=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),x=null,s=void 0,f=Math.max,F=Math.min,i=m.GC$.extend,u=m.mt.En,g=window,c=document,v=h.Common.zf,d=m.mt.vi,I=h.Common.lt.ht,e=m.mt.Tt,A=e.msie&&parseInt(e.version,10)<10,C=v.Gmt,a.CONST_FORMULATEXTBOX="formulatextbox",r="gcUIElement",b="input",T="\xa0",R=".gcFormulaTextBoxInternal",o=".gcFormulaTextBox",M=".gcFormulaTextBoxAcrossSheetInternal",j=".gcsj-func-ac-row",w="TextChanged",y="CaretChanged",U="AppendStarted",Z="AppendEnded",_=37,Y=39,D=38,N=40,B=9,Q=13,W=33,V=34,X=35,K=36,H=27,J=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],q='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',$='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',nn="background",tn="background-repeat",E="text-before",S="caret-before",O="\u200b",en="=",m.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",m.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",m.Events.FormulaTextBoxUpdatePosition="FormulaTextBoxUpdatePosition",g.Vc.wf.push(function(n,t){var e,t,e=l.wvt;!t&&n.endEdit&&e&&(t=e.Rvt)&&t.bvt&&n.il&&(n.il&&n.il.destroy(),n.il=x,n.Nde=x,t.rl||t.d5())}),a.Evt=gn,a.Wvt=hn,m.Worksheet.ch(a.CONST_FORMULATEXTBOX,{startEdit:function(n){n.preventFormulaTextBox||gn(this,n.element,s,n.row,n.col,n.sheetArea)},endEdit:function(){hn(this)},preProcessKeyDown:function(n){var t,t,t=this.il;(t&&t.$D(n.e)||(t=this.parent&&this.parent.h6)&&t.$D(n.e,n.c))&&(n.r=!0)}}),n=m.Hv.prototype,rn=n.O2,m.Hv.ch(a.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(n){var t,t,t,e,t=(0,m.jf)(this.Vv),t=t?t.il:void 0,t=t&&t.Dvt(),e=l.wvt.Rvt;t?n.r=!1:e&&e.bvt&&e.d5()}}),n.O2=function(){var n=(0,m.jf)(this.Vv),n=n&&n.il,t=l.wvt.Rvt,t=t&&t._text;return rn.call(this)&&!t&&!n},on=1,k.prototype.Umt=function(n){var t,e,i,e,n,r,o,t=this;t.Hmt(),t.FD(),t._mt=!0,e=(0,l.Mvt)(t.Vv.Ti),(i=t.zmt())&&(i.suspendPaint(),gn(i,e,!0,i.ui,i.ci,3),(e=i.il).rl=!0,e.Avt=t.Avt,e.Ivt=t.Ivt,e.Smt=t.Smt,e.Xvt=t.Xvt,e.xmt=t.xmt,n&&(t.text(n),t.caret(n.length)),n=t.text(),(r=t.caret())<=0&&(r=n.length),t.focus(),t.caret(r),t.XD=!0,-(t.umt=1)!==(o=n.lastIndexOf(",",r))&&(t.umt=o+1),n||(t.text("="),n="=",t.caret(1),r=1),"="!==n[0]&&(n="="+n,r++),e.text(n),e.caret(r),e.XD=t.XD,e.umt=t.umt,i.resumePaint())},k.prototype.startSelectMode=function(n){var n,t,n=n;n&&0!==n.indexOf("=")&&(n="="+n),(t=this).rl=!0,t.Imt=!0,(0,m.GC$)(t.jmt).css([nn,tn],[$,"no-repeat"]),t.Umt(n)},k.prototype.endSelectMode=function(){this.Imt=!1,this.Vmt(),(0,m.GC$)(this.jmt).css([nn,tn],[q,"no-repeat"])},k.prototype.Vmt=function(){var n=this.zmt();n&&(n.ol(!0,s,!0),n.repaint())},k.prototype.Ak=function(n){n&&(this.Dmt=[n])},k.prototype.Hce=function(){this.Dmt=x},k.prototype.Ymt=function(){return this.Dmt},k.prototype.destroy=function(){var n=this;n.Imt&&n.Vmt(),n.Dmt=x,n.XD=!1,n.umt=-1,n.Zmt(),n.Wmt(),n.Qmt(),(0,m.GC$)(n.Kmt).remove(),(0,m.GC$)(n.Jmt).remove(),(0,m.GC$)(n.F0).remove()},k.prototype.bind=function(n,t,e){var i=this.Ti;i&&n&&(n=n.split(/\s+/).join(o+" "),(0,m.GC$)(i).bind(n+o,t,e))},k.prototype.unbind=function(n,t){var e=this.Ti;e&&n&&(n=n.split(/\s+/).join(o+" "),(0,m.GC$)(e).unbind(n+o,t))},k.prototype.unbindAll=function(){var n=this.Ti;n&&(0,m.GC$)(n).unbind(o)},k.prototype.caret=function(n){var t,e,i,r,t=this,e=t.Ti;if(e){if(i=c.activeElement===e,r=(0,m.GC$)(e),0===arguments.length)return i?t.Xmt(e).end:r.data(S);n!==t.caret()&&(i?(t.qmt(e,n),r.data(S,t.Xmt(e).end)):r.data(S,n),t.ki(y,{}))}},k.prototype.Xmt=function(n){var t,e,i,t,t,r,t=this,e=-1,i=-1;return t.$mt(n)?(e=n.selectionStart,i=n.selectionEnd):t.vmt(n)&&0<(t=g.getSelection()).rangeCount&&((r=(t=t.getRangeAt(0)).cloneRange()).selectNodeContents(n),r.setEnd(t.endContainer,t.endOffset),i=r.toString().length,(r=t.cloneRange()).selectNodeContents(n),r.setEnd(t.startContainer,t.startOffset),e=r.toString().length,r.detach()),{start:e,end:i}},k.prototype.qmt=function(n,t){var e,t,i,e,r,e=this;e.$mt(n)?n.setSelectionRange(t,t):e.vmt(n)&&(e=this.tgt(n,t))&&(t=g.getSelection(),i=c.createRange(),(r=e.node)&&1===r.childNodes.length?i.setStart(r.firstChild,e.offset):r.lastChild&&r.lastChild.length&&i.setStart(r.lastChild,r.lastChild.length),i.collapse(!0),t.removeAllRanges(),t.addRange(i),this.rl)&&(n.parentElement.scrollTop=n.parentElement.scrollHeight)},k.prototype.text=function(n){var t,e,i,i,r,o,u,a,u,u,i,r,t=this,e=t.Ti,i=t.zmt();if(!e)return"";if(!i||i.xT)return e.innerHTML="";if(i=t.$mt(e),r=t.vmt(e),o=t.hfe(e),0===arguments.length){if(u="",i)u=e.value;else if(r){if(0<(a=e.getElementsByClassName("gcsj-func-gray-formula")).length)return"";0<=(u=(u=A?m.mt.oi(e):e.innerText).replace(/\r\n?/g,"\n")).indexOf(T)&&(u=m.mt.yi(u,T," "))}else o&&0<=(u=(u=A?m.mt.oi(e):e.innerText).replace(/\r\n?/g,"\n")).indexOf(T)&&(u=m.mt.yi(u,T," "));return u}(n=null==n?"":n)!==t.text()&&(u=t.ngt(n),t.Fmt=u?t.Ost(u):t.Ost(n),i?e.value=n:r?(u=t.egt(t.Fmt,n),t.Pmt(u),t.caret(n.length)):o?e.innerHTML=n:e.value=n,i={},(r=l.wvt.Rvt)&&r._text&&(i={sheet:r.Mf,editor:r.bvt&&r.bvt.firstChild.firstChild,canvasOffset:r.yvt}),t.ki(w,i)),t.igt&&t.rgt()},k.prototype.I6=function(){var n=this;(0,m.GC$)(n.Ti).data(E,n.text())},k.prototype.autoComplete=function(n){if(0===arguments.length)return this.ogt;this.ogt=n},k.prototype.showHelp=function(n){if(0===arguments.length)return this.agt;this.agt=n},k.prototype.add=function(n){var t,e;if(n)if(m.GC$.isArray(n))for(t=n.length,e=0;e<t;e++)this.ZP(n[e]);else this.ZP(n)},k.prototype.ZP=function(n){var t,e,i,r,o,t=n&&C(G(n.name));if(t){for(i=(e=this.ugt).length,r=0;r<i;r++){if((o=C(e[r].name))===t)return;if(t<o)break}e.splice(r,0,n)}},k.prototype.remove=function(n){var t,e,i;if(n)for(n=C(n),e=(t=this.ugt).length,i=0;i<e;i++)if(C(t[i].name)===n){t.splice(i,1);break}},k.prototype.workbook=function(n){var t=this;if(0===arguments.length)return t.Vv;n===x?t.rl&&t.Vmt():(t.Lmt(n),t.sgt())},k.prototype.Lmt=function(n){var t,e;n&&((t=this).Vv&&t.Wmt(),e=t.Ti)&&(t.Vv=n)},k.prototype.smt=function(){var n,t,e,i,r,o,u,a,s,f,n=[],t=this.Fmt,e=t&&t.length,o=0,u=0;if(0<e)for(a=0;a<e;a++)r=(i=t[a]).text,11===i.type&&(s={textOffset:o,text:r,ranges:i.ranges,index:u,allowDrag:i.allowDrag},"number"==typeof i.sheetArea&&(s.sheetArea=i.sheetArea),n.push(s),u++),o+=r.length;return(f=this.Fvt)&&n.push({ranges:[f],index:u,allowDrag:!1,isPivotClickCell:!0}),n},k.prototype.zvt=function(){var n,t,e,i,r,o,u,n=this.Ti,t=this.smt();if(n&&t&&0<t.length)for(e=this.caret(),i=t.length,o=r=void 0,u=0;u<i;u++){if((o=(r=t[u]).textOffset)<=e&&e<=o+r.text.length)return r;if(e<=o)break}return x},k.prototype.ymt=function(n){var t,e,n;return!!n&&(t=this.caret(),e=n.text,(n=n.textOffset)<=t)&&t<=n+e.length},k.prototype.pmt=function(n){var t,e,i,r,o,u,a,s,f,t=this.smt(),e=t.length;if(n<0||e<=n)return"";for(i=[],u=o=0;u<e;u++){for(r=t[u],a=!1,s=0;s<i.length;s++)if(r.text&&i[s].text.replace(/\s+/g,"").toUpperCase()===r.text.replace(/\s+/g,"").toUpperCase()){a=!0;break}if(a){if(n===u){o=s;break}}else if(i.push(r),n===u){o=i.length-1;break}}return J[o%J.length]},k.prototype.Dvt=function(){var n,t,n;return!!this.XD||!!this.rl||!!(0,m.Df)(this.text())||!!(n=this.cgt(this.caret()))&&(t=n.type,n=n.text,1===t||8===t||7===t&&"%"!==n||5===t||9===t||15===t)},k.prototype.bmt=function(n){var t,e,t;return!(!n||!this.XD)&&(t=this.umt,e=this.caret(),t<=(t=n.textOffset))&&t<e},k.prototype.fmt=function(){var n,t,e,i,r,n=[],t=this.smt(),e=t.length;if(0<e)for(r=0;r<e;r++)i=t[r],this.bmt(i)&&n.push(i);return n},k.prototype.Gvt=function(n,t,e,i,r){var o,u,u,a,s,f,e,t,t,c,e,i,a;if(void 0===r&&(r=m.SheetArea.viewport),u=(o=this).Ti,n&&u){if(!o.XD){if(!o.Dvt())return;o.XD=!(t=!1),o.umt=o.caret(),o.ki(U,{})}u=o.umt,a=o.text(),s=o.caret(),a||(a="=",s=u=o.umt=1),f=s,e&&(t=!1,a=a.substr(0,u)+(s<0?"":a.substr(s)),o.Fmt=o.Ost(a),f=s=u),e=o.cgt(s),t?(t=(t=a.substr(0,s)).substr(0,t.length-e.text.length)).length>=u&&(e.text=n,f=t.length+n.length):(t=o.Fmt,c=h.Common.Uf.hD(t,e),e=o.rl&&1<t.length&&c===t.length-1&&11===e.type,i?(n=u<s||e?a+this.fgt()+n:a.slice(0,s)+n+a.slice(s),o.Fmt=o.Ost(n)):u<s||e?(t.splice(c+1,0,{text:this.fgt(),type:8}),t.splice(c+2,0,{text:n,type:11,sheetArea:r}),n=","+n):t.splice(c+1,0,{text:n,type:11,sheetArea:r}),f=s+n.length),o.lgt(),i={},(a=l.wvt.Rvt)&&a._text&&(i={sheet:a.Mf,editor:a.bvt&&a.bvt.firstChild.firstChild,canvasOffset:a.yvt}),o.ki(w,i),o.caret(f)}},k.prototype.qD=function(){var n=this;n.XD&&(n.XD=!1,n.umt=-1,n.ki(Z,{}))},k.prototype.Nvt=function(){this.XD=!0,this.umt=this.caret()},k.prototype.Tvt=function(n){return void 0!==n&&(this.umt=n),this.umt},k.prototype.Lde=function(n,t,e){var i,r,o,u,a,s,f,c,l,i=this,r=i.Ti;if(r&&!(n<0)&&t){for(o="",u=!1,s=(a=i.Fmt)&&a.length,l=c=0;l<s;l++){if(11===(f=a[l]).type&&c++===n){a[l]={text:t,type:11,sheetArea:f.sheetArea},u=!0;break}o+=f.text}u&&(i.lgt(),i.ki(w,{}),e?i.caret(i.text().length):i.caret(o.length+t.length))}},k.prototype.sgt=function(){var n,t,t,n=this;n.Vv&&(t=n.Ti,n.Vv)&&t&&(t.setAttribute(r,"gcAttachedFormulaTextBox"),n.rl||(n.Vv.h6=n),n.Vv.D3(m.Events.FormulaTextboxEditStarted+R,n,n.hgt),n.Vv.D3(m.Events.EnterCellInternal+R,n,n.dgt),n.Vv.D3(m.Events.FormulaTextboxEditEnded+R,n,n.vgt),n.Vv.D3(m.Events.ActiveSheetChangedInternal+R,n,n.mgt),n.Vv.D3(m.Events.RangeChangedInternal+R,n,n.ggt),n.Vv.D3(m.Events.FormulaTextBoxTextChanged+R,n,n.pgt),n.Vv.D3(m.Events.FormulaTextBoxCaretChanged+R,n,n.bgt),n.Vv.D3(m.Events.ValueChanged+R,n,n.ygt),n.Vv.D3(m.Events.CellChanged+R,n,n.ygt),(t=(0,m.jf)(n.Vv))&&!n.rl&&n.text(n.wgt(t,t.ui,t.ci)),n.D3(w,n,n.Mgt),n.D3(y,n,n.Cgt))},k.prototype.refresh=function(n){var t,e,t,t=this.Vv,e=this;t&&(t=(0,m.jf)(t))&&!e.rl&&(e.rb=!!n||e.rb,e.text(e.wgt(t,t.ui,t.ci)),e.rb=!1)},k.prototype.Wmt=function(){var n=this,t=n.Vv;!n.Bmt&&t&&(n.rl||(t.h6=null,t._3(m.Events.FormulaTextboxEditStarted+R,n.hgt),t._3(m.Events.EnterCellInternal+R,n.dgt),t._3(m.Events.FormulaTextboxEditEnded+R,n.vgt),t._3(m.Events.ActiveSheetChangedInternal+R,n.mgt),t._3(m.Events.RangeChangedInternal+R,n.ggt),t._3(m.Events.FormulaTextBoxTextChanged+R,n.pgt),t._3(m.Events.FormulaTextBoxCaretChanged+R,n.bgt),t._3(m.Events.ValueChanged+R,n.ygt),t._3(m.Events.CellChanged+R,n.ygt),n._3(w,n.Mgt),n._3(y,n.Cgt)),n.text("")),n.Vv=null},k.prototype.Hmt=function(){var n,t,t,n=this;n.rb||(n.rb=!0,(t=(t=this.Vv)&&(0,m.jf)(t))&&!t.isEditing()?(n.rl||t.f6(null,t.ui,t.ci,null,null,!1,null),n.Sgt=!0):t&&1===t.Di?(t.Di=2,t._i(1,2)):n.Sgt=!1,n.rb=!1,n.Tgt)||n.w6()},k.prototype.Agt=function(){var n=this,t=n.Ti,e=n.Igt;t.insertBefore(e,t.firstChild),e.innerText=n.igt},k.prototype.xgt=function(n,t){var e;n&&this.Ngt!==t&&(this.Ngt=t,n.style.display=t?"":"none")},k.prototype.rgt=function(){var n,t,e,i,n=this,t=n.Ti,e;n.vmt(t)?((i=n.Igt)||((i=n.Igt=u("span")).className="gcsj-func-gray-formula"),n.xgt(i,!0),n.Agt()):t.placeholder=n.igt},k.prototype.kgt=function(){var n,t,e,n=this;n.igt&&(n.igt="",t=n.Ti,(e=n.vmt(t))?n.xgt(n.Igt,!1):t&&(t.placeholder=""))},k.prototype.FD=function(){var n,t,t,e,i,r,o,u,i,n=this,t=n.Vv,t=t&&(0,m.jf)(t);t&&(e=t.il,n.Sgt&&e&&(i=e.text(),cn(r=n.text(),i,!0)||(o=n.caret(),u=t.getFormulaInformation(t.getActiveRowIndex(),t.getActiveColumnIndex(),3),n.text(i),u.isArrayFormula&&(o>=r.length&&(o-=1),o=f(0,o-1)),n.caret(o))),n.Sgt&&e||n.rl)&&2!==(i=t.Di)&&(t.Di=2,t._i(i,2))},k.prototype.wgt=function(n,t,e){var i,r,r,o,o,u,i="";if(n){if(r=(r=n.parent)&&r.options,(o=n.getFormulaInformation(t,e,3))&&o.hasFormula){if(i="="+o.formulaWithCulture,o.isDynamicArray)return this.igt=i,"";this.igt="",o.isArrayFormula&&(i="{"+i+"}")}else o=n.getActualStyle(t,e),i="string"==typeof(u=n.getValue(t,e))&&(o.quotePrefix||1<u.length&&"="===u[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+u:m.mt.mi(o,u,n,{sheet:n,row:t,col:e,sheetArea:3})||"";this.kgt()}return i},k.prototype.mgt=function(n,t){var n,e,i,n=n.data;n.rb||(e=t.newSheet,n.rl)||(n.rb=!0,n.close(),t&&e&&n.text(n.wgt(e,e.ui,e.ci)),n.rb=!1)},k.prototype.hgt=function(n,t){var n,e,e,e,n=n.data;n.rb||(e=(e=(e=n.Vv)&&(0,m.jf)(e))&&e.il)&&n.rl===e.rl&&n.Avt===e.Avt&&t.sheetArea!==m.SheetArea.colHeader&&t.sheetArea!==m.SheetArea.rowHeader&&(n.kgt(),n.rb=!0,n.text(e.text()),n.rb=!1)},k.prototype.dgt=function(n,t){var n,e,i,n=n.data;n.rl||n.rb||(n.rb=!0,t&&(n.text(n.wgt(t.sheet,t.row,t.col)),n.Ti)&&(e=n.$mt(n.Ti),i=n.hfe(n.Ti),t.readonly?e?n.Ti.disabled=!0:i&&(n.Ti.contentEditable="false"):e?n.Ti.disabled=!1:i&&(n.Ti.contentEditable="true")),n.rb=!1)},k.prototype.ggt=function(n,t){var n,e,i,r,o,t,n=n.data;n.rb||n.rl||(n.rb=!0,t&&(e=t.sheet,i=t.row,r=t.col,o=t.rowCount,t=t.colCount,new m.Range(i,r,o,t).contains(e.ui,e.ci))&&n.text(n.wgt(e,e.ui,e.ci)),n.rb=!1)},k.prototype.vgt=function(n,t){var n,e,n=n.data;n.rl&&n.Imt&&n._mt?t.ignore=!0:n.rb||t.sheetArea!==m.SheetArea.colHeader&&t.sheetArea!==m.SheetArea.rowHeader&&(n.rb=!0,n.close(),(e=l.wvt.Rvt)&&e._6(t.sheet),t&&t.sheet.il&&!t.sheet.il.rl&&!n.rl&&n.text(n.wgt(t.sheet,t.row,t.col)),n.rb=!1)},k.prototype.ygt=function(n,t){var e,i,e=t.sheet,i=e&&e.parent&&e.parent.h6;i&&i.Dgt()===t.row&&i._gt()===t.col&&i.zmt()===e&&n.data instanceof k&&(t.text=n.data.wgt(e,t.row,t.col),n.data.pgt(n,t))},k.prototype.pgt=function(n,t){var n,e,n=n.data;n.rb||t.sheet.il&&(n.rl!==t.sheet.il.rl||n.Avt!==t.sheet.il.Avt)||t.sheetArea===m.SheetArea.colHeader||t.sheetArea===m.SheetArea.rowHeader||(n.rb=!0,t&&(e=n.caret(),n.text(t.text),n.caret(e)),n.rb=!1)},k.prototype.bgt=function(n,t){var n=n.data;n.rb||t.sheet.il&&(n.rl!==t.sheet.il.rl||n.Avt!==t.sheet.il.Avt)||(n.rb=!0,t&&n.caret(t.caret),n.rb=!1)},k.prototype.Mgt=function(n){var n,t,t,e,i,r,o,u,r,n=n.data;if(!n.rb&&(t=(t=n.Vv)&&(0,m.jf)(t))){if(t.isEditing()||(n.Hmt(),n.focus()),n.rb=!0,e=t.ui,i=t.ci,r=t.il,o=t.getCellType(e,i),r){if(n.rl!==r.rl||n.Avt!==r.Avt)return;u=r.caret(),r.text(n.text()),r.caret(u)}else r={sheet:t,row:e,col:i,sheetArea:3},o.setEditorValue(t.li,n.text(),r);n.rb=!1}},k.prototype.Cgt=function(n){var n,t,t,t,n=n.data;n.rb||(t=(t=n.Vv)&&(0,m.jf)(t))&&t.isEditing()&&((t=t.il)&&(n.rl!==t.rl||n.Avt!==t.Avt)||(n.rb=!0,t&&(t.caret(n.caret()),n.w6()),n.rb=!1))},k.prototype.Hc=function(n){var t,e,i,i,t=this;t.Egt=!1,t.jgt=!1,t.XD=!1,t.umt=-1,t.ugt=[],t.ogt=!0,t.agt=!0,t.Ogt=!0,(e=u("div")).className="gcsj-func-ac-popup",e.style.display="none",e.setAttribute(r,"gcFuncACPopup"),n.insertBefore(e,x),t.Kmt=e,t.Tgt=!1,(i=u("div")).className="gcsj-func-help-popup",i.style.display="none",i.setAttribute(r,"gcFuncHelpPopup"),n.insertBefore(i,x),t.Jmt=i,(t.Rgt=!1,m.GC$)(e).bind("mouseover",function(){t.Ogt=!1}).bind("mouseout",function(){t.Ogt=!0}),(0,m.GC$)(i).bind("mouseover",function(){t.Ogt=!1}).bind("mouseout",function(){t.Ogt=!0}),(0,m.GC$)(e).bind("scroll",function(){t.Bgt&&clearTimeout(t.Bgt),t.Bgt=g.setTimeout(function(){t.Ti&&t.Ti.focus()},100)}),(i=u("div")).style.display="none",i.setAttribute(r,"gcFuncHelpDiv"),n.insertBefore(i,x),t.F0=i,t.Vv=null,t.rb=!1,t.Sgt=!1,t.Bmt=!1},k.prototype.Rmt=function(n){var f,c,t;n&&(c=(f=this).vmt(n),f.$mt(n)||c)&&(t=(0,m.GC$)(n),f.Ti&&f.Zmt(),f.Ti=n,e&&(e.msie||e.chrome)?c||A||e.chrome?(f.D3("focus",function(){t.data(E,f.text())}),f.D3("click",function(){t.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(n){f.D3(n,function(){f.Lgt()})})):f.D3(b,function(){f.Fgt()}):f.D3(b,function(){var n;c&&(n=f.Ti.lastChild,e.chrome)&&n&&"BR"===n.tagName&&f.Ti.removeChild(n),f.Fgt()}),f.D3("keydown",function(n){var t,e,i,r,o,u,a,s,a,a,s,t=n.ctrlKey,e=n.shiftKey,i=n.altKey,r=n.metaKey,o,u=n.keyCode;t||e||i||r||!f.Tgt||(u===N?(f.Pgt(1),d(n)):u===D?(f.Pgt(-1),d(n)):u===B&&(f.Ggt(),d(n))),u===H&&f.close(),f.Ugt(n),s=(a=(0,m.jf)(f.Vv))&&a.rt.Pi(n),f.rl&&s&&(a=a.il)&&a.XD&&a.qD(),c&&(s?(8===u?P(n)&&m.di.processBackspaceAndLeftArrowKeyEvent(n,!0):46===u&&P(n)&&m.di.processDeleteAndRightArrowKeyEvent(n,!0),f.mmt()):13===u&&(t||i)?(P(n)&&In(),f.mmt(!0)):37===u?P(n)&&m.di.processBackspaceAndLeftArrowKeyEvent(n,!1):39===u&&P(n)&&m.di.processDeleteAndRightArrowKeyEvent(n,!1),c)&&t&&(90===u||89===u)&&d(n),a=f.text(),m.mt.Qf()&&c&&r&&(s=void 0,90===u)&&(e?(s=f.kmt.pop())&&(f.text(s),f.Nmt.push(a)):(s=f.Nmt.pop()||"",f.text(s),f.kmt.push(a)),n.preventDefault(),n.stopPropagation())}),f.D3("keyup",function(n){var t,e,i,n;f.Ugt(n),t=f.text(),c&&(e=void 0,i=n.keyCode,(n=n.ctrlKey)&&90===i?(e=f.Nmt.pop()||"",f.text(e),f.kmt.push(t)):n&&89===i&&(e=f.kmt.pop())&&(f.text(e),f.Nmt.push(t)))}),f.D3("focus",function(n){var t;e&&e.mozilla&&!f.Ti.innerText&&(f.Ti.innerText=""),f.Ugt(n),f.rl&&f.Imt&&(f._mt=!0,f.Umt())}),f.D3("blur",function(){f.Ogt&&f.close(),f.rl&&(f.Vmt(),f._mt=!1)}),f.D3("mousedown",function(){f._mt=!0,f.Ngt&&f.igt&&(f.kgt(),f.Hgt=!0),f.Hmt()}),f.D3("mouseup",function(){var n,t;f.Hgt&&(f.Hgt=!1,(n=f.Ti)!==(t=g.getSelection()).anchorNode)&&t.selectAllChildren(n),f.FD()}),f.D3("click",function(n){var t,t,t;f.XD&&f.qD(),(t=(t=(t=f.Vv)&&(0,m.jf)(t))&&t.il)&&t.XD&&!t.rl&&t.qD(),f.Ugt(n)}),f.D3("compositionstart",function(){f.Egt=!0}),f.D3("compositionend",function(){f.Egt=!1,(e.edge||e.chrome||e.msie)&&f.Lgt()}))},k.prototype.Zmt=function(){var n,t,t,n=this,t=n.Ti;t&&((t=(0,m.GC$)(t)).removeData(E),t.removeData(S),t.removeAttr(r),t.data(a.CONST_FORMULATEXTBOX)&&t.data(a.CONST_FORMULATEXTBOX,x),n.E3(),n.unbindAll(),n.rl&&((0,m.GC$)(n.Emt).empty(),n.Emt=x),n.Ti=x)},k.prototype.Lgt=function(){var n=this,t=(0,m.GC$)(n.Ti),e=n.text();t.data(E)!==e&&(n.Egt||t.data(E,e),n.Fgt())},k.prototype.Ugt=function(n){var t;e&&e.msie?setTimeout(function(n,t){return function(){n.zgt(n,t)}}(this,n),10):this.zgt(this,n)},k.prototype.zgt=function(n,t){var e,i,e,t,i,e,t,e=t.keyCode,i=e===_||e===Y||e===K||e===X||e===V||e===W||e===B||e===Q;n.ogt||(i=i||e===D||e===N),e=void 0!==t.button,(i||e)&&(t=n.Ti,i=(0,m.GC$)(t),(e=n.Xmt(t)).start===e.end)&&(t=e.end,i.data(S)!==t)&&(i.data(S,t),n.ki(y,{}),n.w6())},k.prototype.Dgt=function(n){var n,t,n,n=n||this.zmt();return n?(t=n.ui,(n=n.vA)?n.row:t):s},k.prototype._gt=function(n){var n,t,n,n=n||this.zmt();return n?(t=n.ci,(n=n.vA)?n.col:t):s},k.prototype.Qvt=function(n){var n,t,n,n=n||this.zmt();return n?(t=m.SheetArea.viewport,(n=n.vA)?n.sheetArea:t):s},k.prototype.zmt=function(){if(this.Vv)return(0,m.jf)(this.Vv)},k.prototype.parseInternal=function(n,t,e,i,r){var o,u,a,a;return void 0===r&&(r=m.SheetArea.viewport),o=this,u=[],(0,m.kf)(n)&&an(n,'"')%2!=1?(a=new p.Parser,a=L.Vgt(a,n,t,e,i,!0,s,s,r),u=o.Ygt(a,n)):u.push({text:n,type:17}),u},k.prototype.Ost=function(n){var t,e,i,t,e,r,t=this.Vv&&1===this.Vv.options.referenceStyle,e=l.wvt.Rvt,i=this.zmt();return t&&e&&e.Mf&&e.Mf!==i&&(i=e.Mf),t=this.Dgt(i),e=this._gt(i),r=this.Qvt(i),this.parseInternal(n,i,t,e,r)},k.prototype.Fgt=function(){var n,t,e,i,r,n=this,t=n.text();"\n"!==t&&0<=t.indexOf("\n")?n.ki(w,{type:b}):(e=n.Ti,i=(0,m.GC$)(e),n.jgt=!0,n.Fmt=n.Ost(t),n.vmt(e)?n.Egt||("\n"===t?(i.empty(),n.ki(w,{type:b})):(r=n.caret(),n.Pmt(n.Fmt),n.ki(w,{type:b}),n.caret(r))):n.ki(w,{type:b}),r=n.caret(),i.data(S)!==r&&(i.data(S,r),n.ki(y,{})),n.Zgt(),n.Tgt||n.w6())},k.prototype.Wgt=function(){return h.Common.CultureManager.Fe().NumberFormat},k.prototype.Qgt=function(){var n=this.Wgt();return n&&n.arrayGroupSeperator||";"},k.prototype.Kgt=function(){var n=this.Wgt();return n&&n.arrayListSeparator||","},k.prototype.fgt=function(){var n=this.Wgt();return n&&n.listSeparator||","},k.prototype.Jgt=function(){var n=this.Wgt();return n&&n.numberDecimalSeparator||"."},k.prototype.Ygt=function(n,t){for(var e,i,r,o,u,a,s,f,c,l,g,g,e=[],i=[],r=t&&"="!==t[0],o=this.Qgt(),u=this.Kgt(),a=!1,s=0;s<n.length;s++)0<s&&s<n.length-1&&";"===n[s-1].text&&","===n[s].text&&"ARRAYROW"===n[s+1].text||(f=n[s],c=this.Xgt(f,i),l=f.text,2===c?e.push({text:l,type:c}):a&&8===c&&","===l?e.push({text:u,type:9}):a&&8===c&&";"===l?e.push({text:o,type:10}):8===c?e.push({text:l,type:c}):3===c?("ARRAY"===l&&(a=!0),e.push({text:"{",type:3})):4===c?"ARRAY"===l||"}"===l?(a=!1,e.push({text:"}",type:4})):e.push({text:l,type:4}):6===c?e.push({text:")",type:c}):13===c?e.push({text:h.Common.st.Ge(l),type:c,ranges:f.ranges,allowDrag:f.canDrag}):1===c&&r||null!==c&&(11===c&&n[s+1]&&"#"===n[s+1].text&&f.ranges&&0<f.ranges.length?(g=new p.CalcReference(this.zmt().qgt,f.ranges).getSpillRef())&&g.$gt&&(s++,f.ranges=g.$gt,l+="#"):11===c&&l.length===f.endIndex-f.index&&"!"===t[f.endIndex]&&(l+="!"),g={text:l,type:c,ranges:f.ranges,allowDrag:f.canDrag},11===c&&(g.sheetArea=f.sheetArea),e.push(g)));return e},k.prototype.Xgt=function(n,t){var e,i,r,n,r,e=n.type,i=n.subType,r=n.text,n=n.value;if(1===e){if(1===i)return"ARRAY"===r||"ARRAYROW"===r?(t.push(3),3):(t.push(5),"@"===n||"("===n.trim()?5:2);if(2===i){if(")"===n.trim())return 6;if(0<t.length){if(3===(r=t[t.length-1]))return t.pop(),4;if(5===r)return t.pop(),6}}if("="===n.trim())return 1}else if(3===e){if(0===i)return 8}else{if(5===e||6===e||4===e)return 7;if(0===e)return 7===i||0===i||12===i?11:5===i?12:4===i?13:3!==i&&6===i?16:14;if(7===e)return 15;if(8===e);}return 17},k.prototype.lgt=function(){for(var n,t,e,i,r,o,n=this,t=n.Ti,e=n.Fmt,i="",r=e&&e.length,o=0;o<r;o++)i+=e[o].text;n.$mt(t)?t.value=i:n.vmt(t)&&n.Pmt(e)},k.prototype.$mt=function(n){var n=n&&n.tagName;return"TEXTAREA"===n||"INPUT"===n},k.prototype.vmt=function(n){return n&&"DIV"===n.tagName&&"true"===n.contentEditable},k.prototype.hfe=function(n){return n&&"DIV"===n.tagName},k.prototype.t2t=function(n){return"gcEditingInput"===(0,m.GC$)(n).attr(r)},k.prototype.D3=function(n,t,e){var i=this.Ti;i&&n&&(n=n.split(/\s+/).join(R+" "),(0,m.GC$)(i).bind(n+R,t,e))},k.prototype._3=function(n,t){var e=this.Ti;e&&n&&(n=n.split(/\s+/).join(R+" "),(0,m.GC$)(e).unbind(n+R,t))},k.prototype.E3=function(){var n=this.Ti;n&&(0,m.GC$)(n).unbind(R)},k.prototype.ki=function(n,t){var e=this.Ti;e&&(0,m.GC$)(e).trigger(n,t)},k.prototype.cgt=function(n){var t,e,i,r,o;if(!(n<=0)&&0<(e=(t=this.Fmt)&&t.length))for(r=void(i=0),o=0;o<e;o++)if(n<=(i+=(r=t[o]).text.length))return r;return x},k.prototype.n2t=function(){var n,t,e,i,r,o,n=this.Vv;if(n&&(t=(0,m.jf)(n))&&(e=t.getCalcService().allowDynamicArray,i=t.il)){for(o=(r=[].concat(i.ugt)).length-1;0<=o;o--)!e&&r[o]&&dn(r[o].name)?r.splice(o,1):r[o].isFunc=!0;return r.concat(this.e2t(n,t)).concat(this.i2t(n.sheets)).concat(this.r2t(n))}return this.ugt},k.prototype.e2t=function(n,t){var e,t,t,e=[],t=t.getCustomNames();return t&&m.GC$.each(t,function(n,t){e.push({name:t.Zc,description:t.TZ})}),(t=n.getCustomNames())&&m.GC$.each(t,function(n,t){e.push({name:t.Zc,description:t.TZ})}),e},k.prototype.i2t=function(n){var i=[];return n.forEach(function(n){var n,t,e,n=n.tables;if(n&&(t=n.all()))for(e=0;e<t.length;e++)i.push({name:t[e].name(),description:p.sR().Fbx_TableName_Description+t[e].name()})}),i},k.prototype.r2t=function(n){for(var t,e,i,t=[],e=n.mp,i=0;i<e.length;i++)t.push({name:e[i].name(),description:p.sR().Fbx_TableSheetName_Description+e[i].name()});return t},k.prototype.o2t=function(n,t){var e,i,r,o;for(n=C(n),v.OS(n,"[")&&(n=n.substr(n.lastIndexOf("[")+1),n=v.Vi(n,"@","")),e=[],i=t&&t.length,o=0;o<i;o++)r=t[o],0===C(G(r.name)).indexOf(n)&&e.push(r);return e},k.prototype.a2t=function(){var n,t,e,i,r,o,n=this.caret();if(!(n<=0)&&0<(e=(t=this.Fmt)&&t.length))for(r=void(i=0),o=0;o<e;o++){if(i+(r=t[o]).text.length>=n)return r.text.substring(0,n-i);i+=r.text.length}return""},k.prototype.u2t=function(){for(var n,t,e,i,r,o,u,a,s,f,c,l,g,h,n=this.caret(),t=this.Fmt,e=t&&t.length,i=[],r=0,u=0;u<e;u++){if(o=t[u],i.push(o),6===o.type)for(a=0;0<i.length;)if(6===(s=i.pop()).type&&a++,5===s.type&&a--,0===a){0<i.length&&(s=i[i.length-1])&&2===s.type&&i.pop();break}if(n<=(r+=o.text.length))break}if(0<i.length)for(f=0;0<i.length;)if(8===(o=i.pop()).type)f++;else if(2===o.type){for(c=C(o.text),g=(l=this.n2t())&&l.length,h=void 0,u=0;u<g;u++)if(h=l[u],C(G(h.name))===c)return{func:h,activeParamterIndex:f,isFunc:h.isFunc};break}return x},k.prototype.Zgt=function(){var t,n,e,i,r,o,u,a,i,s,f,t=this,n=t.s2t(),e;if(!(t.ogt&&(0,m.kf)(t.text())&&n&&0<n.length&&(!t.XD||t.Lve)&&!t.Egt)||t.rl&&!t.Lve)t.f2t();else{for(t.c2t(),i=t.Kmt,8<n.length?(i.style.height="204px",i.style.overflowY="scroll"):(i.style.height="auto",i.style.overflowY=""),r="",o=n.length,u=void 0,a=0;a<o;a++)r+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(u=n[a]).isFunc+">"+G(u.name)+"</div><div class='gcsj-func-ac-row-description'>"+(u.description||"")+"</div></div>";(i=(0,m.GC$)(t.Kmt)).html(r).show(),t.Tgt=!0,0<(s=i.find(j)).length&&(f="gcsj-ac-row-active",(0,m.GC$)(s[0]).addClass(f),s.bind("mouseover",function(){s.removeClass(f),(0,m.GC$)(this).addClass(f)}),s.bind("click",function(){t.Ggt()}),t.Ngi)&&s.bind("mousedown",function(n){t.Ggt(),d(n)}),t.u_()}},k.prototype.Qmt=function(){var n,t,n=this,t=(0,m.GC$)(n.Kmt).find(j);t&&(t.unbind("mouseover"),t.unbind("click"),n.Ngi)&&t.unbind("mousedown")},k.prototype.s2t=function(){var n,t,e,i,r,t,r,o,u,a,s,f,t,n=this,t=n.cgt(n.caret()),e=t&&t.text,i=[],r=n.Fmt.indexOf(t);if(t&&14===t.type)return i;if(t=this._getTable(r),0<(r=n.h2t(r,t)).length){if(o=[],!t.Mf.NMi)for(s in u=JSON.parse(JSON.stringify(p.sR().d2t)),a=p.getMapping()&&p.getMapping().tableFunctionsMapping,u)(f=a&&a[u[s].name])&&(u[s].name=f),o.push(u[s]);if(i=i.concat(r).concat(o),v.dT(e,"[")||v.dT(e,"[@"))return i}else i=this.n2t();return t=[],t=(e=n.a2t())?n.o2t(e,i):t},k.prototype._getTable=function(n){var t,e,i,t,n,t,i,t=this.Fmt;return!(n<0||!t||n>=t.length)&&(i=(e=this.Vv)&&(0,m.jf)(e),I(n)&&(n=t.length),i)?(t=t[n],n=v.gmt(t.text,"["),i=(t=i.tables)&&t.findByName(n),I(i)?e.Ofe(n):i):null},k.prototype.h2t=function(n,t){var e=[];return e=I(t)?e:ln(t).columns},k.prototype.f2t=function(){(0,m.GC$)(this.Kmt).hide(),this.Tgt=!1},k.prototype.Pgt=function(n){var t,e,i,r,o,u,a,s,t=(0,m.GC$)(this.Kmt).find(j),e=t.length;if(0!==e){if(i="gcsj-ac-row-active",r=0,n)for(o=0;o<e;o++)if((0,m.GC$)(t[o]).hasClass(i)){r=o+n;break}u=(0,m.GC$)(this.Kmt).scrollTop(),t.removeClass(i),(a=0)<e&&(a=t[0].offsetHeight),r=f(r,0),s=t[r=F(r,e-1)],(0,m.GC$)(s).addClass(i),s.offsetTop+s.offsetHeight>(0,m.GC$)(this.Kmt).scrollTop()+(0,m.GC$)(this.Kmt).height()?(0,m.GC$)(this.Kmt).scrollTop((0,m.GC$)(this.Kmt).scrollTop()+a):s.offsetTop<(0,m.GC$)(this.Kmt).scrollTop()?(0,m.GC$)(this.Kmt).scrollTop(s.offsetTop):(0,m.GC$)(this.Kmt).scrollTop(u)}},k.prototype.Ggt=function(){var n,t,e,t,i,r,o,u,a,s,f,c,l,g,h,h,l,c,h,n=this,t=(0,m.GC$)(n.Kmt).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),e=t.text(),t="true"===t.attr("isFunc");if(e){for(i=n.caret(),o=(r=n.Fmt)&&r.length,s=a=u=0,f=x;s<o&&!(i<=u+(a=(f=r[s]).text.length));)s++,u+=a;c=i-u,l=f.text,h=g=0,v.OS(l,"[")?-1===(g=l.lastIndexOf("[",c-1))?(g=l.indexOf("["),f.text=-1===g?e:e+l.substr(g),g=0):("@"===l.charAt(++g)&&(g+=1),-1===(h=l.indexOf("]",c))&&(h=l.length),f.text=l.substring(0,g)+e+l.substr(h)):(f.text=e,(h=l.substr(c))&&1<(l=n.Ost("="+h)).length&&r.splice(s+1,0,l[1])),f.type=t?2:11,h=r[c=s+1],!t||h&&5===h.type||r.splice(c,0,{text:"(",type:5}),n.f2t(),n.Ti.focus(),n.lgt(),n.caret(u+e.length+g+(t?1:0)),n.w6(),n.Fmt=n.Ost(n.text()),n.ki(w,{})}},k.prototype.w6=function(){var n,t,e,i,r,o,u,a,s,f,c,l,g,h,v,d,I,t,n=this;if(n.Tgt&&n.f2t(),(t=n.u2t())===x||!0!==t.isFunc)n.c2t();else if(e=n.fgt(),!(i=n.agt&&(0,m.kf)(n.text())&&t&&!n.XD&&!n.Egt)||n.rl&&!n.Lve)n.c2t();else{for(u=(o=(r=t.func).parameters)&&o.length,a=F(u-1,t.activeParamterIndex),s=void 0,f="",c=0;c<u;c++)l=(s=o[c]).name,s.repeatable&&(l+=e+"..."),s.optional&&(l="["+l+"]"),g=c===u-1?"":e+" ",f+=l=c===a?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+l+"</span>"+g:"<span class='gcsj-func-help-paramter'>"+l+"</span>"+g;t=(h="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+G(r.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+f+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>")+(I="<div class='gcsj-func-help-body'>"+(d="<div class='gcsj-func-help-section-content'>"+(v="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+p.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(r.description||"")+"</div></div>")+"</div>")+"</div>"),(0,m.GC$)(n.Jmt).html(t).show(),n.Rgt=!0,n.u_()}},k.prototype.c2t=function(){(0,m.GC$)(this.Jmt).hide(),this.Rgt=!1},k.prototype.close=function(){this.f2t(),this.c2t()},k.prototype.$D=function(n,t){var e,i,r,o,u,n;return!this.XD&&(e=n.ctrlKey||n.shiftKey||n.altKey||n.metaKey,i=n.keyCode,r=n.ctrlKey,o=n.altKey,u=n.metaKey,n=n.srcElement||n.target,!(!this.Tgt||e||i!==N&&i!==D&&i!==B)||!(this.Ngi||!n||!t||!t.isEditing||"gcAttachedFormulaTextBox"!==n.getAttribute("gcUIElement"))&&(67===i&&(r||u)&&!o||88===i&&(r||u)&&!o))},k.prototype.u_=function(){var n,t,e,t,i,r,n,o,o,i,e,r,u,a,n,s,e,n=this,t=x;n.Tgt?t=n.Kmt:n.Rgt&&(t=n.Jmt),t&&(e=(0,m.GC$)(n.Ti),t=(0,m.GC$)(t),i=e.parent(),r=e.outerHeight(),n.t2t(n.Ti)&&(r=(i=i.parent()).outerHeight()),n=i.css("top"),o=parseFloat(n),isNaN(o)||(n=o),o=i.css("left"),"auto"===n&&(n=e.offset().top,o=e.offset().left),i=n+r,e=(0,m.GC$)(c.body).outerHeight(),r=(0,m.GC$)(c.body).outerWidth(!0),u=t.outerHeight(),a=t[0].offsetWidth,e<(s=i+u)&&0<=(e=n-u)&&(i=e),r<(n=parseFloat(o))+a+2&&(n-=n+a+2-r),t.css("top",i).css("left",n))},k.prototype.focus=function(){(0,m.GC$)(this.Ti).focus()},k.prototype.Pmt=function(n){for(var t,e,i,r,o,u,a,s,f,t=this,e="",i="",r=n&&n.length,o=0,a=0;a<r;a++)s="",11===(u=n[a]).type&&(s=" style='color: "+t.pmt(o)+"'",o++),t.F0.innerText=u.text,e+="<span"+s+" class='gcsj-func-color-text'>"+t.F0.innerHTML+"</span>",i+=u.text;if(i||t.text())if(f=t.Ti,e)f.innerHTML="<span class='gcsj-func-color-content'>"+e+"</span>";else for(;f.firstChild;)f.removeChild(f.firstChild)},k.prototype.tgt=function(n,t){var e,i,r,o,u,e=(0,m.GC$)(n).find(".gcsj-func-color-content .gcsj-func-color-text"),i=e.length;for(t=f(0,t),u=0;u<i;u++)if((t-=(o=(r=e[u]).innerText).length)<=0)return{node:r,offset:o.length+t};return o?{node:r,offset:o.length}:x},k.prototype.y6=function(n,t){var e,i,r,e=g.getSelection(),i=this.Ti.children[0],r=document.createRange();r.setStart(i,n),r.setEnd(i,t),e.removeAllRanges(),e.addRange(r)},k.prototype.mmt=function(n){var t,e,e,i,t=this,e=t.Ti,e=t.vmt(e),i=t.text();e&&i&&(i=n?i.substr(0,i.length-2):i,t.Nmt.push(i))},k.prototype.egt=function(n,t){var e,i,r,o,u,a,s,f;if(t)for(o=t.length,u=r=i=e=0;u<n.length;u++){for(a=n[u].text;i<o;i++)if((s=t[i].toUpperCase())===(f=a[r]?a[r].toUpperCase():void 0))r+=1;else{if("\n"!==s)break;i+1<o&&t[i+1]===O&&(i+=1)}n[u].text=t.substring(e,i),e=i,r=0}return n},k.prototype.ngt=function(n){var t,e,i,r,o;if("="===n[0]&&-1!==n.indexOf("\n")){for(e=n.length,i=!(t=[]),r=0;r<e;r++)(i='"'===(o=n[r])?!i:i)||"\n"!==o?t.push(o):r+1<e&&n[r+1]===O&&(r+=1);return t.join("")}},un=k,a.FormulaTextBox=un},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={},n=r("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).FormulaTextBox=n}();