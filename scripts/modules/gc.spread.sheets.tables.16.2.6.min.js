/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var e,r,t;function i(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},e[t].call(n.exports,n,n.exports,i)),n.exports}e={"./dist/plugins/table/table-action.js":function(M,t,n){var e,b,t,r,D,w,c,v,B,r,d,i,h,m,C,l,o,u,a,f,s,g,y,p,S,T,U,n,t,E,V,_,H,G,R,x,J,P,Y,$,K,q,Z,Q,W,X,tt,nt,et;function F(t,n){n.message===E().Exp_TableAddRowIntersectTable&&t.jT(6,E().Exp_TableAddRowIntersectTable)}function j(t,n){var t=K.call(this,t)||this;return t.l4t=n,t.h4t=n.tableName,t.d4t=n.resizeToRange,t.Cge=n.ignoreEventSuspend,t}function k(t,n){var t=q.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function A(t,n){var t=Z.call(this,t)||this;return t.v4t=n,t.h4t=n.tableName,t.Ky=n.row,t.DU=n.count,t.m4t=n.isAfter,t}function O(t,n){var t=Q.call(this,t)||this;return t.g4t=n,t.h4t=n.tableName,t.p4t=n.changeRows,t}function L(t,n){var t=W.call(this,t)||this;return t.b4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t.m4t=n.isAfter,t}function N(t,n){var t=X.call(this,t)||this;return t.y4t=n,t.h4t=n.tableName,t.iw=n.col,t.DU=n.count,t}function z(t,n){var t=tt.call(this,t)||this;return t.w4t=n,t.h4t=n.tableName,t}function I(t,n){var t,e,t=nt.call(this,t)||this,e=t;return e.M4t=n,e.Ky=n.row,e.iw=n.col,e.D5=n.newValue,t}function rt(t,n){var t,e,t=et.call(this,t)||this,e;return t.C4t=n,t.h4t=n.tableName,t}e=this&&this.__extends||($=function(t,n){return($=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}$(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),Object.defineProperty(t,"__esModule",{value:!0}),b=n("Core"),t=n("Common"),r=n("./dist/plugins/table/table-util.js"),D=r.Util.S4t,w=r.Util.jj,c=r.Util.Ej,v=r.Util._getTable,B=r.Util.T4t,r=b.Commands.ActionBase,d=t.Common.lt.ht,i="tableResize",h="tableInsertRows",m="tableDeleteRows",C="tableInsertColumns",l="tableDeleteColumns",o="tableToRange",u="tableTotalRowFormula",a="DoInsertRows",f="tableShowFooter",s="tableInsertRowsAboveForContextMenu",g="tableInsertRowsBelowForContextMenu",y="tableDeleteRowsForContextMenu",p="tableInsertColumnsLeftForContextMenu",S="tableInsertColumnsRightForContextMenu",T="tableDeleteColumnsForContextMenu",U=void 0,n=n("./dist/plugins/table/table.ns.js"),t=new t.Common.ResourceManager(n.SR,"Tables"),E=t.getResource.bind(t),e(j,K=r),j.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.l4t,r.startTransaction(),t.X5(e,!0);try{(u=e.tables.findByName(i))&&(a=u.range(),f=t.d4t,e.tables.resize(u,f),D(e,u,a,f,t.Cge),n=!0)}finally{t.q5(e,!0),o[s=b.Commands.TI(e.name())]=r.endTransaction()}}return n},j.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.Mf,e=t.h4t,r=!1;if(t.canUndo()){t.X5(n,!0);try{i=t.l4t,o=n.Ut,u=n.tables.findByName(e),(f=i[a=b.Commands.TI(n.name())])&&(o.undo(f),D(n,u,i.resizeToRange,u.range(),t.Cge),r=!0)}finally{t.q5(n,!0)}}return r},V=j,b.Commands[i]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,V,n,e)}},e(k,q=r),k.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.Ky,u=t.DU,a=t.m4t,r.startTransaction(),t.X5(e,!0);try{(f=e.tables.findByName(i))&&(s=f.Sx,f.zpt(o,u,a),n=!0,(l=f.Sx)-s===u)&&w(e,f,h,o,u,a)}catch(t){F(e,t)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.v4t[i]=r.endTransaction()}}return n},k.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,l,c,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.v4t,i=n.Ut,u=r[o=b.Commands.TI(n.name())],a=r.row,f=r.count,s=r.isAfter,u&&(i.undo(u),(l=n.tables.findByName(t.h4t))&&(c=s?a+1:a,l.A4t(c,f),l.I4t(),l.x4t(c,f,B(!0)),w(n,l,m,a,f,U,l.tq())),e=!0)}finally{t.q5(n,!0)}}return e},_=k,b.Commands[h]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,_,n,e)}},e(A,Z=r),A.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.Ky,u=t.DU,a=t.m4t,r.startTransaction(),t.X5(e,!0);try{(f=e.tables.findByName(i))&&(f.N4t(o,u,a,!1),w(e,f,h,o,u,a),t.v4t.row=o,t.v4t.count=u,n=!0)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.v4t[i]=r.endTransaction()}}return n},A.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,l,c,h,v,d,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.v4t,i=n.Ut,u=r[o=b.Commands.TI(n.name())],a=r.row,f=r.count,s=r.isAfter,u&&(c=(l=n.tables.findByName(t.h4t))&&l.z3(),h=void 0,v=s?a+1:a,c&&(d=l.dataRange(),h=c.slice(v-d.row,v-d.row+f)),i.undo(u),l&&(l.A4t(v,f),l.I4t(),l.x4t(v,f,B(!0)),w(n,l,m,a,f,s,h||l.tq())),e=!0)}finally{t.q5(n,!0)}}return e},H=A,b.Commands[a]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,H,n,e)}},e(O,Q=r),O.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,c,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.p4t,r.startTransaction(),t.X5(e,!0);try{if(u=e.tables.findByName(i))for(a=o.length-1;0<=a;a--)f=o[a].row,s=o[a].count,l=u.Sx,u.yE(f,s),n=!0,l-(c=u.Sx)===s&&w(e,u,m,f,s,U,u.tq())}catch(t){F(e,t)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.g4t[i]=r.endTransaction()}}return n},O.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,l,c,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{if(r=t.g4t,i=n.Ut,u=r[o=b.Commands.TI(n.name())],a=t.p4t,u)for(i.undo(u),(f=n.tables.findByName(t.h4t))&&f.I4t(),e=!0,s=a.length-1;0<=s;s--)l=a[s].row,c=a[s].count,w(n,f,h,l,c,!1)}finally{t.q5(n,!0)}}return e},G=O,b.Commands[m]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,G,n,e)}},e(L,W=r),L.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.iw,u=t.DU,a=t.m4t,r.startTransaction(),t.X5(e,!0);try{(f=e.tables.findByName(i))&&(s=f.Tx,f.k4t(o,u,a),n=!0,(l=f.Tx)-s===u)&&c(e,f,C,o,u,a)}catch(t){F(e,t)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.b4t[i]=r.endTransaction()}}return n},L.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.b4t,i=n.Ut,u=r[o=b.Commands.TI(n.name())],a=r.col,f=r.count,u&&(i.undo(u),(s=n.tables.findByName(t.h4t))&&s.I4t(),e=!0,c(n,s,l,a,f))}finally{t.q5(n,!0)}}return e},R=L,b.Commands[C]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,R,n,e)}},e(N,X=r),N.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,o=t.iw,u=t.DU,r.startTransaction(),t.X5(e,!0);try{(a=e.tables.findByName(i))&&(f=a.Tx,a.wE(o,u),n=!0,f-(s=a.Tx)===u)&&c(e,a,l,o,u)}catch(t){F(e,t)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.y4t[i]=r.endTransaction()}}return n},N.prototype.undo=function(){var t,n,e,r,i,o,u,a,f,s,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.y4t,i=n.Ut,u=r[o=b.Commands.TI(n.name())],a=r.col,f=r.count,u&&(i.undo(u),(s=n.tables.findByName(t.h4t))&&s.I4t(),c(n,s,C,a,f,!(e=!0)))}finally{t.q5(n,!0)}}return e},x=N,b.Commands[l]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,x,n,e)}},e(z,tt=r),z.prototype.execute=function(){var t,n,e,r,i,o,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,r.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(i))&&(e.tables.remove(o,3),n=!0)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.w4t[i]=r.endTransaction()}}return n},z.prototype.undo=function(){var t,n,e,r,i,o,u,a,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.w4t,i=n.Ut,(u=r[o=b.Commands.TI(n.name())])&&(i.undo(u),(a=n.tables.findByName(t.h4t))&&a.I4t(),e=!0)}finally{t.q5(n,!0)}}return e},J=z,b.Commands[o]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,J,n,e)}},e(I,nt=r),I.prototype.execute=function(){var t,n,e,r,i,o,u,a,f,s,l,u,t=this,n=!1;if(t.canExecute()){(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{i=t.Ky,o=t.iw,u=t.D5,e.setFormula(i,o,u),u?u.startsWith("=SUBTOTAL(103")||u.startsWith("=SUBTOTAL(102")||(a=e.getFormatter(i,o))&&"GENERAL"!==a.toUpperCase()||(l=(s=(f=e.tables.find(i,o))&&f.BSt[o-f.startColumn()])&&s.formatter(),(0,b.Ffe)(e,i,o,l)):e.setValue(i,o,null),n=!0}finally{t.q5(e,!0),u=b.Commands.TI(e.name()),t.M4t[u]=r.endTransaction()}}return n},I.prototype.undo=function(){var t,n,e,r,i,o,u,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.M4t,i=n.Ut,(u=r[o=b.Commands.TI(n.name())])&&(i.undo(u),e=!0)}finally{t.q5(n,!0)}}return e},P=I,b.Commands[u]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,P,n,e)}},e(rt,et=r),rt.prototype.execute=function(){var t,n,e,r,i,o,i,t=this,n=!1;if(t.canExecute()){r=(e=t.Mf).Ut,i=t.h4t,r.startTransaction(),t.X5(e,!0);try{(o=e.tables.findByName(i))&&(o.showFooter(!0),n=!0)}finally{t.q5(e,!0),i=b.Commands.TI(e.name()),t.C4t[i]=r.endTransaction()}}return n},rt.prototype.undo=function(){var t,n,e,r,i,o,u,t=this,n=t.Mf,e=!1;if(t.canUndo()){t.X5(n,!0);try{r=t.C4t,i=n.Ut,(u=r[o=b.Commands.TI(n.name())])&&(i.undo(u),e=!0)}finally{t.q5(n,!0)}}return e},Y=rt,b.Commands[f]={canUndo:!0,execute:function(t,n,e){return b.Commands.zA(t,Y,n,e)}},b.Commands[s]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f,i;return n.cmd=s,d(n.row)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.row,f=o.rowCount,i=u.footerIndex()===a,n.row=i?a-1:a,n.count=f,n.tableName=u.name(),n.isAfter=i),b.Commands.zA(t,_,n,e))):b.Commands.zA(t,_,n,e)}},b.Commands[g]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=g,d(n.row)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.row,f=o.rowCount,n.row=a,n.count=f,n.tableName=u.name(),n.isAfter=!0),b.Commands.zA(t,_,n,e))):b.Commands.zA(t,_,n,e)}},b.Commands[y]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f,s,l,c,h;if(n.cmd=y,d(n.changeRows)){for(r=b.Commands.Tp(t,n),i=n.selections,a=u=o=void 0,n.changeRows=[],f=0;f<i.length;f++){if(s=i[f],!(l=v(r,s)))return!1;if(o){if(o!==l)return!1}else o=l}for(f=0;f<i.length;f++)for(c=f+1;c<i.length;c++){if(s=i[f],h=i[c],s.row>=h.row&&s.row<=h.row+h.rowCount-1)return!1;if(s.row+s.rowCount-1>=h.row&&s.row+s.rowCount-1<=h.row+h.rowCount-1)return!1;if(s.row<=o.Ky||s.row+s.rowCount>o.Ky+o.Sx)return!1;if(h.row<=o.Ky||h.row+h.rowCount>o.Ky+o.Sx)return!1}for(i.sort(function(t,n){return t.row-n.row}),f=0;f<i.length;f++)u=(s=i[f]).row,a=s.rowCount,n.changeRows.push({row:u,count:a});n.tableName=o.name()}return b.Commands.zA(t,G,n,e)}},b.Commands[p]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=p,d(n.col)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.col,f=o.colCount,n.col=a,n.count=f,n.tableName=u.name(),n.isAfter=!1),b.Commands.zA(t,R,n,e))):b.Commands.zA(t,R,n,e)}},b.Commands[S]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=S,d(n.col)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.col,f=o.colCount,n.col=a,n.count=f,n.tableName=u.name(),n.isAfter=!0),b.Commands.zA(t,R,n,e))):b.Commands.zA(t,R,n,e)}},b.Commands[T]={canUndo:!0,execute:function(t,n,e){var r,i,o,u,a,f;return n.cmd=T,d(n.col)&&d(n.count)?(r=b.Commands.Tp(t,n),f=a=u=o=void 0,1===(i=n.selections).length&&(o=i[0],(u=v(r,o))&&(a=o.col,f=o.colCount,n.col=a,n.count=f,n.tableName=u.name()),b.Commands.zA(t,x,n,e))):b.Commands.zA(t,x,n,e)}},b.Commands.D4t=function(t){t.register(i,b.Commands[i]),t.register(h,b.Commands[h]),t.register(a,b.Commands[a]),t.register(m,b.Commands[m]),t.register(C,b.Commands[C]),t.register(l,b.Commands[l]),t.register(o,b.Commands[o]),t.register(u,b.Commands[u]),t.register(f,b.Commands[f]),t.register(s,b.Commands[s]),t.register(g,b.Commands[g]),t.register(y,b.Commands[y]),t.register(p,b.Commands[p]),t.register(S,b.Commands[S]),t.register(T,b.Commands[T])}},"./dist/plugins/table/table-event.js":function(t,n,e){var w,n,m,r,e,l,h,f,i,o,n,C,g,y,u;Object.defineProperty(n,"__esModule",{value:!0}),w=e("Core"),n=e("Common"),m=e("./dist/plugins/table/table.js"),r=e("./dist/plugins/table/table.ns.js"),e=e("./dist/plugins/table/table-util.js"),l=n.Common.lt.ht,h=null,f=Math.abs,i=10,o="tableResize",n=new n.Common.ResourceManager(r.SR,"Tables"),C=n.getResource.bind(n),g=e.Util._4t,y=e.Util.E4t,u=e.Util.j4t,w.GC$.extend(w.nk.prototype,{mk:function(t,n){var t,e,t=this.Tk(t,n);t&&((e=this).I9=e.x9=n.Ut.getSelections(),n.setSelection(t.row,t.col,t.rowCount,t.colCount))},Tk:function(t,n){var e,r,i,o,u,a,r,n,n,f,s,n,e=n.getSelections(),r=t.tableSelectInfo,i=r.table,o=0,u=0;if(i.oL&&(o=1),i.jO&&(u=1),a=h,r=r.action,n=(n=n.Nde)&&n.Ymt(),!l(n)&&0<n.length&&(e=n),r===m.TableSelectionType.TABLE_ROW_SELECT)a=(0,w.Ec)(t.row,i.iw,1,i.Tx);else if(r===m.TableSelectionType.TABLE_COL_SELECT){for(f=0;f<e.length;f++)if((s=e[f]).col===t.col&&s.row===i.Ky+u&&1===s.colCount&&s.rowCount===i.Sx-u-o){a=(0,w.Ec)(i.Ky,t.col,i.Sx,1);break}n=!a&&-1===t.rowViewportIndex&&e&&e[0]&&e[0].col===t.col&&e[0].rowCount===i.Sx,l(a)&&!n&&(a=(0,w.Ec)(i.Ky+u,t.col,i.Sx-u-o,1))}else if(r===m.TableSelectionType.TABLE_CORNER_SELECT){for(f=0;f<e.length;f++)if((s=e[f]).col===i.iw&&s.row===i.Ky+u&&s.colCount===i.Tx&&s.rowCount===i.Sx-u-o){a=(0,w.Ec)(i.Ky,i.iw,i.Sx,i.Tx);break}l(a)&&(a=(0,w.Ec)(i.Ky+u,i.iw,i.Sx-u-o,i.Tx))}else r===m.TableSelectionType.TABLE_SELECT&&(a=(0,w.Ec)(i.Ky,i.iw,i.Sx,i.Tx));return a},KL:function(t,n){var e,r,i,o,u,a,f,t,s,l,s,l,e,i,c,f,o,e=this.Mf,r=h;return r=e&&!e.options.isProtected&&!e.isEditing()&&n&&n.showResizeHandle()&&(i=t.row,o=t.col,u=t.x,a=t.y,f=t.rowViewportIndex,t=t.colViewportIndex,s=g(e,n),l=y(e,n),i===s)&&o===l&&(l=(s=e.getCellRect(i,o,f,t)).x,e=s.y,i=s.width,o=e+(c=s.height),(f=l+i)-10<=u)&&u<=f&&o-10<=a&&a<=o?{x:u,y:a,table:n}:r},Sk:function(t){var n,e,r,r,i,o,n=this;!0!==n.$k&&!0!==n.rb&&(e=n.Mf,r=(r=t.resizeTableHitInfo)&&r.table)&&!r.QL()&&(n.$k=!0,n.rb=!0,n.O4t=r,n.R4t=r.Ky,n.B4t=r.iw,n.L4t=r.Sx,n.F4t=r.Tx,i=n.R4t+n.L4t-1,o=n.B4t+n.F4t-1,n.P4t=e.getCellRect(i,o),n.G4t=r.range(),n.Rk={e9:t.rowViewportIndex,r9:t.colViewportIndex,Bk:t.hitTestType},n.Ok())},t9:function(){var t,n,e,t=this,n=t.Mf;t.Rk&&t.$k&&t.rb&&t.O4t&&(t.U4t(),t.H4t()&&(t.z4t=t.V4t(),t.Y4t(),t.Z4t(),(e=(e=t.W4t)||t.Q4t()).equals(t.K4t)||(t.W4t=(0,w.Ec)(t.K4t.row,t.K4t.col,t.K4t.rowCount,t.K4t.colCount),u(n,t.O4t,t.Q4t(),t.K4t))),t.a9())},OD:function(){var t,n,e,t=this,n=t.Mf;t.l9(),t.$k&&t.rb&&t.K4t&&t.O4t?(t.$k=!1,t.rb=!1,t.J4t()?(e=t.Q4t(),t.X4t(),e.equals(t.K4t)?n.Dn.q4t():n.Qy().execute({cmd:o,sheetName:n.name(),tableName:t.O4t.name(),resizeToRange:t.K4t}),t.$4t()):(t.$4t(),n.Dn.q4t())):t.$4t()},Q4t:function(){var t=this.O4t;return(0,w.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},U4t:function(){var t=this,n=t.Q9(),e=t.K9();t.tSt=n,t.nSt=e},H4t:function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.R4t,e=t.B4t,r=t.tSt,i=t.nSt,o,u,a,f;return(t.O4t.jO?n+1:n)<=r&&e<=i},V4t:function(){var t,n,e,t,r,t,i,e,n,o,t=this,e=t.fk,t=t.P4t,r=t.x+t.width,t=t.y+t.height,i=e.x,e=e.y,n=f(t-e),o,n=f(r-i)<=n?e<t?2:3:i<r?0:1;return n},Y4t:function(){var t,n,e,r,i,o,u,a,t=this,n=t.R4t,e=t.B4t,r=t.tSt,i=t.nSt,o=t.z4t,u=t.L4t,a=t.F4t;switch(o){case 0:case 1:a=f(i-e)+1;break;case 2:case 3:u=f(r-n)+1}t.K4t?(t.K4t.rowCount=u,t.K4t.colCount=a):t.K4t=(0,w.Ec)(n,e,u,a)},Z4t:function(){var t=this,n;t.Mf.Dn.q4t(),t.G4t=t.eSt()},eSt:function(){var t,n,e,r,i,n,t,n=this.K4t,e=n.row,r=n.col,i=n.rowCount,n=n.colCount;return(0,w.Ec)(e,r,i,n)},X4t:function(){var t=this,n=t.O4t,e;2===t.z4t&&n.oL&&(t.K4t.rowCount+=1)},J4t:function(){var t,n,e,r,i,o,u,a,f,s,u,l,c,h,v,d,b,t=this,n=t.Mf,e=!1,r=n.Ut,i=n.tables,o=t.O4t,u=t.K4t,a=u.row,f=u.col,s=u.rowCount,u=u.colCount,l=t.tSt,c=t.nSt,h=g(n,o),v=y(n,o),d=t.z4t,b=o.IB;return h&&v&&((0,m.hasRowFilter)(n,new w.Range(a,f,s,u))||(r.eE(a,f,s,u)||r.GT(a,f,s,u)?n.jT(6,C().Exp_TableResizeToSpan):b&&b.isFiltered()?2===d?n.jT(6,C().Exp_TableResizeWithHidden):3===d&&o.oL?n.jT(6,C().Exp_TableResizeWithFilter):e=!0:2===d&&t.iSt(h,l)||0===d&&t.rSt(v,c)?n.jT(6,C().Exp_TableResizeWithHidden):1===d&&(i.Pl(a,v+1,s,c-v)||i.oSt(a,v+1,s,c-v))||3===d&&(i.Pl(h+1,f,l-h,u)||i.oSt(h+1,f,l-h,u))?n.jT(6,C().Exp_TableResizeToTable):e=!0)),e},iSt:function(t,n){for(var e,r=this.Mf,i,o=!1,i=t;n<i;i--)if(r.getRowHeight(i)<=0){o=!0;break}return o},rSt:function(t,n){var e,r=this.Mf,i,o=!1;if(!o)for(i=t;n<i;i--)if(r.getColumnWidth(i)<=0){o=!0;break}return o},$4t:function(){var t=this;t.$k=!1,t.rb=!1,t.Rk=h,t.K4t=h,t.W4t=h}})},"./dist/plugins/table/table-render.js":function(t,n,e){var e,r,n;function i(t,n,e,r){var i,o,e,i,o=t.rt.K4t,e=t.getRangeRect(e,r,o);n.strokeStyle=t.getSelectionBorderColor(),n.strokeRect(e.x,e.y,e.width,e.height)}Object.defineProperty(n,"__esModule",{value:!0}),n="tableRender",(r=(e=e("Core")).GC$.extend)(e.g7.prototype,{q4t:function(){var t,n,t=this,n;0<t.Mf.My||t.E1()}}),e.Worksheet.ch(n,{paintAdornment:function(t){var n,t,e,n=this,t=t.ctx,e=n.rt;e&&e.Rk&&e.$k&&i(n,t,e.nD(),e.eD())}})},"./dist/plugins/table/table-theme.js":function(M,t,D){var f,h,B,a,U,E,e,V,H,G,J,P,s,Y,l,c,v,d,b,w,$,m,K,q,Z,Q,W,C,X,tt,nt,et,g,D,rt,it,u,y,p,S,T,_,R,ot,x,F,j,k,A,n,ut,r,i,o,o,r;function at(){for(var t,n,t={},n=1;n<=28;n++)n<=21&&(t["TABLESTYLELIGHT"+n]=!0),n<=11&&(t["TABLESTYLEDARK"+n]=!0),t["TABLESTYLEMEDIUM"+n]=!0;return t}function O(t,n,e,r,i,o,u,a,f,s){var l=this,c=arguments;h(R,function(t,n){l[n]=c[t]})}function ft(r,i){r.name(i.name()),h(g,function(t,n){r[n](i[n]())}),h(C,function(t,n){var e=i[n]();r[n](e?e.Gf():Y)}),r.builtInName(i.builtInName(),!1)}function L(){}function N(t,n){return isNaN(n)?n:new f.LineBorder(t,n)}function z(t,n,e,r,i,o,u,a,f,s){var l=new x;return n&&(l.backColor=n),e&&(l.foreColor=e),r&&(l.font=rt),i&&(l.borderLeft=N(t,i)),o&&(l.borderTop=N(t,o)),u&&(l.borderRight=N(t,u)),a&&(l.borderBottom=N(t,a)),f&&(l.borderHorizontal=N(t,f)),s&&(l.borderVertical=N(t,s)),l}function I(t){return 0===t?"Text 1":"Accent "+t}function st(t){var t,n,e,t=I(t),n=t+" 80",e=new F;return e[l](z(t,0,t,1,0,0,0,1)),e[v](z(t,0,t,0,0,1,0,1)),e[w](z(t,n)),e[b](z(t,0,t,1)),e[d](z(t,0,t,1)),e[m](z(t,n)),e[c](z(t,0,t,1,0,1)),e}function lt(t){var t,n,t=I(t),n=new F;return n[l](z(t,t,j,1)),n[v](z(t,0,0,0,1,1,1,1)),n[w](z(t,0,0,0,0,1)),n[$](z(t,0,0,0,0,1)),n[m](z(t,0,0,0,1)),n[K](z(t,0,0,0,1)),n[b](z(t,0,0,1)),n[d](z(t,0,0,1)),n[c](z(t,0,0,1,0,6)),n}function ct(t){var t,n,e,t=I(t),n=t+" 80",e=new F;return e[l](z(t,0,0,1,0,0,0,2)),e[v](z(t,0,0,0,1,1,1,1,1,1)),e[w](z(t,n)),e[m](z(t,n)),e[b](z(t,0,0,1)),e[d](z(t,0,0,1)),e[c](z(t,0,0,1,0,6)),e}function ht(t){var t,n,e,t,r,t=I(t),n=t+" 20",e=t,t=t+" 80",r=new F;return r[l](z(n,e,j,1)),r[v](z(n,0,0,0,1,1,1,1,1)),r[w](z(n,t)),r[m](z(n,t)),r[b](z(n,0,0,1)),r[d](z(n,0,0,1)),r[c](z(n,0,k,1,0,6)),r}function vt(t){var t,n,e,r,t,i,t=I(t),n=j,e=t,r=t+" 60",t=t+" 80",i=new F;return i[l](z(n,e,j,1,0,0,0,2,0,1)),i[v](z(n,t,0,0,0,0,0,0,1,1)),i[w](z(n,r)),i[m](z(n,r)),i[b](z(n,e,j,1)),i[d](z(n,e,j,1)),i[c](z(n,e,j,1,0,2,0,0,0,1)),i}function dt(t){var n,e,r,i,e,o,n,e="#D3D3D3",r=I(t),i=e,e=0===t?k:e,o=new F;return o[l](z(k,r,j,1,0,2,0,2)),o[v](z(e,0,0,0,1,new f.LineBorder(k,2),1,new f.LineBorder(k,2),0===t?1:0,1)),o[w](z(e,i)),o[m](z(e,i)),o[b](z(e,r,j)),o[d](z(e,r,j)),o[Q](z(e,r,j,1)),o[W](z(e,r,j,1)),o[c](z(k,0,k,0,0,6)),o}function bt(t){var t,n,e,r,i,t,o,t=I(t),n=t,e=t+" 40",r=t+" 80",i=t+" 60",t=t+" 80",o=new F;return o[l](z(e,r,k,1,1,1,1,1,0,1)),o[v](z(e,r,0,0,1,1,1,1,1,1)),o[w](z(e,i)),o[m](z(e,i)),o[b](z(e,0,0,1)),o[d](z(e,0,0,1)),o[c](z(e,t,k,1,1,new f.LineBorder(n,2),1,1,0,1)),o}function wt(t){var n,e,r,i,t,o,n=I(t),e=k,r=0===t?n+" 25":n+" -25",i=0===t?n+" 50":n,t=0===t?n:n+" -50",o=new F;return o[l](z(j,e,j,1,0,0,0,2)),o[v](z(n,i,j)),o[w](z(n,r)),o[m](z(n,r)),o[b](z(j,r,j,1,0,0,2)),o[d](z(j,r,j,1,2)),o[c](z(j,t,j,1,0,2)),o}function mt(t){var n,e,r,t,i,o;function u(t,n){var e;return t<0||3<t?"":{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[n][t]}return n=I(t),e=u(t,"headerColor"),r=u(t,"stripColor"),i=t=u(t,"tableBackground"),(o=new F)[l](z(n,e,j)),o[v](z(n,t)),o[w](z(n,r)),o[m](z(n,r)),o[b](z(n,0,0,1)),o[d](z(n,0,0,1)),o[c](z(k,i,0,1,0,6)),o}function Ct(){}for(Object.defineProperty(t,"__esModule",{value:!0}),t.TableThemes=t.TableTheme=t.TableStyle=void 0,f=D("Core"),h=f.GC$.each,B=f.GC$.isEmptyObject,a=f.mt.T1,U=JSON.stringify,E=JSON.parse,e=f.mt.p0,V=f.mt.go,H=f.mt.vo,G=f.mt.n1,J=f.NodeHelper.sr,P=Math.floor,s=void 0,Y=null,C=[l="headerRowStyle",c="footerRowStyle",v="wholeTableStyle",d="highlightLastColumnStyle",b="highlightFirstColumnStyle",w="firstRowStripStyle",$="secondRowStripStyle",m="firstColumnStripStyle",K="secondColumnStripStyle",q="firstHeaderCellStyle",Z="lastHeaderCellStyle",Q="firstFooterCellStyle",W="lastFooterCellStyle"],g=[X="firstRowStripSize",tt="secondRowStripSize",nt="firstColumnStripSize",et="secondColumnStripSize"],D="name",rt="bold 11pt calibri",it={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},R=["backColor","foreColor","font",u="borderLeft",y="borderTop",p="borderRight",S="borderBottom",T="borderHorizontal",_="borderVertical","textDecoration"],ot=at(),O.prototype.h5=function(e,t,n,r,i){var o=this;n&&a(o[u])&&!a(e[u])&&(e[u]=o[u],e[u].level=20),t&&a(o[y])&&!a(e[y])&&(e[y]=o[y],e[y].level=20),i&&a(o[p])&&!a(e[p])&&(e[p]=o[p],e[p].level=20),r&&a(o[S])&&!a(e[S])&&(e[S]=o[S],e[S].level=20),t||!a(o[T])||a(e[y])||(e[y]=o[T],e[y].level=20),r||!a(o[T])||a(e[S])||(e[S]=o[T],e[S].level=20),n||!a(o[_])||a(e[u])||(e[u]=o[_],e[u].level=20),i||!a(o[_])||a(e[p])||(e[p]=o[_],e[p].level=20),h(R,function(t,n){0<=n.indexOf("border")||a(o[n])&&!a(e[n])&&(e[n]=o[n])})},O.prototype.Gf=function(){var t,n,t=new O,n=U(this.toJSON());return t.fromJSON(E(n)),t},O.prototype.toJSON=function(){var r,i,r=this,i={};return h(R,function(t,n){var e,e,e=r[n],e=e&&e.toJSON?e.toJSON():e;i[n]=B(e)?s:e}),i},O.prototype.fromJSON=function(i,o){var u;i&&(u=this,h(R,function(t,n){var e,r,e=i[n];a(e)&&(0<=n.indexOf("border")?((r=new f.LineBorder).fromJSON(e,o),u[n]=r):u[n]=e)}))},x=O,t.TableStyle=x,f.GC$.extend(f.StyleManager.prototype,{addTableTheme:function(t){var n=this,e,e;(e=(e=n.aSt)||(n.aSt={}))[t.name()]=t},getTableTheme:function(t){var n,e,r,i,n=this,e=n.aSt;return e=e||(n.aSt={}),ot[t.toUpperCase()]?e[r=t.substr(10).toLowerCase()]?e[r]:(ft(i=new F,A[r]),n.addTableTheme(i),i):e[t]}}),L.prototype.toJSON=function(){var e,t,r,i,e=this,t=e.builtInName();return t?{buildInName:t}:(r={name:e.name()},h(C,function(t,n){(i=e[n]())&&(r[n]=i.toJSON())}),h(g,function(t,n){1!==(i=e[n]())&&(r[n]=i)}),B(r)?s:r)},L.prototype.fromJSON=function(i,o){var u,t,t,t;i&&(u=this,(t=i.buildInName)?ft(u,A[t.toLowerCase()]):(t=i.name,t=a(t)?t:i.Zc,a(t)&&u.name(t,!1),h(g,function(t,n){var e=i[n]!==s?i[n]:i["_"+n];e&&u[n](e,!1)}),h(C,function(t,n){var e,r,e=i[n]!==s?i[n]:i["_"+n];e&&((r=new x).fromJSON(e,o),u[n](r,!1))})))},L.prototype.yh=function(t,u){var a,n,e,r,i,o,a=this;for(a.name(G(t.name)),e=function(t){var n,e,r,i,o,n=J(t.dxfId,0),e=t.type,r=J(t.size,1),i=new x,o=it[e||"wholeTable"];"function"==typeof a[o]&&void 0!==t.dxfId&&(u.getDxf(n,i,!0),h(R,function(t,n){0<=n.indexOf("border")&&i[n]===Y&&(i[n]=new f.LineBorder)}),a[o](i,!1)),"firstRowStripe"!==e&&"secondRowStripe"!==e&&"firstColumnStripe"!==e&&"secondColumnStripe"!==e||a[e.substr(0,e.length-1)+"Size"](r,!1)},r=0,i=n=V(t,"tableStyleElement");r<i.length;r++)e(o=i[r]);u.addTableTheme(a)},L.prototype.wh=function(r){var i,o,t,n,u,a,i=this,o=[],t={n_:"tableStyle",c_:o},n=i.builtInName();return n!==Y&&n!==s?t.name="TableStyle"+n:(t.name=H(i.name()),u=0,h(C,function(t,n){var e;(a=i[n]())&&(e=r.getDxfIndex(a))!==s&&(u++,o.push({n_:"tableStyleElement",type:f.SJSStylePropsToStyleProps[n],dxfId:e}))}),h(g,function(t,n){(a=i[n]())&&(u++,o.push({n_:"tableStyleElement",type:n.replace("Size","e"),size:a}))}),t.count=u,t.pivot="0"),t},F=L,(t.TableTheme=F).prototype.name=e(D),F.prototype.builtInName=e("builtInName"),h(C,function(t,n){F.prototype[n]=e(n)}),h(g,function(t,n){F.prototype[n]=e(n,1)}),j="white",k="black",A=Ct,t.TableThemes=A,n=1;n<=28;n++)r=P((ut=n-1)/7),n<=21&&0<=r&&r<3&&(o="Light"+n,(i=[st,lt,ct][r](ut%7)).name&&i.name(o),i.builtInName&&i.builtInName(o),A["light"+n]=i),n<=11&&0<=r&&r<2&&((i=[wt,mt][r](ut%7)).name(o="Dark"+n),i.builtInName(o),A["dark"+n]=i),0<=r&&r<4&&((i=[ht,vt,dt,bt][r](ut%7)).name(r="Medium"+n),i.builtInName(r),A["medium"+n]=i)},"./dist/plugins/table/table-util.js":function(M,t,n){var l,o,u,e,r,m,a,C,c,h,v,i,n,d;function b(t){throw new Error(t)}function f(t,n,e,r,i){u&&(!r&&i&&(r=k(t,i,n,e)),t.zI(n,e,r,i))}function s(t,n,e,r){t.setValue(n,e,r)}function w(t){t.suspendPaint()}function g(t){t.resumePaint()}function y(t){return t.op().Hyt()}function p(t){u&&t.suspendCalcService()}function S(t,n){u&&t.resumeCalcService(n)}function T(t){t&&(w(t),t.suspendEvent(),p(t))}function _(t){t&&(S(t),t.resumeEvent(),g(t))}function R(t){return t.rowCount}function x(t){return t.colCount}function F(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||255<=t.length)}function j(t,n,e,r,i,o){var u,i;return n?((u=t.Uw())._wt=i,i=t.Lp.parse(u,n,e,r,!1,o,!1),delete u._wt,i):C}function k(t,n,e,r,i){return i=i===c||i,t.Lp.unparse(t.Uw(),n,e,r,!1,i)}function A(t){var n,e,r,e;return!(!t||(F(t)||b(d().Exp_TableNameInvalid),e=(n=this).name(),r=n.jS,t===e)||r&&(e=r.findByName(t))&&n!==e)}function O(t,n,e,r,i){for(var o,u,a,f,o=e;n<=o;o--)for(a=r;a<=i;a++){if(N(u=t.Z_(o,a)))return o;if(L(t,o,a))return o;if(f=t.Ut.findSpan(o,a))return f.row+f.rowCount-1}return-1}function D(t,n,e,r,i){for(var o,u,a,f,u=i;r<=u;u--)for(o=n;o<=e;o++){if(N(a=t.Z_(o,u)))return u;if(L(t,o,u))return u;if(f=t.Ut.findSpan(o,u))return f.col+f.colCount-1}return-1}function L(t,n,e){var r=t.getValue(n,e),i,o;return r!==C&&a(r)||(i=t.getSparkline&&t.getSparkline(n,e))||N(o=t.Z_(n,e))}function N(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.cellType||t.diagonalDown||t.diagonalUp))}function B(t,n,e,r,i,o,u,a){return i<=t&&!(n===u&&n+r-1===a)&&(n<u&&u<n+r||u<=n&&n<=a&&a<n+r-1)}function U(t,n,e,r,i,o,u,a){return u<=n&&!(t===i&&t+e-1===o)&&(t<i&&i<t+e||i<=t&&t<=o&&o<t+e-1)}function E(t,n,e){return{col:n,leadingCellRow:e,row:t}}function V(t,n,e){var r,i,o,r=C,i=n.Ky,o=n.endRow();for(e&&(o-=n.oL?1:0);i<=o&&t.getRowHeight(o)<=0;)o--;return r=i<=o?o:r}function H(t,n){for(var e,r,i,e=C,r=n.iw,i=n.endColumn();r<=i&&t.getColumnWidth(i)<=0;)i--;return e=r<=i?i:e}function G(t){for(var n,e,r,n,i,o,u,a,f,s,n=t.Ut,e=n.W_(3).dataTable,r=n.getLastNonNullRow(3,!0),n=t.getRowCount(),i=t.getColumnCount(),o=-1,f=n-1;-1<f;f--)if(u=e[f])for(s=0;s<i;s++)if((a=u[s])&&!v(a.value))return h(f,r);return h(-1,r)}function J(t,n){var e,r,i,o,u,n,a,f,s,f,o,e=n.jS,r,i,o=n.Ky+n.Sx-1,u=n.iw,n=u+n.Tx-1,a=G(t),f=e?e.uSt():-1;return(s=o)<(a=h(a,f))&&(o=new l.Range(f=1+o,u,a-o,n-u+1),s=h(O(t,f,a,u,n),e.uSt(o))),s}function P(t){for(var n,e,r,i,o,u,a,a,f,s,n=t.Ut,e=n.W_(3).dataTable,r=n.getLastNonNullCol(3,!0),i=t.getRowCount(),o,u=-1,f=t.getColumnCount()-1;-1<f;f--)for(s=0;s<i;s++)if((a=(a=e[s])&&a[f])&&!v(a.value))return h(f,r);return h(-1,r)}function Y(t,n){var e,r,i,o,u,n,a,f,s,f,n,e=n.jS,r=n.Ky,i=r+n.Sx-1,o,u,n=n.iw+n.Tx-1,a=P(t),f=e?e.sSt():-1;return(s=n)<(a=h(a,f))&&(n=new l.Range(r,f=1+n,i-r+1,a-n),s=h(D(t,r,i,f,a),e.sSt(n))),s}function $(t,n,i,o,u,a,e,r,f,s){var l,c,t,n,h,r,l=t.getRowCount()-1,c=t.getColumnCount()-1,t=t.Ut.getSpans(),n=n.jS&&n.jS.U3;return!r&&(!f&&l-o<e||f&&c-a<e)?(s||b(d().Exp_TableAddRowNoEnoughRoom),!0):(h=f?U:B,(r=t.some(function(t){var n=t.row,e=t.col,r=t.rowCount,t=t.colCount;return h(n,e,r,t,i,o,u,a)}))?s||b(d().Exp_TableAddRowIntersectSpan):n&&(r=n.some(function(t){var n=t.Ky,e=t.iw,r=t.Sx,t=t.Tx;return h(n,e,r,t,i,o,u,a)}))&&!s&&b(d().Exp_TableAddRowIntersectTable),r)}function K(t,n,e){for(var r,i,o,u,a,f,s,r=n.row,i=n.col,o=r+n.rowCount,u=i+n.colCount,a=r;a<o;a++)for(f=i;f<u;f++)if(((s=t.getCell(a,f)).value()||t.Ut.findSpan(a,f))&&(!e||!e.equals(new l.Range(s.row,s.col,1,1))))return new l.Range(a,f,1,1);return c}function z(t,n,e,r,i,o,u){for(var a,f,s,a=n;a<=e;a++)for(f=r;f<=i;f++)if(s=t.l0(a,f,"locked"),o&&!s||u&&s)return;return 1}function q(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,w;if(i){if(!o&&!u)return C;if(a=t.Mf,s=f=0,t.oL&&(f=1),t.jO&&(s=1),n===m.TableSelectionType.TABLE_ROW_SELECT){if(!z(a,e,e,t.iw,t.endColumn(),o,u))return C}else if(n===m.TableSelectionType.TABLE_COL_SELECT){for(c=!0,h=0,v=l=a.getSelections();h<v.length;h++)if((d=v[h]).col===r&&d.row===t.Ky+s&&1===d.colCount&&d.rowCount===t.Sx-s-f){if(!z(a,t.Ky,t.endRow(),r,r,o,u))return C;c=!1}if(c&&!z(a,t.Ky+s,t.endRow()-f,r,r,o,u))return C}else if(n===m.TableSelectionType.TABLE_CORNER_SELECT){for(c=!0,b=0,w=l=a.getSelections();b<w.length;b++)if((d=w[b]).col===t.iw&&d.row===t.Ky+s&&d.colCount===t.Tx&&d.rowCount===t.Sx-s-f){if(!z(a,t.Ky,t.endRow(),t.iw,t.endColumn(),o,u))return C;c=!1}if(c&&!z(a,t.Ky+s,t.endRow()-f,t.iw,t.endColumn(),o,u))return C}else if(n===m.TableSelectionType.TABLE_SELECT&&!z(a,t.Ky,t.endRow(),t.iw,t.endColumn(),o,u))return C}return{action:n,table:t}}function I(t,n){var e=t.Ky;return n-(t.jO?e+1:e)}function Z(t,n){var e;return n-t.iw}function Q(t){var n=i;return t&&i++,n}function W(t){return"string"==typeof t}function X(t,n,e,r){var i;t.ki(l.Events.TableResizing,{sheet:t,table:n,oldRange:e,newRange:r})}function tt(t,n,e,r,i){var o;t.ki(l.Events.TableResized,{sheet:t,table:n,oldRange:e,newRange:r},i)}function nt(t,n,e,r,i,o,u){var e={sheet:t,table:n,propertyName:e,row:I(n,r),count:i};v(o)||(e.isAfter=o),u&&(e.deletedItem=u),t.ki(l.Events.TableRowsChanged,e)}function et(t,n,e,r,i,o){var e={sheet:t,table:n,propertyName:e,col:r-n.iw,count:i};v(o)||(e.isAfter=o),t.ki(l.Events.TableColumnsChanged,e)}function rt(t,n,e){var r=0;if(t.cSt(n,e))for(r=2;t.cSt(n+r,r);)r++;return 0<r&&(n+=r),n}function it(t){return t&&"="===t[0]}function ot(t){var n,e,r,i,n=-1;if(t)for(e=t.arguments,r=void 0,i=0;i<e.length;i++)if((r=e[i])instanceof o.obt){n=i;break}return n}function ut(t,n,e){var t,r,t,i,t=t.dataRange(),r=t.row,t=t.col,i;return(e?r:t)+n}function at(t){var n=t;return n=t&&"="===t[0]?t.slice(1):n}function ft(t,n){for(var e,r,r=0;r<t.length;r++)if((e=t[r])&&n===e.col)return e;return C}function st(t,n){var e,r,i;if(n)for(e=n.row;e<n.row+n.rowCount;e++)for(r=n.col;r<n.col+n.colCount;r++)if(t.tables&&(i=t.tables.find(e,r)))return i;return null}function lt(t,n){return n?t.tables.AB(n.row,n.col,n.rowCount,n.colCount):null}function ct(t){return v(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t}function ht(t){return t===c}Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0,l=n("Core"),o=n("SheetsCalc"),u=n("CalcEngine"),e=n("Common"),r=n("./dist/plugins/table/table.ns.js"),m=n("./dist/plugins/table/table.js"),a=l.mt.T1,C=null,c=void 0,h=Math.max,v=e.Common.lt.ht,i=0,n=new e.Common.ResourceManager(r.SR,"Tables"),d=n.getResource.bind(n),t.Util={throwError:b,setFormulaToSheet:f,setValue:s,suspendPaint:w,resumePaint:g,Hyt:y,suspendCalcService:p,resumeCalcService:S,fSt:T,lSt:_,getRowCount:R,getColCount:x,isValidTableName:F,formulaToExpression:j,expressionToFormula:k,checkTableName:A,hSt:E,_4t:V,E4t:H,dSt:J,vSt:Y,mSt:$,gSt:K,pSt:q,bSt:I,ySt:Z,T4t:Q,wSt:W,j4t:X,S4t:tt,jj:nt,Ej:et,MSt:rt,kf:it,CSt:ot,SSt:ut,TSt:at,ASt:ft,_getTable:st,ISt:lt,xSt:ct,NSt:ht}},"./dist/plugins/table/table.entry.js":function(t,n,e){var r,i,r=this&&this.__createBinding||(Object.create?function(t,n,e,r){void 0===r&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);i&&("get"in i?n.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,r,i)}:function(t,n,e,r){t[r=void 0===r?e:r]=n[e]}),i=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||r(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),e("./dist/plugins/table/table.interface.js"),e("./dist/plugins/table/table-event.js"),e("./dist/plugins/table/table-render.js"),e("./dist/plugins/table/table-action.js"),e("./dist/plugins/table/table-util.js"),i(e("./dist/plugins/table/table-theme.js"),n),i(e("./dist/plugins/table/table.js"),n),i(e("./dist/plugins/table/table.ns.js"),n)},"./dist/plugins/table/table.interface.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(f,T,t){var s,l,O,P,c,g,h,_,n,C,t,e,R,v,w,m,b,A,Y,$,K,L,q,Z,Q,W,X,tt,nt,et,rt,it,ot,ut,at,ft,st,lt,ct,x,F,y,p,S,ht,vt,dt,N,z,r,bt,j,k,d,wt,mt,Ct,gt,yt,I,M,D,pt,St,Tt,_t,Rt,xt,Ft,jt,kt,At,Ot,Lt,Nt,zt,It,Mt,Dt,Bt,Ut,B,U,E,Et,Vt,Ht,Gt,Jt,Pt,Yt,$t,Kt,qt,Zt,Qt,Wt,Xt,tn,nn,en,rn,on,un,an,fn,sn,ln,cn,hn,vn,dn,bn,wn,i,mn,Cn,gn,yn,t,pn,Sn,Tn,_n,Rn,xn,Fn,jn,kn,An,On,Ln,Nn,zn,In,Mn,Dn,Bn,Un,En,Vn,Hn,V,Gn,Jn,Pn,Yn,$n,Kn,qn,Zn,n,H,Qn,Wn,Xn,te,ne,ee,G,re,n,ie,J,oe,ue,ae,n,n,fe,r;function se(t,n){return t&&n&&t.color===n.color&&t.type===n.type||!t&&!n}function le(t,n){var e,r,i,e=!1;if(A(t[n]))e=!0;else for(i=t.length-1;n<i;i--)if(A(t[r=i-1])){e=!0;break}return e}function ce(o,e,u){var t=o.parent,a=ht(o);function r(t,i){m(t,function(t,n){var e,r,e=n.getExpression(),r=P.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(e,i,-1,-1,u);r!==e&&(n.SB(r),a.invalidName(o.Uw(),n.getName()))})}t?(r(t.getCustomNames(),e),m(t.sheets,function(t,n){r(n.getCustomNames(),e)})):r(o.getCustomNames(),e),a.onAfterRemoveTable(e,u)}function he(t,n){var e,r,n,i,e={position:O.ButtonPosition.right,imageType:O.ButtonImageType.dropdown,visibility:O.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},r,n={items:[{text:H().Table_None,value:null},{text:H().Table_Average,value:"=SUBTOTAL(101,[".concat(n,"])")},{text:H().Table_Count,value:"=SUBTOTAL(103,[".concat(n,"])")},{text:H().Table_Count_Numbers,value:"=SUBTOTAL(102,[".concat(n,"])")},{text:H().Table_Max,value:"=SUBTOTAL(104,[".concat(n,"])")},{text:H().Table_Min,value:"=SUBTOTAL(105,[".concat(n,"])")},{text:H().Table_Sum,value:"=SUBTOTAL(109,[".concat(n,"])")},{text:H().Table_StdDev,value:"=SUBTOTAL(107,[".concat(n,"])")},{text:H().Table_Var,value:"=SUBTOTAL(110,[".concat(n,"])")}]},i=new O.Style;return i.cellButtons=[e],i.dropDowns=[{type:O.DropDownType.list,option:n,submitCommand:"tableTotalRowFormula"}],i}function ve(t){var n;t.tables.all().forEach(function(t){t.formulaFromJSON()})}function de(t,n,e){var t,n,t,e;if(t&&0<t.length&&(t=t[n]))return n=t.cellType(),t=t.formatter(),e=e,n&&((e=e||new O.Style).cellType=n),t&&((e=e||new O.Style).formatter=t),e}function be(t){var t,n,n,e,t,t=t.c_[0],n=t&&t.c_&&t.c_[0];if(n)return n={kSt:{altText:n.altText,altTextSummary:n.altTextSummary}},e=t["xmlns:x14"],(t={kSt:{uri:t.uri}})["x14:table"]=n,t.kSt["xmlns:x14"]=e,{ext:t,attr:{}}}function we(t){if(t&&t.c_)return be(t)}function me(t,n,e,r,i,o,u){var n,e,a,f,s,l,c,h;if(t.Ut&&(e=(n=t.Ut.sheetModels[3].J_(n,e))&&n.style)&&o&&"string"==typeof e)if(i[e])n.style=i[e];else if(a=o.i3(e)){for(f=(a=a.clone(!0)).parentName;f&&(s=t.u8(f));)a.h5(s,!1,10,!0),f=s.parentName;for(l in a.parentName=U,Xn)!Xn.hasOwnProperty(l)||A(a[l])||(0===(c=Xn[l])?a[l]===r[l]&&(a[l]=U):1===c?se(a[l],r[l])&&(a[l]=U):2===c&&O.util.rfe(a[l],r[l])&&(a[l]=U));h=u.Xd+u.$d+e,u.$d++,a.name=h,o.$p(a),n.style=h,i[e]=h}}function Ce(t,n,e,r,i,o){var t,n,u,a,e,e,t=t[n]&&t[n][e],n=t&&t.s;if(n!==U)if(i[n])t.s=i[n];else if(u=o.getStyle(n)){for(a in u=u.clone(!0),Xn)Xn.hasOwnProperty(a)&&A(u[a])&&(u[a]=r[a]);e=o.Xd+o.$d+n,o.$d++,u.name=e,e=o.getStyleIndex(u),t.s=e,i[n]=e}}function ge(t,n,e,r,i,o){n&&(n.table(t),(e=e||{lossless:{}})&&(e.lossless||(e.lossless={}),!1===t.showHeader()&&(e.lossless.showTableHeader=!1),e.ref||(e.lossless.showFilterButton=!1),e.lossless.range={row:t.Ky+1,col:t.iw,rowCount:t.Sx-1-(t.showFooter()?1:0),colCount:t.Tx},n.yh(e,r,i)),t.IB!==n&&(t.IB=n),o?t.IB.reFilter():(t.DSt=!0,t._St()))}function ye(){var t=0;return function(){return++t}}function pe(t,n){var e=t;return typeof n[t]===Yn?(n[t]++,e+="_".concat(n[e])):n[t]=0,e}function o(t,n,e,r,i,o,u){var a,f,a=this;for(a.jO=!u||u.showHeader===U||u.showHeader,a.oL=!(!u||u.showFooter===U)&&u.showFooter,a.ESt=!(!u||u.useFooterDropDownList===U)&&u.useFooterDropDownList,a.jSt=!(!u||u.showResizeHandle===U)&&u.showResizeHandle,a.OSt=[],a.H3=B,a.IB=B,a.jS=B,a.RSt=!1,R(t)&&a.name(t),a.Ky=R(n)?n:-1,a.iw=R(e)?e:-1,a.Sx=R(r)?r:-1,a.Tx=R(i)?i:-1,R(o)&&a.style(o),a.BSt=[],f=0;f<a.Tx;f++)a.BSt.push(new J(f+1));a.LSt=B,a.FSt={},a.PSt=[],a.aj=[],a.GSt=[],a.USt=[],a.HSt=[],a.zSt=[],a.VSt=!0}function Se(t,n){var t,e,t=t&&t.rowFilter&&t.rowFilter();return!A(t)&&(e=t.range).intersect(n.row,n.col,n.rowCount,n.colCount)}function Te(i){return function(t,n){var e=this,r=e.Mf;r&&t!==n&&(G.et(r,"tableNameChanged",{oldName:n,newName:t}),r.Ut.YSt(e,i,n,t))}}function _e(t,n){var e=this;e.dl(),Te("style").call(e,t,n)}function Re(t,n,e,r,i){t.Qy().execute({cmd:On,sheetName:t.name(),tableName:n.name(),row:e,count:r,isAfter:i})}function xe(t,n,e,r,i){t.Qy().execute({cmd:Ln,sheetName:t.name(),tableName:n.name(),row:e,count:r,isAfter:i})}function Fe(t,n){t.Qy().execute({cmd:Nn,sheetName:t.name(),tableName:n.name()})}function je(t){var n,n;if(!A(t))return n=/\[\S[\S\s]*\S\]/,"SUBTOTAL("!==(t=t.trim()).substr(0,9)||!n.test(t)||t.indexOf("[[")?"custom":(n=t.substring(9,12),re[n]||Kn)}function ke(t){return-1<t.indexOf("LET(")}function u(t){var n,e,n=fe.call(this)||this,e=n;return e.table(t),e.act=!1,n}function Ae(t,n,e,r,i,o){var u=this;u.id(t),u.dataField(n),u.name(e||n||mn+u.id()),u.formatter(r),u.cellType(i),u.value(o)}function Oe(t,n){for(var e,r,e=n.row;e<n.row+n.rowCount;e++)for(r=n.col;r<n.col+n.colCount;r++)if(!A(t.getValue(e,r)))return;return 1}function a(t){this.Mf=t,this.U3=[],this.xl=[],this.Nl=[]}function Le(t,n){var t,e;return"Object"===n.constructor.name&&(t=t.findByName(n.tableName))&&(t.H3?n=t.H3:((e=new _.$$).fromJSON(n),t.H3=n=e)),n}function Ne(t,n,e,r,i){for(var i,o,u,a,f,i=0===i,o=i?t.aj:t.GSt,u=-1,f=0;f<o.length;f++)if((a=o[f])&&a.key===r){u=f;break}-1<u&&o.splice(u,A(e)?1:e),i&&t.ZSt()}function ze(t,n){var n,e,r,t,n;n.refresh(),t&&(n=t.table,e=t.row,r=t.count,t=t.stateType,n=n.getSlicerData())&&(0===t?n.onRowsAdded(e,r):n.onRowsRemoved(e,r))}function Ie(t,n,e){var r,i,o;if(n)for(r=n.length-1;0<=r;r--)o=Le(t,(i=n[r]).bindingManager),e?o.wtt(i):o.Mtt(i)}function Me(t,n){var e=new G;return e.Sg(t),e.fromJSON(n),e}function De(t,n){var e,r;if(n)for(e=0;e<n.length;e++)(r=n[e])&&"Object"===r.constructor.name&&(n[e]=t.findByName(r.name),n[e]||(n[e]=Me(t,r)))}function Be(t,n){for(var e,r,e=0;e<n.length;e++)(r=n[e]).table&&"Object"===r.table.constructor.name&&(r.table=t.findByName(r.table.name)),De(t,r.tableList),De(t,r.changedTables)}s=this&&this.__extends||(ae=function(t,n){return(ae=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}ae(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var n,e,r,i,e=1,r=arguments.length;e<r;e++)for(i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},Object.defineProperty(T,"__esModule",{value:!0}),T.TableRemoveOptions=T.TableManager=T.TableColumn=T.WSt=T.hasRowFilter=T.Table=T.TableSelectionType=void 0,O=t("Core"),P=t("SheetsCalc"),c=t("Common"),g=t("CalcEngine"),h=t("Filters"),_=t("Bindings"),n=t("./dist/plugins/table/table.ns.js"),C=t("./dist/plugins/table/table-theme.js"),t=t("./dist/plugins/table/table-util.js"),e=O.mt.p0,R=O.mt.T1,v=O.mt.j,w=O.GC$.inArray,m=O.GC$.each,b=O.GC$.isEmptyObject,A=c.Common.lt.ht,Y=c.Common.ct,$=c.Common.Uf.OS,K=c.Common.kh,L=O.mt.xr,q=O.mt.go,Z=O.mt.c1,Q=O.mt.St,W=O.CopyToOptions.all,X=O.StorageType.data|O.StorageType.style|O.StorageType.comment|O.StorageType.tag|O.StorageType.sparkline|O.StorageType.axis|O.StorageType.bindingPath|O.StorageType.hyperlink|O.StorageType.altText,tt=O.NodeHelper.sr,nt=O.NodeHelper.ur,et=O.mt.n1,rt=O.mt.vo,it=O.Util.gr,ot=O.Util.pr,ut=O.Util.mr,at=O.Util.addXLFNPrefix,ft=O.Util.wr,st=O.Util.Sr,lt=O.Util.po,ct=O.Util.yo,x=t.Util.throwError,F=t.Util.setFormulaToSheet,y=t.Util.setValue,p=t.Util.suspendPaint,S=t.Util.resumePaint,ht=t.Util.Hyt,vt=t.Util.suspendCalcService,dt=t.Util.resumeCalcService,N=t.Util.getRowCount,z=t.Util.getColCount,r=t.Util.checkTableName,bt=t.Util.isValidTableName,j=t.Util.formulaToExpression,k=t.Util.expressionToFormula,d=t.Util.hSt,wt=t.Util._4t,mt=t.Util.E4t,Ct=t.Util.dSt,gt=t.Util.vSt,yt=t.Util.mSt,I=t.Util.gSt,M=t.Util.pSt,D=t.Util.bSt,pt=t.Util.ySt,St=t.Util.T4t,Tt=t.Util.wSt,_t=t.Util.fSt,Rt=t.Util.lSt,xt=t.Util.jj,Ft=t.Util.Ej,jt=t.Util.MSt,kt=t.Util.kf,At=t.Util.CSt,Ot=t.Util.SSt,Lt=t.Util.TSt,Nt=t.Util.ASt,zt=t.Util.ISt,It=t.Util.xSt,Mt=t.Util.NSt,Dt=O.range_parser.getRangeString,Bt=O.range_parser.Dc,Ut=O.range_parser.jc,B=null,U=void 0,E=Math.min,Et=Math.ceil,Vt=Math.max,Ht=JSON.stringify,Gt=JSON.parse,Kt="highlightFirstColumn",qt="highlightLastColumn",Zt="bandRows",Qt="bandColumns",Wt="autoGenerateColumns",Xt="headerRowStyle",tn="footerRowStyle",nn="wholeTableStyle",en="highlightLastColumnStyle",rn="highlightFirstColumnStyle",on="firstRowStripStyle",un="secondRowStripStyle",an="firstColumnStripStyle",fn="secondColumnStripStyle",sn="firstHeaderCellStyle",ln="lastHeaderCellStyle",cn="firstFooterCellStyle",hn="lastFooterCellStyle",vn="firstRowStripSize",dn="secondRowStripSize",bn="firstColumnStripSize",wn="secondColumnStripSize",i=".table",mn="Column",t="dataAreaFormulaStr",pn="isArrayFormula",_n="footerRowStyles",Rn=[Cn="id",Jt="name",Pt="cellType",Yt="value",$t="formatter",gn="dataField",yn="footerFormula",Sn="dataAreaFormula",Tn="footerValue"],xn=4,Fn=2,jn="table",kn="tableResize",An="#485DB1",On="tableInsertRows",Ln="DoInsertRows",Nn="tableShowFooter",zn="tableDeleteRows",In="tableInsertColumns",Mn="tableDeleteColumns",Dn="collection",Bn="tableColumn",Un="property",En="dataSource",Vn="rowsChange",Hn="showFooter",V="range",Gn="columns",Jn="tableExpression",Pn="sheetExpression",Yn="number",$n="string",Kn="custom",qn=O.XFileConstants.Ki,Zn=O.XFileConstants.Bu,n=new c.Common.ResourceManager(n.SR,"Tables"),H=n.getResource.bind(n),Qn=O.UsedRangeUtil.hh,Wn=O.UsedRangeUtil.vh,Xn={backColor:2,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},(n=te=T.TableSelectionType||(T.TableSelectionType={})).TABLE_ROW_SELECT="tableRowSelect",n.TABLE_COL_SELECT="tableColSelect",n.TABLE_CORNER_SELECT="tableCornerSelect",n.TABLE_SELECT="tableSelect",(n=ne=ne||{})[n.deleted=0]="deleted",n[n.dirty=1]="dirty",O.Worksheet.ch(jn,{priority:2e3,getUsedRange:function(t){var n,e,r;t.type&O.UsedRangeType.table&&(r=(e=(n=this).tables).getUsedRange(),Wn(t.range,r))},init:function(){var v=this;v.tables=v.Ut.QSt,v.unbind(i),v.bind(O.Events.BeforeDragDrop+i,function(t,n){var e,r,i,o,u,a,f,e,s,e,l,c,h,l,e=v,r=v.tables,i=H().Exp_DragDropChangePartOfTable,o=n.fromRow,u=n.fromColumn,a=N(n),f=n.columnCount,e=e.rt.q6,s=e.row,e=e.col,l=n.isDragInsert,c=n.isDragCopy,h=B;!l||-1!==o&&-1!==u||(0<=u?(v.isDragCopy&&(e<=u||u+f<=e)||!c&&(e<u||u+f<e))&&(l=!1,r.oSt(-1,e,-1,1)&&(l=!0,h=H().Exp_DragDropShiftTableCell),l||c||!r.oSt(-1,u,-1,f)||(h=i)):0<=o&&u<0&&(c&&(s<=o||o+a<=s)||!c&&(s<o||o+a<s))&&!c&&r.oSt(o,-1,a,-1)&&(h=i)),n.invalidMessage=h}),v.bind(O.Events.RowChanged+i,function(t,n){var e,r,i,e=v.tables,r=e.xl,i=n.propertyName;"isVisible"===i?(!1===n.newValue?r[n.row]=0:r[n.row]=U,e.KSt(n.row)):"height"===i&&(r[n.row]=U,e.KSt(n.row))}),v.bind(O.Events.RowHeightChanged+i,function(t,n){for(var e,r,i,o,u,a,f,e=v.tables,r=e.xl,i=0,o=n.rowList;i<o.length;i++)r[u=o[i]]=U,f=(a=n.sheet).getRowHeight(u),e.KSt(u,0<f)}),v.bind(O.Events.ColumnChanged+i,function(t,n){var e,r,e=v.tables,r=e.Nl;"isVisible"===n.propertyName?(!1===n.newValue?r[n.col]=0:r[n.col]=U,e.JSt(n.col)):"width"===n.propertyName&&(r[n.col]=U,e.JSt(n.col))}),v.bind(O.Events.ColumnWidthChanged+i,function(t,n){for(var e,r,i,o,u,e=v.tables,r=e.Nl,i=0,o=n.colList;i<o.length;i++)r[u=o[i]]=U,e.JSt(u)}),v.bind(O.Events.RangeFiltered+i,function(t,n){for(var e,r,i,o,e=v.tables,r=e.xl,i=n.sheet.IB.range,o=0;o<i.rowCount;o++)r[i.row+o]=U,e.KSt(i.row+o)}),v.bind(O.Events.TableFiltered+i,function(t,n){for(var e,r,i,o,e=v.tables,r=e.xl,i=n.table.range(),o=0;o<i.rowCount;o++)r[i.row+o]=U,e.KSt(i.row+o)}),v.bind(O.Events.TableFilterCleared+i,function(t,n){var e;v.tables.dl()}),v.Q1i&&v.bind(O.Events.RangeChanged+i,function(t,n){var e,r,i,e=n.changedCells;if(e){for(v.pmi(),r=0;r<e.length;r++)i=e[r],v.Q1i(i.row,i.col,1,1,i.sheetArea);v.Smi()}})},resetBinding:function(t){this.tables.XSt()},initBinding:function(t){var n,e,r,i,o,u,n=this,e=n.tables;for(e.XSt(),vt(n),i=0,o=(r=e.all()).length;i<o;i++)(u=r[i])&&u.qSt();dt(n)},dispose:function(t){!1!==t.clearCache&&(this.unbind(i),this.tables)&&(this.tables.L0(),this.tables=null)},clearPendingChanges:function(){var t=this.tables;t&&t.$St()},onGroupChanged:function(t){var n,e,r,i,n,e=this.tables;if(t.fromSetCollapsed)for(r=t.isRow?e.xl:e.Nl,i=t.start;i<=t.end;i++)r[i]=U,t.isRow?e.KSt(i):e.JSt(i)},onLayoutChanged:function(t){var n,e,r,i,o,u,a,f,n=t.changeType,e=t.row,r=t.rowCount,i=t.col,o=t.colCount,u=t.sheetArea,a,f=this.tables;"setRowCount"===n||"setColumnCount"===n?f.dl():!A(u)&&3!==u||("addRows"===n?(f.JO(e,r),f.dl()):"addRows2"===n?f.t5t(e,r):"deleteRows"===n?(f.xP(e,r),f.dl()):"addColumns"===n?(f.qO(i,o),f.dl()):"deleteColumns"===n?(f.NP(i,o),f.dl()):"addColumns2"===n||"deleteColumns2"===n?f.n5t(i):"clear"!==n||t.ignoreTable||f.d5(e,i,r,o,t.type))},toJson:function(t,n){var e,r,i,o,i;function u(t,n){for(var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,C,g,g,e=t.tables.all(),r=0,i=e.length;r<i;r++)if(u=(o=e[r]).z3(),f=(a=o.dataRange()).row,s=a.col,l=f+N(a)-1,c=s+z(a)-1,u){if(h=[],(v=o.BSt)&&0<v.length)for(d=0;d<v.length;d++)w=(b=v[d]).formatter(),A(w)||Q(w)||((m=new O.Style).formatter=w,h[d]=m);for(C=f;C<=l;C++)for(d=s;d<=c;d++)(g=o.Sl(C,d)).e5t&&(g=g.y4,Y.W0(g)&&(g=Y.Q0(g)),t.s8(n,C,d,g,U,h[d-s]))}}r=(e=this).tables,i=n&&n.ignoreStyle,o=n&&n.newWorkSheetName,i||(r&&(t.tables=r.toJSON(o,n)),n&&n.includeBindingSource&&((i=t.data).dataTable=i.dataTable||{},u(e,i.dataTable)))},wh:function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,C,g,y,p,S,T,_,_,R,x,F,j,k,r=this,i=r.tables,o=e&&!1===e.includeStyles,u=n.styleManager;if(i&&!o){if(i.wh(t),e&&e.includeBindingSource)for(f=0,s=(a=i.all()).length;f<s;f++)if(c=(l=a[f]).z3(),v=(h=l.dataRange()).row,d=h.col,b=v+N(h)-1,w=d+z(h)-1,c){if(m=[],(C=l.BSt)&&0<C.length)for(g=0;g<C.length;g++)p=(y=C[g]).formatter(),A(p)||Q(p)||((S=new O.Style).formatter=p,m[g]=u.getStyleIndex(S));for(T=v;T<=b;T++)for(g=d;g<=w;g++)(_=l.Sl(T,g)).e5t&&(_=_.y4,Y.W0(_)&&(_=Y.Q0(_)),r.c8(t,T,g,_,n.sharedStrings,R=m[g-d]))}if(e&&O.OpenSaveFileType.excel===e.fileType&&(F=(x=i.U3).length,j=L(t,"sheetData"),k=n.defaultStyle,j)&&k)for(f=0;f<F;f++)(l=x[f]).M1e(j,k,u)}},fromJson:function(t,n,e){var r,i,o,o,e,r,i=this.tables,o=t.tableManager,o=n?o&&o.tables:t.tables,e=e&&e.ignoreStyle;R(o)&&!e&&i&&i.fromJSON(o,n,t.isApplyRefilter)},fromJsonAfterFormula:function(t,n,e){ve(this)},fromJsonAfterSJSFormula:function(t){ve(this)},yh:function(t,n,e){var r,i=e&&!1===e.includeStyles,o=this.tables,u=L(t,Zn),t=t.rels;R(u)&&R(t)&&!i&&o&&o.yh(u,t,n,e)},lastNonNullRowAndCol:function(){var t,n,e,r,i,o,u,a,a,f,f,t,n,e=0,r=0,i=this.tables.all();if(i)for(o=0,u=i.length;o<u;o++)(a=i[o])&&(e<(f=(a=a.range()).row+N(a)-1)&&(e=f),r<(f=a.col+z(a)-1))&&(r=f);return{lastNonNullRow:e,lastNonNullCol:r}},paintCell:function(t){var n,e,r,t,i,o,e,u,e,i,u,o,e,t,n,t,a,f,n=this;t.isPrinting||t.sheetArea!==O.SheetArea.viewport||n.options.isProtected||(e=n.tables,r=t.ctx,i=(t=t.cell).row,o=t.col,(e=e.find(i,o))&&e.showResizeHandle()&&!e.QL()&&(u=wt(n,e),e=mt(n,e),i===u)&&o===e&&(i=t.x,u=t.y,o=t.width,e=t.height,t=n.zoom(),n=Et(4*t),t=Et(2*t),a=i+o,f=u+e,r)&&0<o&&0<e&&(r.save(),r.rect(i,u,o,e),r.clip(),r.fillStyle=An,r.beginPath(),r.moveTo(a-n,f),r.lineTo(a,f),r.lineTo(a,f-t),r.lineTo(a-n,f-t),r.fill(),r.beginPath(),r.moveTo(a,f-t),r.lineTo(a-t,f-t),r.lineTo(a-t,f-n),r.lineTo(a,f-n),r.fill(),r.restore()))},composeTableFooterList:function(t){var n=t.table,e=t.row,r=t.col,t=t.style;n.i5t(e,r,t)},refSheetLazyLoaded:function(t,o,u){var n,e,t,r,a,n,e=this.tables.all();0<e.length&&T.WSt&&(t=t.rels.c_.filter(function(t){return t.Type===O.RelationshipConstants.lc}).map(function(t){return O.Util.vr(t.Target)}),r=o.tables,a={},O.GC$.each(t,function(t,n){var n=r[n];n&&(a[n.name]=n)}),O.GC$.each(e,function(t,n){var e,r,e,i,e=a[n.name()];e&&(r=L(e,"autoFilter"),e=L(e,"sortState"),ge(n,i=n.IB||new T.WSt,r,e,o.styleManager),u.isApplyRefilter)&&n.IB.reFilter()}))}}),O.Worksheet.prototype.jj=function(t,n,e,r,i,o){var o=o?U:t.tq();xt(this,t,n,e,r,i,o)},O.Worksheet.prototype.Ej=function(t,n,e,r,i){Ft(this,t,n,e,r,i)},O.Workbook.prototype.r5t=function(t){var n,e,e,r,n=this.sheets;if(n)for(r=0;r<n.length;r++)if((e=n[r].tables)&&(e=e.findByName(t)))return e;return B},ee=ye(),o.prototype.L0=function(){var t=this;t.BSt=[],t.OSt=[],t.aj=[],t.GSt=[],t.USt=[],t.FSt={},t.PSt=[],t.Mf=B,t.jS=B,t.IB&&(t.IB.L0(),t.IB=B),t.dl()},o.prototype.dl=function(){this.HSt=[],this.zSt=[]},o.prototype.range=function(){var t=this;return(0,O.Ec)(t.Ky,t.iw,t.Sx,t.Tx)},o.prototype.dataRange=function(){var t,n,e,t=this,n=t.jO?t.Ky+1:t.Ky,e=t.jO?t.Sx-1:t.Sx;return t.oL&&e--,(0,O.Ec)(n,t.iw,e,t.Tx)},o.prototype.headerIndex=function(){return this.jO?this.Ky:-1},o.prototype.footerIndex=function(){return this.oL?this.Ky+this.Sx-1:-1},o.prototype.showHeader=function(t){var n,e,n=this;return 0===arguments.length?n.jO:(n.jO!==t&&((e=n.Mf)&&e.suspendPaint(),n.o5t(t),e)&&e.resumePaint(),n)},o.prototype.o5t=function(t){var n,e,r,i,n=this,e=n.Mf;e&&e.Ut.YSt(n,"showHeader",n.jO,t),(r=n.jO=t)?(0<n.Ky&&(n.Ky=n.Ky-1,n.Sx+=1),n.a5t()):(i=n.Ky,n.Ky=n.Ky+1,--n.Sx,n.u5t(i),n.s5t()),e&&g&&e.recalcRange(n.Ky+(t?0:-1),n.iw,1,n.Tx)},o.prototype.showFooter=function(t,n){var e,r,e=this;if(0===arguments.length)return e.oL;if(e.oL!==t){(r=e.Mf)&&r.suspendPaint();try{e.c5t(t,n||!1)}finally{r&&r.resumePaint()}}return e},o.prototype.expandBoundRows=function(t){var n=this;return 0===arguments.length?n.RSt:(n.RSt!==t&&(n.RSt=t),n)},o.prototype.c5t=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,e=this,r=e.Mf;if(r&&r.Ut.YSt(e,Hn,e.oL,t),i=e.Sx,t){if((!r||e.Ky+i<r.getRowCount())&&(!n||e.f5t(!0,i)))for(e.oL=t,e.Sx+=1,u=(o=e.BSt).length,a=e.footerIndex(),f=e.iw,s=0;s<u;s++)h=f+s,(c=(l=o[s])&&l.footerFormula())&&(v=k(r,c,a,h))&&(c=j(r,v,a,h),l.footerFormula(c));e.l5t()}else e.oL=t,d=e.Ky+i-1,--e.Sx,e.u5t(d),e.I4t(),e.cL(0),n&&e.f5t(!1,i);r&&g&&r.recalcRange(e.Ky+e.Sx+(t?-1:0),e.iw,1,e.Tx)},o.prototype.f5t=function(t,n){var e,r,n,i,o,u,a,f,s,l,s,c,e=this,r=e.Mf,n=e.Ky+n,i=e.iw,o=e.Tx,u=i+o-1,a=Ct(r,e),f=n<=a,s=I(r,new O.Range(n,i,a-n+1,u-i+1)),l,s=(s&&s.row)===n;return!(s&&yt(r,e,n,a,i,u,1)||(s&&f&&r.moveTo(n,i,c=t?n+1:n-1,i,a-n+1,o,W),0))},o.prototype.h5t=function(t){for(var n,e,r,i,o,u,a,f,s,l,n=this,e=n.BSt,r=e.length,i=n.iw,o=[],u=n.name(),a=0;a<r;a++)f=i+a,s=n.getColumnName(a),o.push(he(u,s)),t||(0===a?n.d5t(f,H().Table_Total,!0):a!==r-1||(l=e[a].footerFormula())||(n.v5t(f)?n.m5t(a,"=SUBTOTAL(109,".concat(u,"[").concat(s,"])")):n.m5t(a,"=SUBTOTAL(103,".concat(u,"[").concat(s,"])"))));n.OSt=o},o.prototype.v5t=function(t){for(var n,e,n,r,i,o,u,a,n=this,e=n.Mf,n=n.dataRange(),r=!0,i=n.rowCount,o=n.row,u=0;u<i;u++)if(a=e.getValue(o+u,t),!A(a)&&typeof a!==Yn){r=!1;break}return r},o.prototype.g5t=function(){return this.OSt&&0<this.OSt.length},o.prototype.p5t=function(t,n,e){var r=this,i=this.Mf;r.g5t()&&(i&&i.Ut.YSt(r,_n,r.b5t(),e),0<=n)&&(e?r.OSt.splice(t,n,e):r.OSt.splice(t,n))},o.prototype.b5t=function(){var t,n=this.OSt,e=[];return n.forEach(function(t){t&&e.push(t.clone())}),e},o.prototype.y5t=function(t,n,e){var r=this,e=R(e)?he(r.name(),e):B;r.g5t()&&r.p5t(t,n,e)},o.prototype.useFooterDropDownList=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.ESt:(e&&(e.suspendPaint(),n.ESt!==t&&(e.Ut.YSt(n,"useFooterDropDownList",n.ESt,t),n.ESt=t,n.ESt)&&!n.g5t()&&(n.h5t(),n.w5t()),e.resumePaint()),n)},o.prototype.showResizeHandle=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.jSt:(e&&(e.suspendPaint(),n.jSt!==t&&(e.Ut.YSt(n,"showResizeHandle",n.jSt,t),n.jSt=t),e.resumePaint()),n)},o.prototype.rowFilter=function(){var t=this;return!t.IB&&T.WSt&&(t.IB=new T.WSt(t),t.IB.Uct(t.dataRange())),t.IB},o.prototype.bindColumns=function(t){var n,e,r,i,o,u,a,f,s,l,f,c,n=this,e=[];if(t){for(r=t.length,n.autoGenerateColumns||(r=E(n.Tx,t.length)),n.jO&&n.Mf.KI(n.Ky,n.iw,1,r,3,17,U,!0),i=0;i<r;i++)(o=n.BSt[i])||(o=new J(n.M5t()),n.BSt[i]=o),a=(u=t[i]).id(),f=u.name(),s=u.dataField(),l=u.value(),f=jt(n,f,i),o.id(a),o.name(f),o.dataField(s),o.value(l),o.cellType(u.cellType()),o.formatter(u.formatter()),s&&e.push(c={name:f,value:l,dataField:s}),n.y5t(i,1,f);n.vTt()}n.C5t=e,n.H3&&(n.H3.J$=e)},o.prototype.bindingPath=function(t){var n=this;return 0===arguments.length?n.S5t:(n.S5t=t,n.qSt(),n)},o.prototype.bind=function(t,n,e){var r,i,r=this,i=e;return A(t)||r.bindColumns(t),A(e)&&(i=r.z3()),n&&(r.S5t=n,i=(0,_.q$)(i,n)),_.$$&&i&&r.T5t(i),r},o.prototype.getColumn=function(n){return this.BSt.find(function(t){return t.name()===n})},o.prototype.getColumnName=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.name())!==B?v(t):t:B},o.prototype.setColumnName=function(t,n){var e,r,r,i,o,e=this;return e.cSt(n)||(r=e.BSt)&&0<=t&&t<r.length&&(i=(r=(r=r[t])||(e.BSt[t]=new J(e.M5t()))).name(),o=e.Mf,i!==n&&o&&(o.Ut.A5t(e,r,"name",i,n),r.name(n)),e.jO&&o&&o.setText(e.headerIndex(),e.iw+t,n),e.I5t(i,r.name(),t)),e},o.prototype.I5t=function(t,n,e){var r,i,o,r,r=this,i,o=r.BSt[e];r.y5t(e,1,o.name()),(r=this.LSt)&&r.onColumnNameChanged(t,n)},o.prototype.autoBind=function(){var t=this,n=t.z3();t.H3&&(t.H3.J$=B),_.$$&&n&&t.T5t(n)},o.prototype.setColumnDataField=function(t,n){var e,r,r,t,i,t,e=this,r=e.BSt;return r&&0<=t&&t<r.length&&(r=(r=r[t])||(e.BSt[t]=new J(e.M5t())),t=e.Mf,i=r.dataField(),t&&n!==i&&t.Ut.A5t(e,r,"dataField",i,n),r.dataField(n),t=e.z3(),_.$$)&&t&&e.T5t(t),e},o.prototype.getColumnDataField=function(t){var n,n,t,n=this.BSt;return n&&0<=t&&t<n.length&&(n=n[t])?(t=n.dataField())!==B?v(t):t:B},o.prototype.getColumnFormula=function(t){var n,e,n,r,t,n,n=this.BSt,e=this.Mf;return n&&e&&0<=t&&t<n.length&&(n=n[t])?(r=this.footerIndex(),t=this.iw+t,(n=n.footerFormula())&&k(e,n,r,t,!1)):B},o.prototype.setColumnFormula=function(t,n){return this.m5t(t,n),this},o.prototype.setColumnDataFormula=function(t,n){var e,r,r,i,o,u,a,f,s,l,c,h,t;if(g){if((r=(e=this).BSt)&&0<=t&&t<r.length&&(r=r[t])){for(i=e.Mf,p(i),vt(i),o=t+e.iw,u=e.Ky,a=e.Sx,e.showHeader()&&(u++,a--),e.showFooter()&&a--,f=j(i,n,u,o,!0),s=r.dataAreaFormula(),i&&f!==s&&i.Ut.A5t(e,r,"dataAreaFormula",s,f),r.x5t(n),r.dataAreaFormula(f),l=u;l<u+a;l++)c=i.getFormula(l,o),F(i,l,o,n,f),n||(h=s&&k(i,s,l,o),(c=c&&k(i,j(i,c,l,o),l,o))===h&&i.Ut.setValue(l,o,B));i.Lp.resume(!(t=function(t){return t.w3===i.oMt&&t.row>=u&&t.row<u+a&&t.column===o}),U,t),S(i)}return e}},o.prototype.getColumnValue=function(t){var n,e,e,r,n=this,e=n.BSt;return e&&0<=t&&t<e.length&&(e=e[t])?n.oL&&e.footerFormula()&&(r=n.Mf)?r.getValue(n.footerIndex(),n.iw+t):e.footerValue():B},o.prototype.setColumnValue=function(t,n){var e,r,i,r,o,e=this,r=e.BSt,i=e.Mf;return r&&0<=t&&t<r.length&&((r=r[t])&&(o=r.footerValue(),i&&n!==o&&i.Ut.A5t(e,r,"footerValue",o,n),r.footerValue(n)),e.oL)&&i&&y(i,e.footerIndex(),e.iw+t,n),e},o.prototype.filterButtonVisible=function(t,n){var e,r,i,o,u,a,f,e=this,r=e.Mf,i=e.rowFilter();if(!(t<0||t>=e.Tx))switch((o=arguments).length){case 0:return i&&i.filterButtonVisible();case 1:if("number"==(a=typeof(u=o[0])))return i&&i.filterButtonVisible(u);if("boolean"==a&&i){for(p(r),f=0;f<e.Tx;f++)i.filterButtonVisible(f,u);S(r)}return e;case 2:return i&&i.filterButtonVisible(t,n),e}},o.prototype.allowAutoExpand=function(t){var n=this,e=n.Mf;return 0===arguments.length?n.VSt:(n.VSt!==t&&(e.Ut.YSt(n,"allowAutoExpand",n.VSt,t),n.VSt=t),n)},o.prototype.N5t=function(){return!!this.LSt},o.prototype.Sg=function(t){var n=this,e=n.jS;n.k5t(t),n.Mf&&n.Mf.Ut&&n.Mf.Ut.D5t(n,e)},o.prototype.k5t=function(t){var n,e,n=this;n.jS=t,n.Mf=t&&t.Mf,e=n.IB,t&&e&&e.Mf!==t.Mf&&e.table(n)},o.prototype._5t=function(t){for(var n,e,r,i,o,u,a,f,s,l,c,h,v,d,n=this,e=n.Mf,r=e.getDefaultStyle(),i=n.Ky,o=n.iw,u=n.Sx,a=n.Tx,f={},s=e.parent,l=n.jO?1:0,c=l+(n.oL?1:0),h=0;h<a;h++)for(v=h+o,n.jO&&me(e,i,v,r,f,s,t),n.oL&&me(e,n.footerIndex(),v,r,f,s,t),d=0;d<u-c;d++)me(e,d+i+l,v,r,f,s,t)},o.prototype.M1e=function(t,n,e){for(var r,i,o,u,a,f,s,l,c,h,v,r=this,i=r.Ky,o=r.iw,u=r.Sx,a=r.Tx,f={},s=r.jO?1:0,l=s+(r.oL?1:0),c=0;c<a;c++)for(h=c+o,r.jO&&Ce(t,i,h,n,f,e),r.oL&&Ce(t,r.footerIndex(),h,n,f,e),v=0;v<u-l;v++)Ce(t,v+i+s,h,n,f,e)},o.prototype.E5t=function(t){var n=this,r=[];m(n.BSt,function(t,n){var e=n.dataField();e&&r.push({name:n.name(),value:n.value(),dataField:e})}),0<r.length&&(n.C5t=r,t.J$=n.C5t)},o.prototype.Woe=function(t){var n,e,r,i,r,t,o,n=this,e=n.Mf,r=n.dataRange(),i=r.row,r=N(r),t=t.getRowCount();r<t?n.RSt?(n.cue=!0,e.addRows(i+r,t-r),delete n.cue):((o=e.H3)&&o.Ctt&&(o.Stt=!0),n.mTt=!0,0===r?n.zpt(i,t,U,!0,!0):n.zpt(i+r-1,t-r,!0,!0,!0),delete n.mTt):t<r&&(n.RSt?e.deleteRows(i+t,r-t):(n.mTt=!0,n.yE(i+t,r-t,!0),delete n.mTt))},o.prototype.D3=function(t){var n,e,r,i,o,o,u,a,f,s,e,n=this,e=n.autoGenerateColumns(),r=n.IB&&n.IB.srt;if(n.s5t(),i=n.Mf,e&&(o=n.range(),n.d5(o.row,o.col,N(o),z(o)),n.l5t(o.col,z(o),!0)),e||n.E5t(t),t){if(o={row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx},n.Woe(t),n.H3=t,e){for(n.Tx=t.getColumnCount(),n.BSt=[],u=t.ltt(),a=0;a<n.Tx;a++)f=new J(a+1),n.BSt[a]=f,u&&(f.name(u[a]),f.dataField(u[a]));n.ESt&&(n.OSt=[],n.j5t(n.iw))}else s=[],n.BSt.forEach(function(t){var t=t.dataField();t&&s.push(t)}),t.htt(s);i&&((e=i.Ut).YSt(n,V,o,{row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx}),e.yge(n.Ky,n.iw,n.Sx,n.Tx))}else n.H3=t;n.IB&&(n.IB.Uct(n.dataRange()),n.IB.srt=r)},o.prototype.O5t=function(t){var n,e,r,e,i,o,u,n=this,e=n.H3;if(e&&(r=e.ltt()))for(i=(e=n.BSt[t-n.startColumn()])&&e.dataField(),o=0,u=r.length;o<u;o++)if(r[o]===i)return o;return-1},o.prototype.Sl=function(t,n){var e,r,i,o,t,i,e=!1,r=U,i=this,o=i.H3,t=t-i.dataRange().row;return o&&t<o.getRowCount()&&0<=(i=i.O5t(n))&&(e=!0,r=o.getValue(t,i).value),{e5t:e,y4:r}},o.prototype.Kbt=function(t,n,e,r){var i,o,u,a,f,s,a,r,l,l,r,i=this,o=i.H3,u=D(i,t),a=i.IB,s=!1;return o&&0<=(f=i.O5t(n))&&(r&&a&&a.isRowFilteredOut(t)||(a=(r=o.getValue(u,f)).value,(l=(l=i.Mf)&&l.Ut)&&r.hasBinding&&a!==e&&(r=St(!0),i.R5t(t,u,r),l.B5t(i,t,B,r,ne.dirty),l.dE(t,n,{d6:a})),o.setValue(u,f,e,l&&l.G8)),s=!0),i.DSt=!0,s},o.prototype.ML=function(t,n,e){var r=new O.Style;return this.h5(t,n,r,e),r},o.prototype.L5t=function(t){var n,e,r,n=this.jS.xl,e=n[t];return e===U&&(r=this.Mf,e=n[t]=r.getRowHeight(t)),e},o.prototype.F5t=function(t){var n;return this.Mf.getColumnWidth(t)},o.prototype.h5=function(t,n,e,r){var i,o,u,a,f,r,s,l,c,h,v,d,b,w,m,C,c,g,y,p,S,S,S,S,S,S,S,h,g,v,y,l,T,_,R,r,x,F,j,k,A,S,i=this,o=i.style(),u=i.BSt,a=i.headerIndex(),f=i.footerIndex();if(o){if(s=i.Mf,l=i.jO,c=i.oL,h=i.highlightLastColumn(),v=i.highlightFirstColumn(),d=l?t===i.Ky+1:t===i.Ky,b=c?t===i.Ky+i.Sx-2:t===i.Ky+i.Sx-1,w=n===i.iw,m=n===i.iw+i.Tx-1,C=l?t===a:t===i.Ky,c=c?t===f:t===i.Ky+i.Sx-1,g=o[en](),y=o[rn](),p=new O.Style,a===t)S=o[ln](),m&&h&&S&&S.h5(p,!0,!0,!0,!0),S=o[sn](),w&&v&&S&&S.h5(p,!0,!0,!0,!0),(S=o[Xt]())&&S.h5(p,!0,w,!0,m),m&&h&&g&&g.h5(p,!0,!0,!1,!0),w&&v&&y&&y.h5(p,!0,!0,!1,!0);else if(f===t)S=o[hn](),m&&h&&S&&S.h5(p,!0,!0,!0,!0),S=o[cn](),w&&v&&S&&S.h5(p,!0,!0,!0,!0),(S=o[tn]())&&S.h5(p,!0,w,!0,m),m&&h&&g&&g.h5(p,!1,!0,!0,!0),w&&v&&y&&y.h5(p,!1,!0,!0,!0);else{if(m&&h&&g&&g.h5(p,C,!0,c,!0),w&&v&&y&&y.h5(p,C,!0,c,!0),S=l?t-i.Ky-1:t-i.Ky,h=n-i.iw,R=_=T=l=y=v=g=void 0,r=!r||"cellType"!==r&&"formatter"!==r,i.bandRows()&&r&&0<(v=(g=o[vn]())+o[dn]())){if(void 0===(y=i.HSt[t])){if(O.Be.Fl&&O.Be.Gl){for(x=O.Be.Gl,F=i.dataRange().row;-1===x[F];)F++;if(t<F)return;S=x[t]-x[F]}else if(s){for(j=0,F=i.dataRange().row;F<t;F++)0<i.L5t(F)&&j++;S=j}y=i.HSt[t]=S%v}l=o[on](),T=o[un](),y<g&&l?l.h5(p,_=0===y,w,R=b||y===g-1,m):g<=y&&T&&T.h5(p,_=y===g,w,R=b||y===v-1,m)}if(i.bandColumns()&&r&&0<(v=(g=o[bn]())+o[wn]())){if(void 0===(y=i.zSt[n])){if(k=0,s)for(A=i.iw;A<n;A++)0<i.F5t(A)&&k++;y=i.zSt[n]=k%v}l=o[an](),T=o[fn](),y<g&&l?l.h5(p,d,_=0===y,b,R=m||y===g-1):g<=y&&T&&T.h5(p,d,_=y===g,b,R=m||y===v-1)}de(u,h,p)}(S=o[nn]())&&S.h5(p,C,w,c,m),i.P5t(e,p)}else a!==t&&f!==t&&(r=de(u,n-i.iw))&&i.P5t(e,r)},o.prototype.i5t=function(t,n,e){var r,i,o,u,a,t,i,n,r=this,i=r.oL,o=r.ESt,u,a;r.footerIndex()===t&&i&&r.g5t()&&(t=r.OSt[n-r.iw])&&o&&(i=e.cellButtons,n=e.dropDowns,A(i)&&(i=[]),e.cellButtons=i.concat(t.cellButtons),A(n)&&(n=[]),e.dropDowns=n.concat(t.dropDowns))},o.prototype.P5t=function(t,n){var t=t,e=20,r,r,r,r;A(t.backColor)&&(t.backColor=n.backColor),Mt(t.foreColor)&&(t.foreColor=n.foreColor),A(t.themeFont)&&A(t.font)?(t.themeFont=n.themeFont,t.font=n.font):!A(t.themeFont)&&A(t.font)&&(t.font=n.font),A(t.borderLeft)&&(r=n.borderLeft,t.borderLeft=r&&r.Gf()||r,t.borderLeft)&&(t.borderLeft.level=20),A(t.borderTop)&&(r=n.borderTop,t.borderTop=r&&r.Gf()||r,t.borderTop)&&(t.borderTop.level=20),A(t.borderRight)&&(r=n.borderRight,t.borderRight=r&&r.Gf()||r,t.borderRight)&&(t.borderRight.level=20),A(t.borderBottom)&&(r=n.borderBottom,t.borderBottom=r&&r.Gf()||r,t.borderBottom)&&(t.borderBottom.level=20),A(t.textDecoration)&&(t.textDecoration=n.textDecoration),A(t.cellType)&&(t.cellType=n.cellType),A(t.formatter)&&(t.formatter=n.formatter)},o.prototype.G5t=function(t,n){var e,r,i,o,u,a,e=this;if((t!==e.Ky||n!==e.iw)&&(r=e.Mf)){if((t<0||r.getRowCount()<t+e.Sx||n<0||r.getColumnCount()<n+e.Tx)&&x(H().Exp_TableMoveOutOfRange),u=o=void 0,i=e.jS)for(u=0,a=(o=i.U3).length;u<a;u++)if(o[u]===e){o.splice(u,1),e.U5t();break}r.moveTo(e.Ky,e.iw,t,n,e.Sx,e.Tx,3),o&&u<=a&&(e.H5t(t,n),o.splice(u,0,e),e.z5t()),this.cL(1)}},o.prototype.H5t=function(t,n){var e,r,e=this,r=e.Mf;r&&r.Ut.YSt(e,V,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},{row:t,col:n,rowCount:e.Sx,colCount:e.Tx}),e.Ky=t,e.iw=n,e.V5t(),e.dl()},o.prototype.U5t=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,C,r=this,i=r.Mf;if(i&&g){for(o=r.BSt,u=r.footerIndex(),a=r.range(),s=(f=r.dataRange()).row,l=N(f),A(t)&&(t=0,n=o.length);t<n;t++)if(c=o[t],h=a.col+t,c){for(c.footerFormula()&&0<=u&&(F(i,u,h,B),y(i,u,h,B)),v=c.x5t(),d=Lt(v),w=b=void 0,m=0;m<l;m++)b=i.getFormula(w=s+m,h),A(b)||(A(r.Y5t)&&(r.Y5t=[]),F(i,w,h,B),r.Y5t.push({row:w,col:h,formula:b})),A(b)||!A(d)&&k(i,j(i,d,r.Ky,h),w,h)===b||(A(r.Z5t)&&(r.Z5t=[]),C=Nt(r.Z5t,h),A(C)?((C={}).col=h,C.rowIndexes=[],C.rowIndexes.push(w),r.Z5t.push(C)):C.rowIndexes.push(w));if(c.x5t(U),c.dataAreaFormula())for(m=0;m<l;m++)F(i,w=s+m,h,B),y(i,w,h,B)}!0===e&&(r.Y5t=[])}},o.prototype.W5t=function(t,n,e){var r,i,o,u,a,f,s,l,a,r=this,i=r.Mf,o=r.Y5t;if(o&&0<o.length){for(f=0;f<o.length;f++)u=!0,(a=o[f])&&(s=a.row,l=a.col,a=a.formula,t<=s&&(!0===e&&(s+=n),!1===e)&&(s<t+n?u=!1:s-=n),u)&&F(i,s,l,a);r.Y5t=[]}r.Xyt(t,n,!0,e)},o.prototype.Q5t=function(t,n,e){var r,i,o,u,a,f,s,l,a,c,h,v,d,b,w,m,C,g,y,p,S,T,_,R,w,r=this,i=r.Mf,o=r.Y5t;if(o&&0<o.length){for(f=0;f<o.length;f++)u=!0,(a=o[f])&&(s=a.row,l=a.col,a=a.formula,t<=l&&(!0===e&&(l+=n),!1===e)&&(l<t+n?u=!1:l-=n),u)&&F(i,s,l,a);for(c=r.Z5t||[],h=void 0,f=0;f<c.length;f++)(h=c[f])&&t<=(v=h.col)&&(!0===e&&(h.col+=n),!1===e)&&t+n<=v&&(h.col-=n);for(r.Xyt(t,n,!1,e),b=(d=r.BSt).length,m=(w=r.dataRange()).row,C=w.col,g=w.rowCount,_=T=S=p=y=void 0,f=0;f<b;f++)if(_=C+f,(p=d[f])&&(S=p.dataAreaFormula())){for(y=m,R=0;R<c.length;R++)if((h=c[R])&&h.col===_){for(;-1<h.rowIndexes.indexOf(y)&&y<m+g;)y++;break}y<m+g&&(T=i.getFormula(y,_))&&p.dataAreaFormula(j(i,T,m,_))}r.Y5t=[],r.Z5t=[]}else(w=i.b8&&(i.parent||i).xyt())&&0<w.length&&r.Xyt(t,n,!1,e,U,!0)},o.prototype.Xyt=function(t,n,e,r,i,o){var u,a,f,s,l,c,h,v,d,b,w,w,m,C,g,y,p,S,T,u=this,a=u.Mf,f=u.BSt,s=u.footerIndex(),l=u.dataRange(),c=l.row,h=l.col,v=l.rowCount,d=l.colCount,b=a.b3(),w=a.Lp;if(w&&b&&(w=w.Hyt()))if(p=b.rT,S=function(t,n){return e?t=c:n=h,l.contains(t,n)},o)p.Iyt=!0,w.Xyt(p,t,n,e,r,S),delete p.Iyt;else if(i||(w.Zyt(b,c,h,v,d),w.Xyt(p,t,n,e,r,S)),u.oL)for(i||(w.Zyt(b,s,h,1,d),w.Xyt(b.rT,t,n,e,r,!1)),T=0;T<d;T++)(m=f[T])&&(C=m.footerFormula(),y=h+T,C)&&(g=a.getFormula(s,y))&&(a&&a.Ut.A5t(u,m,"footerFormula",C,g),m.footerFormula(j(a,g,s,y)))},o.prototype.z5t=function(){var t,a,f,s,l,t=this,a=t.Mf;a&&g&&(f=t.footerIndex(),s=t.range(),l=t.dataRange(),m(t.BSt,function(t,n){var e,t,r,i,o,u,e=s.col+t,t=n.footerFormula(),r=n.dataAreaFormula();if(t&&0<=f&&F(a,f,e,B,t),r)for(i=0,o=N(l);i<o;i++)u=l.row+i,F(a,u,e,B,r)}))},o.prototype.K5t=function(t){var n,e,r,i,o,u,a,f,s,l,c,h,v,d,b,l,w,m,r,t,C,g,y,i,u,a,s,t,r,u,i,l,i,u,n=this,e=n.dataRange();if(!t.equals(n.range())){if(r=t.row,i=t.col,o=N(t),u=z(t),a=n.jO,f=n.oL,s=n.ESt,l=0,c=1,a&&(l+=1),f&&(l+=1),(d=n.Mf)&&((o<l||u<1||r+o>d.getRowCount()||i+u>d.getColumnCount())&&x(H().Exp_TableResizeOutOfRange),r===n.Ky&&t.intersect(n.Ky,n.iw,n.Sx,n.Tx)||x(H().Exp_TableResizeInvalidRange),v={row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx},h=n.BSt.slice()),b=n.BSt,w=(l=i)+u-1,m=n.iw,r=n.iw+n.Tx-1,t=n.Tx,n.iw=i,n.Tx=u,l<m){for(C=0,g=l;g<m;g++)y=new J(n.M5t()),b.splice(C,0,y),C++;a&&n.a5t(0,m-l),f&&n.l5t(0,m-l)}else l<=r&&(n.U5t(m,l),b.splice(0,l-m));if(r<w){for(g=1+r;g<=w;g++)y=new J(n.M5t()),b.push(y);a&&n.a5t(t,w-r),f&&n.l5t(t,w-r),s&&n.j5t(t)}else m<=w&&(n.U5t(w,r),b.splice(b.length-(r-w),r-w));o!==n.Sx&&(i=n.H3,a=(u=n.dataRange()).row,s=N(u),i?o>n.Sx?(t=a+s-1,r=o-n.Sx,!d||(i=I(d,new O.Range(u=t+r+1,l,d.getRowCount()-u,w)))&&i.row<u||n.N4t(t,r,!0,!1)):d&&(l=n.Sx-o,n.yE(a+s-l,l)):(i=void 0,f&&(n.l5t(),i=n.footerIndex()),u=n.Sx,n.Sx=o,n.J5t(U,U,u<o),f&&(n.w5t(),n.u5t(i)))),d&&(d.Ut.YSt(n,V,v,{row:n.Ky,col:n.iw,rowCount:n.Sx,colCount:n.Tx}),d.Ut.YSt(n,Gn,h,n.BSt.slice())),n.dl(),n.V5t(!1),n.X5t(e,n.dataRange()),n.I4t(),n.cL(0)}},o.prototype.X5t=function(t,n){var e,r,i,o,u,a,f,s,t,l,n,c,e,r=this.LSt;r&&(i=t.col,o=N(t),u=z(t),a=n.col,f=N(n),s=z(n),t=t.row+o,l=i+u,c=a+s,(n=n.row+f)<t&&r.onRowsRemoved(f,t-n),t<n&&r.onRowsAdded(o,n-t),i<a&&r.onColumnsRemoved(0,a-i),c<l&&r.onColumnsRemoved(s,l-c),a<i&&r.onColumnsAdded(0,i-a),l<c)&&r.onColumnsAdded(i+u-a,c-l)},o.prototype.V5t=function(t){var n=this,e=n.IB;e&&(e.Uct(n.dataRange()),!1!==t)&&e.reFilter()},o.prototype.s5t=function(){var t=this.IB;t&&(t.unfilter(),t.reset())},o.prototype.cSt=function(t,n){var e,r;for(t!==B&&(t=v(t)),e=0;e<this.Tx;e++)if(e!==n&&t===(r=this.getColumnName(e)))return!0;return!1},o.prototype.q5t=function(t){var n,e,t,n,e,n=this,e=n.BSt;return n.jO&&e&&0<=(t=t-n.iw)&&t<e.length&&(n=e[t])?(e=n.name(),A(e)?e:v(e)):B},o.prototype.$5t=function(t,n){var e,r,i,t,i,r,o,e=this,r=e.BSt;e.jO&&r&&(i=r.length,0<=(t=t-e.iw))&&t<i&&(i=r[t])&&(r=i.name(),(o=e.Mf)&&n!==r&&o.Ut.A5t(e,i,"name",r,n),i.name(n),e.I5t(r,i.name(),t))},o.prototype.m5t=function(t,n,e){var r,i,o,u,a,i,t,r=this,i=r.BSt,o=r.footerIndex(),u=r.iw+t,a=r.Mf;g&&0<=t&&t<i.length&&(i=i[t],n&&!e&&a&&(e=j(a,n,o,u),r.oL)&&F(a,o,u,n,e),i)&&(t=i.footerFormula(),a&&e!==t&&a.Ut.A5t(r,i,"footerFormula",t,n),i.footerFormula(e))},o.prototype.d5t=function(t,n,e){var r,i,e,i,e,o,r=this,i=r.BSt;(e||r.oL)&&i&&0<=(e=t-r.iw)&&e<i.length&&(i=i[e])&&(n!==(e=i.footerValue())&&(o=r.Mf)&&(o.Ut.A5t(r,i,"footerValue",e,n),o.Ut.dE(r.Ky+r.Sx-1,t,{d6:i.footerValue()})),i.footerValue(n))},o.prototype.M5t=function(){for(var t,n,e,r,i,t=this.BSt,n=t&&t.length,e=[],i=0;i<n;i++)(r=t[i])&&r.tTt()&&e.push(r.id());if(e.sort(function(t,n){return t-n}),0<(n=e.length)){for(i=0;i<n;i++)if(e[i]!==i+1)return i+1;return n+1}return 1},o.prototype.nTt=function(t,n){var e,r,i,n;if(!A(t)&&!this.cSt(t,n))return t;if(r=mn,i=0,t)r=t,i=1;else if(0<n&&(t=this.BSt[n-1].name(),n=/[0-9]+$/.exec(t))){if(r=t.substr(0,n.index),i=parseInt(t.substr(n.index),10),!this.cSt(e=r+(i+1)))return e;r=t,i=1}for(;;)if(!this.cSt(e=r+ ++i))return e},o.prototype.a5t=function(t,n,e,r){var i,o,u,a,f,s,l,c,h,v,d,b,d,i=this,o=i.BSt,u=i.Mf;if(i.jO&&o&&u)for(a=o.length,f=i.headerIndex(),s=i.iw,A(t)&&(t=0),A(n)&&(n=a),c=E(a,t+n),v=t;v<c;v++)(l=o[v])&&(d=i.jS.U3,-1<(b=w(i,d))&&d.splice(b,1),h=It(u.getValue(f,s+v)),-1<b&&d.splice(b,0,i),F(u,f,s+v,B),h)&&(e?(i.eTt=e,u.setText(f,s+v,l.name()),delete i.eTt):((d=r?h:i.nTt(h,v))===h?(u.Ut.A5t(i,l,"name",l.name(),h),l.name(h)):u.setText(f,s+v,d),g&&u.gL(f,s+v)))},o.prototype.j5t=function(t){for(var n,e,r,n=this.BSt,e=t;e<n.length;e++)r=he(this.name(),n[e].name()),this.OSt.push(r)},o.prototype.l5t=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,c,h,d,r=this,i=r.BSt,o=r.Mf;if(r.oL&&i&&o)for(r.useFooterDropDownList()&&!r.g5t()&&r.h5t(),u=i.length,a=r.footerIndex(),f=r.iw,A(t)&&(t=0),A(n)&&(n=u),A(e)&&(e=r.iTt),l=E(u,t+n),v=t;v<l;v++)(s=i[v])&&(h=o.getValue(a,f+v),A(h)||e?(r.eTt=e,y(o,a,f+v,s.footerValue()),delete r.eTt):(h!==(c=s.footerValue())&&o.Ut.A5t(r,s,"footerValue",c,h),s.footerValue(h)),(c=o.bMt&&o.bMt(a,f+v))&&!e?(c!==(h=s.dataAreaFormula())&&(d=k(o,c,a,f+v),o.Ut.A5t(r,s,"dataAreaFormula",h,d)),s.footerFormula(c)):r.rTt||(r.eTt=e,F(o,a,f+v,B,s.footerFormula()),delete r.eTt))},o.prototype.oTt=function(t,n){var e,r,i,o,u,a,f,s,e=this,r=e.BSt;if(e.jO&&r)for(i=r.length,A(t)&&(t=0),A(n)&&(n=i),u=E(i,t+n),a=t;a<u;a++)(o=r[a])&&(f=o.name(),(s=e.Mf)&&f!==B&&s.Ut.A5t(e,o,"name",f),o.name(B),e.I5t(f,o.name(),a))},o.prototype.aTt=function(t){var n,e,r,i,o,u,a,f,s,t,n=this,e=n.dataRange();if(e.containsRange(t)){for(r=t.row,i=t.col,o=N(t),u=z(t),a=[],f=0;f<o;f++)for(s=0;s<u;s++)n.Kbt(r+f,i+s,B,!0),a.push({columnName:n.getColumnName(i+s-e.col),row:r+f-e.row,data:""});(t=n.LSt)&&t.onDataChanged(a)}},o.prototype.uTt=function(t,n){var e,r,i,o,u,a,f,f,e=this,r=e.BSt;if(e.oL&&r)for(A(t)&&(t=0),A(n)&&(n=r.length),o=E(r.length,t+n),u=t;u<o;u++)(i=r[u])&&(a=e.Mf,f=i.footerFormula(),a&&B!==f&&a.Ut.A5t(e,i,"footerFormula",f),i.footerFormula(B),f=i.footerValue(),a&&B!==f&&a.Ut.A5t(e,i,"footerValue",f),i.footerValue(B))},o.prototype.w5t=function(){var t,n,e,r,i,o,u,a,f,t=this,n=t.BSt;if(t.oL&&n&&(e=t.Mf))for(r=n.length,o=t.iw,a=t.footerIndex(),f=0;f<r;f++)(i=n[f])&&(y(e,a,u=o+f,i.footerValue()),F(e,a,u,B,i.footerFormula()))},o.prototype.u5t=function(t){var n,e,r,i,o,u,n=this,e=n.Mf;if(e&&!(t<0||e.getRowCount()<=t))for(r=n.iw,i=n.Tx,u=0;u<i;u++)F(e,t,o=r+u,B),y(e,t,o,B)},o.prototype.JO=function(t,n,e,r,i,o){var u,a,e,f,s,l,c,o,e,u=this,a=!1,e=e?1:0,f=u.jO&&1===u.Sx;return!f&&t>=u.Ky+u.Sx+e||((s=u.Mf)&&(l=s.Ut,c={row:u.Ky,col:u.iw,rowCount:u.Sx,colCount:u.Tx}),o||u.sTt(t,n,!1),o=u.Ky,e=u.Ky+u.Sx-1+e,t<=o&&!i?u.Ky+=n:(t<=e||f)&&(r||(a=u.cTt(t,n)),u.Sx+=n),s&&l.YSt(u,V,c,{row:u.Ky,col:u.iw,rowCount:u.Sx,colCount:u.Tx})),a},o.prototype.t5t=function(t,n,e){var r,i,i,o,e,u,u,r=this,i=r.Ky+r.Sx-1;!e&&t>=r.Ky&&t<=i&&r.J5t(t,n,!0),e||(r.Xyt(t,n,!0,!0,!0),r.fTt()),i=r.LSt,e=(o=r.dataRange()).row,u=r.endRow(),e<=t&&t<=u&&i&&i.onRowsAdded(t-e,n),(u=r.IB)&&(r.DSt=!0,u.JO(t,n),r.lTt)&&r.Mf.filterRowsVisibleInfo.rE(t,n)},o.prototype.cTt=function(t,n){var e,r,i,i,o,e=this,r=e.H3;return!!r&&(o=void 0,(i=(i=this.Mf)&&i.Ut.G8)&&!(o=i.tableChanges)&&(i.tableChanges=o=[]),r.kE(D(e,t),n,o),!0)},o.prototype.J5t=function(o,u,a){var f,s,t;g&&(s=(f=this).Mf,t=f.dataRange(),A(o)&&(o=t.row),A(u)&&(u=t.rowCount),vt(s),m(f.BSt,function(t,n){var e,r,i,e=n.dataAreaFormula();if(e)for(r=t+f.iw,i=o;i<o+u;i++)(a&&o<=i&&i<o+u||!A(s.getValue(i,r)))&&F(s,i,r,B,e)}),dt(s,!1))},o.prototype.fTt=function(){var u,t,a,n,f,s;g&&(t=(u=this).Mf,a=t.b3(),n=u.dataRange(),A(f)&&(f=n.row),A(s)&&(s=n.rowCount),vt(t),m(u.BSt,function(t,n){var n,e,r,i,o,n=n.hTt();if(n&&n.isArrayFormula)for(e=n.isDynamicArray,r=t+u.iw,i=f;i<f+s;i++)A(a.sT(i,r))&&a.Uyt(i,r,o={row:i,col:r,rowCount:1,colCount:1,isDynamicArray:e})}),dt(t,!1))},o.prototype.qO=function(t,n,e,r,i){var o,e,u,a,f,s,l,c,h,v,d,b,d,d,i,o=this,e=e?1:0;if(!(t>=o.iw+o.Tx+e)){if(a=o.iw,(l=o.Mf)&&(s={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},f=o.BSt.slice()),t<=o.iw&&!i)o.iw+=n;else if(t<o.iw+o.Tx+e&&(u=!0,o.Tx+=n,c=o.BSt)){for(h=t-o.iw,v=0;v<n;v++)d=o.M5t(),b=h+v,(d=new J(d)).name(o.nTt(B,b)),c.splice(b,0,d),d=o.getColumnName(b),o.y5t(b,0,d);r&&o.a5t(h,U,!0)}o.IB&&o.IB.qO(t,n,u),a<=t&&(i=o.LSt)&&i.onColumnsAdded(t-a,n),l&&(l.Ut.YSt(o,V,s,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx}),l.Ut.YSt(o,Gn,f,o.BSt.slice()))}},o.prototype.n5t=function(){var t,n,e,r,i,o,u,t=this,n,e=t.Mf.b3();e&&t.oL&&(r=t.BSt,i=t.footerIndex(),o=t.iw,r.forEach(function(t,n){u=e.pB(i,o+n),A(u)||t.footerFormula(u)}))},o.prototype.xP=function(t,n,e,r,i){var o,u,a,f,a,s,l,c,h,c,v,d,b,w,m,c,C,g,y,o=this,u=!1;if(!(t>=o.Ky+o.Sx)&&(f=(a=o.dataRange()).row,a=N(a),s=o.Ky,l=o.Ky+o.Sx-1,c=o.Mf,h=o.H3,b=[],m="_backupRowsChange",c&&(v=c.Ut)&&(w={row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx},b.push(V),c=v.G8)&&!(d=c.tableChanges)&&(c.tableChanges=d=[]),i||o.sTt(t,n,!0),t<s?t+n<=s&&(o.Ky-=n):t===s?o.jO||(o.Sx-=E(l-t+1,n),!e&&h&&(b.push(m),h.btt(D(o,t),E(l-t+1,n),d),u=!0)):t<=l&&(o.Sx-=E(l-t+1,n),!e&&h&&(b.push(m),h.btt(D(o,t),E(l-t+1,n),d),u=!0),t===l)&&o.oL&&(b.push(Hn),o.oL=!1),o.IB&&(o.DSt=!0,o.IB.xP(t,n)),f<=t&&t<f+a&&(c=o.LSt)&&c.onRowsRemoved(t-f,n),v)&&b&&0<b.length)for(C=0,g=b;C<g.length;C++)switch(y=g[C]){case V:v.YSt(o,V,w,{row:o.Ky,col:o.iw,rowCount:o.Sx,colCount:o.Tx});break;case Hn:v.YSt(o,Hn,o.oL);break;case m:v.B5t(o,t,n,r,ne.deleted)}return u},o.prototype.NP=function(t,n){var e,r,i,o,u,a,f,s,r,e=this,r=e.BSt;t>=e.iw+e.Tx||((i=e.Mf)&&(o={row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx},u=e.BSt.slice()),a=e.iw,f=e.iw,s=e.iw+e.Tx-1,t<f?t+n<=f?e.iw-=n:(e.iw=t,e.Tx-=t+n-f,r&&(r.splice(0,t+n-f),e.y5t(0,t+n-f))):(e.Tx-=E(s-t+1,n),r&&(r.splice(t-f,E(s-t+1,n)),e.y5t(t-f,E(s-t+1,n)))),e.IB&&e.IB.NP(t,n),a<=t&&(r=e.LSt)&&r.onColumnsRemoved(t-a,n),i&&(i.Ut.YSt(e,V,o,{row:e.Ky,col:e.iw,rowCount:e.Sx,colCount:e.Tx}),i.Ut.YSt(e,Gn,u,e.BSt.slice())))},o.prototype.d5=function(t,n,e,r){var i,o,u,a,a,f,s,l,c,h,h,v,h,h,h,a,i=this,o=e,u=r,a=i.Mf;a&&(o=a.getRowCount(),u=a.getColumnCount()),c=(0,O.Ec)(a=t<0?0:t,f=n<0?0:n,s=t<0?o:e,l=n<0?u:r),h=i.headerIndex(),i.jO&&a<=h&&h<a+s&&(h=(0,O.Ec)(h,i.iw,1,i.Tx),v=c.getIntersect(h,o,u))&&i.oTt(v.col-i.iw,z(v)),h=i.dataRange(),(h=c.getIntersect(h,o,u))&&i.aTt(h),h=i.footerIndex(),i.oL&&a<=h&&h<a+s&&(a=(0,O.Ec)(h,i.iw,1,i.Tx),v=c.getIntersect(a,o,u))&&i.uTt(v.col-i.iw,z(v)),i.IB&&i.IB.d5(t,n,e,r)},o.prototype.toJSON=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,e=this,r=e.style(),i=e.rowFilter(),o="columns";for(A(t)?u=e.name():e.Gwt=u=t,a={name:[u,B],row:[e.Ky,-1],col:[e.iw,-1],rowCount:[e.Sx,-1],colCount:[e.Tx,-1],showHeader:[e.jO,!0],showFooter:[e.oL,!1],useFooterDropDownList:[e.ESt,!1],showResizeHandle:[e.jSt,!1],highlightFirstColumn:[e.highlightFirstColumn(),!1],highlightLastColumn:[e.highlightLastColumn(),!1],bandRows:[e.bandRows(),!0],expandBoundRows:[e.expandBoundRows(),!1],bandColumns:[e.bandColumns(),!1],style:[r?r.toJSON():B,B],autoGenerateColumns:[e.autoGenerateColumns(),!0],bindingPath:[e.bindingPath(),U],rowFilter:[i?i.toJSON():B,B],reservedElement:[we(e.dTt),B],allowAutoExpand:[e.VSt,!0],columns:[[]]},f=0;f<e.BSt.length;f++)l=(s=e.BSt[f].toJSON())[yn],c=s[Sn],l&&(n&&n.ignoreFormula?(delete s[yn],s[Tn]=e.Mf.getValue(e.Ky+e.Sx-1,e.iw+f)):s[yn]=k(e.Mf,l,e.footerIndex(),f+e.iw)),c&&(s[Sn]=k(e.Mf,c,e.dataRange().row,f+e.iw)),a[o][0][f]=s;for(v in a[o][1]=B,h={},a)(d=a[v])[0]!==d[1]&&(h[v]=d[0]);return b(h)?U:h},o.prototype.wh=function(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,e,d,b,w,m,C,g,y,p,S,S,p,e,T,i,_,R,o=this,u=o.Mf,a=u.name(),f=o.style(),s=o.rowFilter(),l=o.BSt,c=e.styleManager,h=e.sharedStrings,v=!O.Util.ko(r);if(t.xmlns=O.XFileConstants.Qu,t.id=o._id,t.c_=[],t.n_=O.XFileConstants.du,(e=o.name()||B)&&(e=e.split(" ").join("_"),t.name=e,t.displayName=pe(e.split("-").join("_"),i)),t.ref=Dt([o.range()]),!0!==o.jO&&(t.headerRowCount=0),!1!==o.oL&&(t.totalsRowCount=1),s&&!u.NMi&&s.wh(t,c,r),l&&0<l.length){for(d=[],b=o.footerIndex(),w=o.dataRange().row,m=o.iw,g=C=void 0,y=0;y<l.length&&!(v&&y>=o.Tx);y++)S=(p=l[y]).name(),g=y+o.iw,o.jO&&!A(S)&&(A(C)&&(C=lt(n,a)),ct(C,o.Ky,g,""+S,h)),d.push(p.wh(u,w,b,y+m,r,S={})),p=S.v,o.oL&&!A(p)&&(A(C)&&(C=lt(n,a)),ct(C,o.Ky+o.Sx-1,g,""+p,h));r&&r.fileType===O.OpenSaveFileType.excel&&C&&C.colCount<g+1&&(C.colCount=g+1),e={n_:"tableColumns",count:l.length,c_:d},t.c_.push(e)}f&&(f.builtInName()?T="TableStyle"+f.builtInName():(T=f.name(),A(T)&&(T="CustomTableStyle_"+ee(),f.name(T)))),(i={n_:"tableStyleInfo",name:rt(T)}).showFirstColumn=!1!==o.highlightFirstColumn()?"1":"0",i.showLastColumn=!1!==o.highlightLastColumn()?"1":"0",i.showRowStripes=!0!==o.bandRows()?"0":"1",i.showColumnStripes=!1!==o.bandColumns()?"1":"0",t.c_.push(i),_={useFooterDropDownList:[o.ESt,!1],showResizeHandle:[o.jSt,!1],expandBoundRows:[o.expandBoundRows(),!1],autoGenerateColumns:[o.autoGenerateColumns(),!0],bindingPath:[o.bindingPath(),U],extLst:[o.dTt,B],allowAutoExpand:[o.VSt,!0]},R=t.lossless={},Object.keys(_).forEach(function(t){var n=_[t];n[0]!==n[1]&&(R[t]=n[0])})},o.prototype.fromJSON=function(e,t,n){var r,i,o,u,a,f,o,u,a,f,o,u,a,f,o,u,a,f,o,s,l,c,h,v,d,b,w,i,a,u,f;if(e){if(i=(r=this).Mf,m([Jt,Kt,qt,Zt,Qt,Wt],function(t,n){R(e[n])&&r[n](e[n],!1)}),o=e.row,R(o)&&(r.Ky=o),u=e.col,R(u)&&(r.iw=u),a=e.rowCount,R(a)&&(r.Sx=a),f=e.colCount,R(f)&&(r.Tx=f),Se(i,new O.Range(o,u,a,f))&&(i.rowFilter().reset(),i.rowFilter(void 0)),o=e.showHeader,R(o)&&(r.jO=o),u=e.showFooter,R(u)&&(r.oL=u),a=e.expandBoundRows,R(a)&&(r.RSt=a),f=e.useFooterDropDownList,R(f)&&(r.ESt=f),o=e.showResizeHandle,R(o)&&(r.jSt=o),(u=e.style)&&((a=new C.TableTheme).fromJSON(u,t),r.style(a)),f=e.dataSource,o=e.dataBinding,u=e.bindingPath,t?(f&&_.$$&&(r.H3=new _.$$,r.H3.bind(f)),o&&_.$$&&(r.H3=new _.$$,r.H3.fromJSON(o))):u&&(r.S5t=u,a=i&&i.getDataSource&&i.getDataSource(),_.CellBindingSource)&&a instanceof _.CellBindingSource&&(f=(0,_.q$)(a.getSource(),u))&&(r.H3=new _.$$,r.H3.bind(f)),o=e.columns){for(l=(s=o).length,c=r.BSt=[],v=h=void 0,d=0;d<l;d++)v=s[d],(h=new J(r.M5t())).fromJSON(v),b=h.name(),w=r.nTt(b,d),c.push(h),w!==b&&r.setColumnName(d,w);r.vTt()}r.ESt&&r.h5t(!0),(i=e.rowFilter)&&(a=T.WSt&&new T.WSt)&&(a.table(r),a.fromJSON(i,t),r.IB=a,n?r.IB.reFilter():(r.DSt=!0,r._St())),(u=e.reservedElement)&&(r.dTt=u),f=e.allowAutoExpand,R(f)&&(r.VSt=f)}},o.prototype.yh=function(t,n,e){var r,i,o,e,i,i,u,a,f,s,l,l,l,f,t,c,h,v,l,d,d,d,b,w,m,C,g,y,g,p,S;if(t){if(i=t.ref,o=e&&e.onlyTableData,e=e&&e.isApplyRefilter,(r=this).name(t.name),A(i)||(i=Bt(i,!0)[0],r.Ky=i.row,r.iw=i.col,r.Sx=i.rowCount,r.Tx=i.colCount),r.jO=1<=tt(t.headerRowCount,1),r.oL=1<=tt(t.totalsRowCount,-1),i=L(t,"tableColumns"),u=L(t,"autoFilter"),a=L(t,"sortState"),f=L(t,"tableStyleInfo"),s=L(t,"extLst"),!o&&f&&(l=et(f.name),A(l)||(l=n.getTableTheme(l),r.style(l)),A(f.showFirstColumn)||r.highlightFirstColumn(nt(f.showFirstColumn,!1)),A(f.showLastColumn)||r.highlightLastColumn(nt(f.showLastColumn,!1)),A(f.showRowStripes)||r.bandRows(nt(f.showRowStripes,!1)),A(f.showColumnStripes)||r.bandColumns(nt(f.showColumnStripes,!1))),l=t.lossless,o||A(l)||(f=l.bindingPath,t=l.autoGenerateColumns,c=l.expandBoundRows,h=l.useFooterDropDownList,v=l.showResizeHandle,l=l.allowAutoExpand,f&&(r.S5t=f,d=(d=r.Mf)&&d.getDataSource&&d.getDataSource(),_.CellBindingSource)&&d instanceof _.CellBindingSource&&(d=(0,_.q$)(d.getSource(),f))&&(r.H3=new _.$$,r.H3.bind(d)),R(t)&&r.autoGenerateColumns(t),R(c)&&(r.RSt=c),R(h)&&(r.ESt=h),R(v)&&(r.jSt=v),R(l)&&(r.VSt=l)),i&&(b=q(i,"tableColumn"),!A(b))){for(w=r.BSt=[],m=0,C=b.length;m<C;m++)g=b[m],(y=new J).yh(g,o),g=y.name(),(p=r.nTt(g,m))!==g&&y.name(p),w.push(y);r.vTt()}o||(r.ESt&&r.h5t(!0),ge(r,S=T.WSt&&new T.WSt,u,a,n,e),s&&(r.dTt=s))}},o.prototype._St=function(){var t,n,e,r,i,o,u,a,t=this,n=t.IB,e=t.Mf.filterRowsVisibleInfo.rowsVisibleInfo,r=n.range;if(!A(r))for(i=0;i<r.rowCount;i++)if(!1!==e[o=r.row+i])for(u=0;u<r.colCount;u++)a=r.col+u,n.isFiltered(a)&&n.jct(o,a)},o.prototype.formulaFromJSON=function(){for(var t,n,e,r,i,o,u,a,f,s,l,l,c,t=this,n=t.Mf,e=n.b3(),r=t.BSt,o=t.footerIndex(),u=t.dataRange().row,a=t.iw,s=0;s<r.length;s++)f=s+a,(l=(i=r[s]).footerFormula())&&typeof l==$n&&i.footerFormula(j(n,l,o,f,U,!0)),(l=i.dataAreaFormula())&&e&&(c=e.sT(u,f),A(c)||i.hTt({isArrayFormula:!0,isDynamicArray:c.isDynamicArray})),l&&typeof l==$n&&i.dataAreaFormula(j(n,l,u,f,U,!0))},o.prototype.vTt=function(){for(var t,n,e,r,i,o,t=this,n=t.BSt,e=n.length,o=0;o<e;o++)(i=(r=n[o]).id())<1&&r.id(t.M5t())},o.prototype.startRow=function(){return this.Ky},o.prototype.startColumn=function(){return this.iw},o.prototype.endRow=function(){return this.Ky+this.Sx-1},o.prototype.endColumn=function(){return this.iw+this.Tx-1},o.prototype.hasHeadersRow=function(){return this.jO},o.prototype.hasTotalsRow=function(){return this.oL},o.prototype.tableName=function(){return this.name()},o.prototype.getColumnIndexInTable=function(e){e=e.toLowerCase().replace(/\u00A0/g," ");var r=-1,i=c.Common.zf.Vi(e,"\r\n","\n");return A(e)||m(this.BSt,function(t,n){var n=n.name().toString().toLowerCase().replace(/\u00A0/g," ");if(n===e||n===i)return r=t,!1}),r},o.prototype.source=function(){var t=this.Mf;return t&&t.Uw&&t.Uw()},o.prototype.qSt=function(){var t,n,e,n,n,t=this,n=t.Mf;n&&(e=t.bindingPath())&&(n=n.getDataSource&&n.getDataSource(),_.CellBindingSource)&&n instanceof _.CellBindingSource&&(n=(0,_.q$)(n.getSource(),e),t.T5t(n))},o.prototype.T5t=function(t){var n,e,r,i,o,u,a,n,a,f,e=this,r=e.Mf;if(t&&!((i=Object.keys(t[0]||[]).length)!==(o=e.BSt.length)&&(u=e.Sx,a=(0,O.Ec)(e.Ky,e.iw,u,i),1<(null==(n=null==(n=e.jS)?void 0:n.AB(a.row,a.col,u,i))?void 0:n.length)))){(a=new _.$$).bind(t,r.Ut.G8);try{p(r),e.H3=B,e.D3(a),(f=g&&r.op())&&!f.IsSuspended()&&r.recalcAll()}finally{S(r)}}},o.prototype.clone=function(){var t,n,e,t=this,n=new o,e=Ht(t.toJSON());return n.Sg(t.jS),n.fromJSON(Gt(e)),n},o.prototype.V3=function(t){var n=new _.$$;n.bind(t),this.H3=n},o.prototype.gTt=function(t){var t;t&&!t.bindingPath()&&(t=t.H3)&&this.V3(t.getSource())},o.prototype.z3=function(){var t=this.H3;return t?t.getSource():B},o.prototype.pTt=function(){var t=this.H3;return t?t.getRowCount():0},o.prototype.bTt=function(t,n){var e,n,e=this.PSt;n?e.push(t):-1!==(n=e.indexOf(t))&&e.splice(n,1)},o.prototype.cL=function(n){var e=this;e.PSt.forEach(function(t){t.Pen(e,n)}),2===n&&(e.PSt=[])},o.prototype.Pwt=function(t,n,e){var r,r,i,o,r=this;r.yTt||((i=(i=(r=r.FSt)[e])||(r[e]={}))[o=[t,n].join(",")]=!0)},o.prototype.I4t=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,h,d,r=this,i=r.Mf,o=i&&i.getCalcService&&i.getCalcService();if(r.yTt=!0,o)for(a in a=void 0,u=r.FSt)if(f=o.rO[a])for(c in s=f.pj(),l=u[a])v=+(h=c.split(","))[0],h=+h[1],(d=f.pB(v,h))?(r.wTt(v,h)||r.MTt(d,t,n,e,!1,v,h),f.SB(v,h,d,void 0,!1,s)):delete l[c];else delete u[a];delete r.yTt},o.prototype.CTt=function(t,n,e){var r,i,o,u,a,f,s,l,c,h,c,v,h,r=this,i=r.Mf,o=i&&i.getCalcService();if(r.yTt=!0,o)for(a in a=void 0,u=r.FSt)for(l in f=o.rO[a],s=u[a])h=+(c=l.split(","))[0],c=+c[1],(v=f.pB(h,c))&&t===h&&n===c&&-1<(h=At(v))&&(v.arguments[h]=e);delete r.yTt},o.prototype.wTt=function(t,n){var e,r,i,t,r,e=this,r=e.footerIndex(),i=!1;return-1<r&&t===r&&(r=(t=e.iw)+e.Tx,i=t<=n&&n<r),i},o.prototype.sort=function(t,n){var e=this,r=e.Mf,i=e.dataRange(),e=e.rowFilter();r&&0<=t&&t<i.colCount&&(r.suspendPaint(),r.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:t+i.col,ascending:n}]),e&&(e.nrt={index:t+i.col,ascending:n}),r.resumePaint())},o.prototype.QL=function(){return!!this.H3},o.prototype.N4t=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,l,h,d,b,w,m,C,g,y,p,S,T,a=this,f=a.Mf,s=a.jS,l=a.Ky,c=a.iw,h=a.Sx,v=a.Tx,l=l+h-1,h=e?t+1:t,d=h+n,b=a.dataRange();_t(f);try{w=a.QL(),a.lTt=!0,a.sL(!1),a.STt(),(s.zB=a).JO(h,n,e,!!u,!0,o),a.I4t(),m=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,r&&!a.TTt&&(g=(C=1+l)+n,y=i-C+1,f.moveTo(C,c,g,c,y,v,m)),p=l-h+1,(!e||t!==l)&&0<p&&(w&&!a.oL&&(m=O.CopyToOptions.style),f.EB=!0,f.Nyt=b,f.moveTo(h,c,d,c,p,v,m),delete f.Nyt,delete f.EB),S=f.Ut,T=a.dataRange(),S.bJ&&S.bJ(h,n,[T],!0),S.ATt&&S.ATt(h,n,[T],!0),s.zB=U,a.ITt(),a.t5t(h,n,!0),a.J5t(h,n,!0),a.W5t(h,n,!0),a.fTt(),a.jS.dl()}finally{a.lTt=U,a.sL(!0),Rt(f),a.cL(0),f.recalcAll(!0)}},o.prototype.sL=function(t){this.Mf.sL(t)},o.prototype.insertRows=function(t,n,e){var r;A(t)||A(n)||n<=0||(t=Ot(r=this,t,!0),r.zpt(t,n,e))},o.prototype.zpt=function(t,n,e,r,i){var o,u,a,f,a,s,f,a,l,c,f,h,l,v;A(t)||A(n)||n<=0||(u=(o=this).Mf,f=(a=o.dataRange()).row,0===(a=a.rowCount)&&t===f||!(t<f||(s=f+a)<=t)||x(H().Exp_RowParamOutOfRange),f=o.Ky,a=o.iw,l=o.Sx,h=a+(c=o.Tx)-1,v=(f=f+l-1)<(l=Ct(u,o)),yt(u,o,1+f,l,a,h,n))||o.N4t(t,n,e,v,l,r,i)},o.prototype.deleteRows=function(t,n){var e;A(t)||A(n)||n<=0||(t=Ot(e=this,t,!0),e.yE(t,n))},o.prototype.yE=function(t,n,e){var r,i,o,u,o,a,f,s,l,c,h,u,o,v,d,b,w,m,C,g,y,p,S,T;if(!(A(t)||A(n)||n<=0||(i=(r=this).Mf,u=(o=r.dataRange()).row,o=o.rowCount,(t<u||u+o<=t)&&x(H().Exp_RowParamOutOfRange),a=r.Ky,f=r.iw,c=a+(s=r.Sx)-1,h=f+(l=r.Tx)-1,(s<=1||t===u&&!r.jO&&!r.oL&&o<=n)&&x(H().Exp_TableDeleteCountInvalid),o=c<(u=Ct(i,r)),yt(i,r,1+c,u,f,h,n,!0)))){_t(i);try{r.sL(!1),v=r.QL(),d=void 0,v&&(d=St(!0),r.x4t(t,n,d)),r.STt(),(b=r.jS).zB=r,b.zB.VB=new O.Range(a,f,s,l),r.xP(t,n,U,d,e),r.I4t(),w=E(n,c-t+1),i.clear(t,f,w,l,3,X),m=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,t+n<=c&&(C=m,v&&!r.oL&&(C=O.CopyToOptions.style),i.moveTo(t+n,f,t,f,c-n-t+1,l,C)),o&&(y=(g=1+c)-w,p=u-g+1,i.moveTo(g,f,y,f,p,l,m)),S=i.Ut,T=r.dataRange(),S.yJ&&S.yJ(t,n,[T],!0),delete b.zB.VB,b.zB=U,r.ITt(),r.J5t(),r.W5t(t,n,!1),r.jS.dl()}finally{r.sL(!0),Rt(i),r.cL(0),i.recalcAll(!0)}}},o.prototype.insertColumns=function(t,n,e){var r;A(t)||A(n)||n<=0||(t=Ot(r=this,t,!1),r.k4t(t,n,e))},o.prototype.k4t=function(t,n,e){var r,i,o,u,a,f,s,a,s,l,c,h,s,v,d,h,b,w,m,C,g,y,p,S,T,_,R;if(!(A(t)||A(n)||n<=0||(i=(r=this).Mf,u=(o=r.dataRange()).row,a=o.col,f=o.rowCount,s=o.colCount,(t<a||a+s<=t)&&x(H().Exp_ColParamOutOfRange),a=r.Ky,s=r.iw,h=a+(l=r.Sx)-1,d=(s=s+(c=r.Tx)-1)<(v=gt(i,r)),yt(i,r,a,h,1+s,v,n,!1,!0)))){b=(h=e?t+1:t)+n,_t(i);try{r.sL(!1),r.STt(),C=!(m=((w=r.jS).zB=r).QL()),y=(g=1+s)+n,p=v-g+1,S=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,d&&i.moveTo(a,g,a,y,l,p,S),r.qO(h,n,e,C,!0),r.xTt(h,n,!0),r.I4t(h,n,!0),e&&t===s||(m&&!r.oL&&(S=O.CopyToOptions.style),i.EB=!0,T=r.oL?1:0,i.moveTo(u,h,u,b,f+T,s-h+1,S),delete i.EB),_=i.Ut,R=r.dataRange(),_.wJ&&_.wJ(h,n,[R],!0),_.NTt&&_.NTt(h,n,[R]),w.zB=U,r.ITt(U,!0),r.J5t(),r.Q5t(h,n,!0),(0,P.hMt)(i,h,n,!0,!1,o),r.jS.dl()}finally{r.sL(!0),Rt(i),r.cL(0),i.recalcAll(!0)}}},o.prototype.deleteColumns=function(t,n){var e;A(t)||A(n)||n<=0||(t=Ot(e=this,t,!1),e.wE(t,n))},o.prototype.wE=function(t,n){var e,r,i,o,u,o,u,a,f,s,l,c,h,v,d,b,w,m,C,g,y,p,S,T;if(!(A(t)||A(n)||n<=0||(r=(e=this).Mf,o=(i=e.dataRange()).col,u=i.colCount,(t<o||o+u<=t)&&x(H().Exp_ColParamOutOfRange),o=e.Ky,u=e.iw,s=o+(a=e.Sx)-1,l=u+(f=e.Tx)-1,c=e.oL?1:0,(f<=1||t===u&&f<=n)&&x(H().Exp_TableDeleteCountInvalid),v=l<(h=gt(r,e)),yt(r,e,o,s,1+l,h,n,!0,!0)))){_t(r);try{e.sL(!1),e.STt(),d=e.jS,b=e.QL(),d.zB=e,d.zB.VB=new O.Range(o,u,a,f),e.NP(t,n),e.xTt(t,n,!1),e.I4t(t,n,!1),w=E(n,l-t+1),r.clear(o,t,a,w,3,X),m=O.CopyToOptions.value|O.CopyToOptions.formula|O.CopyToOptions.comment|O.CopyToOptions.outline|O.CopyToOptions.sparkline|O.CopyToOptions.span|O.CopyToOptions.style|O.CopyToOptions.tag|O.CopyToOptions.bindingPath|O.CopyToOptions.hyperlink|O.CopyToOptions.altText,t+n<=l&&(C=m,b&&!e.oL&&(C=O.CopyToOptions.style),r.EB=!0,r.moveTo(o,t+n,o,t,a-c,l-n-t+1,C),delete r.EB),v&&(y=(g=1+l)-w,p=h-g+1,r.moveTo(o,g,o,y,a,p,m)),S=r.Ut,T=e.dataRange(),S.MJ&&S.MJ(t,n,[T],!0),S.kTt&&S.kTt(t,n),delete d.zB.VB,d.zB=U,e.ITt(!0),e.J5t(),e.Q5t(t,n,!1),(0,P.hMt)(r,t,n,!1,!1,i),e.jS.dl()}finally{e.sL(!0),Rt(r),e.cL(0),r.recalcAll(!0)}}},o.prototype.STt=function(){try{var t=this,n=t.Mf,e,r=t.jS.U3;n&&n.Ut.DTt([t],[],2),r.splice(r.indexOf(t),1),t.U5t()}catch(t){}},o.prototype.ITt=function(t,n){var e=this;e.mTt=!0,e.iTt=t,e.jS.WB(e,U,n),delete e.iTt,delete e.mTt},o.prototype.xTt=function(t,n,e){for(var r,i,o,u,a,f,s,l,r=this,i=r.BSt,o=i.length,u=pt(r,t),s=u;s<o;s++)l=void 0,e?u+n-1<s&&(l=s-n):u<=s&&(l=s+n),(f=(a=i[s]).footerFormula())&&r.MTt(f,t,n,e,!0,l)},o.prototype.MTt=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,a=this,f=a.Mf;if(0<e&&t&&t.arguments)for(s=t.arguments,c=l=void 0,h=0;h<s.length;h++)(l=s[h])instanceof P.obt&&(f&&(i?f.Ut._Tt(this,l,o):f.Ut.ETt(a,l,o,u)),l._K(),c=l.offsetWhenInsertRemoveColumn(n,e,r,i),s[h]=c)},o.prototype.ftt=function(t){var n,e,r,i,o,u,a,f,s,l,c,h,v,n=this,e=n.H3,r=n.Mf,i=n.jO?1:0,o=n.Ky+i+t,u=n.iw;if(!e||0===e.getRowCount())return B;if(a=n.Tx,f={},s=e.ftt(t))for(l in s)K(s,l)&&"function"!=typeof l&&(f[l]=s[l]);for(c=0;c<a;c++)v=(h=n.BSt[c])&&h.dataField(),h&&v&&0<v.length&&A(f[v])&&(f[v]=r.getValue(o,u+c));return f},o.prototype.x4t=function(t,n,e){var r,i,o,u,a,f,s,l,r=this,i=[],o=r.H3;if(o)for(f=o.getRowCount(),s=0;s<n;s++)l=B,(a=D(r,u=t+s))<f&&(l=r.ftt(a)),i.push({key:e,data:l});r.aj=i},o.prototype.tq=function(){var e=[],t=this.aj;return t&&m(t,function(t,n){n&&!O.GC$.isFunction(n)&&e.push(n.data)}),e},o.prototype.R5t=function(t,n,e){var r,i,o,u,a,f,r=this;0<r.Mf.lE||(i=r.GSt,(o=r.H3)&&(u=B,n<(a=o.getRowCount())&&(u=r.ftt(n)),i[t]=f={key:e,data:u}))},o.prototype.sTt=function(t,n,e){var r,i,e,o,r=this;if(!(0<r.Mf.lE))if(i=r.GSt,e)e=i.splice(t,n),r.USt.push({rowIndex:t,count:n,deletedDirtyItems:e});else for(o=0;o<n;o++)i.splice(t,0,B)},o.prototype.A4t=function(t,n){this.GSt.splice(t,n)},o.prototype.ZSt=function(){var t,n,n,e,r,i,o,u,t=this,n=t.USt;if(n&&0<n.length)for(e=(n=n.pop()).rowIndex,r=n.count,i=n.deletedDirtyItems,o=0;o<r;o++)u=i[o],t.GSt[e+o]=l({},u)},o.prototype.getDirtyRows=function(){for(var t,n,e,r,i,o,t=this,n=t.GSt,e=[],o=0;o<n.length;o++)r=n[o],A(r)||(i=D(t,o),e.push({row:i,originalItem:r.data,item:t.ftt(i)}));return e},o.prototype.clearPendingChanges=function(){this.GSt=[]},o.prototype.footerRowDropDowns=function(t,n){var e,t,t,r,i,n,e=this,t=e.OSt[t];if(t)return 1===arguments.length?t.dropDowns&&t.dropDowns.slice():(t=t.dropDowns[0],n?(r=n.listOption,i=n.submitCommand,n=n.type,r&&(t.option=r),i&&(t.submitCommand=i),R(n)&&(t.type=n),e):void 0)},o.prototype.checkTableLastRow=function(t){var n=this,e=n.dataRange();return n.headerIndex()===t||e.row+e.rowCount-1!==t},o.prototype.checkTableLastCol=function(t){var n,e=this.dataRange();return e.col+e.colCount-1!==t},o.prototype.jj=function(t,n,e,r,i){var o,u,r,i,u,o=this,u=o.Mf;xt(u,o,e?zn:On,t,n,r,i),r=u.Ut,i=e?On:zn,u=!e&&U,r&&r.ZI(["tableRowsChanged",o,i,t,n,u,e])},o.prototype.Ej=function(t,n,e,r){var i,o,r,u,o,i=this,o=i.Mf;Ft(o,i,e?Mn:In,t,n,r),r=o.Ut,o=!e&&U,r&&r.ZI(["tableColumnsChanged",i,u=e?In:Mn,t,n,o])},G=o,T.Table=G,T.hasRowFilter=Se,(0,O.$e)(G),re={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"},G.prototype.name=e(Jt,"",Te(Jt),r),G.prototype.bandRows=e(Zt,!0,Te(Zt)),G.prototype.bandColumns=e(Qt,!1,Te(Qt)),G.prototype.highlightFirstColumn=e(Kt,!1,Te(Kt)),G.prototype.highlightLastColumn=e(qt,!1,Te(qt)),G.prototype.style=e("style",U,_e),G.prototype.autoGenerateColumns=e(Wt,!0,Te(Wt)),h&&h.HideRowFilter&&(n=h.HideRowFilter,s(u,fe=n),u.prototype.pct=function(){return 0},u.prototype.bct=function(){return this.range.colCount},u.prototype.table=function(t){var n=this;if(0===arguments.length)return n.nM;(n.nM=t)&&(n.Mf=t.Mf)},u.prototype.unfilter=function(t,n){var e,r,t,e=this,r=e.Mf;r&&r.suspendPaint(),fe.prototype.unfilter.call(this,t,n),(t=e.nM)&&t.jS&&t.jS.dl(),r&&r.resumePaint()},u.prototype.JO=function(t,n){var e=this,r=e.nM;fe.prototype.JO.call(this,t,n),r&&e.Fct(r.dataRange())},u.prototype.xP=function(t,n){var e=this,r=e.nM;fe.prototype.xP.call(this,t,n),r&&e.Fct(r.dataRange())},u.prototype.ert=function(t,n,e,r,i){var o,u,a,o,u=this.nM;fe.prototype.ert.call(this,t,n,e,r,i),u&&u.N5t()&&(a=u.getSlicerData()).refresh()},u.prototype.toJSON=function(){var t,n,t,t=this,n=fe.prototype.toJSON.call(t),t=t.nM;return t&&(n.tableName=t.name()),n},u.prototype.L0=function(){this.nM=B,this.Mf=B},T.WSt=u),Ae.prototype.tTt=function(){return 0<this.id()},Ae.prototype.toJSON=function(){var r,i,r=this,i={};return m(Rn,function(t,n){var e=r[n]();A(e)||(n===Pt&&e.toJSON&&"function"==typeof e.toJSON?i[n]=e.toJSON():i[n]=e)}),b(i)?U:i},Ae.prototype.wh=function(t,n,e,r,i,o){var u,a,a,f,s,l,c,i,e,f,c,o,u=this,a=u.name();return a=it(a,"\r",""),a={n_:"tableColumn",id:u.id(),name:rt(it(a,"\n","_x000a_"))},f=u.footerFormula(),s=u.footerValue(),f&&(i&&!1===i.includeFormulas?(f=U,s=t.getValue(e,r)):c=je(l=k(t,f,e,r))),(i=c===Kn)?a.totalsRowFunction=Kn:f?a.totalsRowFunction=c:A(s)||(a.totalsRowLabel=rt(ot(s.toString(),!0)),o.v=s),e=u.dataAreaFormula(),A(e)||ke(e=k(t,e,n,r))||(A(a.c_)&&(a.c_=[]),f={n_:"calculatedColumnFormula",c_:[rt(at(e))]},a.c_.push(f)),i&&!A(l)&&(c={n_:"totalsRowFormula",c_:[rt(l)]},A(a.c_)&&(a.c_=[]),a.c_.push(c)),o=a.lossless,A(u.cellType())||((o=A(o)?a.lossless={}:o)[Pt]=u.cellType().toJSON()),A(u.value())||((o=A(o)?a.lossless={}:o)[Yt]=u.value()),A(u.formatter())||((o=A(o)?a.lossless={}:o)[$t]=u.formatter()),A(u.dataField())||((o=A(o)?a.lossless={}:o)[gn]=u.dataField()),a},Ae.prototype.fromJSON=function(o){var u;o&&(u=this,m(Rn,function(t,n){var e,r,i,i,r,e=o[n]!==U?o[n]:o["_"+n];A(e)||n===Pt&&(r=e.typeName,i=(i=O.CellTypes&&O.CellTypes.ti)&&i[r]||i[e.type]||(0,O.getTypeFromString)(r))&&((r=new i).fromJSON(e,!1),e=r),A(e)||u[n](e,!1)}))},Ae.prototype.yh=function(t,n){var e,r,r,r,r,n,r,n,r,n,t,i,i,t,i,t,n;t&&((e=this).id(tt(t.id,0)),r=t[Jt],A(r)||(r=it(r,"_x000d__x000a_","\n"),e.name(et(it(r,"_x000a_","\n")))),r=t.totalsRowLabel,A(r)||e.footerValue(et(r)),n||(r=t.totalsRowFunction,A(r)||((n=r)===Kn&&(n=et(Z(L(t,"totalsRowFormula")))),e.footerFormula(n)),r=L(t,"calculatedColumnFormula"),A(r)||(n=""+Z(r),e.dataAreaFormula(et(ut(n)))),r=t.lossless,A(r))||(n=r[Pt],A(n)||(t=n.typeName,(i=(i=O.CellTypes&&O.CellTypes.ti)&&i[t]||i[n.type]||(0,O.getTypeFromString)(t))&&((t=new i).fromJSON(n),n=t),A(n))||e.cellType(n),i=r[Yt],A(i)||e.value(i),t=r[$t],A(t)||e.formatter(t),n=r[gn],A(n))||e.dataField(n))},J=Ae,(T.TableColumn=J).prototype.id=function(t){var n=e(Cn,U,function(t){var n=this;n.name()||n.name(mn+t)});return 0===arguments.length?n.call(this):A(t)?this:n.call(this,t)},J.prototype.name=e(Jt,U,function(t){var n,e,n=this;t?(e=O.util.V0(t="string"!=typeof t?""+t:t))!==t&&e.toLocaleDateString&&n.name(e.toLocaleDateString()):n.name(mn+n.id())}),J.prototype.formatter=e($t),J.prototype.cellType=e(Pt),J.prototype.value=e(Yt),J.prototype.dataField=e(gn),J.prototype.footerValue=e(Tn),J.prototype.dataAreaFormula=e(Sn),J.prototype.footerFormula=e(yn),J.prototype.x5t=e(t),J.prototype.hTt=e(pn),a.prototype.getUsedRange=function(){var t,n,e,r,i,o,u,t,n=this.all(),e={};if(n)for(r=void 0,i=0,o=n;i<o.length;i++)u=o[i],Wn(e,Qn(u.range()));return e},a.prototype.L0=function(){for(var t,n,e,r,i,t=this,n=t.U3,e=n.length,i=0;i<e;i++)(r=n[i])&&r.L0();t.U3=[],t.zB=U,t.dl(),t.Mf=B},a.prototype.dl=function(){var t,n,e,r,i,t=this;for(t.xl=[],t.Nl=[],e=(n=t.U3).length,i=0;i<e;i++)(r=n[i]).dl()},a.prototype.KSt=function(t,n){for(var e,r,i,o,u,e,r=this.U3,i=r.length,u=0;u<i;u++)o=r[u],!n&&le(o.HSt,t)?o.HSt=[]:A(o.HSt[t])||(o.HSt[t]=U)},a.prototype.JSt=function(t){for(var n,e,r,i,o,n,e=this.U3,r=e.length,o=0;o<r;o++)le((i=e[o]).zSt,t)?i.zSt=[]:A(i.zSt[t])||(i.zSt[t]=U)},a.prototype.add=function(t,n,e,r,i,o,u){return this._Qt(t,n,e,r,i,o,u)},a.prototype._Qt=function(t,n,e,r,i,o,u,a){var f=this;return f.jTt(f.Mf,t,n,e,r,i,!0),f.WB(new G(t,n,e,r,i,o||C.TableThemes.medium2,u),U,U,a)},a.prototype.addFromDataSource=function(t,n,e,r,i,o){var u,a,f,r,s,u;if(r||x(H().Exp_TableDataSourceNullError),_.$$)return(a=(u=this).Mf).suspendPaint(),vt(a),(f=new _.$$).bind(r),r=f.getRowCount()+1,s=f.getColumnCount(),(u=u.add(t,n,e,r,s,i,o)).D3(f),a.clearPendingChanges(),dt(a),a.resumePaint(),u},a.prototype.find=function(t,n){return this.Hq(t,n)},a.prototype.Hq=function(t,n,e){for(var r,i,o,u,a,f,r=this,i=r.U3,o=(i=!0===e&&r.zB?i.concat([r.zB]):i).length,a=0;a<o;a++)if((f=(u=i[a]).range()).row<=t&&t<f.row+N(f)&&f.col<=n&&n<f.col+z(f))return u;return B},a.prototype.findByName=function(t){return this._bt(t)},a.prototype._bt=function(t,n){for(var e,r,i,o,u,e=this,r=e.U3,i=(r=!0===n&&e.zB?r.concat([e.zB]):r).length,u=0;u<i;u++)if((o=r[u]).name().toLowerCase()===t.toLowerCase())return o;return B},a.prototype.pP=function(t,n,e,r){for(var i,o,u,a,f,s,i=this.U3,o=i.length,u=(0,O.Ec)(t,e,n,r),a=[],s=0;s<o;s++)f=i[s],u.containsRange(f.range())&&a.push(f);return a},a.prototype.AB=function(t,n,e,r){for(var i,o,u,a,f,i=this.U3,o=i.length,u=[],f=0;f<o;f++)(a=i[f]).range().intersect(t,n,e,r)&&u.push(a);return u},a.prototype.Uue=function(t){for(var n,e,r,i,o,u,a,f,n=this.U3,e=n.length,r=t.row,i=t.col,o=t.rowCount,u=t.colCount,f=0;f<e;f++)if((a=n[f]).range().intersect(r,i,o,u))return a},a.prototype.Dy=function(){var t,n,t,t=this,n=t.Mf,t=t.find(n.ui,n.ci);if(t)return n.j1(new O.Range(-1,t.iw,-1,t.Tx))},a.prototype.WB=function(t,n,e,r){var i,o;if(t)return(i=this).findByName(t.name())&&x(H().Exp_TableHasSameNameError),(o=i.Mf).suspendPaint(),t.Sg(i),o.Ut.DTt([],[t],1),i.U3.push(t),t.mTt||t.qSt(),!n&&t.showHeader()&&t.a5t(U,U,e,r),!n&&t.showFooter()&&t.l5t(),i.OTt(t),o.resumePaint(),t},a.prototype.DK=function(t){var n,e,r,n=this,e=w(t,n.U3);return-1<e?((r=n.Mf)&&r.Ut.DTt([t],[],2),n.U3.splice(e,1),n.RTt([t],!1),t):B},a.prototype.remove=function(t,n){var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,C,g,e=this;if((t=Tt(t)?e.findByName(t):t)&&(n=n||0,t.s5t(),t=e.DK(t))){r=t.range(),i=e.Mf;try{if(p(i),o=r.row,u=r.row+N(r),a=r.col,f=r.col+z(r),l=s=void 0,c=t.showHeader(),h=t.headerIndex(),1!=(1&n))for(s=o;s<u;s++)for(l=a;l<f;l++)F(i,s,l,B),y(i,s,l,B);else if(t.QL()){if(c)for(s=h,l=a;l<f;l++)i.setValue(s,l,t.getColumnName(l-r.col));for(b=(d=(v=t.dataRange()).row)+N(v),C=m=w=void 0,s=d;s<b;s++)for(l=a;l<f;l++)(m=t.BSt[pt(t,l)])&&(C=(w=t.ftt(D(t,s)))[m.dataField()],A(C)||i.setValue(s,l,C))}else if(c)for(s=h,l=a;l<f;l++)i.setValue(s,l,t.getColumnName(l-r.col));if(2==(2&n))for(s=o;s<u;s++)for(l=a;l<f;l++)g=i.Z_(s,l)||new O.Style,t.h5(s,l,g),i.setStyle(s,l,g)}finally{S(i)}t.cL(2)}return t},a.prototype.move=function(t,n,e){var r,i,o,r,o,r=this,i=r.Mf;if((t=Tt(t)?r.findByName(t):t)&&0<=n&&0<=e&&(o=t.range(),0===(o=(r=r.AB(n,e,N(o),z(o))).length)||1===o&&r[0]===t)){p(i);try{t.G5t(n,e)}finally{S(i)}}},a.prototype.resize=function(t,n){var e,r,i,o,u,n,u,a,f,s,l,c,e=this,r=e.Mf;if((t=Tt(t)?e.findByName(t):t)&&(i=t.range(),o=t.dataRange(),n=n,n=3===(u=arguments).length?(0,O.Ec)(i.row,i.col,u[1],u[2]):n)&&(u=N(n),a=z(n),0<=u)&&0<=a&&(f=e.AB(n.row,n.col,u,a)).length<=1){_t(r);try{t.K5t(n),t.QL()||(s=r.conditionalFormats,l=r.b8,c=n.rowCount-i.rowCount,s&&s.qJ(i,o,c),l&&l.qJ(i,o,c))}finally{Rt(r)}}},a.prototype.all=function(){var e=[];return m(this.U3,function(t,n){e.push(n)}),e},a.prototype.$St=function(t){for(var n,e,r,n=t||this.U3,e=n.length,r=0;r<e;r++)n[r].clearPendingChanges()},a.prototype.Yj=function(t,n,e,r){for(var i,o,u,a,f,i=[],o=this.U3,u=o.length,a=0;a<u;a++)(f=o[a]).Ky>=t&&f.iw>=n&&f.Ky+f.Sx<=t+e&&f.iw+f.Tx<=n+r&&i.push(f);return i},a.prototype.Zj=function(t,n,e,r){var i,o,u,a,i=this,o=i.AB(t,n,e,r),u=i.Yj(t,n,e,r),a=[];return 0<u.length?o.forEach(function(t){-1===u.indexOf(t)&&a.push(t)}):a=o,a},a.prototype.Wj=function(t,n,e){for(var r,i,o,u,r=t.length,o=0;o<r;o++)if((u=(i=t[o]).range()).row<=n&&n<u.row+N(u)&&(e<0||u.col<=e&&e<u.col+z(u)))return!0;return!1},a.prototype.jTt=function(t,n,e,r,i,o,u){var a,a,n,f;return n?bt(n)?e<0||i<1||e+i>t.getRowCount()?(u&&x(H().Exp_TableInvalidRow),!1):r<0||o<1||r+o>t.getColumnCount()?(u&&x(H().Exp_TableInvalidColumn),!1):(a=t.tables).Pl(e,r,i,o)?(u&&x(H().Exp_TableIntersectError),!1):a.findByName(n)?(u&&x(H().Exp_TableHasSameNameError),!1):Se(t,new O.Range(e,r,i,o))?(u&&x(H().Exp_TableRangeHasFilterError),!1):(n=(a=g&&t.iT(e,r,i,o))&&a.ranges,f=!0,n&&m(a,function(t,n){if(1<N(n)||1<z(n))return u&&x(H().Exp_ArrayFormulaTable),f=!1}),f):(u&&x(H().Exp_TableNameInvalid),!1):(u&&x(H().Exp_TableEmptyNameError),!1)},a.prototype.WI=function(t,n,e,r){for(var i,o,u,a,i=[],o=this.U3,u=0;u<o.length;u++)(a=o[u]).Ky>=t&&a.iw>=n&&a.Ky+a.Sx<=t+e&&a.iw+a.Tx<=n+r&&i.push(a.name());return i},a.prototype.oSt=function(t,n,e,r){var i,o,u,a,f,i=this.all();if(i)for(o=(0,O.Ec)(t,n,e,r),u=i.length,a=void 0,f=0;f<u;f++)if(a=i[f].range(),o.intersect(a.row,a.col,N(a),z(a))&&!o.containsRange(a))return!0;return!1},a.prototype.Pl=function(t,n,e,r){for(var i,o,u,a,i=this.U3,o=i.length,a=0;a<o;a++)if((u=i[a]).range().intersect(t,n,e,r))return!0;return!1},a.prototype._getTable=function(t,n,e,r,i){for(var o,u,a,f,s,l,o=t.tables.all(),u=o.length,f=[],s=0;s<u;s++)(l=(a=o[s]).range()).row>=n&&l.col>=e&&l.row+l.rowCount<=n+r&&l.colCount+l.col<=e+i&&f.push({table:a,index:s});return f},a.prototype.mx=function(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,v,o=e.tables.all(),u=o.length;if(!A(n)&&(f=r.row-n.row,s=r.col-n.col,0!==(l=this._getTable(t,n.row,n.col,n.rowCount,n.colCount)).length))for(c=0;c<u;c++)for(a=o[c],h=0;h<l.length;h++)if(v=l[h],(!i||c!==v.index)&&(v=v.table.range(),a.range().intersect(v.row+f,v.col+s,v.rowCount,v.colCount)))return e.jT(6,H().Exp_TableIntersectError),!0;return!1},a.prototype.t5t=function(t,n){for(var e,r,i,o,e=this,r=e.U3,i=0,o=r.length;i<o;i++)r[i].t5t(t,n);e.Mf.filterRowsVisibleInfo.rE(t,n)},a.prototype.JO=function(t,n){for(var e,r,i,o,u,a,f,s,l,c,e,h,v,d,b,w,e=this,r=e.U3,i=[],o=0,u=r.length;o<u;o++)f=(a=r[o]).z3(),l=(s=a.cue&&!(a.jO&&1===a.Sx))?t-1:t,$(i,f)?a.JO(l,n,!0):(c=a.JO(l,n,s,U,a.cue))&&i.push(f);e=e.Mf;try{for(p(e),v=h=void 0,o=0,u=r.length;o<u;o++)h=(a=r[o]).pTt(),v=a.dataRange(),0<h&&h!==N(v)&&(d=h,a.showHeader()&&(d+=1),a.showFooter()&&(d+=1),b=a.range(),w=(0,O.Ec)(b.row,b.col,d,z(v)),a.K5t(w))}finally{S(e)}},a.prototype.qO=function(t,n){for(var e,r,i,o,e=this.U3,r=e.length,o=0;o<r;o++)(i=e[o]).qO(t,n)},a.prototype.n5t=function(t){for(var n,e,r,i,o,u,n=this.U3,e=n.length,u=0;u<e;u++)i=(r=n[u]).iw,o=r.endColumn(),i<=t&&t<=o&&r.n5t()},a.prototype.xP=function(t,n){for(var e,r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,C,g,e=this,r=e.U3,i=[],o=[],u=[],a=0,f=r.length;a<f;a++)l=(s=r[a]).z3(),((h=t<=(c=s.range()).row&&c.row+N(c)<=t+n)?u:($(i,l)?s.xP(t,n,!0):(s.QL()&&s.x4t(t,n,St(!0)),(v=s.xP(t,n))&&i.push(l)),o)).push(s);e.Mf.filterRowsVisibleInfo.aE(t,n),e.Mf.Ut.DTt(u,[],2),e.U3=o,e.RTt(u,!0),d=e.Mf;try{for(p(d),r=e.U3,w=b=void 0,a=0,f=r.length;a<f;a++)b=(s=r[a]).pTt(),w=s.dataRange(),0<b&&b!==N(w)&&(m=b,s.showHeader()&&(m+=1),s.showFooter()&&(m+=1),C=s.range(),g=(0,O.Ec)(C.row,C.col,m,z(w)),s.K5t(g))}finally{S(d)}},a.prototype.NP=function(t,n){for(var e,r,i,o,u,a,f,s,l,e=this,r=e.U3,i=[],o=[],u=r.length,f=0;f<u;f++)((l=t<=(s=(a=r[f]).range()).col&&s.col+z(s)<=t+n)?o:(a.NP(t,n),i)).push(a);e.Mf.Ut.DTt(o,[],2),e.U3=i,e.RTt(o,!0)},a.prototype.d5=function(t,n,e,r,i){var o,u,a,f,s,l,c,h,v,o=this,u=(0,O.Ec)(t,n,e,r),l=[],c=o.Mf;if(1==(1&i)){for(h=[],f=(a=o.U3).length,v=0;v<f;v++)s=a[v],(u.containsRange(s.range())?l:h).push(s);for(f=h.length,v=0;v<f;v++)(s=h[v]).d5(t,n,e,r);c&&c.Ut.DTt(l,[],2),o.U3=h}if(2==(2&i))for(f=(a=o.U3).length,v=0;v<f;v++)s=a[v],u.containsRange(s.range())&&(c&&c.Ut.YSt(s,"style",s.style()),s.style(B));return o.RTt(l,!0),l},a.prototype.RTt=function(t,n){var e;t&&0!==t.length&&(e=this.Mf,O.GC$.each(t,function(t,n){n.N5t()&&n.getSlicerData().onTableRemoved(n),n.g5t()&&(e&&e.Ut.YSt(n,_n,n.b5t()),n.OSt=[])}),g)&&ce(this.Mf,t,n)},a.prototype.OTt=function(t){t&&t.N5t()&&t.getSlicerData().onTableAdded(t)},a.prototype.BTt=function(t){for(var n,e,r,i,n=1,e,r=t,i=this.LTt();!this.FTt(r,i);)r=t+n,n++;return r},a.prototype.LTt=function(){for(var t,n,e,r,i,o,u,a,f,s,t=[],n,e,i=0,o=this.Mf.parent.sheets;i<o.length;i++)for(a=0,f=r=(u=o[i]).tables.all();a<f.length;a++)s=f[a],t.push(s);return t},a.prototype.FTt=function(t,n){for(var e,r,i,e=0,r=n;e<r.length;e++)if((i=r[e]).name().toLowerCase()===t.toLowerCase())return!1;return!0},a.prototype.Sl=function(t,n){var e,r,i,o,e,r=!1,i=B,o=this.find(t,n);return o&&(o.showHeader()&&t===o.headerIndex()?(i=o.q5t(n),A(i)||(i=v(i)),r=!0):(r=(i=o.Sl(t,n)).e5t,i=i.y4)),{e5t:r,y4:i}},a.prototype.Kbt=function(t,n,e){var r,i,o,u,r,i=!1,o=!0,u=this.find(t,n);return u&&!0!==u.eTt&&(u.showHeader()&&t===u.headerIndex()?(A(e)||(e=u.nTt(v(e),n-u.iw)),u.$5t(n,e)):u.showFooter()&&t===u.footerIndex()?u.d5t(n,e):i=u.Kbt(t,n,e)),i||!1},a.prototype.pMt=function(t,n,e,r,i,o){var u=this.find(t,n);if(g&&u){if(1<e||1<r)return this.Mf.jT(0,H().Exp_ArrayFormulaTable),!1;if(u.showHeader()&&t===u.headerIndex()&&i)return!1;!u.eTt&&u.showFooter()&&t===u.footerIndex()&&(A(i)||u.d5t(n,B),u.m5t(n-u.iw,i,o))}return!0},a.prototype.XSt=function(){for(var t,n,e,r,t=this.all(),n=0,e=t.length;n<e;n++)(r=t[n]).bindingPath()&&(r.H3=B)},a.prototype.KB=function(t,n){var e,r,i,o,u,e=[],r=this;if(r&&(i=r.all()))for(u=i.length-1;0<=u;u--)o=i[u],t.containsRange(o.range())&&(n&&(this.Mf&&this.Mf.Ut.DTt([o],[],2),r.U3.splice(u,1),o.U5t(U,U,n)),e.push(o));return e},a.prototype.JB=function(t,n,e,r,i,o){for(var u,a,f,s,l,c,h,l,l,u=this,a=[],f=0,s=t.length;f<s;f++)l=t[f],h=c=void 0,o?h=l:(c=l.bindingPath()?U:l.z3(),(h=new G).Sg(u),h.fromJSON(Gt(Ht(l.toJSON()))),h.name(u.BTt(h.name())),a.push(h)),l=h.range(),h.rTt=!0,h.H5t(r+l.row-n,i+l.col-e),u.WB(h,o),o?(l=h.LSt)&&(l.Mf=u.Mf,l.refresh()):c&&h.V3(c),h.rTt=!1;for(f=0;f<a.length;f++)a[f].formulaFromJSON()},a.prototype.qB=function(t){for(var n=0,e=t.length;n<e;n++)t[n].z5t()},a.prototype.toJSON=function(t,n){var e,r,i,o,e=this.U3,r=[];if(e)for(i=0;i<e.length;i++)o=t?this.BTt(e[i].name()):U,r.push(e[i].toJSON(o,n));return 0===r.length?U:r},a.prototype.wh=function(t){var n,e,r,i,o,u,a,a,u;if(t&&(n=t.rels,r=(e=this.U3).length,n)&&0<r){for(i=[],o=0;o<r;o++)u=e[o],a=ft(n),a=O.XFileConstants.Rr+a,u=u._id,n.c_.push({n_:O.XFileConstants.Lr,Id:a,Type:O.RelationshipConstants.lc,Target:"../tables/"+O.XFileConstants.du+u+"."+O.XFileConstants.Cr}),i.push({n_:"tablePart","r:id":a});t.c_||(t.c_=[]),t.c_.push({n_:Zn,count:r,c_:i})}},a.prototype.fromJSON=function(t,n,e){var r,i,o,u;if(t)for(this.U3=[],this.dl(),r=0,i=t.length;r<i;r++)o=t[r],(u=new G).Sg(this),this.U3.push(u),u.fromJSON(o,n,e)},a.prototype.yh=function(t,n,e,r){var i,o,u,a,f,s,l,c,h,v,v,v,v,d,b,i=t&&t.c_,o=!O.Util.ko(r);if(i&&n){for((a=O.Util.wo(r,(u=this).Mf.parent&&u.Mf.parent.v2))||(u.U3=[]),u.dl(),f=e.tables,s=e.styleManager,l=[],c=0,h=i.length;c<h;c++)v=i[c][qn],(v=(v=st(n.c_,v))&&v.Target)&&(d=(v=f[v=v.split("/").pop().slice(0,-4)]).name,b=void 0,(b=a?u.findByName(d):b)||((b=new G(d)).Sg(u),u.U3.push(b)),b.yh(v,s,r),l.push(b.range()),o)&&b._5t(s);O.Util.Co(r)&&O.Util.Ao(u.Mf,l,U,e)}},a.prototype.containTableHeaderTotalRowForSheet=function(){var t,n,t,e,r,i,o,u,a,f,s,l,c,t=this.Mf;if(t&&(n=t.getSelections(),i=r=e=void 0,t=t.tables)&&n)for(o=t.U3,s=f=a=u=void 0,l=0;l<n.length;l++)for(i=(r=(e=n[l]).row)+e.rowCount-1,c=0;c<o.length;c++)if(a=(u=o[c]).range(),f=u.headerIndex(),s=u.footerIndex(),!e.containsRange(a)&&(r<=f&&f<=i||r<=s&&s<=i))return!0;return!1},a.prototype.containTableHeaderTotalRow=function(){var t,n,e,r,i,o,e,t,u,a,f,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=i=void 0,r=t.tables)&&e){if(1<e.length)return n;e=e[0],f=a=u=void 0,(t=zt(t,e))&&1===t.length&&(o=(i=e.row)+e.rowCount-1,a=(u=t[0]).headerIndex(),f=u.footerIndex(),i<=a&&a<=o||i<=f&&f<=o)&&(n=!0)}return n},a.prototype.noRoomToInsertColumn=function(){var t,n,e,n,r,i,n,e,r,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(r=(n=n[0]).row,i=n.col,n=n.colCount,e=e.find(r,i),r=t.getColumnCount(3),e)&&e.endColumn()+n>=r)},a.prototype.noRoomToInsertRow=function(){var t,n,e,n,r,i,n,e,r,t=this.Mf;return!!(t&&(n=t.getSelections(),e=t.tables)&&n&&1===n.length&&(r=(n=n[0]).row,i=n.col,n=n.rowCount,e=e.find(r,i),r=t.getRowCount(3),e)&&e.endRow()+n>=r)},a.prototype.checkTableRow=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!(!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range(),t)&&e)||t.jO||t.oL||1!==e.rowCount)},a.prototype.checkTableCol=function(){var t,n,t,n,e,n,t,e,t=this.Mf;return!!(t&&(n=t.getSelections(),t=t.tables)&&n&&1===n.length&&(e=(n=n[0]).row,n=n.col,e=(t=t.find(e,n))&&t.range())&&1===e.colCount)},a.prototype.isAcrossTables=function(){var t,n,e,r,e,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),r=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=zt(t,e))&&(n=1<t.length)}return n},a.prototype.isWholeTableCol=function(){var t,n,e,r,e,t,t,i,t,o,e,t=this.Mf,n=!1;return t&&(e=t.getSelections(),r=t.tables)&&e&&(1<e.length?n=!0:(e=e[0],1===(t=zt(t,e)).length&&(i=(t=t[0]).iw,t=t.Tx,o=e.col,e=e.colCount,n=i===o&&t===e))),n},a.prototype.containTableHeader=function(){var t,n,e,r,i,o,e,t,u,t,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),o=i=void 0,r=t.tables)&&e){if(1<e.length)return n;e=e[0],(t=zt(t,e))&&1===t.length&&(t=(u=t[0]).headerIndex(),o=(i=e.row)+e.rowCount-1,i<=t)&&t<=o&&(n=!0)}return n},a.prototype.eq=function(){var t,n,e,r,i,t,o,u,a,f,t=this.Mf,n=!1;if(t&&(e=t.getSelections(),r=t.tables)&&e){if(i=t.getActiveRowIndex(),t=t.getActiveColumnIndex(),1<e.length||!r.find(i,t))return n;for(o=r.U3,u=e[0],a=void 0,f=0;f<o.length;f++)a=o[f],u&&u.intersect(a.Ky,a.iw,a.Sx,a.Tx)&&(n=!0)}return n},a.prototype.uSt=function(t){var n,e,r,i,o,u,a,f,s,n=-1,e,r=this.U3;if(r)for(i=r.length,f=a=u=o=void 0,s=0;s<i;s++)o=r[s].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(f=(u=o.row)+(a=o.rowCount)-1)&&(n=f);return n},a.prototype.sSt=function(t){var n,e,r,i,o,u,a,f,s,n=-1,e,r=this.U3;if(r)for(i=r.length,f=a=u=o=void 0,s=0;s<i;s++)o=r[s].range(),t&&!o.intersect(t.row,t.col,t.rowCount,t.colCount)||n<(f=(u=o.col)+(a=o.colCount)-1)&&(n=f);return n},a.prototype.yx=function(t,n,e,r,i,o,u){var a,f,s,l,c,h,v,d,b,u,w,m,n,C,g,y,p,S,T,_,a=this;if(!(a.Mf.options.isProtected||t&&e&&Oe(t,e)||0===(f=a.all()).length||(s=e&&f.some(function(t){return e.equals(t.range())}))))for(u&&(d=u.shiftInfo,b=u.applyDragFillAfterTableExpand,d)&&(l=d.shiftCells,c=d.isCopy,h=d.isFirst,v=d.isHeaderPaste),u=n.row,w=n.col,m=n.rowCount,n=n.colCount,v&&(-1===u&&(u=0),-1===w&&(w=0),-1===m&&(m=t.getRowCount()),-1===n)&&(n=t.getColumnCount()),C=new O.Range(u,w,m,n),p=0,S=f;p<S.length;p++)(g=S[p]).VSt&&(y=g.range(),T=e&&e.equals(y),_=e&&0!==a.Mf.Ut.getSpans(e,3).length,l?c&&h&&C.col===y.col&&C.colCount===y.colCount&&C.row>y.row&&e.col===y.col&&e.colCount===y.colCount&&e.row>y.row&&C&&y.contains(C.row,C.col,1,C.colCount)&&e&&y.containsRange(e)&&(a.PTt(g,y,C),d.ignoreFooterShiftIndex=g.footerIndex()):e&&(T||_)||(g.TTt=i,a.GTt(g,y,C,r,o,b),delete g.TTt))},a.prototype.GTt=function(t,n,e,r,i,o){var u,a,f,s,l,c,h,v,d,b,w,w,i,w,m,C,g,y,p,S,T,d,_,b,R,h,x,F,y,u=this,a=u.Mf,f=null,s=!1,l=n.row,c=n.col,h=n.rowCount,v=n.colCount,d=l+h-1,b=new O.Range(l,c,h,v);if(t.showFooter()){if(w=new O.Range(l+h-1,c,1,v),e.row===w.row&&e.col>=c&&e.col+e.colCount<=c+v)return;s=!0,b.rowCount--}if(i&&(w=t.showHeader()?h-1:h,i.push(new O.Range(l,c,w,v))),i=e.row,w=e.col,m=e.row+e.rowCount-1,C=e.col+e.colCount-1,g=l+h-1-(s?1:0),y=c+v-1,p=U,S=a.getRowCount(),T=b.contains(i-1,w)&&!b.contains(i,w),s||(T=T&&C<=y&&c<=w),d=b.contains(i,w-1)&&!b.contains(i,w)&&m<=d&&i>=n.row,_=b.contains(i,w)&&!b.contains(m,C)){if(b=Vt(g,m)-l+1,R=Vt(y,C)-c+1,y<C&&(h=I(a,new O.Range(l,1+y,h,C-y)))&&C>h.col&&(R=v),f=new O.Range(l,c,b,R),s&&(f.rowCount++,m++,g++),(p=g<m?I(a,new O.Range(g+1,c,f.row+f.rowCount-1,v)):p)&&0<(x=m-p.row+1)){if(I(a,new O.Range(S-Math.abs(x),c,Math.abs(x),v)))return void a.jT(6,H().Exp_TableAddRowNoEnoughRoom);!0!==o&&a.moveTo(p.row,c,f.row+f.rowCount,c,S-f.row-f.rowCount,v,W)}}else if(T&&!s){if(f=new O.Range(i,c,e.rowCount,v),(F=I(a,f,e))&&!e.containsRange(F))return}else if(d&&(f=new O.Range(l,w,n.rowCount,e.colCount),F=I(a,f,e))&&!e.containsRange(F))return;T&&!s&&kt(r)&&(t.useFooterDropDownList(!0),Fe(a,t)),f&&!n.containsRange(f)&&(y=n.union(f),u.UTt(t,y,o))},a.prototype.PTt=function(t,n,e){var r,i,o,u,n,a,i,r=this,i=n.row,o=n.col,u=n.rowCount,n=n.colCount,a;new O.Range(i+(t.showHeader()?1:0),o,u-(t.showHeader()?1:0),n).contains(e.row,e.col,1,e.colCount)&&(i=new O.Range(i,o,u+e.rowCount,n),r.UTt(t,i))},a.prototype.UTt=function(t,n,e){var r=this.Mf,i=r.getParent();i&&i.commandManager().execute({cmd:kn,sheetName:r.name(),tableName:t.name(),resizeToRange:n,ignoreEventSuspend:e})},a.prototype.HL=function(t,n,e){var r,i,o,u,o,a,f,s,l,c,h,v,d,b,w,o,m,C,g,y,p,S,T,_,R,x,F,_,S,r,y,p,p,r,m,g,r=this,i=this.Mf,o=i.options,u=o.isProtected,o=o.protectionOptions,a=!1!==o.allowSelectLockedCells,f=!1!==o.allowSelectUnlockedCells;if(!u||a||f){if(s=e.col,l=e.row,c=2,v=h=18,d=5,b=10,w=6,o=te.TABLE_SELECT,m=te.TABLE_CORNER_SELECT,C=te.TABLE_COL_SELECT,g=te.TABLE_ROW_SELECT,y=i.getActiveRowIndex(),p=i.getActiveColumnIndex(),-1===e.rowViewportIndex&&-1!==e.colViewportIndex&&(S=i.getCellRect(l,s,e.rowViewportIndex,e.colViewportIndex),(T=r.find(y,p))instanceof G)&&(_=i.Tb-i.frozenRowCount(),T.showHeader())&&y>=T.Ky&&y<T.Ky+T.Sx&&p>=T.iw&&p<T.iw+T.Tx&&T.Ky<_&&T.Ky+T.Sx>_&&e.col<T.iw+T.Tx&&e.col>=T.iw)if(t>S.x+5&&t<S.x+S.width-18&&n<S.height-5){for(R=i.getSelections(),x=0;x<R.length;x++)if(!((F=R[x]).col===e.col&&1===F.colCount&&F.row===T.Ky&&F.rowCount===T.Sx||F.col===e.col&&1===F.colCount&&-1===F.row&&F.rowCount===i.getRowCount()))return M(T,C,l,s,u,a,f)}else if(t>S.x+18)return M(T,"default",l,s,u,a,f);if(_=i.getCellRect(l,s),r.find(l,s)instanceof G&&-1!==e.colViewportIndex&&-1!==e.rowViewportIndex){if(S=!1,T=r.find(l,s),r=r.find(y,p),y=!0,1===(R=i.getSelections()).length&&(p=R[0]).row<=l&&p.row+p.rowCount>l&&p.col<=s&&p.col+p.colCount>s&&(y=!1),T===r&&(S=!0),s===T.iw&&l===T.Ky){if(y&&S&&(t<=_.x+2||n<=_.y+2))return M(T,o,l,s,u,a,f);if(t>_.x+2&&t<_.x+18&&n>_.y+2&&n<_.y+6)return M(T,m,l,s,u,a,f);if(t>_.x+18&&n>_.y+2&&n<_.y+6)return M(T,C,l,s,u,a,f);if(t>_.x+2&&t<_.x+18&&n>_.y+6)return M(T,g,l,s,u,a,f)}if(s===T.iw+T.Tx-1&&l===T.Ky){if(y&&S&&(t>=_.x+i.getColumnWidth(s)-2||n<=_.y+2))return M(T,o,l,s,u,a,f);if(t<_.x+i.getColumnWidth(s)-2&&n>_.y+2&&n<_.y+6)return M(T,C,l,s,u,a,f)}if(s===T.iw&&l===T.Ky+T.Sx-1){if(y&&S&&(t<=_.x+2||n>=_.y+i.getRowHeight(l)-2))return M(T,o,l,s,u,a,f);if(t>_.x+2&&t<_.x+18&&n<_.y+i.getRowHeight(l)-2)return M(T,g,l,s,u,a,f)}if(y&&S&&s>T.iw&&s<T.iw+T.Tx&&l===T.Ky&&n<=_.y+2)return M(T,o,l,s,u,a,f);if(s>T.iw&&s<T.iw+T.Tx&&l===T.Ky&&n>_.y+2&&n<_.y+6)return M(T,C,l,s,u,a,f);if(y&&S&&l>T.Ky&&l<T.Ky+T.Sx&&s===T.iw&&t<=_.x+2)return M(T,o,l,s,u,a,f);if(l>T.Ky&&l<T.Ky+T.Sx&&s===T.iw&&t>_.x+2&&t<_.x+18)return M(T,g,l,s,u,a,f);if(p=i.getColumnWidth(T.iw+T.Tx-1),r=i.getRowHeight(T.Ky+T.Sx-1),m=_.x+p,g=_.y+r,S&&(l>T.Ky&&l<T.Ky+T.Sx&&s===T.iw+T.Tx-1&&m-2<=t&&t<=m||s>T.iw&&s<T.iw+T.Tx&&l===T.Ky+T.Sx-1&&g-2<=n&&n<=g)){if(s===T.iw+T.Tx-1&&l===T.Ky+T.Sx-1&&g-10<=n&&m-10<=t)return B;if(y)return M(T,o,l,s,u,a,f)}}}return B},a.prototype.wR=function(t,n){var e,r,e,i,o,u,e=this,r=e.Mf;if(e.find(t,n)instanceof G){for(i=0,(e=e.find(t,n)).oL&&(i=1),o=0,e.jO&&(o=1);0<t&&0===r.getRowHeight(t-1);)t--;if(1===o&&n===e.iw&&t===e.Ky)return u=wt(r,e,!0),d(u,e.iw+e.Tx-1,u);if(n===e.iw&&t===e.Ky)return u=wt(r,e,!0),d(u,e.iw+e.Tx-1,u);if(t>e.Ky&&t<e.Ky+e.Sx-i&&n===e.iw)return t===e.Ky+o?(t=wt(r,e,!0),d(t,e.iw+e.Tx-1,t)):d(t-1,e.iw+e.Tx-1,t-1)}return null},a.prototype.xR=function(t,n){var e,r,e,i,o,u,u,a,f,s,l,c,c,h,a,v,e=this,r=e.Mf;if(e.find(t,n)instanceof G){for(i=0,(e=e.find(t,n)).oL&&(i=1),o=0,e.jO&&(o=1),u=r.getRowCount()-1;t+1<r.getRowCount()&&0===r.getRowHeight(t+1);)t++;if(u!==t&&n===e.iw+e.Tx-1&&t<e.Ky+e.Sx-i)return u=e.Ky+e.Sx,s=(a=e.iw)+(f=e.Tx)-1,l=d(t+1,e.iw,t+1),t===u-i-1&&(e.VSt?(c=Ct(r,e),1===i&&yt(r,e,u,c,a,s,1,!0,!1,!0)||(a=(h=(c=I(r,new O.Range(u,a,c-u+1,s-a+1)))&&c.row)===u,u!==r.getRowCount()&&(a?Re:xe)(r,e,t,1,!0))):l=d(t,1+s,t)),l;if(r.getRowCount()-1===t&&n===e.iw+e.Tx-1&&0===i){for(v=e.Ky+o;v+1<r.getRowCount()&&0===r.getRowHeight(v);)v++;return v+1===r.getRowCount()&&0===r.getRowHeight(v)?d(e.Ky,e.iw,e.Ky):d(v,e.iw,v)}}return null},a.prototype.fR=function(t,n){var e,r,e,i,o,u,e=this,r=e.Mf;if(e.find(t,n)instanceof G){for(i=0,(e=e.find(t,n)).oL&&(i=1),o=0,e.jO&&(o=1);0<n&&0===r.getColumnWidth(n-1);)n--;if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:u=mt(r,e),leadingCellCol:u,row:e.Ky+e.Sx-1-i};if(n===e.iw&&(t===e.Ky||t===e.Ky+o))return{col:u=mt(r,e),leadingCellCol:u,row:e.Ky+e.Sx-1-i};if(n>e.iw&&n<e.iw+e.Tx&&(t===e.Ky||t===e.Ky+o))return n===e.iw?{col:n=mt(r,e),leadingCellCol:n+1,row:e.Ky+e.Sx-1-i}:{col:n-1,leadingCellCol:n-1,row:e.Ky+e.Sx-1-i}}return null},a.prototype.SB=function(){for(var t,n,e,r,i,t,n=this.U3,e=n.length,i=0;i<e;i++)(r=n[i]).w5t()},a.prototype.cL=function(t,n){for(var e,r,i,o,u,a,f,a,f,e,r=this.U3,i=r.length,o=0;o<i;o++)u=r[o],t?(a=u.Ky,f=u.Ky+u.Sx-1,a<=n&&n<=f&&u.cL(0)):(a=u.iw,f=u.iw+u.Tx-1,a<=n&&n<=f&&u.cL(0))},a.prototype.AJ=function(t,n,e,r,i){for(var o,u,a,f,s,o=this.AB(t,n,e,r),u=[],a=0,f=o.length;a<f;a++)s=o[a].dataRange(),i?s.rowCount+=e:s.colCount+=r,u.push(s);return u},oe=a,T.TableManager=oe,(r=ue=T.TableRemoveOptions||(T.TableRemoveOptions={}))[r.none=0]="none",r[r.keepData=1]="keepData",r[r.keepStyle=2]="keepStyle",O.GC$.extend(O.Y8.prototype,{D5t:function(t,n){var e,r,r,e,r=this.G8;r&&(r.tableChanges||(r.tableChanges=[]),delete(r=r.tableChanges).isRestored,r.push({type:"changeTableManager",table:t,oldTableManager:n}))},YSt:function(t,n,e,r){var i,o,o,i,o=this.G8;o&&(o.tableChanges||(o.tableChanges=[]),delete(o=o.tableChanges).isRestored,o.push({type:Un,table:t,name:n,value:e,newValue:r}))},DTt:function(t,n,e){var r,i,i,r,r=this,i=r.G8;i&&(i.tableChanges||(i.tableChanges=[]),i=i.tableChanges,r=r.QSt,delete i.isRestored,i.push({type:Dn,tableList:r.U3.slice(),changedTables:t,addedTables:n,changeType:e}))},A5t:function(t,n,e,r,i){var o,u,u,o,u=this.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(u=u.tableChanges).isRestored,u.push({tableName:t.name(),type:Bn,tableColumn:n,name:e,value:r,newValue:i}))},HTt:function(t,n,e){var r,i,o,r,r,r=this,i,o=t.getValue(n,e).value,r=r.G8;r&&(r.tableChanges||(r.tableChanges=[]),delete(r=r.tableChanges).isRestored,r.push({type:En,bindingManager:t,row:n,col:e,oldValue:o}))},B5t:function(t,n,e,r,i){var o,u,u,o,u=this.G8;u&&(u.tableChanges||(u.tableChanges=[]),delete(u=u.tableChanges).isRestored,u.push({type:Vn,table:t,key:r,row:n,count:e,stateType:i}))},_Tt:function(t,n,e){var r,i,o,r,i=this.G8;i&&(i.tableExpressionChanges||(i.tableExpressionChanges=[]),(o=i.tableExpressionChanges).push({type:Jn,table:t,expression:n,col:e}))},ETt:function(t,n,e,r){var i,o,u,i,o=this.G8;o&&(o.sheetExpressionChanges||(o.sheetExpressionChanges=[]),(u=o.sheetExpressionChanges).push({type:Pn,table:t,expression:n,row:e,col:r}))},zTt:function(h){var v,d,t,n,e,r,i;if(h){for(v=null,Ie(d=this.QSt,h._bindingChanges,!0),t=function(t){var e,n,r,i,o,u,a,f,s,f,l,c,e=h[t],n=void 0;switch(e.type){case Dn:if(2===e.changeType)for(r=function(t){var n,t,n=e.changedTables[t],t=d.U3.findIndex(function(t){return t.name===n.name});0<=t&&d.U3.splice(t,1)},i=0;i<e.changedTables.length;i++)r(i);else if(1===e.changeType&&e.addedTables)for(o=e.addedTables,i=0;i<o.length;i++)(u=o[i])&&"Object"===u.constructor.name&&(u=Me(d,u),d.U3.push(u));break;case Bn:n=d.findByName(e.tableName),a=e.tableColumn,"name"===e.name&&(a=e.value),0<=(f=n.BSt.findIndex(function(t){return t.name()===a}))&&((s=n.BSt[f])[e.name](e.newValue),"name"===e.name)&&n.I5t(a,e.newValue,f);break;case Un:(n=e.table)?(f=e.name,l=e.newValue,f===V?(n.Ky=l.row,n.iw=l.col,n.Sx=l.rowCount,n.Tx=l.colCount):f===Gn?(l=l&&l.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new J).fromJSON(t),n):t}),n.BSt=l):f===_n?(l=l&&l.map(function(t){var n;return t&&"Object"===t.constructor.name?((n=new O.Style).fromJSON(t,!1,null),n):t}),n.OSt=l):("style"===f&&l&&l.buildInName&&(l=C.TableThemes[l.buildInName.toLowerCase()]),n[f](l))):"name"===e.name&&(n=d.findByName(e.value))&&n.name(e.newValue);break;case"changeTableManager":break;case En:(c=Le(d,e.bindingManager)).setValue(e.row,e.col,e.oldValue);break;case Vn:v=n=e.table,Ne(n="Object"===n.constructor.name?d.findByName(n.name):n,e.row,e.count,e.key,e.stateType)}},n=0;n<h.length;n++)t(n);if(v)for(v.LSt&&v.LSt.refresh(),e=this.Mf.slicers&&this.Mf.slicers.all(),n=0;n<e.length;n++)if((r=e[n]).LSt===v.LSt&&r.gmi)for(i=0;i<r.gmi.length;i++)r.gmi[i].onDataChanged()}},VTt:function(t){var n,e,r,i,o,u,a,a,f,s,s;if(t)for(n=this.QSt,e=void 0,r=!1,Ie(n,t.bindingChanges),i=t.length-1;0<=i;i--)switch(u=void 0,(o=t[i]).type){case Dn:a=o.changedTables,n.U3=o.tableList,a&&0<a.length&&a.forEach(function(t){t&&(r=!0,t.w5t(),t.qSt())});break;case Bn:o.tableColumn[o.name](o.value);break;case Un:u=o.table,a=o.name,f=o.value,a===V?(s=u.footerIndex(),u.Ky=f.row,u.iw=f.col,u.Sx=f.rowCount,u.Tx=f.colCount,u.LSt&&ze(e,u.LSt),r&&-1!==s&&u.u5t(s)):a===Gn?u.BSt=f:a===_n?u.OSt=f:u[a](f),u.cL(0);break;case"changeTableManager":u=o.table,s=o.oldTableManager,u.k5t(s);break;case En:o.bindingManager.setValue(o.row,o.col,o.oldValue);break;case Vn:Ne(o.table,o.row,o.count,o.key,o.stateType),e=o}},YTt:function(t){var n,e,r,i,r,o,r;if(t){for(n=void 0,e=t.length-1;0<=e;e--)(r=t[e]).type===Jn&&(n=r.table,i=r.expression,r=r.col,o=void 0,o=n.BSt[r].footerFormula())&&-1<(r=At(o))&&(o.arguments[r]=i);n&&n.w5t()}},ZTt:function(t){var n,e,r,i,o;if(t)for(n=t.length-1;0<=n;n--)(e=t[n]).type===Pn&&(r=e.expression,i=e.row,o=e.col,e.table.CTt(i,o,r))}}),O.Y8.ch(jn,{priority:7e3,init:function(){this.QSt=new oe(this.Mf)},clearPendingChanges:function(t){var n=this.tables;n&&n.$St(t.tableList)},undoAddRows:function(t){var n,e,n,r,i,o,n=t.sheetArea;!A(n)&&n!==O.SheetArea.viewport||(n=(e=this).Mf,r=t.row,i=t.rowCount,(o=n.tables.AB(r,-1,i,-1)).forEach(function(t){t.x4t(r,i,St(!0))}))},getValue:function(t){var n,e,r,i,o,r,n=t.row,e=t.col,r=t.sheetArea,i=this.Mf.tables;3===r&&i&&(o=i.find(n,e))&&(r=i.Sl(n,e),t.isValueGet=r.e5t,t.value=r.y4)},setValue:function(t){var n,e,r,i,o,u,i,a,n=t.row,e=t.col,r=t.value,i=t.sheetArea,o=this.Mf.tables;3===i&&o&&(u=o.find(n,e))&&(a=void 0,(i=t.changes)&&!(a=i.tableChanges)&&(i.tableChanges=[]),t.isValueSet=o.Kbt(n,e,r))},applyChanges:function(t){var n,e,t,r,i,e,n=this,e=t.changes,t=t.isUndo;e&&(r=e.tableChanges,i=e.tableExpressionChanges,e=e.sheetExpressionChanges,r&&(Be(n.QSt,r),t?n.VTt(r):n.zTt(r)),t)&&(i&&n.YTt(i),e)&&n.ZTt(e),n.QSt.dl()},undo:function(t){var n=t.tableChanges,e=t.tableExpressionChanges,t=t.sheetExpressionChanges;n&&!n.isRestored&&this.VTt(n),e&&this.YTt(e),t&&this.ZTt(t),this.QSt.dl()}}),O.Workbook.ch(jn,{init:function(){O.Commands.D4t(this.commandManager())},onCultureChanged:function(){H()},preFromSJSFormat:function(t,n,e){var e,e,t,r,i,o,u,a,f,s,e=e&&!1===e.includeStyles;if(!e&&(t=(e=t.styles)&&e.tableStyles,r=n.styleManager,t)&&(r.addDefaultStyleName("defaultTableStyle",t.defaultTableStyle||"TableStyleMedium2"),0<(i=tt(t.count,0)))&&(o=q(t,"tableStyle")))for(u=0,a=o;u<a.length;u++)(f=a[u])&&0==+f.pivot&&0<f.count&&(s=new C.TableTheme).yh(f,r)},preToSJSFormat:function(t,n,e){var r,e,i,o,u,a,f,s,l,r=e&&e.fileType===O.OpenSaveFileType.excel,e=e&&!1===e.includeStyles;if(r&&!e)for(o=0,u=i=this.mp;o<u.length;o++)s=(f=(a=u[o]).Mf).getRowCount(),l=f.getColumnCount(),(a._gi===O.SheetType.tableSheet||a._gi===O.SheetType.ganttSheet)&&0<s&&0<l&&f.tables.WB(new G(f.name().replace(/ /g,"")+"Table",0,0,s,l,a.hl,{showHeader:!1}))},wh:function(t,n,e){var r,i,o,u,a,f,s,l,c,h,v,d,b,w,m,m,r=this,i=t.tables,o=n&&n.styleManager,u=e&&e.fileType===O.OpenSaveFileType.excel,a=e&&!1===e.includeStyles;if(!a)for(f={},l=(s=0,O.Ap)(r);s<l;s++)if((c=(0,O.Tp)(r,s))&&(v=(h=c.tables)&&h.all())&&0<v.length)for(d=0,b=v;d<b.length;d++)w=b[d],m=(i=i||(t.tables={}))[O.XFileConstants.du+w._id]={},w.wh(m,t,n,e,f),(m=w.style())&&!m.builtInName()&&o.addTableStyle(m.wh(o)),u&&!a&&c.NMi&&h.DK(w)}})},"./dist/plugins/table/table.ns.js":function(t,n,e){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var e=e("./dist/plugins/table/table.res.en.js");n.SR={en:e}},"./dist/plugins/table/table.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Table_Var=n.Table_StdDev=n.Table_Sum=n.Table_Min=n.Table_Max=n.Table_Count_Numbers=n.Table_Count=n.Table_Average=n.Table_None=n.Table_Total=n.Exp_TableAddRowNoEnoughRoom=n.Exp_TableAddRowIntersectTable=n.Exp_TableAddRowIntersectSpan=n.Exp_TableDeleteCountInvalid=n.Exp_ColParamOutOfRange=n.Exp_RowParamOutOfRange=n.Exp_TableResizeToTable=n.Exp_TableResizeWithHidden=n.Exp_TableResizeWithFilter=n.Exp_TableResizeToSpan=n.Exp_TableResizeInvalidRange=n.Exp_ArrayFormulaTable=n.Exp_TableResizeOutOfRange=n.Exp_TableMoveOutOfRange=n.Exp_TableDataSourceNullError=n.Exp_TableRangeHasFilterError=n.Exp_TableHasSameNameError=n.Exp_TableIntersectError=n.Exp_TableInvalidColumn=n.Exp_TableInvalidRow=n.Exp_TableNameInvalid=n.Exp_TableEmptyNameError=n.Exp_DragDropChangePartOfTable=n.Exp_DragDropShiftTableCell=void 0,n.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",n.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",n.Exp_TableEmptyNameError="The table name cannot be empty.",n.Exp_TableNameInvalid="The table name is not valid.",n.Exp_TableInvalidRow="Invalid row index or row count.",n.Exp_TableInvalidColumn="Invalid column index or column count.",n.Exp_TableIntersectError="The tables cannot be intersected.",n.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",n.Exp_TableRangeHasFilterError="The current table range contains a filter range.",n.Exp_TableDataSourceNullError="Table datasource cannot be null.",n.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",n.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",n.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",n.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",n.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",n.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",n.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",n.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",n.Exp_RowParamOutOfRange="The param row out of data range of table.",n.Exp_ColParamOutOfRange="The param col out of data range of table.",n.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",n.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",n.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",n.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",n.Table_Total="Total",n.Table_None="None",n.Table_Average="Average",n.Table_Count="Count",n.Table_Count_Numbers="Count Numbers",n.Table_Max="Max",n.Table_Min="Min",n.Table_Sum="Sum",n.Table_StdDev="StdDev",n.Table_Var="Var"},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},Bindings:function(t){t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},Filters:function(t){t.exports=GC.Spread.Sheets.Filter}},r={},t=i("./dist/plugins/table/table.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Tables=t}();