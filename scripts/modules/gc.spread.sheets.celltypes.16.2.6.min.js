/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var n,e,t;function s(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,s)),i.exports}n={"./dist/plugins/celltype/buttoncelltype.js":function(t,i,n){var e,s,d,c,l,o,u,D,n,s,r,h,a,g,M,v,w,I,f,N,b,A;function y(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,g,a,e),s=t.getValueForKey(i,n,M,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,M,a,e))}function j(){var t,n,t=A.call(this)||this;return t.typeName="6",n=t,r(f,function(t,i){n["_"+t]=i}),t}e=this&&this.__extends||(b=function(t,i){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}b(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Button=void 0,s=n("Common"),d=n("Core"),c=d.Events.SelectionChanged,l=s.Common.lt.ht,o=d.mt.vi,u=d.CellTypes.Context,D=d.CellTypes.Text,n=d.CellTypes.Base,s=d.GC$,r=s.each,a=void 0,g="_isFirstMouseUp",M="_mouseupToken",v="#707070",w="#34B4E3",I=".buttonCellType",f={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:h=null,buttonState:0},e(j,A=n),j.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,l,h,g,M,I,f,a,l,a,N;t&&(a=(u=this)._marginLeft,l=u._marginTop,h=n+a,g=e+l,M=s-a-u._marginRight,I=o-l-u._marginBottom,0<M-2)&&0<I-2&&(f=n<h+M&&h<n+s&&e<g+I&&g<e+o)&&(t.save(),(h<n||n+s<h+M||g<e||e+o<g+I)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.strokeStyle!==(a=v)&&(t.strokeStyle=a),t.strokeRect(h+.5,g+.5,M-1,I-1),l=void 0,a=u._buttonState,N=u._text,l=2===a?w:(l=u._buttonBackColor)||{degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]},t.fillStyle!==l&&(t.fillStyle=l),d.W.setFillStyle(t,l,n,e,s,o,function(){t.fillRect(h+1,g+1,M-2,I-2)}),t.restore(),N)&&D.prototype.paintValue.call(u,t,N,h,g,M,I,r,c)},j.prototype.getText=function(t,i){return t},j.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},j.prototype.getHitInfo=function(t,i,n,e,s){var o,r,c,u,a,o,e,o=this;return s&&(r=s.sheetArea,l(r)||3===r)&&e?(c=e.x+o._marginLeft,u=e.x+e.width-o._marginRight,a=e.y+o._marginTop,o=e.y+e.height-o._marginBottom,e={x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:r,sheet:s.sheet,cellStyle:n},c<=t&&t<=u&&a<=i&&i<=o&&(e.isReservedLocation=!0),e):h},j.prototype.processMouseDown=function(t){var i,n,i=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||i.pG||(i.pG=!0,i._buttonState=2,n.repaint(t.cellRect),0))},j.prototype.processMouseUp=function(t){var i,n,e,s,o,r,t,i=this,n=t&&t.sheet;if(i.pG&&n&&t.isReservedLocation){if(i._buttonState=0,n.repaint(t.cellRect),i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(r=n.Ut.getValueForKey(e,s,g,o)))return i.j3(n,e,s,o),n.Ut.do("setValueForKey",e,s,g,!0,o),t=setTimeout(function(){y(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,M,t,o),!0;y(n,e,s,o)}return!1},j.prototype.processMouseLeave=function(t){var i,n,i=this,n=t&&t.sheet;n&&i.pG&&(i._buttonState=0,n.repaint(t.cellRect),i.pG=!1)},j.prototype.processKeyDown=function(t,i){var n,e,s,n=i.sheet,e=this;return!(!n||e.bG)&&(s=n.getCellRect(i.row,i.col),e._buttonState=2,n.repaint(s),n.D3(c+I,function(){n._3(c+I),e.bG=!1,e._buttonState=0,n.repaint(s)}),e.bG=!0)},j.prototype.processKeyUp=function(t,i){var n,e,s,o,r,n=i.sheet,e=this;return!(!n||!e.bG||(s=i.row,o=i.col,r=n.getCellRect(s,o),e._buttonState=0,n.repaint(r),n._3(c+I),e.j3(n,s,o,i.sheetArea),e.bG=!1))},j.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},j.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,r,o=this,r;return u.Bt(t,o._text,n,e,s)+o._marginLeft+o._marginRight},j.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,r,o=this,r;return u.tn(t,o._text,n,e,s)+o._marginTop+o._marginBottom},j.prototype.QD=function(t){this.isReservedKey(t)&&o(t)},j.prototype.isImeAware=function(t){return!1},j.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return r(f,function(t,i){"buttonState"!==t&&(s=n["_"+t])!==i&&(e[t]=s)}),e},j.prototype.fromJSON=function(n){var e=this;r(f,function(t){var i=n[t];l(i)||(e["_"+t]=i)})},j.prototype.jn=function(t){},j.prototype.Ke=function(){},N=j,i.Button=N,r(f,function(i){N.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),d.CellTypes.ti[6]=N},"./dist/plugins/celltype/cellbuttons.js":function(n,t,i){var j,t,i,A,o,r,Y,y,C,u,a,H,W,V,J,X,N,d,g,F,z,M,_,m,K,T,q,s,D,v,w,b,p,x,L,S,l,I,h,f,t,$,k,e,i;function tt(t){switch(t){case p:return j.ButtonPosition.left;case x:return j.ButtonPosition.right;case L:return j.ButtonPosition.leftOfText;case S:return j.ButtonPosition.rightOfText}}function it(t){switch(t){case j.ButtonPosition.left:return p;case j.ButtonPosition.right:return x;case j.ButtonPosition.leftOfText:return L;case j.ButtonPosition.rightOfText:return S}}function nt(t){for(var i,n,e,i=t.split(" "),e=0;e<i.length;e++)if(0<=i[e].indexOf(s)){n=i[e];break}switch(n){case D:return p;case v:return x;case w:return L;case b:return S}}function et(t){switch(t){case p:return D;case x:return v;case L:return w;case S:return b}}function st(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,N,y,e),s=t.getValueForKey(i,n,d,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,d,y,e))}function ot(t,i,n){var e,s;switch(n){case k.topLeft:return new j.Rect(t.x,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),new j.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.topRight:return e=t.width-i.width,e=Math.max(0,e),new j.Rect(t.x+e,t.y,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleLeft:return s=(t.height-i.height)/2,s=Math.max(0,s),new j.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.MiddleRight:return e=t.width-i.width,e=Math.max(0,e),s=(t.height-i.height)/2,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomLeft:return s=t.height-i.height,s=Math.max(0,s),new j.Rect(t.x,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomCenter:return e=(t.width-i.width)/2,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height));case k.bottomRight:return e=t.width-i.width,e=Math.max(0,e),s=t.height-i.height,s=Math.max(0,s),new j.Rect(t.x+e,t.y+s,Math.min(i.width,t.width),Math.min(i.height,t.height))}}function rt(t,i,n){for(var e,s,e=[],s=0;s<t.length;s++)e.push({width:B(t[s].button,i,n),height:yt(t[s].button,n)});return e}function O(t,i,n,e,s,o){for(var r,c,u,a,l,h,g,r=[],c=[],u=0;u<t.length;u++)a=i[t[u].index],A(a)?c.push(t[u]):r.push(a);for(l=at(r),u=0;u<c.length;u++)h=B(c[u].button,n,e),(g=!o||l.width+h<=o.width)&&(l.width+=h);return l.height=l.height||(o?o.height:0),l}function ct(t,i,n,e,s,o,r,c,u,a,l,h){var n,g,c,i,r,M,n,a,s,I,f,N,n=Q(i,n,r,c,!0,[t]);if(0<n.length){switch(G(n,i,r),t){case j.ButtonPosition.left:g=D;break;case j.ButtonPosition.right:g=v;break;case j.ButtonPosition.leftOfText:g=w;break;case j.ButtonPosition.rightOfText:g=b;break;default:return}switch(c=O(n,a,s,e,!0,o),i="0",r=Y(),((M=j.mt.Tt).mozilla||1<r)&&(i="1px"),n=c.width,a=c.height,s=it(t),A(u.canvasSizes)&&(u.canvasSizes={}),(I=u.canvasSizes)[s]={width:n,height:a},N=ut(g,n,a,f={width:n+"px",height:a+"px",display:"block",position:"absolute",bottom:i,overflow:"hidden",paddingTop:"0"}),t){case j.ButtonPosition.left:N.style.left="0";break;case j.ButtonPosition.right:N.style.right="0";break;case j.ButtonPosition.leftOfText:N.style.left=I[L].width+"px";break;case j.ButtonPosition.rightOfText:N.style.right=I[S].width+"px";break;default:return}l.appendChild(N)}}function ut(t,i,n,e){var s,o,s=document.createElement("canvas");for(o in s.className=t+" "+q,e)e.hasOwnProperty(o)&&(s.style[o]=e[o]);return s.width=i,s.height=n,s}function at(t){var i,n,e,s,o;if(t.length<=0)return new j.Rect(0,0,0,0);for(i=t[0].x,n=t[0].y,e=t[0].x+t[0].width,s=t[0].y+t[0].height,o=1;o<t.length;o++)i=Math.min(i,t[o].x),n=Math.min(n,t[o].y),e=Math.max(e,t[o].x+t[o].width),s=Math.max(s,t[o].y+t[o].height);return new j.Rect(i,n,e-i,s-n)}function lt(t){var i,n,i=j.mt.Tt,n=Y();if(1!==n)return i.mozilla?Math.ceil(t*n):Math.round(t*n)}function Z(t,i,n,e,s,o,r,c){var u,r,a,l,h,g,M;if(!A(t))for(A(c[n])&&(c[n]={}),G(i,e.sheet,e.row),u=t.getContext("2d"),r=O(i,r,s,e,!0),u.setTransform(parseFloat(t.style.width)/r.width,0,0,parseFloat(t.style.height)/r.height,0,0),h=new j.Rect(l=a=0,0,parseFloat(t.style.width),parseFloat(t.style.height)),g=0;g<i.length&&(M=E(u,a,0,B(i[g].button,s,e),e.sheet.getRowHeight(e.row),i[g].button,s,e,o,c[n],i[g].index,h),!A(M));g++)a+=M.width}function ht(n,e,s,o,r,t){var t,i,i,i,i;A(t.eventListeners)&&(t.eventListeners={}),A(t.eventListeners[e])&&(t.eventListeners[e]={}),i=(t=t.eventListeners[e]).mouseDownListener=function(t){var i;zt(c({x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousedown",i),i=t.mouseUpListener=function(t){var i;mt(c({x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mouseup",i),i=t.mouseMoveListener=function(t){var i;Tt(c({x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,n)},n.addEventListener("mousemove",i),i=t.mouseLeaveListener=function(t){var t={x:t.offsetX,y:t.offsetY,context:s,cellRect:r,cellStyle:o,buttonArea:e};t.x<0&&(t.x=0),t.x>=parseFloat(n.style.width)&&(t.x=parseFloat(n.style.width)-1),pt(c(t,!0),!0,n)},n.addEventListener("mouseleave",i)}function gt(t,i,n,e,s,o,r,c,u,a,l,h){var i,g,M,n,I,f,N,d,i=Q(i,n,r,c,!0,[t]);if(0<i.length){switch(M=g=void 0,t){case j.ButtonPosition.left:g=D,M=p;break;case j.ButtonPosition.right:g=v,M=x;break;case j.ButtonPosition.leftOfText:g=w,M=L;break;case j.ButtonPosition.rightOfText:g=b,M=S;break;default:return}if(n=h.querySelector("."+g),!A(n)){switch(I=parseFloat(n.style.width),f=o.options.contentRect,N=o.options.leftExternalRect,d=o.options.rightExternalRect,t){case j.ButtonPosition.left:f.x+=I,f.width-=I;break;case j.ButtonPosition.right:f.width-=I;break;case j.ButtonPosition.leftOfText:N.width+=I;break;case j.ButtonPosition.rightOfText:d.width+=I}Z(n,i,M,e,s,u,a,l),ht(n,M,e,s,o.options.cellRect,u)}}}function Mt(t,i,n,e,s,o,r){var i,n,c,u,a,l,h,i=Q(i,n,e,s,!0,[t]);if(i&&0<i.length)switch(n=it(t),c=o&&o[n]&&o[n].width||0,u=r.contentContainer,a=r.contentRect,l=r.leftExternalRect,h=r.rightExternalRect,t){case j.ButtonPosition.left:ft(u,"left",c),a.x+=c,a.width-=c;break;case j.ButtonPosition.leftOfText:ft(u,"left",c),l.width+=c;break;case j.ButtonPosition.right:a.width-=c;break;case j.ButtonPosition.rightOfText:h.width+=c}}function It(t){return+t.replace("px","")||0}function ft(t,i,n){var e=0;t.style[i]&&(e=It(t.style[i])),t.style[i]="".concat((e+=n)-1,"px")}function Nt(t,i){A(i.mouseDownListener)||t.removeEventListener("mousedown",i.mouseDownListener),A(i.mouseUpListener)||t.removeEventListener("mouseup",i.mouseUpListener),A(i.mouseMoveListener)||t.removeEventListener("mousemove",i.mouseMoveListener),A(i.mouseLeaveListener)||t.removeEventListener("mouseleave",i.mouseLeaveListener)}function G(t,i,n){for(var e,s,o,e=i.BO(),s=0;s<t.length;s++)(o=Ot(t[s].button,n))&&e.Rt(o)}function U(t){var i=t.isPrinting,t=t.printZoomFactor;return i&&"number"==typeof t&&1!==t}function dt(t,i){return 2===i.columnHeaderFitMode&&i.cornerX&&(t.width=i.cornerX-t.x,t.height=t.height-(i.cornerY-t.y)-1,t.y=i.cornerY-1),t}function Dt(t,i,n){switch(n){case j.ButtonPosition.leftOfText:return new j.Rect(t.x,t.y,i.x-t.x,t.height);case j.ButtonPosition.rightOfText:return new j.Rect(i.x+i.width,t.y,t.x+t.width-i.x-i.width,t.height)}}function vt(t,i,n,e,s,o,r){var c,u,a,l,h,g,M,I,f;if(t&&!(i.length<=0)){if(s=Lt(s),G(i,c=o.sheet,o.row),2===o.columnHeaderFitMode&&o.cornerX&&(u=o.cellRect.x+o.cellRect.width-(n.x+n.width),(n=n.clone()).width=o.cornerX-n.x-u,n.height=n.height-(o.cornerY-n.y)-1,n.y=o.cornerY-1),a=Dt(n,e,r?j.ButtonPosition.leftOfText:j.ButtonPosition.rightOfText),t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),t.beginPath(),l=P(c,o.row,o.col,o.sheetArea),h=Lt(s),A(l.layout)&&(l.layout={}),r){for(g=a.x+a.width,M=i.length-1;0<=M&&(f=E(t,g-=I=B(i[M].button,h,o),n.y,B(i[M].button,h,o),a.height,i[M].button,h,o,l,l.layout,i[M].index,n),!A(f));M--);e.x=g}else{for(g=a.x,M=0;M<i.length&&(f=E(t,g,n.y,B(i[M].button,h,o),a.height,i[M].button,h,o,l,l.layout,i[M].index,n),!A(f));M++)g+=f.width;e.width=g-e.x}t.restore()}}function wt(t,i,n,e,s){if(!(t+n<s.x||t>s.x+s.width||i+e<s.y||i>s.y+s.height))return t+n>s.x+s.width&&(n=s.x+s.width-t),i+e>s.y+s.height&&(e=s.y+s.height-i),t<s.x&&(t=s.x),i<s.y&&(i=s.y),new j.Rect(t,i,n,e)}function E(t,i,n,e,s,o,r,c,u,a,l,h){var g,u,g=M;if(u.buttonDownIndex===l?g=_:u.buttonHoverIndex===l&&(g=m),u=wt(i,n,e,s,h),!A(u))return bt(t,u.x,u.y,u.width,u.height,o,r,c,g,h),a[l]=new j.Rect(u.x,u.y,u.width,u.height),a[l].offsetX=u.x-h.x,a[l].offsetY=u.y-h.y,c.cornerY&&(a[l].offsetY+=c.cornerY),a[l]}function bt(t,i,n,e,s,o,r,c,u,a){var l,h,g,g,M,M,I,M,f,l,l,u,I,l,f,N,d,D,v,D,i,D,w,n,e,b;t.save(),t.beginPath(),l=o.useButtonStyle,h=U(c),g=c.printZoomFactor,g=h?g:c.sheet.zoom(),i+=M=l?z*g:0,n+=M,e-=2*M,s-=2*M,M=H,I=o.hoverBackColor||J,M&&t.strokeStyle!==M&&(t.strokeStyle=M),l&&t.strokeRect(i+.5,n+.5,e-1,s-1),M=Zt(o.enabled,c.row),l?f=!1===o.enabled?o.buttonBackColor||V:u===_?W:u===m||c.visualState===j.VisualState.hover?I:((l=t.createLinearGradient(i+e/2,n,i+e/2,n+s)).addColorStop(.125,"#F6FAFB"),l.addColorStop(1,"#D2DBEB"),o.buttonBackColor||l):(f=o.buttonBackColor||"white",u===m&&(o.enabled||A(o.enabled))&&(f=I)),(l=r.font)&&t.font!==l&&(t.font=l),t.fillStyle!==f&&(t.fillStyle=f),t.rect(i+=1,n+=1,e-=2,s-=2),t.clip(),t.beginPath(),t.fillRect(i,n,e,s),u=new j.Rect(i,n,e,s),I=new j.Rect(i,n,e,s),l=F*g,f=Ot(o,c.row),o.caption&&f&&(N=(T.Bt(C,o.caption,r,g,c)+2*z)*g,d=R(o)*g,D=new j.Rect(0,0,N+d+l,s),D=ot(v=new j.Rect(i,n,e,s),D,k.MiddleCenter),o.captionAlign===j.CaptionAlignment.left?(I=new j.Rect(D.x,n,N,s),u=D.x+N+l<i+e-2?new j.Rect(D.x+N+l,n,Math.max(0,d),s):new j.Rect(0,0,0,0)):(u=new j.Rect(D.x,n,Math.min(d,e),s),I=D.x+d+l<i+e-2?new j.Rect(D.x+d+l,n,Math.min(e-2-d-l,N),s):new j.Rect(0,0,0,0))),o.caption&&(i=(T.Bt(C,o.caption,r,g,c)+2*z)*g,D=(T.tn(C,o.caption,r,g,c)+2*z)*g,n=ot(I,w=new j.Rect(0,0,i,D),k.MiddleCenter),e=new K,r=r.clone(),!1===M&&(r.foreColor=X),r.cellButtons=y,r.decoration=y,e.paintValue(t,o.caption,n.x,n.y-(b=h?0:2),n.width,n.height,r,c)),f&&At(t,o,u.x,u.y,u.width,u.height,f,c,a),t.restore()}function At(t,i,n,e,s,o,r,c,u){var a,l,c,a,n,e,h,s,o,a,g,i,M;t.save(),t.rect(n+2,e+2,s-4,o-4),t.clip(),t.beginPath(),(l=(a=c.sheet).BO()).jt(r)?l.qh(r)&&(c=U(c)?c.printZoomFactor:a.zoom(),a=new j.Rect(n,e,s,o),n=R(i)-2,e=jt(i)-2,s=ot(a,h=new j.Rect(0,0,n*c,e*c),k.MiddleCenter),a=(o=l.Ot(r)).width,g=o.height,j.mt.Tt.msie&&i.imageType&&(g=i.imageType===j.ButtonImageType.custom?(I[r]||(o.style.position="absolute",o.style.left="-10000px",o.style.top="-100000px",document.body.appendChild(o),I[r]={width:o.width,height:o.height},document.body.removeChild(o)),a=I[r].width,I[r].height):a=12),u&&j.mt.Tt.msie&&s.x+s.width>u.x+u.width?0<(i=u.x+u.width-s.x)&&t.drawImage(o,0,0,i*(M=a/(n*c)),g,s.x,s.y,i,e*c):t.drawImage(o,0,0,a,g,s.x,s.y,n*c,e*c)):l.Rt(r),t.restore()}function B(t,i,n,e){var s,o,i,r,c,n;return void 0===e&&(e=!0),s=U(n)?n.printZoomFactor:n.sheet.zoom(),o=2*z+3,A(t.width)?(i=T.Bt(C,t.caption,i,s,n),r=t.useButtonStyle,(c=Ot(t,n.row))&&(i=R(t)+i,o=(r?o:0)+F),e?(i+o+7)*s:i+o+7):(n=u(1,t.width),isNaN(n)&&(n=1),e?n*s:n)}function yt(t,i,n){var e,s,e,i,t;return void 0===n&&(n=!0),e=i.sheet,s=U(i)?i.printZoomFactor:e.zoom(),e=e.getRowHeight(i.row),i=t.imageSize?t.imageSize.height:C,t=u(1,i||e),isNaN(t)&&(t=1),n?t*s:t}function Q(t,i,n,e,s,o){var r,c,u,a,l,h,r=[];if(!i||0===i.length)return[];for(c=!1,u=t.Ut.getValueForKey(n,e,g),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===e&&!0!==u&&(c=!0),a=0;a<i.length;a++)if(l=i[a].visible,!s||!i[a].i4i)for(h=0;h<o.length;h++)(i[a].position===o[h]||A(i[a].position)&&o[h]===j.ButtonPosition.right)&&(l&&"function"==typeof l&&l(n)||i[a].visibility===j.ButtonVisibility.onEditing&&s||i[a].visibility!==j.ButtonVisibility.onEditing&&c||i[a].visibility===j.ButtonVisibility.always||A(i[a].visibility))&&r.push({index:a,button:i[a]});return r}function R(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.width&&(i=a(t.imageSize.width)),"number"==typeof t.imageSize.width)?t.imageSize.width:i)===C||isNaN(i)||i<0?16:i}function jt(t){var i;return i=(i=t.imageSize&&("string"==typeof t.imageSize.height&&(i=a(t.imageSize.height)),"number"==typeof t.imageSize.height)?t.imageSize.height:i)===C||isNaN(i)||i<0?16:i}function P(t,i,n,e,s){var o,r,o={isMouseDownReservedLocation:!1};return e===j.SheetArea.corner?o:((r=t.Ut.getValueForKey(i,n,l,e))||s||Ct(t,i,n,e,r=o),r)}function Ct(t,i,n,e,s){t.Ut.setValueForKey(i,n,l,s,e)}function c(t,i){var n,e,s,o,r,c,u,a,l,h,g,M,I,f,N,d,D,v,w,b,A,y,a,t,l,t,l;if(void 0===i&&(i=!1),n=t.context.row,e=t.context.col,s=t.cellRect,o=t.cellStyle,r=t.context,u=(c={x:t.x,y:t.y,row:n,col:e,cellRect:s,cellStyle:o,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:r}).sheet,!1!==t.cellStyle.locked&&u.options.isProtected&&!u.NMi)return null;if(a=P(u,c.row,c.col,c.sheetArea,!0),l=t.cellStyle.cellButtons,!a||!l||l.length<=0)return null;if(h=a.layout,!(h=i?a.editorLayout[t.buttonArea]:h))return null;for(f in g=-1,M=c.x,I=c.y,h)if(h.hasOwnProperty(f)){if(N=void 0,d=h[f],i)N=new j.Rect(d.x,d.y,d.width,d.height);else{if(D=d.offsetX,u.parent&&!u.parent.options.scrollByPixel&&0<(v=u.frozenColumnCount())&&v<(w=u.getViewportLeftColumn(1))&&(b=u.getSpan(n,e,c.sheetArea))&&b.col<=w&&w<b.col+b.colCount)for(A=w-v,y=0;y<A;y++)D-=u.getColumnWidth(v+y+1,c.sheetArea);N=new j.Rect(s.x+D,s.y+d.offsetY,d.width,d.height)}if(N&&N.contains(M,I)){g=+f;break}}return-1!==g?c.cellButtonHitInfo={hitButtonIndex:g,buttonConfig:l[g],buttonArea:t.buttonArea}:(a=u.getCellType(c.row,c.col))&&(t=O(Q(u,l,n,e,i,[j.ButtonPosition.left]),h,o,r,!1),l=O(Q(u,l,n,e,i,[j.ButtonPosition.right]),h,o,r,!1),t=new j.Rect(s.x+t.width,s.y,s.width-t.width-l.width,s.height),l=a.getHitInfo(c.x,c.y,o,t,r))&&l.isReservedLocation&&(c.isReservedLocation=!0),c}function zt(t,i,n){var e,s,o,r,c,c,u,a,l,s,u,l,a,i,h,g;return void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(e=t.sheet,o=t.row,r=t.col,c=t.sheetArea,o===e.ui&&r===e.ci||c!==j.SheetArea.viewport||e.endEdit())&&(t.cellButtonHitInfo.buttonConfig&&(s=t.cellButtonHitInfo.buttonConfig.hasOverLay),c=P(e,o,r,t.sheetArea),t.cellButtonHitInfo&&(a=t.cellButtonHitInfo.hitButtonIndex,u=t.cellButtonHitInfo.buttonConfig),l=Zt(u&&u.enabled,t.row),e)&&(!c.isMouseDownReservedLocation||s)&&u&&(l||A(l))&&0<=a&&(c.buttonDownIndex=a,c.isMouseDownReservedLocation=!0,i&&n?(s=t.cellStyle,u=c.layout,l=t.context,a=c.editorLayout,i=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,h=s.cellButtons,i&&Z(n,g=Q(e,h,o,r,!0,[tt(i)]),i,l,s,c,u,a)):e.repaint(t.cellRect),1)}function mt(t,i,n){var e,s,o,r,c,u,u,a,l,h,c,g,M,I,f,n;if(void 0===i&&(i=!1),t&&(e=t&&t.sheet,s=t.row,o=t.col,r=P(e,t.row,t.col,t.sheetArea),c=t.cellButtonHitInfo,r.isMouseDownReservedLocation)&&e){if(c&&0<=c.hitButtonIndex&&c.buttonConfig.command&&(u=c.buttonConfig.command,i||e.getActiveRowIndex()===s&&e.getActiveColumnIndex()===o||e.eR(s,o,1,1,2),"string"==typeof u?e.getParent().commandManager().execute({cmd:u,row:s,col:o,sheetName:e.name(),sheetArea:t.sheetArea}):"function"==typeof u&&u.call(C,e,s,o,t.sheetArea)),i&&0<=r.buttonDownIndex&&n&&(r.buttonDownIndex=-1,u=t.cellStyle,a=r.layout,l=t.context,h=r.editorLayout,c=c&&c.buttonArea,g=u.cellButtons,c)&&Z(n,M=Q(e,g,s,o,!0,[tt(c)]),c,l,u,r,a,h),r.buttonDownIndex=-1,i||e.repaint(t.cellRect),r.isMouseDownReservedLocation=!1,I=t.sheetArea,!(f=e.Ut.getValueForKey(s,o,N,I)))return St(e,s,o,I),e.Ut.do("setValueForKey",s,o,N,!0,I),n=setTimeout(function(){st(e,s,o,I)},250),void e.Ut.do("setValueForKey",s,o,d,n,I);st(e,s,o,I)}}function Tt(t,i,n){var e,s,o,o,i,r,c,u,a,l,h;void 0===i&&(i=!1),t&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),o=-1,(o=t.cellButtonHitInfo?t.cellButtonHitInfo.hitButtonIndex:o)!==(A(s.buttonHoverIndex)?-1:s.buttonHoverIndex))&&(s.buttonHoverIndex=o,i?(o=t.cellStyle,i=s.layout,r=t.context,c=s.editorLayout,u=o.cellButtons,a=t.row,l=t.col,n&&xt(u,e,a,l,h=n.parentElement,r,o,s,i,c)):e.repaint(t.cellRect))}function pt(t,i,n){var e,s,i,o,r,c,u,a,l,h;void 0===i&&(i=!1),t&&t.cellButtonHitInfo&&(s=P(e=t&&t.sheet,t.row,t.col,t.sheetArea),i?(s.buttonHoverIndex=-1,0<=t.cellButtonHitInfo.hitButtonIndex&&(i=t.cellStyle,o=s.layout,r=t.context,c=s.editorLayout,u=i.cellButtons,a=t.row,l=t.col,n)&&xt(u,e,a,l,h=n.parentElement,r,i,s,o,c)):(e&&(s.buttonHoverIndex=-1,s.buttonDownIndex=-1,s.isMouseDownReservedLocation=!1),e.repaint(t.cellRect)))}function xt(t,i,n,e,s,o,r,c,u,a){for(var l,h,g,M,l=0;l<f.length;l++)h=it(f[l]),Z(g=s.querySelector("."+et(h)),M=Q(i,t,n,e,!0,[tt(h)]),h,o,r,c,u,a)}function Lt(t){var t=t.clone(!0);return t.hAlign=j.HorizontalAlign.left,t.vAlign=j.VerticalAlign.center,t.wordWrap=!1,t.isVerticalText=!1,t.shrinkToFit=!1,t.formatter="General",t.textIndent=0,t}function St(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)}function kt(t,i,n,e,s){var o,r,c,o=t.Il(i,n,s);if(o&&o.cellButtons&&0<o.cellButtons.length&&0<(r=o.cellButtons.filter(function(t){return 1===t.visibility})).length){e&&t.Ut.do("setValueForKey",i,n,g,!0,s);try{c=t.getCellRect(i,n,1===s?-1:void 0,2===s?-1:void 0),t.repaint(c)}finally{e&&t.Ut.do("setValueForKey",i,n,g,y,s)}}}function Ot(t,i){var n,e,i,s,n=null,e=t.imageType;if(A(t.imageType))return null;switch(s=(i=Zt(t.enabled,i))||A(i),e){case j.ButtonImageType.dropdown:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.left:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case j.ButtonImageType.right:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case j.ButtonImageType.clear:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.ok:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.plus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.minus:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.redo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.undo:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.search:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.separator:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.spinLeft:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case j.ButtonImageType.spinRight:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case j.ButtonImageType.ellipsis:n=s?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case j.ButtonImageType.expand:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case j.ButtonImageType.collapse:n=s?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case j.ButtonImageType.custom:n=t.imageSrc}return n}function Zt(t,i){return"function"==typeof t?t(i):t}Object.defineProperty(t,"__esModule",{value:!0}),j=i("Core"),t=i("Common"),i=i("./dist/plugins/celltype/celltypes.ns.js"),A=t.Common.lt.ht,o=j.W.V,r=j.mt.vt,Y=j.Bf.Zl,y=void 0,C=null,u=Math.max,a=parseInt,H="#707070",W="#34B4E3",V="#e6e6e6",J="lightgray",X="#CACACA",N="_isFirstMouseUp",d="_mouseupToken",g="_leaveCell",M=F=0,_=z=2,m=3,K=j.CellTypes.Base,T=j.CellTypes.Context,q="gc-cell-button-canvas",D=(s="gc-editor-")+"left-cellbuttons",v=s+"right-cellbuttons",w=s+"left-of-text-cellbuttons",b=s+"right-of-text-cellbuttons",p="leftButtonArea",x="rightButtonArea",L="leftOfTextButtonArea",S="rightOfTextButtonArea",l="_cellButtonParam",I={},h=j.GC$,f=[j.ButtonPosition.left,j.ButtonPosition.right,j.ButtonPosition.leftOfText,j.ButtonPosition.rightOfText],t=new t.Common.ResourceManager(i.SR,"CellTypes"),$=t.getResource.bind(t),(i=k=k||{})[i.topLeft=0]="topLeft",i[i.topCenter=1]="topCenter",i[i.topRight=2]="topRight",i[i.MiddleLeft=3]="MiddleLeft",i[i.MiddleCenter=4]="MiddleCenter",i[i.MiddleRight=5]="MiddleRight",i[i.bottomLeft=6]="bottomLeft",i[i.bottomCenter=7]="bottomCenter",i[i.bottomRight=8]="bottomRight",j.CellTypes.Base.ch("cellButton",{beforePaintLabel:function(t){var i,n,e,s,o,r,c,u,a,l,r,h,g,M,I,f,N,d,D,i=t.options.context,n=t.options.style;if(!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.options.context.sheet,s=i.row,o=i.col,r=Q(e,n.cellButtons,s,o,!1,[j.ButtonPosition.left,j.ButtonPosition.right]))&&0<r.length&&(c=Lt(n),G(r,e,t.options.context.row),u=t.ctx)){for(a=dt(t.options.rect.clone(),i),u.save(),u.rect(a.x,a.y,a.width,a.height),u.clip(),u.beginPath(),l=a.x,r=a.x+a.width,h=P(e,i.row,i.col,i.sheetArea),A(h.layout)&&(h.layout={}),g=h.layout,M=Q(e,n.cellButtons,s,o,!1,[j.ButtonPosition.left]),I=0;I<M.length&&(f=E(u,l,a.y,B(M[I].button,c,i),a.height,M[I].button,c,i,h,g,M[I].index,a),!A(f));I++)l+=f.width;for(N=l,l=r,I=(d=Q(e,n.cellButtons,s,o,!1,[j.ButtonPosition.right])).length-1;0<=I&&(f=E(u,l-=D=B(d[I].button,c,i),a.y,D,a.height,d[I].button,c,i,h,g,d[I].index,a),!A(f));I--);u.restore(),(a=t.options.rect).width=a.x+a.width-(r-l)-N,a.x=N}},beforePaintText:function(t){var i,n,e,s,o,t,i=t.context,n=t.style;!i.cellOverflowLayout&&n.cellButtons&&0<n.cellButtons.length&&(e=t.context.sheet,s=i.row,o=i.col,(t=t.externals).left=t.left.concat(rt(Q(e,n.cellButtons,s,o,!1,[j.ButtonPosition.leftOfText]),n,i)),t.right=t.right.concat(rt(Q(e,n.cellButtons,s,o,!1,[j.ButtonPosition.rightOfText]),n,i)))},beforeFillTextArea:function(t){var i,n,e,s,o,e,r,c,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,vt(e,a=Q(r=(e=t.context).sheet,n,c=e.row,u=e.col,!1,[j.ButtonPosition.leftOfText]),s,o,i,e,!0))},afterFillTextArea:function(t){var i,n,e,s,o,e,r,c,u,a,i=t.style,n=i.cellButtons;i.cellButtons&&0<i.cellButtons.length&&(e=t.ctx,s=t.availRect,o=t.textRect,vt(e,a=Q(r=(e=t.context).sheet,n,c=e.row,u=e.col,!1,[j.ButtonPosition.rightOfText]),s,o,i,e,!1))},onCreateCellEditor:function(t){var i,n,e,s,o,r,c,u,a,t,l,h,g,M,I,i=t.options.dom;if(i&&i.children&&(n=i.children[0])&&n.children&&(e=n.children[0])&&(o=(s=t.context).sheet,r=s.row,c=s.col,u=t.options.cellStyle,a=(u=A(u)?o.getActualStyle(r,c):u).cellButtons,!(A(a)||a&&a.length<=0))){for(t=t.options.cellRect,l=new j.Rect(t.x,t.y,t.width,t.height),h=P(o,r,c,s.sheetArea),A(h.layout)&&(h.layout={}),g=h.layout,M=!1,I=0;I<a.length;I++)a[I].position!==j.ButtonPosition.leftOfText&&a[I].position!==j.ButtonPosition.rightOfText||(M=!0);for(M&&(n.style.overflow="hidden"),I=0;I<f.length;I++)ct(f[I],o,a,s,u,l,r,c,h,g,i,n)}},onActivateCellEditor:function(t){var i,n,e,s,o,r,c,u,a,l,h,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o=t.options.cellStyle,r=o.cellButtons;if(!(A(r)||r.length<=0))for(c=P(n,e,s,i.sheetArea),A(c.editorLayout)&&(c.editorLayout={}),u=c.layout,a=c.editorLayout,l=Lt(o),h=t.options.dom,g=0;g<f.length;g++)gt(f[g],n,r,i,l,t,e,s,c,u,a,h)},onDeactivateCellEditor:function(t){var i,n,e,s,o,n,r,c,u,a,l,h,g,i=t.context,n=i.sheet,e=i.row,s=i.col,o,n=n.getActualStyle(e,s,i.sheetArea).cellButtons;if(n&&0<n.length)for(c=(r=P(i.sheet,e,s,i.sheetArea,!0))&&r.eventListeners,a=(u=t.options.dom).querySelectorAll("."+q),l=0;l<a.length;l++)g=nt((h=a[l]).className),A(g)||A(c)||A(c[g])||(Nt(h,c[g]),delete r.eventListeners[g])},onUpdateContainer:function(t){var i,n,e,s,i,o,r,c,i=t.context,n=i.sheet,e=i.row,s=i.col,i=P(i.sheet,e,s,i.sheetArea,!0),o=i&&i.canvasSizes,r=t.cellStyle.cellButtons;if(!(A(r)||r.length<=0))for(t.context.preventOverflow=!r.every(function(t){return t.i4i}),c=0;c<f.length;c++)Mt(f[c],n,r,e,s,o,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=c(t)},processMouseDownOnCellPadding:function(t){zt(t)},processMouseUpOnCellPadding:function(t){mt(t)},processMouseMoveOnCellPadding:function(t){Tt(t)},processMouseLeaveOnCellPadding:function(t){pt(t)},getCellButtonAutoHeight:function(e){var s,o,t,r,t,c,s=e.context.sheet,o=e.context.row,t=e.context.col,r=e.cellStyle;r.cellButtons&&0!==r.cellButtons.length&&(t=Q(s,r.cellButtons,o,t,!1,[j.ButtonPosition.left,j.ButtonPosition.right]),c=0,t.forEach(function(t){var i,n,i=T.tn(C,t.button.caption,r,s.zoom(),e.context)-2,n;Ot(t.button,o)&&(i=u(i,R(t.button))),c=u(i,c)}),e.value=c+ +z)},getCellButtonAutoWidth:function(i){var t,n,e,s,t,o,t=i.context.sheet,n=i.context.row,e=i.context.col,s=i.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(t=Q(t,s.cellButtons,n,e,!1,[j.ButtonPosition.left,j.ButtonPosition.right,j.ButtonPosition.leftOfText,j.ButtonPosition.rightOfText]),o=0,t.forEach(function(t){o+=B(t.button,s,i.context,!1)}),i.value=o)}}),j.Worksheet.ch(e="cellButtons",{setHost:function(){var n=this;n.bind(j.Events.EnterCell+"."+e,function(t,i){kt(n,i.row,i.col,!1,i.sheetArea)}),n.bind(j.Events.LeaveCell+"."+e,function(t,i){kt(n,i.row,i.col,!0,i.sheetArea)}),n.bind(j.Events.TopRowChanged+"."+e,function(t,i){kt(n,i.row,i.col,!0,i.sheetArea)})},dispose:function(t){var i=this;i.unbind(j.Events.EnterCell+"."+e),i.unbind(j.Events.LeaveCell+"."+e),i.unbind(j.Events.TopRowChanged+"."+e)},processMouseDown:function(t){var i=t.hitInfo.cellTypeHitInfo;i&&i.cellButtonHitInfo&&zt(i)&&(t.r=!0)}}),j.Workbook.ch(e,{onCultureChanged:function(){$()}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,i,n){var e,s,o,r,c,u,a,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var s=Object.getOwnPropertyDescriptor(i,n);s&&("get"in s?i.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,s)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),s=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.ti=i.EditorType=i.Context=i.Base=void 0,r=(o=n("Core")).CellTypes.Base,c=o.CellTypes.Context,u=o.CellTypes.EditorType,a=o.CellTypes.ti,i.Base=r,i.Context=c,i.EditorType=u,i.ti=a,i.Hi=o.CellTypes.Hi,i.zi=o.CellTypes.zi,Object.defineProperty(i,"Corner",{set:function(t){t!==i.Hi.Corner&&(i.Hi.Corner=t)},get:function(){return i.Hi.Corner}}),Object.defineProperty(i,"ColumnHeader",{set:function(t){t!==i.Hi.ColumnHeader&&(i.Hi.ColumnHeader=t)},get:function(){return i.Hi.ColumnHeader}}),Object.defineProperty(i,"RowHeader",{set:function(t){t!==i.Hi.RowHeader&&(i.Hi.RowHeader=t)},get:function(){return i.Hi.RowHeader}}),Object.defineProperty(i,"Text",{set:function(t){t!==i.zi.Text&&(i.zi.Text=t)},get:function(){return i.zi.Text}}),s(n("./dist/plugins/celltype/checkboxcelltype.js"),i),s(n("./dist/plugins/celltype/buttoncelltype.js"),i),s(n("./dist/plugins/celltype/hyperlinkcelltype.js"),i),s(n("./dist/plugins/celltype/comboboxcelltype.js"),i),n("./dist/plugins/celltype/cellbuttons.js"),s(n("./dist/plugins/celltype/editor/colorpicker.js"),i),s(n("./dist/plugins/celltype/editor/timepicker.js"),i),s(n("./dist/plugins/celltype/editor/calendar.js"),i),s(n("./dist/plugins/celltype/editor/calculator.js"),i),s(n("./dist/plugins/celltype/editor/monthPicker.js"),i),s(n("./dist/plugins/celltype/editor/listControl.js"),i),s(n("./dist/plugins/celltype/dropdown-action.js"),i),s(n("./dist/plugins/celltype/radiochecklistcelltype.js"),i),s(n("./dist/plugins/celltype/celltypes.ns.js"),i),s(n("./dist/plugins/celltype/rangecelltype.js"),i),s(n("./dist/plugins/celltype/dataobjectcelltype.js"),i),s(n("./dist/plugins/celltype/editor/popupControl.js"),i)},"./dist/plugins/celltype/celltypes.ns.js":function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/celltype/celltypes.res.en.js");i.SR={en:n}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Calendar_BuiltIn_Yesterday=i.Calendar_BuiltIn_Today=i.Calendar_Today=i.Calendar_FirstYear=i.Calendar_EraName_4=i.Calendar_EraName_3=i.Calendar_EraName_2=i.Calendar_EraName_1=i.Calendar_Time_PM=i.Calendar_Time_AM=i.Calendar_Months_12=i.Calendar_Months_11=i.Calendar_Months_10=i.Calendar_Months_9=i.Calendar_Months_8=i.Calendar_Months_7=i.Calendar_Months_6=i.Calendar_Months_5=i.Calendar_Months_4=i.Calendar_Months_3=i.Calendar_Months_2=i.Calendar_Months_1=i.Calendar_ShortMonths_12=i.Calendar_ShortMonths_11=i.Calendar_ShortMonths_10=i.Calendar_ShortMonths_9=i.Calendar_ShortMonths_8=i.Calendar_ShortMonths_7=i.Calendar_ShortMonths_6=i.Calendar_ShortMonths_5=i.Calendar_ShortMonths_4=i.Calendar_ShortMonths_3=i.Calendar_ShortMonths_2=i.Calendar_ShortMonths_1=i.Calendar_Weeks_7=i.Calendar_Weeks_6=i.Calendar_Weeks_5=i.Calendar_Weeks_4=i.Calendar_Weeks_3=i.Calendar_Weeks_2=i.Calendar_Weeks_1=i.Calendar_ShortWeeks_7=i.Calendar_ShortWeeks_6=i.Calendar_ShortWeeks_5=i.Calendar_ShortWeeks_4=i.Calendar_ShortWeeks_3=i.Calendar_ShortWeeks_2=i.Calendar_ShortWeeks_1=i.Cancel=i.OK=void 0,i.DataObject_MeetTable=i.DataObject_MeetSpan=i.DataObject_MeetLock=i.MultiColumn_InvalidDataSource=i.Calculator_OverFlowInfo=i.Calculator_SqrtParameterException=i.Calculator_InvalidInputInfo=i.Calculator_DivideByZeroInfo=i.StandardColor=i.ThemeColor=i.Quarter_Format_4=i.Quarter_Format_3=i.Quarter_Format_2=i.Quarter_Format_1=i.Calendar_NextTenYear=i.Calendar_LastTenYear=i.Calendar_NextYear=i.Calendar_LastYear=i.Calendar_NextMonth=i.Calendar_LastMonth=i.Calendar_BuiltIn_LastMonth=i.Calendar_BuiltIn_ThisMonth=i.Calendar_BuiltIn_Last7Days=void 0,i.OK="OK",i.Cancel="Cancel",i.Calendar_ShortWeeks_1="MON",i.Calendar_ShortWeeks_2="TUE",i.Calendar_ShortWeeks_3="WED",i.Calendar_ShortWeeks_4="THU",i.Calendar_ShortWeeks_5="FRI",i.Calendar_ShortWeeks_6="SAT",i.Calendar_ShortWeeks_7="SUN",i.Calendar_Weeks_1="Monday",i.Calendar_Weeks_2="Tuesday",i.Calendar_Weeks_3="Wednesday",i.Calendar_Weeks_4="Thursday",i.Calendar_Weeks_5="Friday",i.Calendar_Weeks_6="Saturday",i.Calendar_Weeks_7="Sunday",i.Calendar_ShortMonths_1="JAN",i.Calendar_ShortMonths_2="FEB",i.Calendar_ShortMonths_3="MAR",i.Calendar_ShortMonths_4="APR",i.Calendar_ShortMonths_5="MAY",i.Calendar_ShortMonths_6="JUN",i.Calendar_ShortMonths_7="JUL",i.Calendar_ShortMonths_8="AUG",i.Calendar_ShortMonths_9="SEP",i.Calendar_ShortMonths_10="OCT",i.Calendar_ShortMonths_11="NOV",i.Calendar_ShortMonths_12="DEC",i.Calendar_Months_1="JANUARY",i.Calendar_Months_2="FEBRUARY",i.Calendar_Months_3="MARCH",i.Calendar_Months_4="APRIL",i.Calendar_Months_5="MAY",i.Calendar_Months_6="JUNE",i.Calendar_Months_7="JULY",i.Calendar_Months_8="AUGUST",i.Calendar_Months_9="SEPTEMBER",i.Calendar_Months_10="OCTOBER",i.Calendar_Months_11="NOVEMBER",i.Calendar_Months_12="DECEMBER",i.Calendar_Time_AM="AM",i.Calendar_Time_PM="PM",i.Calendar_EraName_1="M",i.Calendar_EraName_2="T",i.Calendar_EraName_3="S",i.Calendar_EraName_4="H",i.Calendar_FirstYear="1",i.Calendar_Today="Today",i.Calendar_BuiltIn_Today="Today",i.Calendar_BuiltIn_Yesterday="Yesterday",i.Calendar_BuiltIn_Last7Days="Last 7 Days",i.Calendar_BuiltIn_ThisMonth="This Month",i.Calendar_BuiltIn_LastMonth="Last Month",i.Calendar_LastMonth="Go to previous month",i.Calendar_NextMonth="Go to next month",i.Calendar_LastYear="Go to previous year",i.Calendar_NextYear="Go to next year",i.Calendar_LastTenYear="Go to previous ten years",i.Calendar_NextTenYear="Go to next ten years",i.Quarter_Format_1="Q1",i.Quarter_Format_2="Q2",i.Quarter_Format_3="Q3",i.Quarter_Format_4="Q4",i.ThemeColor="Theme Colors",i.StandardColor="Standard Colors",i.Calculator_DivideByZeroInfo="Cannot divide by zero.",i.Calculator_InvalidInputInfo="Invalid Input.",i.Calculator_SqrtParameterException="Invalid input for function.",i.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",i.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",i.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",i.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",i.DataObject_MeetTable="Cannot insert data because a table in the way."},"./dist/plugins/celltype/checkboxcelltype.js":function(G,t,i){var n,e,j,s,a,v,r,u,i,D,o,w,c,l,h,C,g,M,b,A,y,z,m,I,f,U,N,E,d,B,Q,T,p,x,R,L,S,k,O,e,P;function Y(t,i,n,e){var t,s,t=t.Ut;t&&(t.do("setValueForKey",i,n,p,l,e),s=t.getValueForKey(i,n,x,e))&&(clearTimeout(s),t.do("setValueForKey",i,n,x,l,e))}function Z(){var t,n,t=P.call(this)||this;return t.typeName="5",t._boxSize=L,n=t,o(S,function(t,i){n["_"+t]=i}),t}function H(t){return 5*t}function W(t,i,n,e,s,o,r,c){var u,a,l,h,g,M,I,n,f,N,d,D,v,w,b,r,A,a,e,y,i,u=5*r,a=i.hAlign,l=n.x,h=n.width,g=0,M=i.vAlign,I=n.y,n=n.height,f=0,N=0,d=1<e.split("\n").length,D=l,v=I,w=h,b=n,r=L*r;return 0===t||1===t?(1===a?g=l+h/2-r/2:w=2===a?(g=l+h-u-r,h-u+2):(D=(g=l+u)-1,h-u+1),b=(a=j.q.un(e,A=w-3-1,i.font)).length*o,d=d||1<a.length,f=r+b,v=0===t?(1===M?(N=I+n/2-f/2+b-3,b+=6):N=2===M?I+n-u-f+b:I+u+b,N-b):(1===M?(N=I+n/2-f/2-3,b+=6):N=2===M?I+n-u-f:I+u,N+r)):(N=1===M?I+n/2-r/2:2===M?I+n-u-r:I+u,i=o/2-(e=C(c.fontInfo.fontSize))/2+(y=8<e?Math.floor((e-8)/5+2):1)-1,d=d||h-r-u-4<s,w=h-r-u,2===M?b=n+i+2-u:0===M&&(b=n-((v=I-(2+i)+u)-I)),2===t?(g=l+h-u-r,w=h-r):D=(g=l+u)+r+1),{multiLine:d,startX:g,startY:N,textX:D,textY:v,textW:w,textH:b}}function V(t,i,n,e,s){var o,i,r,n,c,u,o=5*s,i=i.hAlign,r=n.x-1,n=n.width+1,c=0,u=0;return 0===t||1===t?(u=r+o,1===i?u=r+n/2-L*s/2:2===i&&(u=r+n-o-L*s)):2===t?(c=L*s+e,u=r+o+e,1===i?u=r+n/2-c/2+e:2===i&&(u=r+n-o-c+e)):(c=L*s+e,u=r+o,1===i?u=r+n/2-c/2:2===i&&(u=r+n-o-c)),u-r}function J(t,i,n,e,s){var o,i,r,n,c,u,o=5*s,i=i.vAlign,r=n.y-1,n=n.height+1,c=0,u=0;return 0===t?(c=L*s+e,u=r+o+e,1===i?u=r+n/2-c/2+e:2===i&&(u=r+n-o-c+e)):1===t?(c=L*s+e,u=r+o,1===i?u=r+n/2-c/2:2===i&&(u=r+n-o-c)):(u=r+o,1===i?u=r+n/2-L*s/2:2===i&&(u=r+n-o-L*s)),u-r}function X(t,i,n,e,s){var o,o,o,o=i.getValue(n,e,s),o=t.wG(o),o={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:o,autoFormat:!0};i.Qy().execute(o),t.j3(i,n,e,s)}function F(t,i,n,e,s){var o,r,o=s&&s.sheet,r=t.getEditorValue(i,s);t.setEditorValue(i,r,s),t.updateEditor(i,n,e,s),t.j3(o,o.ui,o.ci,s.sheetArea)}n=this&&this.__extends||(O=function(t,i){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}O(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBox=t.CheckBoxTextAlign=void 0,e=i("Common"),j=i("Core"),s=j.mt.En,a=e.Common.lt.ht,v=j.mt.vt,r=j.mt.vi,u=j.CellTypes.Context,i=j.CellTypes.Base,D=j.GC$,o=D.each,w=j.mt.yt,c=null,l=void 0,h=Math.max,C=parseInt,g="position",M="absolute",b="font",A="left",y="right",z="top",m="alphabetic",I=".gcEditingInput",f="background-color",U="white",N="green",E="div",d="normal 11pt calibri",B="width",Q="height",T="white-space",p="_isFirstMouseUp",x="_mouseupToken",(e=R=t.CheckBoxTextAlign||(t.CheckBoxTextAlign={}))[e.top=0]="top",e[e.bottom=1]="bottom",e[e.left=2]="left",e[e.right=3]="right",S={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!(L=12),boxSize:L},n(Z,P=i),Z.prototype.Poe=function(t,i,n,e,s,o,r,c){var u=this,a=C(n.startX),l=C(n.startY),h=C(n.textX),g=C(n.textY),M=C(n.textW),n=C(n.textH);u.Goe(t,a,l,s,o,r),u.paintText(t,i,h,g,M,n,c,e,i,null)},Z.prototype.Goe=function(t,i,n,e,s,o){t.save(),t.strokeStyle="black",t.strokeRect(i+.5,n+.5,2*e+.05,2*e+.05),t.fillStyle=U,t.fillRect(i+1,n+1,2*e-1,2*e-1),this._isThreeState&&a(o)?(t.beginPath(),t.fillStyle=N,t.rect(i+3*s,n+3*s,2*(e-2.5*s),2*(e-2.5*s)),t.fill()):!0==!!o&&(t.beginPath(),t.lineWidth=2.5*s,t.moveTo(i+3*s,n+e),t.lineTo(i+e,n+2*e-3.5*s),t.lineTo(i+2*e-1.5*s,n+3*s),t.stroke()),t.restore()},Z.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,l,h,g,M,I,f,N,N,d,D,d,D,d,s,o,o,s,d,n,o,e,s,u,a,r;t&&(t.save(),t.rect(n,e,s,o),t.clip(),t.beginPath(),u=r.hAlign,a=r.font,l=r.foreColor,g=(h=this)._textAlign,M=h.getText(i,c),f=I=0,(N=c.sheet)&&(I=N.Qt(M,a),f=v(a)),N=N.zoom(),d=c.isPrinting,D=c.printZoomFactor,++n,++e,--s,--o,D=(d=this.CG(f,N=d&&"number"==typeof D&&1!==D?D:N)).radius,d=d.scaleFactor,s=new j.Rect(n,e,s,o),r.wordWrap&&(o=W(g,r,s,M,I,f,N*d,c)).multiLine?h.Poe(t,M,o,c,D,N,i,r):(o=V(g,r,s,I,N*d),s=J(g,r,s,f,N*d),d=C((n+o).toString()),n=C((e+s).toString()),o=A,e=d+1,1===u?(o="center",e+=D):2===u&&(o=y,e+=2*D),a&&t.font!==a&&j.mt.bt(t,a),l&&(t.fillStyle=l),s=r.textDecoration,r=f/2-(u=parseInt(c.fontInfo.fontSize,10))/2+(a=8<u?Math.floor((u-8)/5+2):1)-1,t.textBaseline!==m&&(t.textBaseline=m),2===g?(t.textAlign=y,t.fillText(M,d+1-2,n+D+f/2-r),s&&h.le(t,s,d+1-2,n+D+f/2-r,I,u,a)):0===g&&(t.textAlign=o,t.fillText(M,e,n-2-r),s)&&h.le(t,s,e,n-2-r,I,f),h.Goe(t,d,n,D,N,i),l&&(t.fillStyle=l),3===g?(t.textAlign=A,t.fillText(M,d+1+2*D+2,n+D+f/2-r),s&&h.le(t,s,d+1+2*D+2,n+D+f/2-r,I,u,a)):1===g&&(t.textAlign=o,t.fillText(M,e,n+2*D+2+f-r),s)&&h.le(t,s,e,n+2*D+2+f-r,I,u,a)),t.restore())},Z.prototype.CG=function(t,i){var n,e,s,o,n,e=this._boxSize,s=L/2,o=1;return"auto"===e&&(s=t/4,o=t/2/L),"number"==typeof e&&0<e&&(s=i*e/2,o=e/L),{radius:s,scaleFactor:o}},Z.prototype.bi=function(t,i,n){var e,i,t,s,o,r,e,i=i.font,t=this.getText(t,n),s=0,o;return n.sheet&&(s=v(i),t)&&(s*=(r=t.split(/\r\n|\r|\n/)).length),s},Z.prototype.getText=function(t,i){return this.SG(t)},Z.prototype.focus=function(t,i){t&&t.parentNode.focus()},Z.prototype.createEditorElement=function(t,i){var n,n,n,i,t,e,e,i,n=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.Ti,n=j.mt.gi(n)+1e3;return D(i).css("z-index",n).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=D(i.firstChild)).css("overflow","hidden"),(i=D(s("input"))).attr("type","checkbox"),i.attr("class","gc-checkbox-cell-type-input"),e=(t=this.TG(t))/L,i.css("transform","scale("+e+")"),n.append(i),(e=D(s("span"))).css(g,M).css(b,w(d)).css("cursor","default").css(T,"nowrap").css("word-break","break-all"),n.append(e),(i=D(s(E))).css(g,M).css(f,N).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),n.append(i),c},Z.prototype.TG=function(t){var i,n,i,e,i=t.sheet,n=i.zoom();return"number"==typeof this._boxSize&&0<this._boxSize?this._boxSize*n:"auto"===this._boxSize?(e="",e=(i=i.Z_(t.row,t.col))&&i.font?i.font:d,n*v(e)/2):L/2},Z.prototype.wG=function(t){var t,t=this._isThreeState?!a(t)&&(!0!=!!t||c):!t;return t},Z.prototype.setEditorValue=function(t,i,n){var t,e,s,t,o,n,r,c,u;t&&(e=(t=t.parentNode.children)[0],s=t[1],t=t[2],e)&&s&&t&&(o=this,u=c=void 0,(r=(n=n&&n.sheet)&&n.Ai)||(u=o.wG(i)),o._isThreeState?a(u)?(c=!1,D(t).show()):(c=!!u,D(t).hide()):c=!!u,e.checked=c,D(s).text(o.SG(u)))},Z.prototype.getEditorValue=function(t,i){if(t){var t=t.parentNode.children,n=t[0],e=t[1],t=t[2];if(n&&e&&t&&(!this._isThreeState||!D(t).isVisible()))return n.checked}return c},Z.prototype.j3=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},Z.prototype.activateEditor=function(i,n,e,s){var t,t,o,t=s&&s.sheet;i&&t&&(t=D(i.parentNode.parentNode),o=this,t.bind("mousedown"+I,function(t){r(t)}),t.bind("mouseup"+I,function(){F(o,i,n,e,s)}),t.bind("keydown"+I,function(t){var i=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===i)return o.AG=!0,r(t),!1;8===i&&r(t)}}),t.bind("keyup"+I,function(t){!o.AG||32!==t.keyCode||t.ctrlKey||t.shiftKey||t.altKey||(o.AG=!1,F(o,i,n,e,s))}),D(i).bind("click",function(t){r(t)}))},Z.prototype.updateEditor=function(t,i,n,e){var s,o,t,r,c,u,r,t,u,a,l,h,g,a,l,o,s,M,a,u,e,I,f,n,l,f,n,c,N,d,h,u,s=e&&e.sheet;t&&s&&(o=s.Dn,c=(r=(t=t.parentNode).children)[0],u=r[1],r=r[2],c)&&u&&r&&(D(t).width(n.width).height(n.height),u=(t=D(u)).text(),a=i.foreColor,l=i.font,h=i.hAlign,g=i.textDecoration,a&&t.css("color",a),a=void 0,a=l||o.Nn(),1<(l=s.zoom())&&(a=o._n(a)),t.css(b,w(a)),o=s.Gi(u,a),s=v(a),u&&(s*=(M=u.split(/\r\n|\r|\n/)).length),f=V(u=(a=this)._textAlign,i,n,o,l*(I=(e=this.TG(e))/L)),n=J(u,i,n,s,l*I),D(c).css("margin-left",f).css("margin-top",n),l=c.offsetLeft,f=c.offsetTop,n=c.offsetWidth,c=c.offsetHeight,(d=N=0)===u?(N=l,1===h?N=l+e/2-o/2:2===h&&(N=l+e-o),d=f-s,N-=(I-1)*L/2,d-=(I-1)*L/2):1===u?(N=l,1===h?N=l+e/2-o/2:2===h&&(N=l+e-o),d=f+c,N-=(I-1)*L/2,d+=(I-1)*L/2):(2===u?(N=l-o-2,d=f+e/2-s/2,N-=(I-1)*L/2):(N=l+n+2,d=f+e/2-s/2,N+=(I-1)*L/2),d-=(I-1)*L/2),t.css(A,N).css(z,d),i.wordWrap?t.css(T,"normal"):t.css(T,"nowrap"),a._isThreeState?(h=l+(n-r.offsetWidth)/2,u=f+(c-r.offsetHeight)/2,D(r).css(A,h).css(z,u).toggle().toggle()):D(r).hide(),g)&&a.Qe(t,g)},Z.prototype.SG=function(t){var i=this,n=i._caption;return i._isThreeState&&a(t)?i._textIndeterminate||n:!0==!!t?i._textTrue||n:i._textFalse||n},Z.prototype.getHitInfo=function(t,i,n,e,s){if(s){var o=s.sheetArea;if(a(o)||3===o)return{x:t,y:i,row:s.row,col:s.col,cellRect:e,sheetArea:3,isReservedLocation:!0,sheet:s.sheet,cellStyle:n}}return c},Z.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},Z.prototype.processMouseUp=function(t){var i,n,e,s,o,r,t,i=this,n=t&&t.sheet;if(n&&i.pG&&t.isReservedLocation){if(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,!(r=n.Ut.getValueForKey(e,s,p,o)))return X(i,n,e,s,o),n.Ut.do("setValueForKey",e,s,p,!0,o),t=setTimeout(function(){Y(n,e,s,o)},250),n.Ut.do("setValueForKey",e,s,x,t,o),!0;Y(n,e,s,o)}return!1},Z.prototype.processMouseLeave=function(t){if(!t)return!1;this.pG=!1},Z.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},Z.prototype.processKeyUp=function(t,i){return X(this,i.sheet,i.row,i.col,i.sheetArea),!0},Z.prototype.getAutoFitWidth=function(t,i,n,e,s){var o,r,c,t,n,o=this,r=o._textAlign,c=u.Bt(t,o.SG(t),n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===r||1===r?c=h(c,n):c+=n,c+5+2},Z.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,r,c,c,t,n,o=this,r=o._textAlign,c=o.SG(t),c=u.tn(c,c,n,e,s),t=o.bi(t,n,s),n=2*o.CG(t,e).radius;return 0===r||1===r?c+=n:c=h(c,n),c+5},Z.prototype.QD=function(t){this.isReservedKey(t)&&r(t)},Z.prototype.isImeAware=function(t){return!1},Z.prototype.Ke=function(){},Z.prototype.Je=function(t){var t={caption:t.caption,textTrue:t.textTrue,textIndeterminate:t.textIndeterminate,textFalse:t.textFalse,textAlign:t.textAlign&&R[t.textAlign],isThreeState:t.isThreeState,boxSize:t.boxSize};this.fromJSON(t)},Z.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return o(S,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},Z.prototype.fromJSON=function(n){var e=this;o(S,function(t){var i=n[t];a(i)||(e["_"+t]=i)})},Z.prototype.Tfe=function(t){var i,n=this._textAlign;return 2===n||3===n?L*t+5*t:0},k=Z,t.CheckBox=k,o(S,function(i){k.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:("boxSize"===i&&("number"==typeof t&&0<t&&(this["_"+i]=t),"auto"!==t)||(this["_"+i]=t),this)}}),j.CellTypes.ti[5]=k},"./dist/plugins/celltype/comboboxcelltype.js":function(s,t,i){var o,E,D,B,l,h,Q,a,c,g,r,R,P,Y,H,M,I,v,u,f,N,d,w,W,V,J,X,b,A,y,j,F,C,z,m,_,K,T,p,q,$,tt,x,it,nt,L,et,S,st,ot,rt,k,ct,ut,at,lt,ht,gt,Mt,It,ft,O,Nt,dt,Dt,vt,wt,bt,At,i,yt;function Z(t,i){t.appendChild(i)}function jt(t,i){t.removeChild(i)}function G(t){return t&&t.parentNode.parentNode.comboBox}function n(t,i,n,e,s,o,r,c,u){var a,i,u,t,n,e,n,t,u,a=this;a.xG=t,a.sfe=i,a.dfe=u,i=t.firstChild,g(t).bind(N,function(t){a.NG(t)}).css([q,A,y,z,m,"overflow"],[r||0,n,e,s,o,"visible"]).attr([j],["gcComboBox"]),u=v(0,s-17),a._editable=!1,a.DG=t=l(L),a._G=n=l("textarea"),Z(i,a.EG=t),Ct(t),Ct(n),g(n).bind("keyup",function(){var t,i,t=a.EG.value;a._text=t,i=a.jG(t),a.editorValue(i),a.OG(t),a.RG()}).bind(d,function(){a.BG()}).bind(w,function(){a.RG()}),g(t).bind(f,function(){a.LG?a.ki(O,{isMouse:!0}):a.PG()}).bind(d,function(){a.BG()}).bind(w,function(){a.RG()}),a.GG(0,0,u,o),Z(i,e=a.UG=l(L)),g(e).css([ot,J,p,K],[C,X,x,tt]).attr(j,"gcDropDownButton").bind(f,function(){var t,i;!h(a.HG)&&(t=a.HG,a.HG=I,(i=(new Date).valueOf())-t<100)||(a.LG?a.ki(O,{isMouse:!0}):a.PG())}),n=l("canvas"),a.fg=n,a.zG(u,0,s-u,o),Z(e,n),Z(i,t=a.VG=l(L)),a.YG=!1,a.ZG=c||s,g(t).css([J,ot,p,q,_,$,"cursor",K,m,rt],[X,"1px solid",x,r||0,C,C,"default",tt,o,a.ZG+k]),g(t).attr(j,"gcDropDownWindow").attr(F,-1),a.WG(0,+o),a.QG=0,Z(t,u=a.KG=l(L)),a.JG=new D.x4(t,u),a._itemHeight=22,a.qG=20,a.$G=-1,a._editorValueType=0,a._items=[],a.eU=dt,a.iU=""}function Ct(t){g(t).css(["margin","overflow","resize",J,"padding",_,p,"white-space",K,ot],[0,"hidden",C,X,Mt+"px 0px 0px "+gt+k,C,x,"nowrap",tt,C]).attr(j,"gcComboBoxEditor").attr(F,-1)}function e(){var t,n,t=yt.call(this)||this;return t.typeName="7",t.v6=!1,t.rU=!1,n=t,r(vt,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function zt(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===W&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function U(t,i){return t.hasOwnProperty(i)}o=this&&this.__extends||(At=function(t,i){return(At=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}At(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.EditorValueType=void 0,E=i("Common"),D=i("Core"),B=D.CellTypes.Base,l=D.mt.En,h=E.Common.lt.ht,Q=E.Common.ft,a=D.mt,c=a.vi,g=D.GC$,r=g.each,R=a.yt,P=a.Ct,Y=a.M0,H=document,M=null,I=void 0,v=Math.max,u=parseInt,f="click",N="keydown",d="mouseover",w="mouseout",W="string",V="number",J="position",X="absolute",b="font",A="left",y="top",j="gcUIElement",F="tabindex",C="none",z="width",m="height",_="outline",K="box-sizing",T="color",p="background-color",q="z-index",$="display",tt="content-box",x="white",it="black",nt="title",L="div",et="span",S="text",st="value",ot="border",rt="min-width",k="px",ct=a.wt,(i=ut=t.EditorValueType||(t.EditorValueType={}))[i.text=0]="text",i[i.index=1]="index",i[i.value=2]="value",at=17,Mt=gt=1,It=gt,O="EndEdit.gcEditingInput",Nt=ft=18,dt="lightgrey",vt={editorValueType:ht=0,items:M,itemHeight:22,editable:!(Dt="#1E90FF"),maxDropDownItems:lt=20,allowFloat:!0},n.prototype.getComboBox=function(){return this.xG},n.prototype.dispose=function(){var t=this;g(t.xG).unbind(N),g(t._G).unbind("keyup").unbind(d).unbind(w),g(t.DG).unbind(f).unbind(d).unbind(w),g(t.UG).unbind(f),g(t.KG).find("div").forEach(function(t){g(t).unbind(d).unbind(w).unbind(f)}),t.JG.dispose()},n.prototype.updateLocationAndSize=function(t,i,n,e){var s,o,s=this,o=v(0,n-17);s.GG(0,0,o,e),s.zG(o,0,n-o,e),s.WG(0,+e)},n.prototype.updateStyle=function(t,i,n){var e=this;n=R(n),t=t||I,g(e.EG).css(p,t).css(T,i).css(b,n),g(e.UG).css(p,t).css(T,i).css(b,n),g(e.VG).css(p,t).css(T,i).css(b,n),e.iU=i,g(e.xG).css(p,"transparent"),e.eU=Q.Tv(Q._(t),Q._(dt))?x:dt},n.prototype.updateImeMode=function(t){g(this.EG).css("ime-mode",t)},n.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},n.prototype.editorValue=function(t){var i,n,i=this;return 0===arguments.length?i.oU:(t!==i.oU&&(i.oU=t,n=i.aU(t),i.text(n),i.OG(n,!0,t)),i)},n.prototype.aU=function(t){var i,n=this,e=n._items,s=e.length,o=n._editorValueType,r,c,u;if(n.uU=!0,1===o)(i=(r=e[t])&&U(r,S)?r.text:r)===I&&(i=t,n.uU=!1);else if(0===o){for(i=t,u=0;u<s&&!((r=e[u])&&U(r,S)&&r.text===t||r===t);u++);s<=u&&(n.uU=!1)}else if(2===o){for(c=0;c<s;c++)if((r=e[c])&&U(r,st)&&r.value===t){i=r.text;break}s<=c&&(i=t,n.uU=!1)}return i=h(t)?"":i},n.prototype.jG=function(t){var i,n,e,i,s,o,r,c,i=this,n=i._items,e=n.length,i=i._editorValueType,s=t;if(1===i)for(r=0;r<e;r++)((o=n[r])&&U(o,S)&&o.text===t||o===t)&&(s=r);else if(2===i)for(c=0;c<e;c++)(o=n[c])&&U(o,S)&&o.text===t?s=o.value:o===t&&(s=I);return s},n.prototype.OG=function(t,i,n){var e,s,o,r,c,u,a,l,s=-1;if(!h(t)&&""!==t)for(r=(o=this._items).length,e=0;e<r;e++)if(a=u=void 0,u=U(c=o[e],S)?c.text:c,U(c,st)&&(a=c.value),(l=i?u:u.toString().substr(0,t.length))===t){if(s=e,h(n))break;if(!h(a)&&a===n)break}this.sU(s)},n.prototype.RG=function(){g(this.EG).removeAttr(nt)},n.prototype.BG=function(){var t,i,n,e,t=this,i=t.Wt(t._text),n=g(t.EG),e;n.width()+gt<i?n.attr(nt,t._text):n.removeAttr(nt)},n.prototype.GG=function(t,i,n,e){n-=0,e-=0,g(this.EG).css(A,t).css(y,i).css(z,n-gt).css(m,e-Mt)},n.prototype.editable=function(t){var i,n,e,s,o,s,i=this;return 0===arguments.length?i._editable:i._editable!==t?(i._editable=t,n=i.xG.firstChild,e=i.EG,s=g(e),o={left:u(s.css(A)),top:u(s.css(y)),width:u(s.css(z)),height:u(s.css(m))},s={backColor:s.css(p),foreColor:s.css(T),font:e.style.font},jt(n,e),i.EG=t?i._G:i.DG,Z(n,i.EG),g(i.EG).css(p,s.backColor).css(T,s.foreColor).css(b,s.font),i.GG(o.left,o.top,o.width,o.height),i):void 0},n.prototype.text=function(t){var i=this,n=i.EG;if(0===arguments.length)return i._text;t!==i._text&&(i._text=t,i._editable?n.value=t:n.textContent=t)},n.prototype.focus=function(){var t=this,i=t.EG;i.focus(),t._editable&&(i.selectionStart=i.value.length)},n.prototype.selectAll=function(){var t=this;t._editable&&t.EG.select()},n.prototype.zG=function(t,i,n,e){var s,o,s,t,i;n-=0,e-=0,o=(s=this).fg,g(s.UG).css(A,t).css(y,i).css(z,n).css(m,e),g(o).attr(z,n).attr(m,e),s=o.width,t=o.height,(i=o.getContext("2d")).beginPath(),i.lineWidth=2,i.fillStyle=it,i.moveTo(s-17+4,(t-2)/2-2.5),i.lineTo(s-17+7,(t-2)/2+3.5),i.lineTo(s-17+10,(t-2)/2-2.5),i.fill()},n.prototype.showDropDownList=function(){var i=this,t=i.JG;i.YG=!0,g(i.VG).bind(N,function(t){i.NG(t)}).show(),i.cU=!1,i.fU(),this.adjustPosition(),i.cU&&t.pS(g(i.KG.children).height()),t.w4(!1),i.lU(Dt,x),i.hU(i.$G),i.focus()},n.prototype.adjustPosition=function(){var t,i,n,e,s,o,r,c,u,a,l,a,h,h,h,a,t=this,i=g(t.VG);i&&(n=parseInt(i.css("left"),10),e=parseInt(i.css("top"),10),s=i.width(),o=i.height(),isNaN(n)||isNaN(e)||isNaN(s)||isNaN(o)||(c=r=0,!(u=.8)!==this.dfe?(l=(a=H.documentElement).clientWidth,a=a.clientHeight,h=i[0].getBoundingClientRect(),a<o&&(i.css("max-height",Math.round(.8*a)+k),o=Math.round(.8*a)),l<s&&(i.css("max-width",Math.round(.8*l)+k),s=Math.round(.8*l)),h.left+s>l&&(c=h.left+s-l),h.top+o>a&&(r=h.top+o-a)):(a=(h=t.sfe).clientHeight,l=h.clientWidth,a<o&&(o=Math.round(.8*a),i.css("max-height",o+k)),l<s&&(s=Math.round(.8*l),i.css("max-width",s+k)),h=i[0].getBoundingClientRect(),a=t.sfe.getBoundingClientRect(),r=v(0,h.bottom-a.bottom),c=v(0,h.right-a.right)),(n<0||e<0||0<r||0<c)&&((n-=c+5)<0&&(n-=22),i.css({left:n+k,top:(e-=r+5)+k}))))},n.prototype.shiftPadding=function(t,i){var n=this.xG.firstChild;t===A?g(n).css({left:(+g(n).css(A).replace(k,"")||0)-i}):t===y&&g(n).css({top:(+g(n).css(y).replace(k,"")||0)-i})},n.prototype.closeDropDownList=function(){var t=this;t.YG=!1,g(t.VG).unbind(N).hide(),t.lU("",t.iU),t.focus()},n.prototype.PG=function(){this.YG?this.closeDropDownList():this.showDropDownList()},n.prototype.listHeight=function(t){var i=this,n=g(i.VG);if(0===arguments.length)return n.height();0<t&&(n.height(t),i.JG.w4(!1))},n.prototype.WG=function(t,i){g(this.VG).css(A,t).css(y,i)},n.prototype.items=function(t){var i,n,e,s,o,r,i=this;if(0===arguments.length)return i._items;if(t){for(i._items=t,n=i.KG,e=void 0,g(n).find("div").forEach(function(t){g(t).unbind(d).unbind(w).unbind(f)}),e=n.firstChild;e;)jt(n,e),e=n.firstChild;for(s=i.QG=0,o=t.length;s<o;s++)r=t[s],i.dU(U(r,S)?r.text:r);return i}},n.prototype.dU=function(t){var i,n,e,i=this,n=l(L),e=l(et);e.textContent=t.toString(),e.style.padding="0 18px 0 "+It+k,e.style.textOverflow="ellipsis",e.style.whiteSpace="nowrap",Z(n,e),Z(i.KG,n),i.QG++,g(n).bind(f,function(){var t=g(n).index();i.selectedIndex(t),i.closeDropDownList(),i.ki(O,{isMouse:!0})}).bind(d,function(){var t=g(n);n.oldBackColor=t.css(p),t.css(p,i.eU)}).bind(w,function(){g(n).css(p,n.oldBackColor||"")}).css(rt,i.ZG+"px")},n.prototype.vU=function(){var t=this;t.S5=l(et),g(t.S5).css([$,b],[C,t.VG.style.font]).appendTo(H.body)},n.prototype.mU=function(){jt(H.body,this.S5)},n.prototype.Mt=function(t){return this.S5.textContent=t,g(this.S5).width()+2+It},n.prototype.lU=function(t,i){var n=this,e=n.$G;0<=e&&e<n.QG&&g(n.KG.children[e]).css([p,T],[t,i])},n.prototype.NG=function(t){var i,n,e,s,o,r,i=this,n=t.keyCode,e=t.which;(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||37===e||39===e)&&9!==e&&i.editable()||(s=i.QG,o=i.$G,r=0,38===e||40===e?(0<=(r=0<=o&&o<s?o+(38===e?-1:1):r)&&r<s&&i.selectedIndex(r),i.YG&&i.hU(r),c(t)):13===e||37===e||39===e||9===e?(i.selectedIndex(i.$G),(i.YG||i.editable())&&i.closeDropDownList(),i.ki(O,{keyCode:n,shiftKey:t.shiftKey}),(i.YG||i.editable())&&c(t)):27===e?(i.closeDropDownList(),i.ki(O,{keyCode:n}),c(t)):i.editable()||32!==e||c(t))},n.prototype.getSelectedValue=function(t,i,n){var i,e,i=i[t];return h(i)||(1===n?e=t:0===n?e=U(i,S)?i.text:i:2===n&&U(i,st)&&(e=i.value)),e},n.prototype.sU=function(t){var i=this;i.lU("",i.iU),i.$G=t,i.lU(Dt,x),i.hU(t)},n.prototype.selectedIndex=function(t){var i,t,i=this;if(0===arguments.length)return i.$G;0<=t&&t<i.QG&&(i.sU(t),t=i.getSelectedValue(i.$G,i._items,i._editorValueType),h(t)||i.editorValue(t))},n.prototype.itemCountPerPage=function(t){if(0===arguments.length)return this.qG;0<t&&(this.qG=t)},n.prototype.allowFloat=function(t){var i=this;if(0===arguments.length)return i.dfe;i.dfe=t},n.prototype.Wt=function(t){this.vU();var t=this.Mt(t);return this.mU(),t},n.prototype.itemHeight=function(t){if(0===arguments.length)return this._itemHeight;0<t&&(this._itemHeight=t)},n.prototype.fU=function(){var t,i,i,n,e,s,t=this;t.vU(),i=t._items[0],i=v(t._itemHeight,g(t.S5).text(h(i)?"":i).height()),g(t.KG.children).css(m,i),(e=t.QG)<=(s=t.qG)?n=e*i:(n=s*i,t.cU=!0),t.listHeight(n),t.mU()},n.prototype.hU=function(t){var t;0<=t&&t<this.QG&&(t=this.KG.children[t],this.JG.xS(t))},n.prototype.bind=function(t,i,n){g(this.xG).bind(t,i,n)},n.prototype.unbind=function(t,i){g(this.xG).unbind(t,i)},n.prototype.ki=function(t,i){g(this.xG).trigger(t,i)},wt=n,o(e,yt=B),e.prototype.isReservedKey=function(t,i){return this.rU},e.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,a,l,h,g,M,g,M,I,f,N,d,I,f,N,u,u=this,a=c.sheet,a=a.zoom?a.zoom():1,l=17,h=v(0,s-17-1);3===r.hAlign&&(r.hAlign=0),r.wordWrap&&(r.wordWrap=!1),g=c.isPrinting,M=c.printZoomFactor,g&&"number"==typeof M&&1!==M&&(a=M),0<h&&0<o&&(g={},M=void 0,c.quotePrefix=r.quotePrefix,I=r.formatter&&"General"!==r.formatter,f=r._autoFormatter&&r._autoFormatter.formatCached&&"General"!==r._autoFormatter.formatCached,N=void 0,d=this.getItemValue(i),N=I?r.formatter:f?r._autoFormatter:D.CellTypes.Context.Nt(t,d,h+1,r,a),M=this.format(ct(i),N,g,c),M=(I=u.getText(i,c))!==i?M||(i=I):M)&&(f=new D.Rect(n,e,s,o),yt.prototype.adjustRectForIconSet.call(this,r.hAlign,c.sheet,c.row,c.col,c.sheetArea,f,g.content&&yt.prototype.hasInfilling.call(this,g.content)),n=f.x,s=f.width,N=r.isVerticalText,P(d)&&!N&&!0!==r.shrinkToFit&&(M!==(u=D.CellTypes.Context.Et(t,M,h+1,r,a))&&(delete g.content,r.textIndent=0),M=u),this.paintText(t,i,n,e,h,o,r,c,M,g)),t.save(),(s<17||o<17)&&(t.rect(n,e,s,o),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=it,t.moveTo(n+s-17+3,e+(o-2)/2-2.5),t.lineTo(n+s-17+6,e+(o-2)/2+3.5),t.lineTo(n+s-17+9,e+(o-2)/2-2.5),t.fill(),t.restore()},e.prototype.getText=function(t,i){return t},e.prototype.createEditorElement=function(t,i){var n,e,e,e,s,o,r,c,r,u,u,t,n=t&&t.sheet,e=n&&n.parent,e=e&&e.Ti,e=a.gi(e)+1e3,s=n.defaults,o=this,r=n.getActualStyle(t.row,t.col).cellPadding,c=0;return r&&(c=parseFloat(zt(r)[3])||0),r=0,r=(u=n.getSpan(t.row,t.col))?Y(n,u.col,u.col+u.colCount,!1):n.nn(t.col)-c,(u=new wt(i,n.qc(),0,0,s.colWidth,s.rowHeight,e,r)).editorValueType(o._editorValueType),u.items(o._items),u.itemHeight(o._itemHeight),u.itemCountPerPage(o._maxDropDownItems),u.editable(o._editable),u.allowFloat(o.allowFloat()),t=u.getComboBox(),Object.defineProperty(t,"comboBox",{get:function(){return this.gU},set:function(t){this.gU!==t&&(this.gU&&this.gU.dispose(),this.gU=t)}}),t.comboBox=u,M},e.prototype.getEditorValue=function(t,i){var t=G(t);return t&&(this.v6=!t.uU),t&&t.editorValue()},e.prototype.setEditorValue=function(t,i,n){var t=G(t);t&&t.editorValue(i)},e.prototype.focus=function(t,i){var t=G(t);t&&t.focus()},e.prototype.selectAll=function(t,i){var t=G(t);t&&t.selectAll()},e.prototype.activateEditor=function(t,i,n,e){var s,u,a,s=this,u=e.sheet,a=G(t);a&&(a.editorValueType(s._editorValueType),a.items(s._items),a.itemHeight(s._itemHeight),a.itemCountPerPage(s._maxDropDownItems),a.editable(s._editable),a.bind(O,function(t,i){var n,e,s,n,o,r,c,n=i.keyCode,e=i.shiftKey;if(n){if(n=(s=u.Qy()).getShortcutKey(n,!1,e||!1,!1,!1),o=s.getCommands(n))for(r=0,c=o.length;r<c;r++)if("navigationLeft"!==o[r].Zc&&"navigationRight"!==o[r].Zc||(u.Di=1),o[r].execute(u.parent,{sheetName:u.name()}))return!0}else i.isMouse&&a.LG&&u.endEdit()})),s.rU=!0},e.prototype.deactivateEditor=function(t,i){var n,e,s,o,r,c;if(t&&(n=G(t))){if(e=i.sheet.getActualStyle(i.row,i.col,i.sheetArea).cellPadding)for(s=[A,y],o=[3,0],r=0;r<s.length;r++)c=parseInt(zt(e)[o[r]],10),n.shiftPadding(s[r],c=typeof c==V&&0<c?c:0);n.unbind(O),n.closeDropDownList(),n.LG=!1}this.rU=!1},e.prototype.updateImeMode=function(t,i){var t;this.isImeAware()&&(t=G(t))&&t.updateImeMode(i)},e.prototype.updateEditor=function(t,i,n,e){var e,t,e,e=t&&e&&e.sheet;e&&(t=G(t),i&&t&&(e=e.Dn,t.updateStyle(i.backColor,i.foreColor||it,e._n(i.font||e.Nn()))),n)&&t&&t.updateLocationAndSize(n.x,n.y,n.width,n.height)},e.prototype.format=function(t,i,n,e){var s,t;return h(t)?"":(t=(s=this).getItemValue(t),B.prototype.format.call(s,t,i,n))},e.prototype.getItemValue=function(t){var i,n,e,s,o,r,i,c,i=this,n=i._editorValueType,e=i._items;if(e)if(r=e.length,1===n){if(0<=(i=u(t))&&i<r&&(s=e[i])!==I&&s!==M)return o=U(s,S)?s.text:s}else if(2===n)for(c=0;c<r;c++)if((s=e[c])&&U(s,st)&&s.value===t)return o=s.text;return t},e.prototype.parse=function(t,i,n){var e,s,o,r,c,u,a,e=this,s=e._editorValueType,o=e._items,u=B.prototype.parse.call(e,t,i);if(o){if(a=o.length,0===s)return u;if(1===s){for(c=0;c<a;c++)if((r=o[c])&&U(r,S)&&r.text===u||r===u)return c}else if(2===s)for(c=0;c<a;c++)if((r=o[c])&&U(r,S)&&r.text===u)return r.value}return u},e.prototype.getHitInfo=function(t,i,n,e,s){var o,r,c,c,c,i;return s&&(o=s.sheetArea,r=s.sheet,h(o)||3===o)&&e&&(c=zt(n.cellPadding),c=parseInt(c[1],10)||0,c=e.x+e.width-c,i={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:o,sheet:r},c-17<=t)&&t<c?(i.isReservedLocation=!0,i):M},e.prototype.processMouseDown=function(t){var i,n,n,i=t.sheet,n=t.sheetArea;(h(n)||3===n)&&t.isReservedLocation&&i&&(t.row===i.ui&&t.col===i.ci||i.setActiveCell(t.row,t.col),i.startEdit(),n=G(i.li))&&(a.Tt.mozilla&&(n.HG=(new Date).valueOf()),n.showDropDownList(),n.LG=!0)},e.prototype.getAutoFitWidth=function(t,i,n,e,s){var o;return n&&n.wordWrap&&(n.wordWrap=!1),D.CellTypes.Context.Bt(t,i,n,e,s)+17},e.prototype.getAutoFitHeight=function(t,i,n,e,s){return n&&n.wordWrap&&(n.wordWrap=!1),D.CellTypes.Context.tn(t,i,n,e,s)},e.prototype.isImeAware=function(t){return!0},e.prototype.lfe=function(t,i){var i=yt.prototype.lfe.call(this,t,i);return t.readonly||this._editable||(i.readonly=!0),i},e.prototype.Ke=function(){},e.prototype.Je=function(t){var t={editorValueType:t.editorValueType&&ut[t.editorValueType],items:t.items,itemHeight:t.itemHeight,maxDropDownItems:t.maxDropDownItems,editable:t.editable};this.fromJSON(t)},e.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return r(vt,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]=o)}),s},e.prototype.fromJSON=function(n){var e=this;r(vt,function(t){var i=n[t];h(i)||(e["_"+t]=i)})},bt=e,t.ComboBox=bt,r(vt,function(i){bt.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),D.CellTypes.ti[7]=bt},"./dist/plugins/celltype/dataobjectcelltype.js":function(t,i,l){var n,e,s,h,o,o,g,o,M,r,s,c,u;function I(t){return t&&"object"==typeof t&&!(t instanceof e.CalcError)&&!(t instanceof Date)&&!Array.isArray(t)}function f(t){return I(t)?N(t,""):[]}function N(t,i){for(var n,e,s,o,r,c,u,a,n=[],e,s=0,o=Object.keys(t);s<o.length;s++)r=o[s],u=i?i+"."+r:r,"function"!=typeof(c=t[r])&&(I(c)?(a=N(c,u),n.push({text:r,value:c,path:u,layout:{displayAs:h.LayoutDisplayAs.popup},items:a})):n.push({text:r,value:c,path:u}));return n}function a(t){var i=u.call(this)||this;return i.typeName="18",i.pU=t,i}n=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.DataObject=void 0,e=l("CalcEngine"),s=l("Common"),h=l("Core"),o=l("./dist/plugins/celltype/celltypes.ns.js"),o=new s.Common.ResourceManager(o.SR,"CellTypes"),g=o.getResource.bind(o),o=h.CellTypes.Text,M=s.Common.lt.ht,r=void 0,n(a,u=o),a.prototype.Xe=function(t,i,n,e,s){var o=t.Z_(i,n,s,!0);o||((o=new h.Style).cellType=this),t.Ut.do("setStyle",i,n,o,s)},a.prototype.qe=function(u,a,t,i,n){var e,n,e,n=f(u.getValue(a,t,n));0<n.length?(i.formatter=this.pU,i.cellButtons=[{command:"openList",imageType:h.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],i.dropDowns=[{type:h.DropDownType.list,option:{items:n,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(t,i,n){for(var e,s,o,r,c,e=l("SheetsCalc"),s=n.sheetArea,o=n.col+1;o<t.getColumnCount(s);o++){if(t.options.isProtected&&t.getCell(n.row,o,s).locked()){t.jT(16,g().DataObject_MeetLock);break}if(t.Ut.findSpan(n.row,o,s)){t.jT(16,g().DataObject_MeetSpan);break}if(3===s&&t.tables&&t.tables.find(n.row,o)||t.pivotTables&&t.pivotTables.findPivotTable(n.row,o)){t.jT(16,g().DataObject_MeetTable);break}if(M(t.getValue(n.row,o,s))){r=e.rangesToFormula([new h.Range(n.row,n.col,1,1)],a,o,15,1===u.parent.options.referenceStyle),c=n.path,t.Qy().execute({cmd:"editCell",sheetName:t.name(),row:n.row,col:o,sheetArea:s,newValue:"="+r+'."'+c+'"',autoFormat:!1});break}}}}]):(i.cellButtons=r,i.dropDowns=r),i.formatter&&h.util.St(i.formatter)&&u.SL(a,t,i.formatter)},a.prototype.paint=function(t,i,n,e,s,o,r,c){this.pU===r.formatter&&!this.bU||(this.Xe(c.sheet,c.row,c.col,i,c.sheetArea),this.bU=!1),u.prototype.paint.call(this,t,i,n,e,s,o,r,c)},a.prototype.toJSON=function(){return{typeName:this.typeName,format:this.pU}},a.prototype.fromJSON=function(t){this.pU=t.format,this.bU=!0},i.DataObject=s=a,h.CellTypes.ti[18]=s},"./dist/plugins/celltype/dropdown-action.js":function(a,t,i){var y,j,C,z,m,T,p,N,x,t,d,L,S,k,e,s,o,O,i,D,Z,G,U,E,B,Q,R,P,Y,n,r,v,c;function H(t,i){return n.createElement(t,i)}function u(A){return{canUndo:!1,execute:function(t,i,n){var e,t,s,o,r,c,u,a,l,h,g,M,I,l,f,N,d,D,v,l,h,t,w,s,b,l,h,e=(0,y._f)(t,i.sheetName);if(!e||t.jg().name()!==i.sheetName)return!1;if(t=i.row,s=i.col,(k(t)||k(s))&&(t=e.getActiveRowIndex(),s=e.getActiveColumnIndex()),o=i.sheetArea,k(o)&&(o=3),t<0||t>=e.getRowCount(o)||s<0||s>=e.getColumnCount(o))return!1;if(e.showCell(t,s,y.VerticalPosition.nearest,y.HorizontalPosition.nearest),u=e.getCellRect(t,s,r=1===o?-1:void 0,c=2===o?-1:void 0),e.parent&&!e.parent.options.scrollByPixel&&!e.isEditing()){if(0<(a=e.frozenColumnCount())&&a<(l=e.getViewportLeftColumn(1))&&(h=e.getSpan(t,s,o))&&h.col<=l&&l<h.col+h.colCount&&0<(g=l-a))for(M=0;M<g;M++)u.width=u.width-e.getColumnWidth(a+M+1,o);if(0<(I=e.frozenRowCount())&&I<(l=e.getViewportTopRow(1))&&(h=e.getSpan(t,s,o))&&h.row<=l&&0<(f=(l<h.row+h.rowCount?l:h.rowCount)-I))for(M=0;M<f;M++)u.height=u.height-e.getRowHeight(I+M+1,o)}switch(N=H("div"),d=V(e,t,s,o),(k(i.row)||k(i.col))&&(i.row=e.getActiveRowIndex(),i.col=e.getActiveColumnIndex()),l=i.row,h=i.col,t=e.Il(l,h,o),w=J(A),(l=(s=t.dropDowns)&&0<s.length)&&(h=s.filter(function(t){return t.type===w})[0])&&(void 0!==h.option&&null!==h.option&&(v=h.option),b=h),A){case Z:D=new p.ColorPicker(N);break;case G:D=v&&v.showDateRange?(d=W(d,"dateRange"),new x.RangeCalendar(N,v)):(d=W(d,"date"),new x.Calendar(N));break;case U:d=W(d,"date"),D=new m.TimePicker(N);break;case E:d=(d=W(d,"number")).toString(),D=new j.Calculator(N);break;case B:d=W(d,"date"),D=new T.MonthPicker(N);break;case Q:(D=new C.List(N)).formula=e.getFormula(i.row,i.col);break;case R:d=v&&v.showNumberRange?W(d,"numberRange"):W(d,"number"),D=new z.Slider(N);break;case P:D=new L.WorkFlow(N),"string"!=typeof d&&d!==O&&(d=d.toString());break;case Y:D=new S.MultiColumn(N,O,e)}return X(D,d,u,e,i,t,l,b,v),!0}}}function V(t,i,n,e){var s,o;return t.isEditing()?(s=t.getCellType(i,n)).getEditorValue(t.li,o={sheet:t,row:i,col:n,sheetArea:e}):t.getValue(i,n,e)}function W(t,i){var i,n;return"date"===i?"string"==typeof t?(t=s.yU(t))===O&&(t=new Date):t instanceof Date||(t=new Date):"dateRange"===i?t&&"object"==typeof t&&(t={start:o(t.start),end:o(t.end)}):"number"===i?"string"==typeof t?t=e.yU(t):"number"!=typeof t&&(t=0):"numberRange"===i&&(n=i=0,t&&"object"==typeof t&&("string"===t.start?i=e.yU(t.start):isNaN(t.start)||(i=t.start),"string"===t.end?n=e.yU(t.end):isNaN(t.end)||(n=t.end)),t={start:i,end:n}),t}function w(t,i,n,e){var s,o,r,c,n,i,c,r,s=n.row,o=n.col;(k(s)||k(o))&&(s=t.getActiveRowIndex(),o=t.getActiveColumnIndex()),r=n.sheetArea,k(r)&&(r=3),i&&i.submitCommand?"string"==typeof i.submitCommand?t.getParent().commandManager().execute({cmd:i.submitCommand,sheetName:t.name(),row:s,col:o,newValue:e.value}):"function"==typeof i.submitCommand&&((c={}).row=n.row,c.col=n.col,c.sheetArea=r,c.path=e.path,i.submitCommand.call(null,t,e.value,c)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:s,col:o,newValue:e.text,autoFormat:!e.noAutoFormat,sheetArea:r,isUndo:!1}),t.isEditing()&&t.ci===o&&t.ui===s&&(n=t.getCellType(s,o),i={sheet:t,row:s,col:o,sheetArea:y.SheetArea.viewport},c=t.Il(s,o,r),r=t.getCellRect(s,o),t.li.Li=e.value,n.updateEditor(t.li,c,r,i),n.setEditorValue(t.li,e.text,i)))}function J(t){var i=-1;switch(t){case Z:i=y.DropDownType.colorPicker;break;case G:i=y.DropDownType.dateTimePicker;break;case U:i=y.DropDownType.timePicker;break;case E:i=y.DropDownType.calculator;break;case B:i=y.DropDownType.monthPicker;break;case Q:i=y.DropDownType.list;break;case R:i=y.DropDownType.slider;break;case P:i=y.DropDownType.workflowList;break;case Y:i=y.DropDownType.multiColumn}return i}function b(t,i,n,e,s){var i,i,i=i.cellButtons;t&&i&&0<i.length&&(i=t.Ut.getValueForKey(n,e,r,s))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,e)))}function X(i,t,n,e,s,o,r,c,u){var a,l,h,g,M,u,t,u,I,I,t,u,n,f;D.ef(),a=e.parent,l=e.qc(),h=s.row,g=s.col,M=s.sheetArea,u&&(u.row=h,u.col=g),i.setOptions(u),i.setValue(t),u=l.getBoundingClientRect(),t=n.x+u.left,u=n.y+u.top,(I=A(a))&&(t+=I.x,u+=I.y),I=new N.Rectangle(t,u,n.width,n.height),u=(t=i.getOptions())&&!k(t.dropDownAlignment)?t.dropDownAlignment:y.DropDownAlignment.Far,n=t&&!k(t.dropDownDirection)?t.dropDownDirection:void 0,f=new N.PopupControl(i.getContainer(),I,{align:u,hostElement:l,direction:n}),v+=1,r&&i.wU(),f.open(),i.scrollToSelect(),r&&i.refresh(),i.on(d.BaseDropdown.Event_ValueChanged,function(t){t.notCloseDropDown||f.close(),F(s,t)&&w(e,c,s,t)}),a&&(a.CC=a.CC||[],a.CC.push(f)),i.getContainer().addEventListener("contextmenu",function(t){t.stopPropagation(),t.preventDefault()}),f.on("close",function(){b(e,o,h,g,M),i&&i.dispose(),--v,f=null;var t=a.CC.indexOf(f);a.CC.splice(t,1),D.cf()})}function A(t){var i,n,e,s;if(t&&(i=t.options.tabStripVisible)&&0!==(n=t.options.tabStripPosition)){switch(e={x:0,y:0},s=t.w2.kg,n){case 1:e.y=s.height;break;case 2:e.x=s.width}return e}}function F(t,i){return!0!==i.notSubmit&&(3===t.sheetArea||t.cmd!==E||!isNaN(i.value))}Object.defineProperty(t,"__esModule",{value:!0}),t.commands=void 0,y=i("Core"),Object.defineProperty(t,"commands",{enumerable:!0,get:function(){return y.Commands}}),j=i("./dist/plugins/celltype/editor/calculator.js"),C=i("./dist/plugins/celltype/editor/listControl.js"),z=i("./dist/plugins/celltype/editor/slider.js"),m=i("./dist/plugins/celltype/editor/timepicker.js"),T=i("./dist/plugins/celltype/editor/monthPicker.js"),p=i("./dist/plugins/celltype/editor/colorpicker.js"),N=i("./dist/plugins/celltype/editor/popupControl.js"),x=i("./dist/plugins/celltype/editor/calendar.js"),t=i("Common"),d=i("./dist/plugins/celltype/editor/baseControl.js"),L=i("./dist/plugins/celltype/editor/workflowPicker.js"),S=i("./dist/plugins/celltype/editor/multiColumnPicker.js"),k=t.Common.lt.ht,e=t.Common.st,s=t.Common.ct,o=y.mt.Eve,O=null,i=window,D=i.Vc,Z="openColorPicker",G="openDateTimePicker",U="openTimePicker",E="openCalculator",B="openMonthPicker",Q="openList",R="openSlider",P="openWorkflowList",Y="openMultiColumn",n=document,r="_cellButtonParam",y.Commands[Z]=u(Z),y.Commands[G]=u(G),y.Commands[U]=u(U),y.Commands[E]=u(E),y.Commands[B]=u(B),y.Commands[Q]=u(Q),y.Commands[R]=u(R),y.Commands[P]=u(P),y.Commands[Y]=u(Y),v=0,y.Workbook.ch("registerOpendropdownCommand",c={init:function(){this.commandManager().register(Z,y.Commands[Z]),this.commandManager().register(G,y.Commands[G]),this.commandManager().register(U,y.Commands[U]),this.commandManager().register(E,y.Commands[E]),this.commandManager().register(B,y.Commands[B]),this.commandManager().register(Q,y.Commands[Q]),this.commandManager().register(R,y.Commands[R]),this.commandManager().register(P,y.Commands[P]),this.commandManager().register(Y,y.Commands[Y])}}),y.Worksheet.ch("registerOpendropdownCommand",{preProcessMouseWheel:function(t){0<v&&!this.RD&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,i,n){var e,n,s,o,r,c,u;function a(t){var i=c.call(this)||this;return i.Wc=t,i}function l(t){var i=u.call(this)||this;return i.Ti=t,i}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseDropdown=i.BaseControl=void 0,n=n("./dist/plugins/celltype/editor/eventbase.js"),c=n.EventBase,e(a,c),a.prototype.init=function(t,i,n){this.Ti=this.Wc.querySelector("."+i),this.Ti?this.RemoveChilds(this.Ti):(this.Ti=this.CreateElement(t,i,n),this.Wc.appendChild(this.Ti))},a.prototype.GetContainer=function(){return this.Wc},a.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},a.prototype.CreateElement=function(t,i,n,e){var s,o,s=document.createElement(t);if(i&&(s.className=i),n)for(o in n)n[o]&&s.setAttribute(o,n[o]);return e&&e.appendChild(s),s},i.BaseControl=a,u=n.EventBase,e(l,u),l.prototype.getOptions=function(){return this.MU},l.prototype.updateStyle=function(t,i,n){},l.prototype.scrollToSelect=function(){},l.prototype.getContainer=function(){return this.Ti},l.prototype.refresh=function(){},l.prototype.wU=function(){},l.prototype.dispose=function(){},l.Event_ValueChanged="ValueChangedEvent",i.BaseDropdown=l},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,i,n){var e,s,o,n,h,g,M,r,c,I,f,N,u,a,l;function d(t,i,n){var t=l.call(this,t)||this;return t.setOptions(i),t.CU=n,t}function D(t,i,n){var e={sheet:t};h(n)||(e.isEsc=n),t.ki(i,e)}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.BaseSpreadPicker=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Core"),n=n("Common"),h=n.Common.lt.ht,g=Math.min,M=Math.max,r=null,c=".baseSpreadNS",I=800,f=400,N=100,l=s.BaseDropdown,e(d,l),d.prototype.setOptions=function(t){var i,t,i,i=this;(i.MU=t)&&(t=i.Ti,(i=document.createElement("div")).setAttribute("class","gc-base-spread-div"),t.appendChild(i),this.SU=i,this.TU=this.AU(i))},d.prototype.setValue=function(t){var i,n,i=this;i.MU&&(n=i.TU,setTimeout(function(){var t;window.Vc.cf(),n&&n.focus(!0)},1e3))},d.prototype.wU=function(){var t,i,n,e,s,n,t=this;t.SU&&(i=t.Ti,(n=t.MU)&&(e=n.width,s=n.height),n=t.IU(e,s),h(e)&&(e=n.width),h(s)&&(s=n.height),(0,o.GC$)(i).width(e).height(s))},d.prototype.refresh=function(){this.TU&&this.TU.refresh()},d.prototype.dispose=function(){var t=this;t.CU&&(t.CU.Zg(),t.CU=r),t.SU&&(t.SU=r),t.TU&&(t.TU.unbind(o.Events.DropdownSpreadMouseClick+c),t.TU.unbind(o.Events.DropdownSpreadKeyboardEnter+c),t.TU.L0(),t.TU=r)},d.prototype.IU=function(t,i){for(var n,e,s,o,r,c,u,a,a,t,t,i,l,n,e=this.TU,s=e.getActiveSheet(),o=s.getColumnCount(),r=0,c=0;c<o;c++)r+=s.getColumnWidth(c,3);return u=r,a=s.getRowCount(3)+s.getRowCount(1),a=s.getRowHeight(0,3)*a,u<I&&h(t)||u<=t?e.options.showHorizontalScrollbar=!1:(t=0,a+=t=e.zb?e.zb.ZC():t),a<f&&h(i)||a<i?e.options.showVerticalScrollbar=!1:(t=0,u+=t=(i=e.Xb)?(l=i.lS(!1))||e.NC():t),{width:g(u,I),height:g(M(a,N),f)}},d.prototype.AU=function(t){var t,i,n,e,t=new o.Workbook(t,{sheetCount:1});return t.xU=!0,(i=t.options).allowUserDragDrop=!1,i.allowUserDragFill=!1,i.allowUserResize=!1,i.allowUserZoom=!1,i.tabStripVisible=!1,i.allowContextMenu=!1,i.allowUserDeselect=!1,i.scrollbarMaxAlign=!0,(n=t.getActiveSheet()).RD=!0,e=this,t.bind(o.Events.DropdownSpreadMouseClick+c,function(t,i){e.submitData(i)}),t.bind(o.Events.DropdownSpreadKeyboardEnter+c,function(t,i){e.submitData(i)}),t},d.prototype.submitData=function(t){},i.BaseSpreadPicker=d,o.GC$.extend(o.Worksheet.prototype,{BD:function(){D(this,o.Events.DropdownSpreadMouseClick)},GD:function(t){D(this,o.Events.DropdownSpreadKeyboardEnter,t)}})},"./dist/plugins/celltype/editor/calculator.js":function(t,i,n){var e,o,s,r,c,n,u,a,l,h,g,M,I,f,N,d,D,v,w,b,A,y;function j(t){var t=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);return t=isNaN(t)?0:t}function C(){}function z(){}function m(){}function T(t,i,n,e,s,o,r,c,u,a,l){var h=this;h.Y6=t,h._x=i,h._y=n,h.NU=e,h.kU=s,h.DU=o,h._U=r,h.EU=c,h.jU=u,h.OU=a,h.RU=l,h.BU=N}function p(t){var i,n,e,i=y.call(this,t)||this,n=i;return n.Ti=document.createElement("div"),n.Ti.classList.add("gc-calculator-container"),n.Ti.innerHTML=a,(e=n.Ti.querySelector(".okbtn")).textContent=u().OK,t.appendChild(i.Ti),n.LU(),n.FU(),n.PU(),n.GU(),n.UU("0"),i}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Calculator=i.CalculatorErrorInfo=void 0,o=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),r=n("Common"),c=n("Core"),n=new r.Common.ResourceManager(s.SR,"CellTypes"),u=n.getResource.bind(n),a='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,h=Math.abs,g=Math.pow,M=Math.round,I=Math.sqrt,f=Math.max,N=new Array("0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"),C.Init=function(){var t;C.GetBrowserType(),C.IsIE=void 0!==C.ie||void 0!==C.edge},C.GetBrowserType=function(){try{var t=navigator.userAgent.toLowerCase();window.ActiveXObject?C.ie=t.match(/msie ([\d.]+)/)[1]:-1!==t.indexOf("edge")?C.edge=t.match(/edge\/([\d.]+)/)[1]:-1!==t.indexOf("firefox")&&(C.firefox=t.match(/firefox\/([\d.]+)/)[1]),-1!==t.indexOf("rv:")&&-1===t.indexOf("firefox")&&(C.ie=t.match(/rv:([\d.]+)/)[1])}catch(t){}},(d=C).Init(),z.IsErrorText=function(t){return t===u().Calculator_DivideByZeroInfo||t===u().Calculator_InvalidInputInfo||t===u().Calculator_SqrtParameterException||t===u().Calculator_OverFlowInfo},D=z,i.CalculatorErrorInfo=D,m.IsDotContained=function(t){var i;return-1!==(t+"").indexOf(".")},m.GetDotPosition=function(t){var i,n,e,i=t+"",n=0,e=0;for(e=i.length;0<e;e--){if("."===i.substring(e-1,e))return n;n++}return 0===e?0:n},m.FormatOutput=function(t){var i,n,e;if(null==t)return null;if(n=0,e=(i=t+"").length,m.IsDotContained(i))for(;"0"===i.substring(e-1,e)&&""!==i&&-1===i.indexOf("e");)i=i.substring(0,e-1),e--;return i},m.FormatResult=function(t){var i,n,t,e,s,o,s,i=(t=isNaN(t)?0:t)+"",n="";return t<0&&(n="-",i=i.substring(1,i.length)),t=i.length,e="",-1!==(s=i.indexOf("e"))&&(e=i.substring(s,t),t=(i=i.substring(0,s)).length),m.IsDotContained(i)&&16<t&&(o=0,i=1<parseFloat(i)?(o=m.GetDotPosition(i)-(t-16),i.toString().substring(0,17)):(o=m.GetDotPosition(i)-(t-17),i.toString().substring(0,18)),i=(0<o?M(parseFloat(i)*g(10,o))/g(10,o):M(parseFloat(i))).toString()),t=i.length,!m.IsDotContained(i)&&15<t&&(o=t-15,i=(M(parseFloat(i)/g(10,o))*g(10,o)).toString()),i=n+i+e,s=parseFloat(i),m.IsOverFlow(s.toString())?u().Calculator_OverFlowInfo:s},m.SingleMathOperation=function(t,i){var t,i,t=parseFloat(t);if(isNaN(t)&&(t=0),"SQRT"===i){if(t<0)return u().Calculator_InvalidInputInfo;t=I(t)}if("POW"===i&&(t=g(t,2)),"1/x"===i){if(0===t)return u().Calculator_DivideByZeroInfo;i=m.GetDotPosition(t.toString()),t=g(10,i)/(g(10,i)*t)}return m.FormatResult(t)},m.DoubleMathOperation=function(t,i,n){var t,i,e,s,o,r,t=parseFloat(t),i=parseFloat(i);if(m.IsDotContained(t.toString())||m.IsDotContained(i.toString())){if(o=s=0,m.IsDotContained(t.toString())&&(s=m.GetDotPosition(t.toString())),m.IsDotContained(i.toString())&&(o=m.GetDotPosition(i.toString())),r=f(s,o),"+"===n&&(e=((t*=g(10,r))+(i*=g(10,r)))/g(10,r)),"-"===n&&(e=((t*=g(10,r))-(i*=g(10,r)))/g(10,r)),"*"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o)),"/"===n){if(t*=g(10,r),0===(i*=g(10,r)))return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=(t*=g(10,s))*(i*=g(10,o))/g(10,s+o+2))}else{if("+"===n&&(e=t+i),"-"===n&&(e=t-i),"*"===n&&(e=t*i),"/"===n){if(0===i)return u().Calculator_DivideByZeroInfo;e=t/i}"%"===n&&(e=t*i/100)}return m.FormatResult(e)},m.IsOverFlow=function(t){var t=parseFloat(t);if(0!==t){if(79e27<t)return!0;if(t<1e-28&&-1e-28<t)return!0;if(t<-79e27)return!0}return!1},v=m,T.prototype.HU=function(){var t=this;t.Y6="",t._x=null,t._y=null,t.NU=null,t.kU=0,t.EU=!1,t.jU=!1},T.prototype.Click=function(t){var i,t,i=this;return 0<=t&&t<=11&&(i.OU&&(i.zU(t),i.OU=!1),i.VU(t),10!==t)&&(i.RU="ClickNumericButton"),(12<=t&&t<=19||27===t)&&(i.OU?(i.zU(t),i.OU=!1):(i.YU(t),i.RU="ClickMathButton")),24===t&&(i.OU&&(i.zU(t),i.OU=!1),i.ZU()),25!==t&&26!==t||(i.zU(t),i.OU=!1),i.OU?null:((t={}).outputText=i.WU(),D.IsErrorText(i.Y6)&&(i.OU=!0),t.result=void 0===i.Y6||null===i.Y6?"":i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,t)},T.prototype.VU=function(t){var i=this;if(null!==i.Y6&&void 0!==i.Y6||(i.Y6=""),!(14<i.DU&&10!==t))switch(11!==t&&10!==t&&(0!==t||i.Y6+""!="0"&&""!==i.Y6)&&i.DU++,10!==t&&(i.EU=!0),i.kU){case 0:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0!==t?i.Y6=""+t:"0"!==i.Y6&&(i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0."),""===i.Y6||v.IsDotContained(i.Y6)?""!==i.Y6&&v.IsDotContained(i.Y6)||(i.Y6="0."):i.Y6=i.Y6+"."),i.kU=1;break;case 1:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i.jU||(i._y=i.Y6);break;case 2:0<=t&&t<=9&&(i.Y6="",i.Y6=i.Y6+t),11===t&&(i.Y6="0."),10===t&&(i.Y6="0"),i.kU=3,i._y=i.Y6;break;case 3:0<=t&&t<=9&&("ClickNumericButton"!==i.RU&&void 0!==i.RU&&null!==i.RU&&(i.Y6="0"),"0"===i.Y6&&0===t||("0"===i.Y6&&0!==t?i.Y6=""+t:i.Y6=i.Y6+""+t)),10===t&&(-1===i.Y6.toString().indexOf("e")?""!==i.Y6&&"0"!==i.Y6&&(-1===i.Y6.toString().indexOf("-")?i.Y6="-"+i.Y6:i.Y6=i.Y6.toString().substring(1,i.Y6.toString().length)):0<+i.Y6?i.Y6="-"+i.Y6:i.Y6=i.Y6.substring(1,i.Y6.length)),11===t&&("ClickNumericButton"!==i.RU&&null!==i.RU?i.Y6="0.":v.IsDotContained(i.Y6)||(""===i.Y6?i.Y6="0.":i.Y6=i.Y6+".")),i._y=i.Y6}},T.prototype.YU=function(t){var i=this;switch(i.DU=0,i.EU=!1,i.jU&&(i.jU=!1),i.Y6=v.FormatOutput(i.Y6),i.kU){case 0:""===i.Y6&&(i.Y6=0),(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6),i.kU=1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&i.HU();break;case 1:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?i._y=i.Y6:i._x=i.Y6)),19===t&&(null!==i.NU&&void 0!==i.NU&&null!==i._y&&void 0!==i._y?(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6)):"-0."===i.Y6&&(i.Y6="0."),i.jU=!0,i.EU=!1),12<=t&&t<=15&&(i.NU=t,i._x=i.Y6,i.kU=2),17===t&&(null!==i.NU&&void 0!==i.NU?(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]).toString(),i._y=i.Y6):i.HU());break;case 2:(16<=t&&t<=18&&17!==t||27===t)&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i.kU=3,i._y=i.Y6)),19===t&&(i._y=i._x,i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0),12<=t&&t<=15&&(i.NU=t,i._y=i.Y6),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._x.toString(),i.BU[17]),D.IsErrorText(i.Y6)||(i._y=i.Y6,i.kU=3));break;case 3:16<=t&&t<=18&&17!==t&&(i.Y6=v.SingleMathOperation(i.Y6,i.BU[t]).toString(),D.IsErrorText(i.Y6)||(i._y=i.Y6)),12<=t&&t<=15&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i._y=null,i.NU=t,i.kU=2)),17===t&&(i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[17]),D.IsErrorText(i.Y6)||(i._y=i.Y6)),19===t&&(i._y=i.Y6,i.Y6=v.DoubleMathOperation(i._x.toString(),i._y.toString(),i.BU[i.NU]).toString(),D.IsErrorText(i.Y6)||(i._x=i.Y6,i.kU=1,i.EU=!1),i.jU=!0)}i.Y6+=""},T.prototype.ZU=function(){var t,i,n,t=this;if(0<t.DU&&t.DU--,(0===t.kU||1===t.kU||3===t.kU)&&!0===t.EU)switch(t.Y6+="",(i=0)<(n=t.Y6.length)&&(t.Y6=t.Y6.substring(0,n-1)),"-0"===t.Y6&&(t.Y6="0"),"-"===t.Y6&&(t.Y6=""),""===t.Y6&&(t.EU=!1),t.kU){case 0:case 1:t._x=t.Y6;break;case 3:t._y=t.Y6}},T.prototype.zU=function(t){var i=this;i.DU=0,i.EU=!1,i.Y6="",25===t&&(1!==i.kU||null===i.NU||void 0===i.NU||i.jU||(i._y=0),2===i.kU)&&(i.kU=3),26===t&&i.HU()},T.prototype.WU=function(){var t,i,t=this,i="";return i=""===t.Y6||null===t.Y6||void 0===t.Y6?"0":t.Y6},T.prototype.mf=function(t){var i=t.keyCode;switch(t.shiftKey&&(i|=65536),t.ctrlKey&&(i|=131072),t.altKey&&(i|=262144),i){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(d.IsIE)break;return 12;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===i&&d.firefox||187===i&&!d.firefox?19:-1}},w=T,y=o.BaseDropdown,e(p,y),p.prototype.setValue=function(t){var i,t,i=this;t=i.QU(t);try{if(!i.q8(t))throw new Error(u().Calculator_InvalidInputInfo);t=""===t?"0":t,i.Y6=i.KU(t),i._text=i.JU(t),i._x=parseFloat(i.Y6),i._y=null,i.NU=null,i.kU=0,i.DU=i.XU(parseFloat(i.Y6)),0<i.DU?i.EU=!0:i.EU=!1,i.jU=!1,i.OU=!1,i.RU=null}catch(t){i._text=u().Calculator_InvalidInputInfo,i.Y6="",i._x=null,i._y=null,i.OU=!0}return i.qU(i.OU),i.UU(i._text),(t={}).outputText=i._text,t.result=i.Y6,t.x=i._x,t.y=i._y,t.operation=i.NU,t.token=i.kU,t.count=i.DU,t.memoryNumber=i._U,t.isBSCanUse=i.EU,t.isEqualClicked=i.jU,t.isOperationInvalid=i.OU,t.lastOperation=i.RU,i.$U=new w(i.Y6,i._x,i._y,i.NU,i.kU,i.DU,i._U,i.EU,i.jU,i.OU,i.RU),i},p.prototype.setOptions=function(){},p.prototype.scrollToSelect=function(){var t=this.Ti.querySelector(".gc-main-screen .gc-main");this.tH(t)},p.prototype.LU=function(){var t=this;t.nH="0",t._text=t.nH,t.Y6="",t._x=0,t._y=0,t.NU=null,t.kU=0,t.DU=0,t._U=null,t.EU=!1,t.jU=!1,t.OU=!1,t.RU=null},p.prototype.FU=function(){var t=this;t.$U=new w(this.Y6,t._x,t._y,t.NU,t.kU,t.DU,t._U,t.EU,t.jU,t.OU,t.RU)},p.prototype.PU=function(){var t=this;t.qU(t.OU)},p.prototype.GU=function(){var n,e,s,t,i,n=this,e=this,s=e.Ti,t,i=function(t){!0!==e.mf(t)&&(t.preventDefault(),t.stopPropagation())};s.addEventListener("click",function(t){for(var i,t,t,i=t.srcElement||t.target;i&&!i.classList.contains("button");)i=i.parentElement;i&&(i.getAttribute("data-value")?(t=i.getAttribute("data-value"),t=p.eH(t),s.focus(),-1!==t&&e.iH(t)):i.classList.contains("okbtn")&&("ClickNumericButton"===e.RU&&e.iH(19),n.fire(o.BaseDropdown.Event_ValueChanged,{value:e._text,text:e._text})))}),s.addEventListener("keydown",i),s.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation()})},p.prototype.UU=function(t){var i,n,i=this.Ti.querySelector(".gc-main-screen .gc-main"),n=i.value;null!=n&&n.toString().replace(/\r\n/g,"\n")!==t.toString().replace(/\r\n/g,"\n")&&(i.value=t,this.tH(i))},p.prototype.tH=function(t){var i=this;if(null!==i.rH&&void 0!==i.rH||(i.rH=j(t)),i.oH(t))for(;i.oH(t);)i.aH(t);else i.uH(t)},p.prototype.oH=function(t){var i,n,e,i,s,o;return 1<t.scrollWidth-t.clientWidth||!(!c.mt.Tt.edge&&!c.mt.Tt.msie||t.clientWidth<=0)&&(n=(i=window.getComputedStyle(t)).fontWeight,e=i.fontSize,i=i.fontFamily,(o=c.q.Wt(t.value,s=n+" "+e+" "+i))+40>t.clientWidth)},p.prototype.aH=function(t){var i=j(t);t.style.fontSize="".concat(i-1,"px")},p.prototype.uH=function(t){for(var i,n,i=this,n=j(t);!i.oH(t)&&n<i.rH;)if(t.style.fontSize="".concat(++n,"px"),i.oH(t)){for(;i.oH(t);)i.aH(t);break}},p.prototype.QU=function(t){if(void 0!==t&&("string"==typeof t||t instanceof String))return(t=null==t?"":t).toString();throw new Error(t+" type is not a string.")},p.prototype.sH=function(t,i){var n,e,s,o;if(0===i.length)return"";for(n="",s=e=0;e<i.length;e++){for(o=!1,s=0;s<t.length;s++)i.substring(e,e+1)===t.substring(s,s+1)&&(o=!0);!0===o&&(n+=i.substring(e,e+1))}return n},p.prototype.q8=function(t){var i;return this.sH("-.0123456789",t)===t&&(-1===(i=t.indexOf("-"))||0===i)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},p.prototype.KU=function(t){var t,i,t,n,e,s,o,t=parseFloat(t),i=t<0?!0:!1,t=h(t),n=l(t),e=v.GetDotPosition(t.toString()),s=(t*g(10,e)-n*g(10,e))/g(10,e);if(999999999999999<n)throw new Error(u().Calculator_InvalidInputInfo);return 999999999999999!==n?(o=0===n?15:15-n.toString().length,s=M(s*g(10,o))/g(10,o),e=v.GetDotPosition(s.toString()),t=(n*g(10,e)+s*g(10,e))/g(10,e),n=l(t),e=v.GetDotPosition(t.toString()),0===(s=(t*g(10,e)-n*g(10,e))/g(10,e))&&(t=n),i?"-"+t:""+t):0===s?n:void 0},p.prototype.JU=function(t){var t=t.toString();return t=""===t?"0":t},p.prototype.XU=function(t){var t,i,n,t,e,s,t=h(t),i=l(t),n=v.GetDotPosition(t.toString()),t=(t*g(10,n)-i*g(10,n))/g(10,n),e,s;return(0===i?0:i.toString().length)+(0==t?0:n)},p.prototype.qU=function(t){for(var i=10;i<=18;i++)this.cH(i,t);this.cH(27,t)},p.prototype.cH=function(t,i){var t,t,t=N[t],t=this.Ti.querySelector('[data-value="'+t.toLowerCase()+'"]');t&&(i?t.classList.add("disabled"):t.classList.remove("disabled"))},p.eH=function(t){var i=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i=parseInt(t,10);break;case"+/-":i=10;break;case".":i=11;break;case"+":i=12;break;case"-":i=13;break;case"*":i=14;break;case"/":i=15;break;case"sqrt":i=16;break;case"%":i=17;break;case"1/x":i=18;break;case"=":i=19;break;case"MC":i=20;break;case"MR":i=21;break;case"MS":i=22;break;case"M+":i=23;break;case"BS":i=24;break;case"CE":i=25;break;case"C":i=26;break;case"pow":i=27;break;default:i=-1}return i},p.prototype.iH=function(t){var i,t,i=this,t=i.$U.Click(t);null!=t&&(null!==t.result&&void 0!==t.result&&(i.Y6=t.result),null!==t.outputText&&void 0!==t.outputText&&(i.nH=t.outputText,i._text=i.nH,i.UU(i.nH)),null!==t.isOperationInvalid&&void 0!==t.isOperationInvalid&&t.isOperationInvalid!==i.OU&&(i.OU=t.isOperationInvalid,i.qU(i.OU)),t.memoryNumber!==i._U&&(i._U=t.memoryNumber),t.lastOperation!==i.RU)&&(i.RU=t.lastOperation)},p.prototype.mf=function(t){var t=this.$U.mf(t);return null==t||-1!==t&&void this.iH(t)},i.Calculator=p},"./dist/plugins/celltype/editor/calendar.js":function(G,t,i){var n,U,E,o,e,r,c,i,f,e,u,B,a,Q,R,P,Y,H,W,V,J,X,F,l,N,_,K,q,$,tt,it,nt,et,st,d,D,h,g,ot,M,I,rt,s,ct,ut,v,w,at,b,A,y,lt,ht,gt,Mt,It,ft,Nt,dt,Dt,vt,wt,bt,At,j,yt,C,jt,Ct,zt,mt,z,Tt,m,T,pt,xt,Lt,St,p,kt,Ot,Zt,Gt,Ut,Et,Bt,Qt,i,Rt,Pt,Yt;function x(t){return B.createElement(t)}function Ht(){}function Wt(){this.yearTds=[]}function Vt(){this.monthTds=[]}function Jt(){this.weekThs=[],this.dayTds=[]}function Xt(){this.calendarYearSection=new pt,this.calendarMonthSection=new xt,this.calendarDaySection=new Lt,this.timeItemLIs=[]}function L(){}function Ft(t,i,n,e){this.year=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function _t(t,i,n,e){this.month=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function Kt(t,i,n,e){this.date=t,this.selected=!!i,this.disabled=!!n,this.focused=!!e}function S(t){this.owner=t,this.calendarPage=c.CalendarPage.month,this.oldSelectedData=null,this.S1e=null,this.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},this.selectedDate=new Date,this.updateDayFocusDate(),this.focusDateTimeIndex=-1,T.initResource()}function k(t){var i=Rt.call(this)||this;return i.fH=40,i.lH=100,i.hH=!1,i.jS=t,i}function O(t,i,n,e){var s=Pt.call(this,t)||this;return s.dH=7,s.HG=!0,n&&(s.parent=n,s.A1e=!0,s.HG=!1,s.N1e=e),s._data=new Gt(s),s.Dn=new Ut(s),s.Dn.on(o.BaseDropdown.Event_ValueChanged,function(t){var i,i,i=r.Common.CultureManager.getCultureInfo().DateTimeFormat,i=new r.Formatter.GeneralFormatter(i.defaultDatePattern).format(t.newValue);s.fire(o.BaseDropdown.Event_ValueChanged,{text:i,value:t.newValue})}),s.Dn.on(Ut.Event_GetHost,function(t){t.host=s.Ti}),s.A1e||(s.Ti.innerHTML=""),s.Ti.appendChild(s.Dn.createCalendarDom()),s.Dn.attachEvent(),s.A1e||s.setValue(new Date),s.Dn.showCalendarPage(c.CalendarPage.day),s.Dn.setCalendarActivePart(m.Date),i&&s.setOptions(i),s}function Z(t,i){var t=Yt.call(this,t)||this;return t.D1e=0,t.S1e=null,t.T1e={start:p.getDefaultDate(),end:p.getDefaultDate()},t._1e(i),t.aY(),t}n=this&&this.__extends||(Qt=function(t,i){return(Qt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Qt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.RangeCalendar=t.Calendar=void 0,U=i("./dist/plugins/celltype/editor/eventbase.js"),E=i("./dist/plugins/celltype/editor/timepicker.js"),o=i("./dist/plugins/celltype/editor/baseControl.js"),e=i("./dist/plugins/celltype/celltypes.ns.js"),r=i("Common"),c=i("Core"),i=new r.Common.ResourceManager(e.SR,"CellTypes"),f=i.getResource.bind(i),e=r.Common.lt,u=e.ht,B=document,a="gc-calendar-container",Q="gc-date-ranges-calendar",R="gc-range-calendar-container",P="gc-date-range-container",Y="gc-date-time-container",H="gc-date-part-container",W="gc-time-part-container",V="gc-ok-button-container",J="gc-date-container",X="gc-week-container",F="gc-today-container",l="gc-content-container",N="gc-header-container",_="gc-header-title",K="gc-content-td-date",q="gc-content-td-time",$="gc-date-time-vertical-partline",tt="gc-date-time-horizontal-partline",it="gc-year-page",nt="gc-year-select-div",et="gc-month-page",st="gc-day-page",d="gc-left-arrow",D="gc-right-arrow",h="gc-arrow-disable",g="gc-is-focused",ot="gc-cl-select",M="gc-cl-is-selected",I="gc-cl-disabled-text",rt="gc-cl-select-container",s="gc-focus-part-indicator",ct="gc-cl-datepicker",ut="gc-cl-dropdown",v="gc-cl-datepicker-filter",w="gc-cl-datepicker-filter-month",at="gc-cl-grid-align-spread",b="gc-cl-align-middle",A="gc-cl-button-icon-container",y="gc-cl-datepicker-month",lt="gc-cl-day",ht="gc-cl-week",gt="gc-cl-show-inline-block",Mt="gc-builtIn-date-Range-child-div",It="gc-builtIn-date-ranges-div",ft="gc-date-ranges-result-div",Nt="gc-date-ranges-result-button",dt="gc-builtIn-date-range-childDiv-select",Dt="gc-date-ranges-result-buttonDiv",vt="gc-date-ranges-result-input",wt="gc-cl-p-bottom-x-small",bt="gc-cl-shrink-none",At="gc-cl-grow",j="gc-cl-grid",yt="gc-uiButton",C="gc-cl-button",jt="gc-cl-button-brand",Ct="year-index",zt="month-index",mt="week-index",z="day-index",Tt="dateRange-index",(i=m=m||{})[i.Date=1]="Date",i[i.Time=2]="Time",Ht.initResource=function(){Ht.resource={shortWeeks:[f().Calendar_ShortWeeks_1,f().Calendar_ShortWeeks_2,f().Calendar_ShortWeeks_3,f().Calendar_ShortWeeks_4,f().Calendar_ShortWeeks_5,f().Calendar_ShortWeeks_6,f().Calendar_ShortWeeks_7],shortMonths:[f().Calendar_ShortMonths_1,f().Calendar_ShortMonths_2,f().Calendar_ShortMonths_3,f().Calendar_ShortMonths_4,f().Calendar_ShortMonths_5,f().Calendar_ShortMonths_6,f().Calendar_ShortMonths_7,f().Calendar_ShortMonths_8,f().Calendar_ShortMonths_9,f().Calendar_ShortMonths_10,f().Calendar_ShortMonths_11,f().Calendar_ShortMonths_12],weeks:[f().Calendar_Weeks_7,f().Calendar_Weeks_1,f().Calendar_Weeks_2,f().Calendar_Weeks_3,f().Calendar_Weeks_4,f().Calendar_Weeks_5,f().Calendar_Weeks_6],months:[f().Calendar_Months_1,f().Calendar_Months_2,f().Calendar_Months_3,f().Calendar_Months_4,f().Calendar_Months_5,f().Calendar_Months_6,f().Calendar_Months_7,f().Calendar_Months_8,f().Calendar_Months_9,f().Calendar_Months_10,f().Calendar_Months_11,f().Calendar_Months_12],timePrefix:[f().Calendar_Time_AM,f().Calendar_Time_PM],eraNames:[f().Calendar_EraName_1,f().Calendar_EraName_2,f().Calendar_EraName_3,f().Calendar_EraName_4],earFirstYear:f().Calendar_FirstYear,today:f().Calendar_Today,lastMonth:f().Calendar_LastMonth,nextMonth:f().Calendar_NextMonth,lastYear:f().Calendar_LastYear,nextYear:f().Calendar_NextYear,lastTenYears:f().Calendar_LastTenYear,nextTenYears:f().Calendar_NextTenYear}},Ht.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},T=Ht,pt=Wt,xt=Vt,Lt=Jt,St=Xt,L.dateEqual=function(t,i,n){if(!t&&!i)return!0;if(!t)return!1;if(!i)return!1;try{return n?t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()&&t.getHours()===i.getHours()&&t.getMinutes()===i.getMinutes()&&t.getSeconds()===i.getSeconds():t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}catch(t){return!1}},L.getMonthMaxDay=function(t,i){return-1!==[1,3,5,7,8,10,12].indexOf(i)?31:-1!==[4,6,9,11].indexOf(i)?30:t%4==0&&t%100!=0?29:28},L.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},L.addMilliseconds=function(t,i){var t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return t.setMilliseconds(t.getMilliseconds()+i),new Date(t.valueOf())},L.getEraDate=function(t){var i,n,e,i={era:-1,eraYear:-1};if(L.isValidEraDate(t))for(n=0;n<L.eraCount;n++)if(t<(e=n+1!==L.eraCount?L.eraDates[n+1]:L.addMilliseconds(L.eraMax,1))){i.era=n,i.eraYear=t.getFullYear()-L.eraDates[n].getFullYear()+1;break}return i},L.getEraYearString=function(t){var i,i,i=new Date(t,5,30),i=L.getEraDate(i);return-1===i.era||-1===i.eraYear?t.toString():t.toString()+"\u5e74"},L.getShortEraYearString=function(t){var t,t,i,t=new Date(t,11,31),t=L.getEraDate(t);return-1===t.era||-1===t.eraYear?"":(i=1===t.eraYear?T.resource.earFirstYear:t.eraYear,T.resource.eraNames[t.era]+i+"\u5e74")},L.getDateLocaleLabel=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?T.resource.timePrefix[0]:T.resource.timePrefix[1])+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},L.getBuiltInDateRanges=function(){var t,i,n,e,s,o,r,e,t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.setDate(t.getDate()-1),(n=new Date(t)).setDate(t.getDate()-6),e=t.getFullYear(),s=t.getMonth(),o=new Date(e,s,1),r=new Date(e,s-1,1),e=new Date(e,s+1,0),[[f().Calendar_BuiltIn_Today,{start:new Date(t.getFullYear(),t.getMonth(),t.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[f().Calendar_BuiltIn_Yesterday,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:i}],[f().Calendar_BuiltIn_Last7Days,{start:new Date(n.getFullYear(),n.getMonth(),n.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())}],[f().Calendar_BuiltIn_ThisMonth,{start:new Date(o.getFullYear(),o.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),e.getDate())}],[f().Calendar_BuiltIn_LastMonth,{start:new Date(r.getFullYear(),r.getMonth(),1),end:new Date(o.getFullYear(),o.getMonth(),0)}]]},L.getDefaultDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},L.getNextMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()+1,n=new Date(i,t,1);return 12===t&&(n.setFullYear(i+1),n.setMonth(0)),n},L.getPreviousMonth=function(t){var i,t,n,i=t.getFullYear(),t=t.getMonth()-1,n=new Date(i,t,1);return-1==t&&(n.setFullYear(i-1),n.setMonth(11)),n},L.getFirstDayOfMonth=function(t){var i,t,i=t.getFullYear(),t=t.getMonth();return new Date(i,t,1)},L.getShortDate=function(t){var i,t;return u(t)?t:(i=t.start,t=t.end,{start:new Date(i.getFullYear(),i.getMonth(),i.getDate()),end:new Date(t.getFullYear(),t.getMonth(),t.getDate())})},L.eraCount=4,L.eraMax=new Date(2087,11,31,23,59,59),L.eraMin=new Date(1868,8,8),L.eraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),p=L,Ft.prototype.getLabel=function(){return this.year.toString()},kt=Ft,_t.prototype.getLabel=function(){return T.resource.shortMonths[this.month]},Ot=_t,Kt.prototype.getLabel=function(){return this.date.getDate().toString()},Zt=Kt,S.getMonthName=function(t){return T.resource.months[t]},S.getShortMonthName=function(t){return T.resource.shortMonths[t]},Object.defineProperty(S.prototype,"RangeCalendar",{get:function(){return this.owner&&this.owner.parent},enumerable:!1,configurable:!0}),S.prototype.updateDayFocusDate=function(){var t,i;this.owner.A1e?(t=this.T1e,1===this.owner.N1e?this.focusDate=p.getFirstDayOfMonth(t.start):2===this.owner.N1e&&(i=void 0,i=t.end.getMonth()===t.start.getMonth()?p.getNextMonth(t.start):p.getFirstDayOfMonth(t.end),this.focusDate=i)):this.focusDate=new Date(this.selectedDate.valueOf())},S.prototype.updateDayItems=function(){var t,i,n,e,s,o,r,c,u,a,l;for(this.dayItems=[],t=this.focusDate.getFullYear(),i=this.focusDate.getMonth(),c=r=((o=(e=(n=new Date(t,i,1)).getDay())-(s=this.owner.dH))<0?7+o:o)%7;0<c;c--)(u=new Date(t,i,1)).setDate(u.getDate()-c),a=new Zt(u,!1,!0,!1),this.dayItems.push(a);for(c=1;c<=42-r;c++)u=new Date(t,i,c),a=new Zt(u),u.getMonth()!==i&&(a.disabled=!0),this.owner.A1e?(l=this.T1e,(p.dateEqual(u,l.start)||p.dateEqual(u,l.end))&&(a.selected=!0),u>l.start&&(u<l.end||this.E1e&&u<=this.E1e)&&!a.disabled&&(a.focused=!0)):(p.dateEqual(u,this.selectedDate)&&(a.selected=!0),p.dateEqual(u,this.focusDate)&&(a.focused=!0)),this.dayItems.push(a)},S.prototype.updateMonthItems=function(){var t,i,n,n,e;for(this.monthItems=[],t=0;t<12;t++)i=new Ot(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getMonth()===t||n.end.getMonth()===t,i.focused=n.start.getMonth()<t&&n.end.getMonth()>t):(n=this.selectedDate,e=this.focusDate,i.selected=n&&n.getMonth()===t&&n.getFullYear()===e.getFullYear(),i.focused=e&&e.getMonth()===t),this.monthItems.push(i)},S.prototype.updateYearItems=function(){var t,i,n;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)i=new kt(t),this.owner.A1e?(n=this.T1e,i.selected=n.start.getFullYear()===t||n.end.getFullYear()===t,i.focused=n.start.getFullYear()<t&&n.end.getFullYear()>t):(i.selected=this.selectedDate&&this.selectedDate.getFullYear()===t,i.focused=this.focusDate&&this.focusDate.getFullYear()===t,i.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd),this.yearItems.push(i)},S.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},S.prototype.getShortWeekName=function(t){var i,n,i,n;return T.resource.shortWeeks[t=(this.owner.dH+t-1)%7]},S.prototype.getCurrentMonthName=function(){var t=this.focusDate.getMonth();return S.getMonthName(t)},S.prototype.updateCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):this.RangeCalendar.notifyCalendarData({selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e})},Gt=S,Rt=U.EventBase,n(k,Rt),Object.defineProperty(k.prototype,"host",{get:function(){return this.jS.getContainer()},enumerable:!1,configurable:!0}),k.prototype.createCalendarDom=function(){var t,i,n,e,s,e,t,t=this.jS;return this.mH=new St,i=x("div"),this.jS.A1e?i.className=a+" "+P:i.classList.add(a),t.HG?i.classList.add(Y):i.classList.add(J),n=x("table"),e=x("tr"),(s=x("td")).classList.add(K),t.HG&&s.classList.add(q),s.appendChild(this.gH()),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.HG&&(e=x("tr"),t=x("td"),s.appendChild(this.pH()),s.appendChild(this.bH()),t.appendChild(this.yH()),t.appendChild(this.wH()),e.appendChild(t),n.appendChild(e)),this.mH.outerContainerDiv=i},k.prototype.wH=function(){var t,i,t=x("div");return t.classList.add(V),(i=x("button")).textContent=f().OK,i.className=C+" "+jt+" "+yt,t.appendChild(i),this.mH.okButton=i,t},k.prototype.pH=function(){var t=x("div");return t.classList.add($),t},k.prototype.yH=function(){var t=x("div");return t.classList.add(tt),t},k.prototype.gH=function(){var t=x("div");return t.className=H+" "+ct+" "+ut,t.tabIndex=0,t.appendChild(this.MH()),t.appendChild(this.CH()),t.appendChild(this.SH()),this.mH.dateContainerDiv=t},k.prototype.MH=function(){var t=x("div");return t.classList.add(it),t.appendChild(this.TH()),t.appendChild(this.AH()),t},k.prototype.TH=function(){var t,i,n,e,s,s,o,r,r,t=x("div");return t.className=N+" "+v+" "+j,(i=x("div")).className=w+" "+j+" "+at+" "+At,(n=x("div")).classList.add(b),(e=x("button")).className=C+" "+A,e.title=f().Calendar_LastTenYear,e.setAttribute("type","button"),(s=x("div")).classList.add(d),e.appendChild(s),(s=x("span")).classList.add(b),(o=x("button")).className=C+" "+A,o.title=f().Calendar_NextTenYear,o.setAttribute("type","button"),(r=x("div")).classList.add(D),o.appendChild(r),i.appendChild(e),i.appendChild(s),i.appendChild(o),(r=this.mH.calendarYearSection).headerDiv=t,r.lastYearRangeButton=e,r.focusDateYearRangeName=s,r.nextYearRangeButton=o,t.appendChild(i),t},k.prototype.AH=function(){var t,i,t=x("table");return t.className=l+" "+y,(i=x("div")).appendChild(t),this.mH.calendarYearSection.currentYearRangeTable=t,this.IH(),i},k.prototype.IH=function(){for(var t,i,n,e,s,o,r,t=this.mH.calendarYearSection,i=x("tbody"),n=0;n<3;n++){for(e=x("tr"),s=0;s<4;s++)(o=x("td")).setAttribute(Ct,(4*n+s).toString()),(r=x("span")).classList.add(lt),r.setAttribute(Ct,(4*n+s).toString()),r.innerText=(4*n+s+1).toString(),o.appendChild(r),e.appendChild(o),t.yearTds.push(o);i.appendChild(e)}t.currentYearRangeTable.appendChild(i)},k.prototype.CH=function(){var t=x("div");return t.classList.add(et),t.appendChild(this.xH()),t.appendChild(this.NH()),t},k.prototype.xH=function(){var t,i,n,e,s,s,o,r,r,t=x("div");return t.className=N+" "+v+" "+j,(i=x("div")).className=w+" "+j+" "+at+" "+At,(n=x("div")).classList.add(b),(e=x("button")).className=C+" "+A,e.title=f().Calendar_LastYear,e.setAttribute("type","button"),(s=x("div")).classList.add(d),e.appendChild(s),(s=x("span")).className=_+" "+b,(o=x("button")).className=C+" "+A,o.title=f().Calendar_NextYear,o.setAttribute("type","button"),(r=x("div")).classList.add(D),o.appendChild(r),i.appendChild(e),i.appendChild(s),i.appendChild(o),(r=this.mH.calendarMonthSection).headerDiv=t,r.lastYearButton=e,r.currentYearName=s,r.nextYearButton=o,t.appendChild(i),t},k.prototype.NH=function(){var t,i,t=x("table");return t.className=l+" "+y,(i=x("div")).appendChild(t),this.mH.calendarMonthSection.currentYearTable=t,this.kH(),i},k.prototype.kH=function(){for(var t,i,n,e,s,o,r,t=this.mH.calendarMonthSection,i=x("tbody"),n=0;n<3;n++){for(e=x("tr"),s=0;s<4;s++)(o=x("td")).setAttribute(zt,(4*n+s+1).toString()),(r=x("span")).classList.add(lt),r.setAttribute(zt,(4*n+s+1).toString()),r.innerText=(4*n+s+1).toString(),o.appendChild(r),e.appendChild(o),t.monthTds.push(o);i.appendChild(e)}t.currentYearTable.appendChild(i)},k.prototype.SH=function(){var t=x("div");return t.classList.add(st),t.appendChild(this._H()),t.appendChild(this.EH()),t.appendChild(this.jH()),this.jS.A1e||t.appendChild(this.OH()),t},k.prototype._H=function(){var t,i,n,e,s,s,o,r,r,c,u,a,l,h,g,M,I,a,t=x("div");for(t.className=N+" "+v+" "+j,(i=x("div")).className=w+" "+j+" "+at+" "+At,(n=x("div")).classList.add(b),(e=x("button")).className=C+" "+A,e.title=f().Calendar_LastMonth,e.setAttribute("type","button"),(s=x("div")).classList.add(d),e.appendChild(s),(s=x("span")).className=_+" "+b,(o=x("button")).className=C+" "+A,o.title=f().Calendar_NextMonth,o.setAttribute("type","button"),(r=x("div")).classList.add(D),o.appendChild(r),i.appendChild(e),i.appendChild(s),i.appendChild(o),(r=x("div")).className=nt+" "+bt,(c=x("div")).classList.add(rt),(u=x("select")).classList.add(ot),l=(a=new Date).getFullYear()-this.lH,h=a.getFullYear()+this.fH,g=l;g<=h;g++)(M=x("option")).text=g.toString(),M.value=g.toString(),u.options.add(M);return(I=x("div")).classList.add(rt),c.appendChild(u),r.appendChild(c),t.appendChild(r),t.appendChild(i),(a=this.mH.calendarDaySection).headerDiv=t,a.lastMonthButton=e,a.currentMonthName=s,a.nextMonthButton=o,a.yearSelect=u,t},k.prototype.EH=function(){var t,i,n,e,s,o,r,t=x("div");for(t.className=X+" "+v+" "+j,(i=x("table")).className=l+" "+y,n=x("thead"),e=x("tr"),s=0;s<7;s++)(o=x("th")).setAttribute(mt,s.toString()),(r=x("span")).classList.add(ht),r.setAttribute(mt,s.toString()),r.innerText=this.jS._data.getShortWeekName(s),o.appendChild(r),e.appendChild(o),this.mH.calendarDaySection.weekThs.push(o);return n.appendChild(e),i.appendChild(n),t.appendChild(i),t},k.prototype.jH=function(){var t,i,n,e,s,o,r,c,u,a,t=this.mH.calendarDaySection,i=x("div"),n=x("div"),e=x("table");for(e.className=l+" "+y,s=x("tbody"),o=0;o<6;o++){for(r=x("tr"),c=0;c<7;c++)(u=x("td")).setAttribute(z,(7*o+c).toString()),(a=x("span")).classList.add(lt),a.setAttribute(z,(7*o+c).toString()),u.appendChild(a),r.appendChild(u),t.dayTds.push(u);s.appendChild(r)}return e.appendChild(s),n.appendChild(e),i.appendChild(n),t.dayContentTable=e,i},k.prototype.OH=function(){var t,i,n,e,s,o,t=x("div");return t.classList.add(F),(i=x("table")).classList.add(l),n=x("tbody"),e=x("tr"),s=x("td"),(o=x("i")).className=gt+" "+wt,o.innerText=T.resource.today,s.appendChild(o),e.appendChild(s),n.appendChild(e),i.appendChild(n),t.appendChild(i),this.mH.calendarDaySection.todayTd=s,this.mH.calendarDaySection.todayTable=i,t},k.prototype.bH=function(){var i,t,i=this,t=x("div");return t.className=W+" "+ct+" "+ut,t.tabIndex=0,this.mH.timeContainerDiv=t,this.RH=new E.TimePicker(t),this.RH.setOptions({step:{minute:30},height:260}),this.RH.on(o.BaseDropdown.Event_ValueChanged,function(t){i.BH(t)}),t},k.prototype.updateCalendarDom=function(){this.LH(),this.jS.HG&&this.FH()},k.prototype.LH=function(){switch(this.jS._data.calendarPage){case c.CalendarPage.year:this.PH();break;case c.CalendarPage.month:this.GH();break;case c.CalendarPage.day:this.UH()}},k.prototype.HH=function(){var t,i,n,e,s,o,t,r,c,r,t,i,u,a,l,t=this.jS._data,i=this.mH.calendarDaySection,n=!1;for(i.currentMonthName.innerText=t.getCurrentMonthName(),e=t.focusDate.getFullYear(),s=i.yearSelect,o=0;o<s.options.length;o++)if(e.toString()===s.options[o].value){s.selectedIndex=o,n=!0;break}if(t=this.fH+this.lH+1,n?s.options[t]&&s.selectedIndex<=t-1&&s.options[t].remove():((r=x("option")).text=e.toString(),r.value=e.toString(),s.options[t]=r,s.selectedIndex=t),this.jS.A1e&&(c=this.jS.parent).R1e&&c.B1e)if(r=i.lastMonthButton,t=i.nextMonthButton,i=this.jS.N1e,u=c.R1e._data.focusDate,a=c.B1e._data.focusDate,1===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))>a.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&u.getMonth()>=a.getMonth()-1?(t.disabled=!0,t.classList.add(h)):(t.disabled=!1,t.classList.remove(h))}else if(2===i){for(o=0;o<s.options.length;o++)(l=parseInt(s.options[o].value,10))<u.getFullYear()?s.options[o].disabled=!0:s.options[o].disabled=!1;u.getFullYear()===a.getFullYear()&&a.getMonth()<=u.getMonth()+1?(r.disabled=!0,r.classList.add(h)):(r.disabled=!1,r.classList.remove(h))}},k.prototype.PH=function(){var t,i,n,e,s,o,r,c,r,u,t=this.jS._data,i=this.mH.calendarYearSection;if(t.updateYearItems(),i.focusDateYearRangeName.innerText=t.focusDateYearRangeStart.toString()+" - "+t.focusDateYearRangeEnd.toString(),n=i.yearTds,0!==(e=t.yearItems).length)for(s=0;s<3;s++)for(o=0;o<4;o++)c=e[r=4*s+o],(u=(r=n[r]).querySelector("span")).innerText=c.getLabel(),c.disabled?r.classList.add(I):r.classList.remove(I),c.selected?r.classList.add(M):r.classList.remove(M),c.focused?u.classList.add(g):u.classList.remove(g)},k.prototype.GH=function(){var t,i,n,e,s,o,r,c,u,c,a,t=this.jS._data,i=this.mH.calendarMonthSection;for(t.updateMonthItems(),n=t.focusDate.getFullYear(),e=t.monthItems,s=i.monthTds,i.currentYearName.innerText=n.toString(),o=0;o<3;o++)for(r=0;r<4;r++)u=e[c=4*o+r],(a=(c=s[c]).querySelector("span")).innerText=u.getLabel(),u.selected?c.classList.add(M):c.classList.remove(M),u.focused?a.classList.add(g):a.classList.remove(g)},k.prototype.UH=function(){this.HH(),this.zH()},Object.defineProperty(k.prototype,"RangeCalendar",{get:function(){return this.jS&&this.jS.parent},enumerable:!1,configurable:!0}),k.prototype.zH=function(){var t,i,n,e,s,o,r,o,c,t=this.jS._data;if(t.updateDayItems(),0!==(i=t.dayItems).length)for(n=this.mH.calendarDaySection.dayTds,e=0;e<6;e++)for(s=0;s<7;s++)r=i[o=7*e+s],(c=(o=n[o]).querySelector("span")).innerText=r.getLabel(),r.disabled?o.classList.add(I):o.classList.remove(I),r.focused?c.classList.add(g):c.classList.remove(g),r.selected?o.classList.add(M):o.classList.remove(M)},k.prototype.FH=function(){this.RH.setValue(this.jS._data.selectedDate)},k.prototype.attachEvent=function(){this.VH(),this.attachDateEvent(),this.jS.HG&&this.attachTimeEvent()},k.prototype.VH=function(){var i=this;this.mH.outerContainerDiv.addEventListener("keydown",function(t){i.YH(t)})},k.prototype.YH=function(t){9===t.keyCode?(this.jS.HG&&(this.jS._data.calendarActivePart===m.Date?this.setCalendarActivePart(m.Time):this.setCalendarActivePart(m.Date)),t.preventDefault()):this.jS._data.calendarActivePart!==m.Date||this.jS.A1e||this.ZH(t)},k.prototype.ZH=function(t){switch(this.jS._data.calendarPage){case c.CalendarPage.year:this.WH(t);break;case c.CalendarPage.month:this.QH(t);break;case c.CalendarPage.day:this.KH(t)}},k.prototype.WH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(c.CalendarPage.month);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.JH();break;case 39:this.XH();break;case 38:this.JH(4);break;case 40:t.ctrlKey||t.metaKey?this.qH():this.XH(4);break;case 36:n.setFullYear(i.focusDateYearRangeStart);break;case 35:n.setFullYear(i.focusDateYearRangeEnd);break;case 33:this.$H();break;case 34:this.tz()}i.updateYearRange(),this.LH()},k.prototype.QH=function(t){var i,n,i=this.jS._data,n=i.focusDate;switch(t.keyCode){case 13:i.selectedDate=new Date(n.valueOf()),this.showCalendarPage(c.CalendarPage.day);break;case 32:i.selectedDate=new Date(n.valueOf());break;case 37:this.nz();break;case 39:this.ez();break;case 38:t.ctrlKey||t.metaKey?this.iz():this.nz(4);break;case 40:t.ctrlKey||t.metaKey?this.rz():this.ez(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.JH();break;case 34:this.XH()}this.LH()},k.prototype.KH=function(t){var i,n,e,s,o,r,i=this.jS._data,n=i.focusDate,e=n.getFullYear(),s=n.getMonth(),o=n.getDate(),r=p.getMonthMaxDay(e,s+1);switch(t.keyCode){case 13:return i.selectedDate=new Date(n.valueOf()),void this.oz();case 32:i.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(o-1);break;case 39:n.setDate(o+1);break;case 38:n.setDate(o-7);break;case 40:n.setDate(o+7);break;case 36:n.setDate(1);break;case 35:n.setDate(r);break;case 33:t.shiftKey?this.nz(12):this.nz();break;case 34:t.shiftKey?this.ez(12):this.ez()}i.selectedDate=new Date(n.valueOf()),this.LH()},k.prototype.attachDateEvent=function(){var i=this;this.mH.dateContainerDiv.addEventListener("click",function(t){var t=t.target;t&&(t===i.mH.calendarDaySection.yearSelect||t.parentElement===i.mH.calendarDaySection.yearSelect)||i.setCalendarActivePart(m.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},k.prototype.attachYearEvent=function(){var i=this;this.mH.calendarYearSection.lastYearRangeButton.addEventListener("click",function(t){i.$H(),i.LH()}),this.mH.calendarYearSection.nextYearRangeButton.addEventListener("click",function(t){i.tz(),i.LH()}),this.mH.calendarYearSection.currentYearRangeTable.addEventListener("click",function(t){i.az(t)})},k.prototype.$H=function(){var t=this.jS._data;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},k.prototype.tz=function(){var t=this.jS._data;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},k.prototype.qH=function(){this.showCalendarPage(c.CalendarPage.month)},k.prototype.az=function(t){var t,t,i,i,t=t.srcElement||t.target;t&&(t=+t.getAttribute(Ct),0!==(i=this.jS._data.yearItems).length)&&(i=i[t],this.jS._data.focusDate.setFullYear(i.year),this.qH())},k.prototype.attachMonthEvent=function(){var i=this;this.mH.calendarMonthSection.lastYearButton.addEventListener("click",function(t){i.JH(),i.LH()}),this.mH.calendarMonthSection.nextYearButton.addEventListener("click",function(t){i.XH(),i.LH()}),this.jS.A1e||this.mH.calendarMonthSection.currentYearName.addEventListener("click",function(t){i.iz()}),this.mH.calendarMonthSection.currentYearTable.addEventListener("click",function(t){i.uz(t)})},k.prototype.JH=function(t){var t,t,t=t||1,t=Math.max(this.jS._data.focusDate.getFullYear()-t,0);this.jS._data.focusDate.setFullYear(t)},k.prototype.XH=function(t){var t,t,t=t||1,t=Math.min(this.jS._data.focusDate.getFullYear()+t,9999);this.jS._data.focusDate.setFullYear(t)},k.prototype.iz=function(){this.jS._data.updateYearRange(),this.showCalendarPage(c.CalendarPage.year)},k.prototype.rz=function(){this.showCalendarPage(c.CalendarPage.day)},k.prototype.uz=function(t){var t,t,t=t.srcElement||t.target;t&&(t=+t.getAttribute(zt),this.jS._data.focusDate.setMonth(t-1),this.rz())},k.prototype.attachDayEvent=function(){var i,t,i=this,t=this.mH.calendarDaySection;t.lastMonthButton.addEventListener("click",function(t){i.nz(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.nextMonthButton.addEventListener("click",function(t){i.ez(),i.hH||(i.jS.A1e?(i.RangeCalendar.checkFocusDateValid(),i.RangeCalendar.updateRangeCalendarDom()):i.LH())}),t.todayTable&&t.todayTable.addEventListener("click",function(t){i.fz()}),this.jS.A1e?t.dayContentTable.addEventListener("mouseover",function(t){i.j1e(t)}):t.currentMonthName.addEventListener("click",function(t){i.cz()}),t.dayContentTable.addEventListener("click",function(t){i.jS.A1e?i.O1e(t):i.lz(t)}),t.yearSelect.addEventListener("change",function(t){i.hz(t)}),this.mH.calendarDaySection.yearSelect.addEventListener("keydown",function(t){t.stopPropagation()})},k.prototype.nz=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()-t,e=i.focusDate.getDate();t<0&&(t+=12,--n),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s)),i.focusDate=n},k.prototype.ez=function(t){var i,t,n,t,e,s,n,i=this.jS._data,t=t||1,n=i.focusDate.getFullYear(),t=i.focusDate.getMonth()+t,e=i.focusDate.getDate();11<t&&(t-=12,n+=1),s=p.getMonthMaxDay(n,t+1),n=new Date(n,t,Math.min(e,s),i.focusDate.getHours(),i.focusDate.getMinutes(),i.focusDate.getSeconds()),i.focusDate=n},k.prototype.cz=function(){this.showCalendarPage(c.CalendarPage.month)},k.prototype.lz=function(t){var i,t,t,n,e,n,t,t,i=this.jS._data,t=t.srcElement||t.target;if(t){if(t=t.getAttribute(z),u(t))return;if(0===(n=i.dayItems).length)return;n=(e=n[+t]).date,t=(t=i.selectedDate)?new Date(t.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.LH(),this.jS.HG||this.oz()}this.mH.dateContainerDiv.focus()},k.prototype.O1e=function(t){var i,t,t,n,n,t,n,e,s,s,e,s,i,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(t=(n=n[+t]).date,n=n.disabled,s=(e=i.T1e)?new Date(e.start.valueOf()):p.getDefaultDate(),0===this.RangeCalendar.D1e?(e.start=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.end=e.start,this.RangeCalendar.D1e++):1===this.RangeCalendar.D1e&&(s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),e.start<=s?(e.end=s,this.RangeCalendar.D1e=0):(e.end=e.start=s,this.RangeCalendar.D1e=1)),i.updateCalendarData(),n&&(e=this.jS._data.focusDate,s=this.jS.parent,i=p.getFirstDayOfMonth(t),1===this.jS.N1e?e<t?s.B1e._data.focusDate=i:t<this.jS._data.focusDate&&(this.jS._data.focusDate=i):2===this.jS.N1e&&(n=s.R1e,e<t?(n._data.focusDate=p.getPreviousMonth(t),this.jS._data.focusDate=i):t<this.jS._data.focusDate&&(n._data.focusDate=i))),this.RangeCalendar.updateRangeCalendarDom()))},k.prototype.j1e=function(t){var i,t,t,n,e,n,t,s,n,i=this.jS._data,t=t.srcElement||t.target;t&&(t=t.getAttribute(z),u(t)||0!==(n=i.dayItems).length&&(n=(e=n[+t]).date,t=i.T1e,i.E1e=null,t.start&&1===this.RangeCalendar.D1e&&(s=t?new Date(t.start.valueOf()):p.getDefaultDate(),(n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))>t.start)&&(i.E1e=n),i.updateCalendarData(),this.RangeCalendar.updateRangeCalendarDom()))},k.prototype.fz=function(){var t,i,i,n,t=this.jS,i=t._data.selectedDate,i=i?new Date(i.valueOf()):null,n=new Date;i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(0)),t._data.selectedDate=n,t._data.focusDate=new Date(n.valueOf()),this.LH(),t.HG||this.oz()},k.prototype.hz=function(t){var t=t.srcElement||t.target;t&&(this.jS._data.focusDate.setFullYear(+t.value),this.jS.A1e?(this.RangeCalendar.checkFocusDateValid(),this.RangeCalendar.updateRangeCalendarDom()):this.LH())},k.prototype.attachTimeEvent=function(){var i=this;this.mH.timeContainerDiv.addEventListener("click",function(t){i.setCalendarActivePart(m.Time)}),this.mH.okButton.addEventListener("click",function(t){i.oz()})},k.prototype.BH=function(t){var i,n,t,i=this.jS._data,n=i.selectedDate?new Date(i.selectedDate.valueOf()):new Date,t=t.value;n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),n.setSeconds(t.getSeconds()),i.selectedDate=n,i.focusDate=new Date(n.valueOf())},k.prototype.oz=function(){var t=this.jS._data;this.fire(o.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},k.prototype.showCalendarPage=function(t){var i,n,e,i=this.host.querySelector("."+it),n=this.host.querySelector("."+et),e=this.host.querySelector("."+st);switch(i.style.display="none",n.style.display="none",e.style.display="none",t){case c.CalendarPage.year:i.style.display="";break;case c.CalendarPage.month:n.style.display="";break;case c.CalendarPage.day:e.style.display=""}this.jS._data.calendarPage=t,this.updateCalendarDom()},k.prototype.setCalendarActivePart=function(t){switch(this.jS._data.calendarActivePart=t,this.mH.dateContainerDiv.classList.remove(s),this.jS.HG&&this.mH.timeContainerDiv.classList.remove(s),t){case m.Date:this.jS.HG&&this.mH.dateContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus();break;case m.Time:this.jS.HG&&this.mH.timeContainerDiv.classList.add(s),this.mH.outerContainerDiv.focus()}},k.Event_GetHost="GetHost",Ut=k,Pt=o.BaseDropdown,n(O,Pt),O.prototype.setOptions=function(t){var i,t;t&&(t.showTime||this.A1e||(this.HG=t.showTime,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),i=t&&t.calendarPage?t.calendarPage:c.CalendarPage.day,(t=t&&t.startDay?t.startDay:c.CalendarStartDay.saturday)!==this.dH&&(this.dH=t,this.Ti.innerHTML="",this.Ti.appendChild(this.Dn.createCalendarDom()),this.Dn.attachEvent()),this.Dn.showCalendarPage(i),this.Dn.setCalendarActivePart(m.Date))},O.prototype.setValue=function(t){var i=this._data;if(t){if(this.A1e&&t instanceof Object){if(!t.start||!t.end)return;i.S1e={start:t.start,end:t.end},i.T1e={start:t.start,end:t.end},i.updateCalendarData()}else t instanceof Date&&(i.selectedDate=t,i.oldSelectedData=new Date(t.valueOf()),i.focusDate=new Date(t.valueOf()),i.updateYearRange());i.updateDayFocusDate()}},O.prototype.scrollToSelect=function(){this.Dn.updateCalendarDom()},Et=O,t.Calendar=Et,Yt=o.BaseDropdown,n(Z,Yt),Z.prototype.setOptions=function(t){u(t.showBuiltInDateRange)&&(t.showBuiltInDateRange=!0),t.showTime=!1,t.calendarPage=c.CalendarPage.day,this.R1e.setOptions(t),this.B1e.setOptions(t)},Z.prototype.setValue=function(t){this.R1e.setValue(t),this.B1e.setValue(t),this.updateRangeCalendarDom()},Z.prototype.updateRangeCalendarDom=function(){this.R1e.Dn.updateCalendarDom(),this.B1e.Dn.updateCalendarDom(),this.updateDataRangeResult(this.T1e)},Z.prototype.L1e=function(){var t,e,t=p.getBuiltInDateRanges(),e=x("div");return e.className=a+" "+It,t.forEach(function(t,i){var n,i,n=x("div");n.className=Mt,n.setAttribute(Tt,i+""),i=B.createTextNode(t[0]),n.appendChild(i),e.appendChild(n)}),this.P1e=e},Z.prototype._1e=function(t){var i,n,n;this.Ti.innerHTML="",(i=x("div")).className=a+" "+R,t&&!1===t.showBuiltInDateRange||i.appendChild(this.L1e()),(n=x("div")).classList.add(Q),this.R1e=new Et(n,t,this,1),i.appendChild(n),(n=x("div")).classList.add(Q),this.B1e=new Et(n,t,this,2),i.appendChild(n),this.Ti.appendChild(i),this.Ti.appendChild(this.G1e())},Z.prototype.aY=function(){var i=this;this.P1e&&this.P1e.addEventListener("click",function(t){i.U1e(t)}),this.H1e.addEventListener("click",function(t){i.onOkButtonClick(t)}),this.z1e.addEventListener("click",function(t){i.onCancelButtonClick(t)}),this.on(Ut.Event_GetHost,function(t){t.host=i.Ti})},Z.prototype.G1e=function(){var t,i,i,n,i,n,t=x("div");return t.className=ft,(i=x("div")).classList.add(vt),t.appendChild(i),this.V1e=i,this.updateDataRangeResult(this.T1e),(i=x("div")).className=Dt,(n=x("button")).textContent=f().Cancel,n.className=Nt,i.appendChild(n),t.appendChild(i),this.z1e=n,(i=x("div")).className=Dt,(n=x("button")).textContent=f().OK,n.className=Nt,i.appendChild(n),t.appendChild(i),this.H1e=n,t},Z.prototype.U1e=function(t){var t,t,i,t,t=t.srcElement||t.target;t&&(t=t.getAttribute(Tt),u(t)||(t=(i=p.getBuiltInDateRanges())[t],this.T1e={start:t[1].start,end:t[1].end},this.notifyCalendarData(),this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})))},Z.prototype.updateDataRangeResult=function(t){var i,n,e,s,s;if(t&&t.start instanceof Date&&t.end instanceof Date&&(this.V1e.innerHTML="".concat(t.start.toLocaleDateString("en-US"),"-").concat(t.end.toLocaleDateString("en-US"))),this.P1e)for(i=p.getBuiltInDateRanges(),n=0;n<this.P1e.children.length;n++)e=this.P1e.children[n],s=parseInt(e.getAttribute(Tt),10),e.className=Mt,s=i[s]&&i[s][1],p.dateEqual(s.start,t.start)&&p.dateEqual(s.end,t.end)&&(e.className=Mt+" "+dt)},Z.prototype.onOkButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.T1e)})},Z.prototype.onCancelButtonClick=function(t){this.fire(o.BaseDropdown.Event_ValueChanged,{text:p.getShortDate(this.S1e)})},Z.prototype.checkFocusDateValid=function(){var t,i,t,t=this.R1e._data.focusDate,i;this.B1e._data.focusDate<=t&&(t=p.getNextMonth(t),this.B1e._data.focusDate=t)},Z.prototype.notifyCalendarData=function(t){t?(this.T1e=t.selectedDateRange,this.S1e=t.oldSelectedDateRange,this.E1e=t.hoverDate):t={selectedDateRange:this.T1e,oldSelectedDateRange:this.S1e,hoverDate:this.E1e},this.R1e&&this.R1e._data.updateCalendarData(t),this.B1e&&this.B1e._data.updateCalendarData(t)},t.RangeCalendar=Z},"./dist/plugins/celltype/editor/colorpicker.js":function(t,i,n){var e,s,o,r,c,n,u,l,n,a,h,g,M;function I(t,i){var t=M.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.ColorPicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("Core"),r=n("./dist/plugins/celltype/editor/baseControl.js"),c=n("./dist/plugins/celltype/celltypes.ns.js"),n=n("Common"),u=n.Common.lt.ht,l="group-name",n=new n.Common.ResourceManager(c.SR,"CellTypes"),a=n.getResource.bind(n),M=r.BaseDropdown,e(I,M),I.prototype.setOptions=function(t){var i;t&&(this.options=this.options||{},u(t.colorBlockSize)||(i=parseInt(t.colorBlockSize,10),!isNaN(i)&&0<=i&&(this.options.colorBlockSize=t.colorBlockSize)),u(t.groups)||(this.options.groups=t.groups)),this._6()},I.prototype.setValue=function(t){u(t)||(this.vz=t,this.mz=null,this._6())},I.prototype.Hc=function(){for(var i,t,n,e,i=this,t=I.DefaultColorGroup(),n=[],e=0;e<t.length;e++)n.push({name:t[e].name,colors:t[e].colors,needScaleColor:t[e].needScaleColor});this.options={colorBlockSize:I.DefaultCellWidth,groups:n},this.gz=document.createElement("div"),this.gz.classList.add("gc-color-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},I.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.bz()),this.yz()},I.prototype.yz=function(){var t,i,n,e,t=this.gz.querySelectorAll(".gc-color-picker-color-cell");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=t[i].getAttribute("color"),e=t[i].getAttribute(l),this.vz===n&&(!this.mz||this.mz&&this.mz===e)&&t[i].classList.add("selected")},I.prototype.wz=function(){for(var t,i,n,e,s,o,t=0,i=this.options.groups,n=0;n<i.length;n++)for(e=i[n],s=0;s<e.colors.length;s++)o=e.colors[s],t=Math.max(t,o.length);return t},I.prototype.bz=function(){for(var t,i,n,e,s,o,o,t=[],i=this.options.colorBlockSize||I.DefaultCellWidth,n=this.wz(),e=this.options.groups,s=0;s<e.length;s++)o=this.Mz(e[s],i,n),t.push(o),e[s].needScaleColor&&(o=this.Cz(e[s].colors[0]),t.push(this.Mz(o,i,n)));return{items:t}},I.prototype.Cz=function(t){var i,n,e,s,o,r,c,u,a,l,h,g,M,I,f,N,i={},n=[],s=[-(e=n.length=5),-15,-25,-35,-50],o=[-10,-25,-50,-75,-90],r=[80,60,40,-25,-50],c=document.createElement("span"),u=t.length;c.style.display="none",document.body.appendChild(c);try{for(a=0;a<u;a++)for(h=(l=this.Sz(t[a],c))[0],g=l[1],M=l[2],I=this.Tz(h,g,M),f=0;f<5;f++)n[f]||((N=[]).length=u,n[f]=N),n[f][a]=1===I?this.Az(h,g,M,s[f]):.8<=I?this.Az(h,g,M,o[f]):0===I?this.Az(h,g,M,Math.abs(s[5-f-1])):I<=.2?this.Az(h,g,M,Math.abs(o[5-f-1])):this.Az(h,g,M,r[f]);i.colors=n}finally{document.body.removeChild(c)}return i},I.prototype.Sz=function(t,i){var n,e,s,o,t;return i.style.color=t,t=(o=window.getComputedStyle(i).color).replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[n=parseInt(t[0],10),e=parseInt(t[1],10),s=parseInt(t[2],10)]},I.prototype.Az=function(t,i,n,e){var t,i,n;return e/=100,t=this.Iz(t,i,n),i=parseInt((0<e?(240-t.luminosity)*e:t.luminosity*e).toString(),10),n=this.xz(t.hue,t.luminosity+i,t.saturation),this.Nz(n.r,n.g,n.b)},I.prototype.kz=function(t){var t=t.toString(16);return 1===t.length?"0"+t:t},I.prototype.Nz=function(t,i,n){return"#"+this.kz(t)+this.kz(i)+this.kz(n)},I.prototype.xz=function(t,i,n){var e,s,o,r,c;return 0===n?e=s=o=parseInt((255*i/240).toString(),10):(c=r=void 0,r=2*i-(c=i<=120?(i*(240+n)+120)/240:i+n-(i*n+120)/240),e=parseInt(((255*this.Dz(r,c,t+80)+120)/240).toString(),10),s=parseInt(((255*this.Dz(r,c,t)+120)/240).toString(),10),o=parseInt(((255*this.Dz(r,c,t-80)+120)/240).toString(),10)),{a:255,r:e,g:s,b:o}},I.prototype.Dz=function(t,i,n){return n<0&&(n+=240),240<n&&(n-=240),n<40?t+((i-t)*n+20)/40:n<120?i:n<160?t+((i-t)*(160-n)+20)/40:t},I.prototype.Tz=function(t,i,n){var e;return this.Iz(t,i,n).luminosity/240},I.prototype.Iz=function(t,i,n){var e,s,o,r,c,u,c,u,a,n,r=Math.max(Math.max(t,i),n),c=Math.min(Math.min(t,i),n),u=r+c,e=parseInt(((240*u+255)/510).toString(),10),c=r-c;return 0==c?(s=0,o=160):(s=e<=120?parseInt(((240*c+u/2)/u).toString(),10):parseInt(((240*c+(510-u)/2)/(510-u)).toString(),10),u=(40*(r-t)+c/2)/c,a=(40*(r-i)+c/2)/c,n=(40*(r-n)+c/2)/c,(o=t===r?parseInt((n-a).toString(),10):i===r?parseInt((80+u-n).toString(),10):parseInt((160+a-u).toString(),10))<0&&(o+=240),240<o&&(o-=240)),{luminosity:e,saturation:s,hue:o}},I.prototype.Mz=function(r,c,u){var a,t,a=this,t={items:function(){var t,i,n,e,s,o,t=document.createElement("div");for(t.classList.add("gc-color-picker-group-row"),t.style.width=(c+7)*u+"px",i=0;i<r.colors.length;i++){for((n=document.createElement("div")).classList.add("gc-color-picker-color-row"),e=r.colors[i],s=0;s<e.length;s++)(o=document.createElement("div")).setAttribute(l,r.name),o.setAttribute("color",e[s]),o.style.backgroundColor=e[s],o.style.width=c+"px",o.style.height=c+"px",o.classList.add("gc-color-picker-color-cell"),a.vz===e[s]&&a.mz===r.name&&o.classList.add("selected"),n.appendChild(o);t.appendChild(n)}return t},layout:{direction:o.LayoutDirection.horizontal,displayAs:o.LayoutDisplayAs.inline}};return r.name&&(t.text=r.name),t},I.prototype.pz=function(t){var t,i,t,t=t.srcElement||t.target;t&&(i=t.getAttribute("color"),t=t.getAttribute(l),i)&&t&&(this.vz=i,this.mz=t,this._z(i),this.yz())},I.prototype._z=function(t){this.fire(r.BaseDropdown.Event_ValueChanged,{value:t,text:t})},I.DefaultCellWidth=10,I.DefaultColorGroup=function(){return[{name:a().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:a().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},i.ColorPicker=I},"./dist/plugins/celltype/editor/eventbase.js":function(t,i){var n;function e(){this.Ez={}}Object.defineProperty(i,"__esModule",{value:!0}),i.EventBase=void 0,e.prototype.on=function(t,i){var n=this.Ez[t];(n=null==n?this.Ez[t]=[]:n).push(i)},e.prototype.off=function(t,i){var n,i;t?null!=(n=this.Ez[t])&&(i?(i=n.indexOf(i),n.splice(i,1)):n=[],this.Ez[t]=n):this.Ez={}},e.prototype.fire=function(t,i){var n,t,n=this,t=this.Ez[t];null!=t&&t.forEach(function(t){try{t.call(n,i)}catch(t){}})},i.EventBase=e},"./dist/plugins/celltype/editor/listControl.js":function(G,t,i){var n,c,u,o,h,g,r,e,s,a,l,M,I,f,N,d,D,v,w,b,A,y,j,C,U,z,m,E,B,T,Q,R,p,P,x,L;function S(t){return e.createElement(t)}function Y(t,i){return t.substring(0,i)+t.substring(i+1,t.length)}function H(t,i){if(o.Common.Uf.OS(t,i))return 1;if(o.Common.ct.W0(i))for(var n=0;n<t.length;n++)if(t[n]-i==0)return 1}function W(t,i){for(var n,e,n=o.Common.ct.W0(i),e=t.length-1;0<=e;e--)(t[e]===i||n&&t[e]-i==0)&&t.splice(e,1)}function V(t){var i,n,e,s,o;if(g(t)||0===t.length)return[];for(i=[],e=n=0;e<t.length;e++)"\\"===(s=t.charAt(e))?","!==(o=t.charAt(e+1))&&"\\"!==o||(t=Y(t,e)):","===s&&(i.push(t.substring(n,e)),n=e+1);return i.push(t.substring(n,t.length)),i}function J(t){for(var i,n,e,i=[],n=0;n<t.length;n++)(e=t[n])&&"string"==typeof e&&(e=e.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),i[n]=e;return i.join(",")}function k(){this.jz=new WeakMap}function O(t,i,n){var e=L.call(this,t)||this;return e.Ti=S("div"),e.Ti.classList.add(a),t.appendChild(e.Ti),e.cE=new s,e.Oz=n&&n.Oz||{y4:void 0},e.Rz={items:[],doms:[]},e.setOptions(i),e}function Z(t){if(t.hasOwnProperty("items"))Z(t.items);else if(Array.isArray(t))for(var i=0;i<t.length;i++)t[i].hasOwnProperty("items")?Z(t[i]):t[i].hasOwnProperty("text")&&!t[i].hasOwnProperty("value")&&(t[i].value=t[i].text);return t}n=this&&this.__extends||(x=function(t,i){return(x=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}x(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0,c=i("./dist/plugins/celltype/editor/popupControl.js"),u=i("./dist/plugins/celltype/editor/baseControl.js"),o=i("Common"),h=i("Core"),g=o.Common.lt.ht,r=o.Common.Uf.hD,e=document,k.prototype.set=function(t,i,n){var e=this.jz.get(t);e||this.jz.set(t,e={}),e[i]=n},k.prototype.get=function(t,i){var t=this.jz.get(t);return t&&t[i]},k.prototype.clear=function(){this.jz=new WeakMap},s=k,a="gc-list-control",l="gc-list-control-container",M="gc-list-control-group",I="gc-list-control-group-text",f="gc-list-control-item",N="gc-list-control-hassubitem",d="gc-list-control-selected-item",D="gc-list-control-item-text",v="gc-list-control-item-text-ellipsis",w="gc-list-control-item-ellipsis",b="gc-list-control-item-icon",A="gc-list-control-emptyicon",y="gc-list-control-subitem",j="gc-list-alignment-horizontal",C="gc-list-alignment-vertical",U="gc-list-control-item-wrap",z="gc-list-control-noitem",m="gc-list-control-listseparator",E="gc-list-control-item-bigicon",B="gc-list-control-item-bigtext",T="hide-children",Q="gc-list-control-tree",R="gc-list-control-tree-text",p="gc-list-control-tree-content",L=u.BaseDropdown,n(O,L),O.prototype.setOptions=function(t){g(t)||(this.MU=Z(t),this.Ti.innerHTML="",this.Dn())},O.prototype.setValue=function(t){if(this.MU&&this.MU.multiSelect)if("string"==typeof t)t=V(t);else if(g(t))t=[];else if(o.Common.lt.Nh(t)){if(1!==this.MU.valueType){t=t.slice(0);for(var i=0;i<t.length;i++)t[i]=""+t[i]}}else t=[t];this.Oz.y4=t,this.Bz()},O.prototype.scrollToSelect=function(){},O.prototype.updateStyle=function(t,i,n){this.Ti.style.font=n},O.prototype.Dn=function(){var t=S("div");t.classList.add(l),this.MU.Oue&&(t.setAttribute("role","listbox"),t.setAttribute("tabindex","-1")),this.Lz(t,this.MU),this.Ti.appendChild(t),this.Fz()},O.prototype.Lz=function(t,i){var n;i&&(this.Pz(t,i.layout),i.items)&&(Array.isArray(i.items)?this.Gz(t,i.items):(n=i.items())instanceof HTMLElement&&(t.appendChild(n),t.classList.add(f),this.Pz(n,i.layout)))},O.prototype.Pz=function(t,i){i&&i.direction===h.LayoutDirection.horizontal?t.classList.add(j):t.classList.add(C)},O.prototype.Gz=function(t,i){for(var n,e,s,o,r,c,u,o,a,l,l,n=i.some(function(t){return!!t.icon}),e=0;e<i.length;e++)i[e].items?(s=i[e]).layout&&s.layout.displayAs===h.LayoutDisplayAs.inline?((o=S("div")).classList.add(M),(r=S("span")).innerText=s.text,!g(s.text)&&""!==s.text||r.classList.add(T),r.classList.add(I),o.appendChild(r),Array.isArray(s.items)?this.Lz(o,s):(c=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(f),this.Pz(c,s.layout),u.appendChild(c),o.appendChild(u)),t.appendChild(o)):s.layout&&s.layout.displayAs===h.LayoutDisplayAs.tree?((o=S("div")).classList.add(Q),(a=S("div")).classList.add(f),a.classList.add(N),(r=S("span")).innerText=s.text,r.classList.add(R),a.appendChild(r),s.layout.collapsible&&((l=S("span")).classList.add(y),a.appendChild(l),this.Uz(a)),o.appendChild(a),(l=S("div")).classList.add(p),Array.isArray(s.items)?this.Lz(l,s):(c=s.items())instanceof HTMLElement&&((u=S("div")).classList.add(f),this.Pz(c,s.layout),u.appendChild(c),l.appendChild(u)),o.appendChild(l),t.appendChild(o)):this.Hz(t,i[e],!1,!0):this.Hz(t,i[e],n)},O.prototype.Hz=function(t,i,n,e){var s,o,o,n,o,n,o,n,o;void 0===e&&(e=!1),(s=S("div")).classList.add(f),this.MU.textEllipsis&&s.classList.add(w),"-"===i.text?(s.classList.add(z),(o=S("div")).classList.add(m),s.appendChild(o)):(n&&((o=S("div")).classList.add(b),i.icon?o.style.backgroundImage="url(".concat(i.icon,")"):o.classList.add(A),s.appendChild(o)),(n=S("span")).classList.add(D),this.MU.textEllipsis&&n.classList.add(v),o=i.text,g(i.text)&&(o=g(i.value)?"":i.value),n.innerText=o,s.appendChild(n),s.setAttribute("text",o),n=g(i.value)?null:i.value,(o=r(this.Rz.items,n))<0&&(o=this.Rz.items.length,this.Rz.doms.push([]),this.Rz.items.push(n)),this.Rz.doms[o].push(s),this.cE.set(s,"items",i),e&&((n=S("span")).classList.add(y),s.classList.add(N),this.cE.set(s,"sub-items",i),s.appendChild(n),this.zz(s))),this.MU.Oue&&(s.setAttribute("role","option"),s.setAttribute("tabindex","0"),o=i.text||i.value,g(o)||s.setAttribute("aria-label",o)),t.appendChild(s)},O.prototype.qj=function(t,i){var n,e,n=this.Rz.doms[t];if(i)for(e=0;e<n.length;e++)n[e].classList.contains(N)||n[e].classList.add(d);else for(e=0;e<n.length;e++)n[e].classList.contains(d)&&n[e].classList.remove(d)},O.prototype.Bz=function(){for(var t,i,n,e,s,o,i=this,n=i.MU,t=g(i.formula)?n&&n.multiSelect?e=i.Oz.y4:[i.Oz.y4]:["="+i.formula],s=0;s<i.Rz.items.length;s++)o=i.Rz.items[s],H(t,o=n&&n.multiSelect&&1!==n.valueType?""+o:o)?i.qj(s,!0):i.qj(s,!1)},O.prototype.Fz=function(){var s=this;this.Ti.querySelector("."+l).addEventListener("click",function(t){var i,i,n,t,i,e,i=s.Vz(t.target,".".concat(f));i&&(i.classList.contains(N)?s.Yz(t):(i=s.cE.get(i,"items"),n=s.MU,!i&&o.Common.lt.Eh(n&&n.onItemSelected)&&(i={value:n.onItemSelected(t)}),g(i)||(t=i.value,i=i.path,n&&n.multiSelect&&(H(e=(e=s.Oz.y4).slice(0),t=n.multiSelect&&1!==n.valueType?""+t:t)?W(e,t):o.Common.Uf.ZP(e,t),s.Oz.y4=t=e,s.Bz(),1!==n.valueType)&&(t=J(t)),s.fire(u.BaseDropdown.Event_ValueChanged,{path:i,value:t,text:t,notCloseDropDown:n&&n.multiSelect,noAutoFormat:!0}))))})},O.prototype.Vz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},O.prototype.Yz=function(t){var i,n,e,s,o,o,r,i=this,n=this.Vz(t.target,".".concat(f));n.classList.contains(N)&&(e=this.cE.get(n,"sub-items"))&&e.items&&(s=S("div"),o=this.MU,e.multiSelect=o&&o.multiSelect,e.valueType=o&&o.valueType,e.onItemSelected=o&&o.onItemSelected,(o=new O(s,e,this)).Bz(),(r=new c.PopupControl(s,n,{align:h.DropDownAlignment.Near,hostElement:n,direction:h.DropDownDirection.Right})).open(),o.on(u.BaseDropdown.Event_ValueChanged,function(t){i.fire(u.BaseDropdown.Event_ValueChanged,t),i.MU&&i.MU.multiSelect?i.Bz():r.close()}),this.cE.set(n,"sub-items-popup",r),t.stopPropagation(),t.preventDefault())},O.prototype.zz=function(t){var n=this;t.addEventListener("mouseenter",function(t){n.Yz(t)}),t.addEventListener("mouseleave",function(t){var t,i,t=t.target;t.classList.contains(N)&&(i=n.cE.get(t,"sub-items-popup"))&&(i.close(),n.cE.set(t,"sub-items-pop",void 0))})},O.prototype.Uz=function(t){var e=this;t.addEventListener("click",function(t){var i,i,n,i=t.target,i=e.Vz(i,".".concat(N));i&&(n=i.parentElement.querySelector("."+p))&&(i.parentElement.classList.contains(T)?i.parentElement.classList.remove(T):i.parentElement.classList.add(T),t.stopPropagation(),t.preventDefault())})},t.List=O},"./dist/plugins/celltype/editor/monthPicker.js":function(t,i,n){var e,u,s,a,o,n,l,r,c,h,g,M,I,f,N,d,D,v;function w(t){return r.createElement(t)}function b(t,i){var t=v.call(this,t)||this;return t.setOptions(i),t.Fz(),t}e=this&&this.__extends||(D=function(t,i){return(D=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}D(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MonthPicker=void 0,u=n("./dist/plugins/celltype/editor/baseControl.js"),s=n("./dist/plugins/celltype/celltypes.ns.js"),a=n("Common"),o=a.Common.lt.ht,n=new a.Common.ResourceManager(s.SR,"CellTypes"),l=n.getResource.bind(n),r=document,c="gc-month-picker-separator",h="gc-month-picker-year-item",g="gc-month-picker-month-item",M="gc-month-picker-qtr-item",I="selected",f="data-month",N="data-qtr",v=u.BaseDropdown,e(b,v),b.prototype.setOptions=function(t){var i,n,n,e,e,e,i=this,n=new Date,n={startYear:n.getFullYear()-10,stopYear:n.getFullYear(),height:300};t&&(o(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e))||(n.startYear=e),!o(t.stopYear)&&0<t.stopYear&&(e=parseInt(t.stopYear,10),isNaN(e)||(n.stopYear=e)),n.stopYear<n.startYear&&(n.stopYear=t.startYear),o(t.height)||(e=parseInt(t.height,10),isNaN(e))||(n.height=e)),n.height=Math.max(1,n.height),i.MU=n,i.Ti.innerHTML="",i.Zz()},b.prototype.setValue=function(t){var i,n,e,s,t,o,i=this;t&&(n=t.getMonth()+1,e=t.getFullYear()),"number"==typeof n&&(t=i.Ti.querySelector("[".concat(f,"='").concat(e,"-").concat(n,"']")))&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),i.Wz=t)},b.prototype.scrollToSelect=function(){var t,t,t=this.Wz;t&&(t=t.offsetTop,this.Ti.scrollTop=t)},b.prototype.Qz=function(t,i){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=n&&i.item(n)!==this;)--n;return-1<n});for(var n=t;n&&!n.matches(i);)n=n.parentElement;return n},b.prototype.Fz=function(){var c=this;this.Ti.addEventListener("click",function(t){var i,t,n,e,s,o,t,t,s,r,n,i=c,t=i.Qz(t.target,".".concat(g,",.").concat(M));t&&!t.getAttribute(N)&&(t.classList.add(I),i.Wz&&i.Wz.classList.remove(I),s=e=n=null,(i.Wz=t).getAttribute(f)&&(n=+(t=(o=t.getAttribute(f)).split("-"))[1],s=+t[0]),t=new Date(s,n-1,1,0,0,0,0),s=a.Common.CultureManager.Fe().DateTimeFormat,n=(r=new a.Formatter.GeneralFormatter(s.shortDatePattern)).format(t),i.fire(u.BaseDropdown.Event_ValueChanged,{text:n,value:t}))})},b.prototype.Zz=function(){var t,i,n,e,s,t=this;for(0<=this.MU.height?t.Ti.style.maxHeight=this.MU.height+"px":t.Ti.style.height="auto",t.Ti.classList.add("gc-month-picker-container"),i=t.MU.startYear;i<=t.MU.stopYear;i++)n=document.createElement("div"),t.Jz(n),(e=document.createElement("div")).classList.add("gc-month-picker-year-container"),t.Xz(i,e),(s=document.createElement("div")).classList.add("gc-month-picker-month-container"),t.qz(i,1,s),t.qz(i,2,s),t.qz(i,3,s),t.qz(i,4,s),n.appendChild(e),n.appendChild(s),this.Ti.appendChild(n)},b.prototype.Jz=function(t){var i=w("div");i.classList.add(c),t.appendChild(i)},b.prototype.Xz=function(t,i){var n=w("div");n.classList.add(h),n.innerText="".concat(t),i.appendChild(n)},b.prototype.qz=function(t,i,n){var e,s,o,r,c,e=document.createElement("div"),s=w("div"),o=w("div"),r=w("div"),c=w("div");switch(s.classList.add(g),o.classList.add(g),r.classList.add(g),c.classList.add(M),i){case 1:s.innerText=l().Calendar_ShortMonths_1,s.setAttribute(f,"".concat(t,"-").concat(1)),o.innerText=l().Calendar_ShortMonths_2,o.setAttribute(f,"".concat(t,"-").concat(2)),r.innerText=l().Calendar_ShortMonths_3,r.setAttribute(f,"".concat(t,"-").concat(3)),c.innerText=l().Quarter_Format_1,c.setAttribute(N,"".concat(t,"-").concat(1));break;case 2:s.innerText=l().Calendar_ShortMonths_4,s.setAttribute(f,"".concat(t,"-").concat(4)),o.innerText=l().Calendar_ShortMonths_5,o.setAttribute(f,"".concat(t,"-").concat(5)),r.innerText=l().Calendar_ShortMonths_6,r.setAttribute(f,"".concat(t,"-").concat(6)),c.innerText=l().Quarter_Format_2,c.setAttribute(N,"".concat(t,"-").concat(2));break;case 3:s.innerText=l().Calendar_ShortMonths_7,s.setAttribute(f,"".concat(t,"-").concat(7)),o.innerText=l().Calendar_ShortMonths_8,o.setAttribute(f,"".concat(t,"-").concat(8)),r.innerText=l().Calendar_ShortMonths_9,r.setAttribute(f,"".concat(t,"-").concat(9)),c.innerText=l().Quarter_Format_3,c.setAttribute(N,"".concat(t,"-").concat(3));break;case 4:s.innerText=l().Calendar_ShortMonths_10,s.setAttribute(f,"".concat(t,"-").concat(10)),o.innerText=l().Calendar_ShortMonths_11,o.setAttribute(f,"".concat(t,"-").concat(11)),r.innerText=l().Calendar_ShortMonths_12,r.setAttribute(f,"".concat(t,"-").concat(12)),c.innerText=l().Quarter_Format_4,c.setAttribute(N,"".concat(t,"-").concat(4))}e.appendChild(s),e.appendChild(o),e.appendChild(r),e.appendChild(c),n.appendChild(e),i<4&&this.Jz(n)},i.MonthPicker=b},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,i,n){var e,r,c,s,u,o,a,l,n,I,o,h,g,M,f,N;function d(t){return Array.isArray(t)}function D(t){return"string"==typeof t}function v(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}function w(t){t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint()}function b(t,i){var n,s,o,r,e,c,u,n=t[0],s=[];if(d(n))for(r=A(o=t,i),e=function(t,i){var n=o[t],e={};r.forEach(function(t,i){e[t]=n[i]}),s.push(e)},c=0,u=o.length;c<u;c++)e(c,u);else s=t;return s}function A(t,i){var n=[];return i&&0<i.length?i.forEach(function(t){n.push(t.name)}):n=t.shift(),n}function y(t,i,n){return N.call(this,t,i,n)||this}e=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.MultiColumn=void 0,r=n("Core"),c=n("SheetsCalc"),s=n("CalcEngine"),u=n("CalcEngine"),o=n("Common"),a=n("./dist/plugins/celltype/editor/baseControl.js"),l=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),n=n("./dist/plugins/celltype/celltypes.ns.js"),I=o.Common.lt.ht,o=new o.Common.ResourceManager(n.SR,"CellTypes"),h=o.getResource.bind(o),g=!!s,N=l.BaseSpreadPicker,e(y,N),y.prototype.setOptions=function(i){var n,t,e,s,t,i,e;if(N.prototype.setOptions.call(this,i),((n=this).MU=i)&&(t=n.TU,e=i.dataSource,s=i.bindingInfos,t=t.getActiveSheet(),e)){i=!0,v(t),t.options.isProtected=!0,t.options.rowHeaderVisible=!1,t.selectionPolicy(r.SelectionPolicy.single),t.selectionUnit(r.SelectionUnit.row);try{n.$z(t,e,s)}catch(t){i=!1,n.dispose()}finally{i&&t&&((e=new r.Style).hv=!1,t.setStyle(-1,-1,e,r.SheetArea.viewport),w(t))}}},y.prototype.setValue=function(t){var i,n,e,i,i=this;i.MU&&(N.prototype.setValue.call(this,t),e=(n=i.TU).getActiveSheet(),i=i.tV(t),e.setSelection(i,-1,1,-1))},y.prototype.dispose=function(){N.prototype.dispose.call(this)},y.prototype.$z=function(t,i,n){var e,i;i&&(i=this.nV(i))&&(t.setDataSource(b(i,n)),n)&&t.bindColumns(n)},y.prototype.nV=function(t){var t,i,n,n,n,e,s,o,s,o,i,t=t,i=this.CU;if(D(t)){if(g){if(n=(0,c.formulaToExpression)(i,t),n=i.getCalcService().BI(i.Uw(),n,(0,u.eV)(0,0),!0),s=!1,o=void 0,!(s=!(e=u.Convert.LE(n)||u.Convert.Nh(n))||(o=u.Convert.iV(n,0,!1,!1,!1)).isError||o.isConvertError?s:!0))throw new Error(h().MultiColumn_InvalidDataSource);n=o}}else t instanceof r.Range?n=i.getArray(t.row,t.col,t.rowCount,t.colCount):d(t)?n=t:t.TDi&&(n=(i=(o=(s=i.parent)&&s.dataManager().rV)&&o[t.TDi])&&i.oV());return n},y.prototype.tV=function(t){var i,n,e,s,o,r,c,u,a,l,h,g,M,i=this,n=0;if(t)if(s=(e=i.TU).getActiveSheet(),r=(o=Object.keys(t)).length,u=(c=s.getDataSource()).length,a=!1,l=i.MU.key,I(l))for(h=0;h<u;h++){for(g=c[h],a=!0,M=0;M<r;M++)if(g[l=o[M]]!==t[l]&&void 0!==g[l]){a=!1;break}if(a){n=h;break}}else for(h=0;h<u;h++)if((g=c[h])[l]===t){n=h;break}return n},y.prototype.submitData=function(t){var i,n,e,s,o,t,n,t,i=this,n=t.sheet,e;t.isEsc?s={notSubmit:!0}:-1<(t=(o=n.getSelections()[0]).row)&&(n=n.getDataItem(t),t=i.MU.key,s={value:n=I(t)?n:n[t],text:n}),I(s)||i.fire(a.BaseDropdown.Event_ValueChanged,s)},i.MultiColumn=y},"./dist/plugins/celltype/editor/popupControl.js":function(t,i,n){var e,w,n,b,A,s,o,r,c,u;function a(t,i,n,e){this._x=t,this._y=i,this.YC=n,this.ZC=e}function l(t,i,n){var e=u.call(this,null)||this;return e.sourceElement=t,e.target=i,e.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:w.DropDownDirection.Down,align:w.DropDownAlignment.Near,horAdj:b.Flip|b.Slide,verAdj:b.Flip|b.Slide},e.globalMousedownEventHandler=function(t){var i,n;if(e.rf){for(n=i=t.target;n&&n!==e.sourceElement;)n=n.parentElement;n||(e.close(),t.stopPropagation(),t.preventDefault())}},e.windowResizeEventHandler=function(){e.rf&&e.close()},e.MU=e.defaultOption,e.rf=!1,n&&e.mergeOption(n),e.aV=null===e.MU.hostElement||void 0===e.MU.hostElement||!(e.MU.hostElement instanceof HTMLElement),e}e=this&&this.__extends||(r=function(t,i){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PopupControl=i.Rectangle=i.DropDownAdjustment=void 0,w=n("Core"),n=n("./dist/plugins/celltype/editor/baseControl.js"),(c=b=i.DropDownAdjustment||(i.DropDownAdjustment={}))[c.None=0]="None",c[c.Flip=1]="Flip",c[c.Slide=2]="Slide",a.CreateFromDom=function(t){return new a(t.left,t.top,t.width,t.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this._x+this.YC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this._y+this.ZC},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Location",{get:function(){return{X:this._x,Y:this._y}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return{width:this.YC,height:this.ZC}},enumerable:!1,configurable:!0}),a.prototype.Offset=function(){for(var t,i,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];1===t.length&&"number"==typeof t[0].X&&"number"==typeof t[0].X?(this._x+=t[0].X,this._y+=t[0].Y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(this._x+=t[0],this._y+=t[1])},A=a,i.Rectangle=A,s="ribbon-dropdowngroup-popup",u=n.BaseControl,e(l,u),l.prototype.open=function(){this.rf||(this.MU.Oue&&this.target.setAttribute&&this.target.setAttribute("aria-expanded","true"),this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},l.prototype.beforeOpen=function(){this.bindEvent()},l.prototype.dispose=function(){var i=this;this.MU.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.MU.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,i.globalMousedownEventHandler,!0)})),this.aV?(this.sourceElement.classList.remove(s),this.sourceElement.style.display=this.uV,this.sourceElement.style.position=this.Z3):this.sV&&this.sV.parentNode&&(this.MU.hostElement.removeChild(this.sV),this.sV=null)},l.prototype.close=function(){var t;this.rf&&(this.rf=!1,this.MU.Oue&&(t=this.target).setAttribute&&(t.setAttribute("aria-expanded","false"),setTimeout(function(){t.focus()})),this.dispose(),this.fire("close"))},l.prototype.mergeOption=function(t){for(var i in t)void 0!==t[i]&&(this.MU[i]=t[i])},l.prototype.clearPosition=function(){this.cV.style.top=this.cV.style.bottom=this.cV.style.left=this.cV.style.right=""},l.prototype.calcPosition=function(){var t,i,n,n,t,e,s,s,o,r,o,r,n,i=this.target instanceof A,t=i?this.target:A.CreateFromDom(this.target.getBoundingClientRect()),n=new A(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(n,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.MU.direction,this.MU.align,this.MU.horAdj,this.MU.verAdj),t=this.cV.offsetParent,e=t.getBoundingClientRect(),s=document.body,s=t.offsetWidth===s.offsetWidth&&t.offsetHeight===s.offsetHeight,o=document.documentElement,r=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),o=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),r=n.X-(s?-r:e.left-t.scrollLeft),n=n.Y-(s?-o:e.top-t.scrollTop);i&&(r<0&&(r=0),n<0)&&(n=0),this.cV.style.left="".concat(r,"px"),this.cV.style.top="".concat(n,"px")},l.prototype.calculateDropDownLocation=function(t,i,n,e,s,o,r){var c,u,a,l,h,g,M,I,f,N,d,r,o,D,v,i,c={X:t.x,Y:t.y};switch(t.Offset(-c.X,-c.Y),i.Offset(-c.X,-c.Y),u=i.left,a=i.right,l=i.top,h=i.bottom,g=l,M=t.height-h,I=u,f=t.width-a,N=(r&b.Flip)===b.Flip,d=(o&b.Flip)===b.Flip,r=(r&b.Slide)===b.Slide,o=(o&b.Slide)===b.Slide,e){case w.DropDownDirection.Up:n.height>g&&N&&(e=w.DropDownDirection.Down);break;case w.DropDownDirection.Down:n.height>M&&N&&(e=w.DropDownDirection.Up);break;case w.DropDownDirection.Left:n.width>I&&d&&(e=w.DropDownDirection.Right);break;case w.DropDownDirection.Right:n.width>f&&d&&(e=w.DropDownDirection.Left)}switch(v=D=0,e){case w.DropDownDirection.Up:v=l-n.height;break;case w.DropDownDirection.Down:v=h;break;case w.DropDownDirection.Left:D=u-n.width;break;case w.DropDownDirection.Right:D=a}return e===w.DropDownDirection.Up||e===w.DropDownDirection.Down?s===w.DropDownAlignment.Near?D=u:s===w.DropDownAlignment.Center?D=u-(n.width-i.width)/2:s===w.DropDownAlignment.Far&&(D=a-n.width):e!==w.DropDownDirection.Right&&e!==w.DropDownDirection.Left||(s===w.DropDownAlignment.Near?v=l:s===w.DropDownAlignment.Center?v=l-(n.height-i.height)/2:s===w.DropDownAlignment.Far&&(v=h-n.height)),i=new A(D,v,n.width,n.height),o&&(i.width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width))),r&&(i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height))),i.Offset(c),i.Location},l.prototype.render=function(){var i=this;this.aV?(this.Z3=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.uV=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(s),this.cV=this.sourceElement):(this.sV=document.createElement("div"),this.sV.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.sV.classList.add(s),this.sV.appendChild(this.sourceElement),this.MU.hostElement.appendChild(this.sV),this.cV=this.sV),this.MU.Oue&&setTimeout(function(){var t;i.cV&&(t=i.cV.querySelector("[role=menu],[role=listbox]"))&&t.focus()},500)},l.prototype.bindEvent=function(){var i=this;this.MU.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,i.globalMousedownEventHandler,!0)})),this.MU.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},i.PopupControl=l},"./dist/plugins/celltype/editor/slider.js":function(t,i,n){var e,s,o,r,c,u,a,l,h,g,M,I,f,N,d,D,v,w,b,A;function y(t){return document.createElement(t)}function j(t){var i=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(l(0,(i[1]||"").length-parseInt(i[2],10)))}function C(t){var t,i,t=j(t||0),i=0;return i=0<=t.indexOf(".")?t.length-t.indexOf(".")-1:i}function z(){}function m(t,i){this.Wc=i,this.fV={},this.fV=M.extend(this.fV,t)}function T(t,i){this.Wc=i,this.lV={},this.lV=M.extend(this.lV,t)}function p(t,i){this.Wc=t,this.hV={},this.dV="",this.hV=M.extend(this.hV,i),this.dV='\n        <div class="'.concat(this.hV.prefixCls,"-tooltip ").concat(this.hV.prefixCls,'-tooltip-placement-top">\n            <div class="').concat(this.hV.prefixCls,'-tooltip-content">\n                <div class="').concat(this.hV.prefixCls,'-tooltip-arrow"></div>\n                <div class="').concat(this.hV.prefixCls,'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        ')}function x(t,i){this.Wc=i,this.vV={},this.mV=!1,this.gV=a,this.isSelected=!1,this.yme=a,this.vV=M.extend(this.vV,t),this.gV=new N(this.Wc,this.pV())}function L(t,i){this.Wc=i,this.bV={},this.bV=M.extend(this.bV,t)}function S(t,i,n,e,s){this.Wc=t,this.yV=i,this.wV=n,this.endHandle=e,this.MU=s,this.MV=a,this.CV=a,this.MV=new f(this.SV(),this.Wc),this.CV=new D(this.TV(),this.Wc)}function k(t,i){var e=A.call(this,t)||this;return e.yV=a,e.wV=a,e.Y1e=a,e.Z1e=a,e.AV=a,e.Mme=function(t){var t,t,t;M.pauseEvent(t),t=e.AV.getKeyboardValueMutator(t),M.isEmpty(t)||(t=t(e._V.value),(t=e.AV.trimAlignValue(t))!==e._V.value&&(e.setValue(t),e._V.onChange(t),e._V.onAfterChange(t),e.fire(s.BaseDropdown.Event_ValueChanged,{value:t,text:t.toString(),notCloseDropDown:!0})))},e.IV=function(t){0===t.button&&(document.addEventListener("mouseup",e.xV,!1),document.addEventListener("pointerup",e.xV,!1),document.addEventListener("MSPointerUp",e.xV,!1),document.addEventListener("mousemove",e.NV,!1),document.addEventListener("pointermove",e.NV,!1),document.addEventListener("MSPointerMove",e.NV,!1),e.NV(t))},e.NV=function(t){var t,i,t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.xV=function(t){var i,n;e.NV(t),document.removeEventListener("mousemove",e.NV),document.removeEventListener("mouseup",e.xV),document.removeEventListener("pointermove",e.NV),document.removeEventListener("pointerup",e.xV),document.removeEventListener("MSPointerMove",e.NV),document.removeEventListener("MSPointerUp",e.xV),i=e.kV(t,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),M.pauseEvent(t)},e.EV=function(t){var i=t.target||t.srcElement;document.addEventListener("touchend",e.jV,!1),i.classList.contains("".concat(e._V.prefixCls,"-handle"))?document.addEventListener("touchmove",e.OV,!1):e.OV(t)},e.OV=function(t){var t,t,i,t=t.targetTouches[0],t=e.kV(t,!0),i=e.AV.trimAlignValue(t);e._V.showNumberRange?e.Cme(i,t):e.DV!==i&&(e.setValue(i),e._V.onChange(i))},e.jV=function(t){var i,i,n;document.removeEventListener("touchmove",e.OV),document.removeEventListener("touchend",e.jV),i=t.changedTouches[0],i=e.kV(i,!0),n=e.AV.trimAlignValue(i),e._V.showNumberRange?(e.Cme(n,i),e._V.onAfterChange(e._V.numberRange),e.fire(s.BaseDropdown.Event_ValueChanged,{value:e._V.numberRange,text:e._V.numberRange,notCloseDropDown:!0})):(e.DV=n,e._V.onAfterChange(e._V.value),e.fire(s.BaseDropdown.Event_ValueChanged,{value:n,text:n.toString(),notCloseDropDown:!0})),M.pauseEvent(t)},e.init(i),e}e=this&&this.__extends||(b=function(t,i){return(b=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}b(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Slider=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("Common"),r=n("Core"),c=o.Common.lt.ht,u=o.Common.zf.j0,a=null,l=Math.max,h=Math.min,g=Math.abs,z.isEmpty=function(t){return void 0===t||t===a||""===t||Array.isArray(t)&&0===t.length},z.isEmptyObject=function(t){var i,n,i=!0;for(n in t)if(n){i=!1;break}return i},z.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},z.isObject=function(t){var i=typeof t;return"function"==i||"object"==i&&!!t},z.allKeys=function(t){var i,n,i=[];if(!z.isObject(t))return[];for(n in t)t.hasOwnProperty(n)&&i.push(n);return i},z.parseStyleObject=function(t){var i,n,e,s,o,r,o;if(!z.isObject(t))return"";for(i="",e=0,s=(n=z.allKeys(t)).length;e<s;e++)r=t[o=n[e]],o=o.replace(/([A-Z])/g,"-$1"),i+="".concat(o.toLowerCase(),": ").concat(r,"; ");return i.trim()},z.extend=function(t,i,n){var e,s,o,r,c;for(void 0===n&&(n={}),e=z.allKeys(t),o=0,r=(s=z.allKeys(i)).length;o<r;o++)n[c=s[o]]=i[c];for(o=0,r=e.length;o<r;o++)void 0===n[c=e[o]]&&(n[c]=t[c]);return n},z.noop=function(){},z.measureWidth=function(t,i){var n,e,n=0,e=y("span");e.classList.add(i);try{e.innerText=t,e.style.display="none",document.body.appendChild(e),n=(0,r.GC$)(e).width()}finally{document.body.removeChild(e)}return n},M=z,m.prototype.render=function(){var t,i;if(!this.fV.included)return a;t=this.RV(),(i=this.Wc.querySelector(".".concat(this.fV.className)))===a&&((i=y("div")).classList.add("".concat(this.fV.className)),this.Wc.appendChild(i)),i.setAttribute("style",M.parseStyleObject(t))},m.prototype.setLength=function(t,i){this.fV.length=t,c(i)||(this.fV.offset=i),this.render()},m.prototype.RV=function(){return this.fV.direction===r.LayoutDirection.vertical?{bottom:"".concat(this.fV.offset,"%"),height:"".concat(this.fV.length,"%")}:{left:"".concat(this.fV.offset,"%"),width:"".concat(this.fV.length,"%")}},I=m,T.prototype.render=function(){var t,i,n,e,s,t=this.Wc.querySelector(".".concat(this.lV.className));if(t===a){for((t=y("div")).className="".concat(this.lV.className),n=0,e=(i=this.BV()).length;n<e;n++)s=this.LV(i[n]),t.appendChild(s);this.Wc.appendChild(t)}},T.prototype.LV=function(t){var i,n,n,n,i=y("span"),n=this.lV.max-this.lV.min,n=g(t-this.lV.min)/n*100+"%",n=this.lV.direction===r.LayoutDirection.vertical?{bottom:n}:{left:n};return i.classList.add("".concat(this.lV.prefixCls,"-dot")),i.setAttribute("style",M.parseStyleObject(n)),i.setAttribute("key",t.toString()),i},T.prototype.BV=function(){var t,i,n,t=Object.keys(this.lV.marks).map(function(t){return Number(t)});if(t.sort(function(t,i){return t-i}),i=t,this.lV.dots)for(n=this.lV.min;n<=this.lV.max;n+=this.lV.step)-1===i.indexOf(n)&&i.push(n);return i},f=T,p.prototype.render=function(t,i){var t,i,n,n,e,n;this.hV.offset=t,t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip")),i=new o.Formatter.GeneralFormatter(this.hV.formatString).format(i),M.isEmpty(t)&&(n=u(i),this.dV=this.dV.replace(/{{value}}/,n),(n=y("div")).innerHTML=this.dV,this.Wc.appendChild(n.firstElementChild),t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"))),(e=t.querySelector(".".concat(this.hV.prefixCls,"-tooltip-inner"))).textContent=i,n=this.GV(i),t.setAttribute("style",M.parseStyleObject(n)),this.hV.tooltipVisible?this.show():this.hide()},p.prototype.show=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));M.isEmpty(t)||(t.style.display="inline-block")},p.prototype.hide=function(){var t=this.Wc.querySelector(".".concat(this.hV.prefixCls,"-tooltip"));M.isEmpty(t)||(t.style.display="none")},p.prototype.GV=function(t){var t,t=0===(t=M.measureWidth(t,"".concat(this.hV.prefixCls,"-tooltip")))?12:t/2+4;return this.hV.direction===r.LayoutDirection.vertical?{left:"-".concat(t,"px"),bottom:"calc(".concat(this.hV.offset,"% + 10px)")}:{top:"-28px",left:"calc(".concat(this.hV.offset,"% - ").concat(t+4,"px)")}},N=p,x.prototype.render=function(){var t,i,n,e,t=this.UV(),i=this.GV(),n=this.vV.tabIndex||0;!this.vV.disabled&&n!==a||(n=a),(e=this.Wc.querySelector(".".concat(this.vV.className)))===a&&((e=y("div")).className=t,this.Wc.appendChild(e),e.setAttribute("role","slider"),e.setAttribute("aria-valuemin",this.vV.min.toString()),e.setAttribute("aria-valuemax",this.vV.max.toString()),e.setAttribute("aria-valuenow",this.vV.value.toString()),e.setAttribute("aria-disabled",String(this.vV.disabled)),e.addEventListener("blur",this.Sme.bind(this)),e.addEventListener("mouseenter",this.Tme.bind(this)),e.addEventListener("keydown",this.Sme.bind(this)),e.addEventListener("mousedown",this.Ame.bind(this)),e.addEventListener("touchstart",this.Ame.bind(this)),document.addEventListener("touchend",this.Ime.bind(this)),document.addEventListener("mouseup",this.Ime.bind(this))),e.tabIndex=n,e.setAttribute("style",M.parseStyleObject(i)),this.yme=e},x.prototype.Ame=function(t){this.yme.focus(),this.isSelected=!0,this.gV.show()},x.prototype.Ime=function(t){var i=this.yme;document.activeElement===i&&(this.HV(!1),i.blur(),this.isSelected=!1)},x.prototype.Sme=function(){this.HV(!1)},x.prototype.Tme=function(){this.gV.show()},x.prototype.isSelectedByMouse=function(t){return c(t)||(this.isSelected=t),this.isSelected},x.prototype.setOffset=function(t,i){this.vV.offset=t,this.render(),this.gV.render(t,i)},x.prototype.HV=function(t){this.mV=t},x.prototype.UV=function(){return this.mV?"".concat(this.vV.className," ").concat(this.vV.prefixCls,"-handle-click-focused"):"".concat(this.vV.className)},x.prototype.GV=function(){return this.vV.direction===r.LayoutDirection.vertical?{bottom:"".concat(this.vV.offset,"%")}:{left:"".concat(this.vV.offset,"%")}},x.prototype.pV=function(){return{prefixCls:"gc-slider",tooltipVisible:this.vV.tooltipVisible,direction:this.vV.direction,offset:this.vV.offset,formatString:this.vV.formatString}},x.prototype.dispose=function(){this.yme&&(this.yme.removeEventListener("blur",this.Sme.bind(this)),this.yme.removeEventListener("mouseenter",this.Tme.bind(this)),this.yme.removeEventListener("keydown",this.Sme.bind(this)),this.yme.removeEventListener("mousedown",this.Ame.bind(this)),this.yme.removeEventListener("touchstart",this.Ame.bind(this))),this.yme=a,document.removeEventListener("touchend",this.Ime.bind(this)),document.removeEventListener("mouseup",this.Ime.bind(this))},d=x,L.prototype.render=function(){var t,i,n,e,s,s,t=this.Wc.querySelector(".".concat(this.bV.className));if(t===a){for((t=y("div")).className="".concat(this.bV.className),i=this.zV(),this.VV(i),n=0,e=i.length;n<e;n++)s=i[n],(s=this.YV(s))!==a&&t.appendChild(s);this.Wc.appendChild(t)}},L.prototype.VV=function(t){var i,n,e,e;for(this.ZV=0,i=1,n=t.length;i<n;i++)(e=this.bV.marks[t[0]])&&(e=M.measureWidth(e.label,"".concat(this.bV.className,"-text")),!this.ZV||this.ZV<e)&&(this.ZV=e)},Object.defineProperty(L.prototype,"maxWidth",{get:function(){return this.ZV},enumerable:!1,configurable:!0}),L.prototype.zV=function(){var t;return M.allKeys(this.bV.marks).sort(function(t,i){return t-i})},L.prototype.YV=function(i){var n,t,e,s,o,o,t,n=this,t=this.bV.marks[i],e=M.isObject(t)?t.label:t;return M.isEmptyObject(e)?a:(s="".concat(this.bV.className,"-text"),o=this.WV(i),o=M.extend(o,t.style),(t=y("span")).classList.add(s),t.setAttribute("style",M.parseStyleObject(o)),t.setAttribute("key",i.toString()),t.addEventListener("mousedown",function(t){n.bV.onClickLabel(t,i)}),t.innerHTML=u(e),t)},L.prototype.WV=function(t){var i=this.bV.max-this.bV.min;return this.bV.direction===r.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.bV.min)/i*100+"%"}:{left:(t-this.bV.min)/i*100+"%",transform:"translateX(-50%)"}},D=L,S.prototype.render=function(){var t=y("div");t.className="".concat(this.MU.prefixCls,"-rail"),this.Wc.appendChild(t),this.yV.render(),this.MV.render(),this.wV.render(),this.endHandle&&this.endHandle.render(),this.CV.render(),this.CV.maxWidth&&this.MU.direction===r.LayoutDirection.vertical&&(this.Wc.style.paddingRight=this.CV.maxWidth+"px")},S.prototype.calcValueByPosition=function(t,i){var t,t,t=t-this.QV(),t=this.KV(t);return i?t:this.trimAlignValue(t)},S.prototype.trimAlignValue=function(t){return M.isEmpty(t)?a:this.JV(t)},S.prototype.calcOffset=function(){var t;return 100*(l(this.MU.value-this.MU.min,0)/(this.MU.max-this.MU.min))},S.prototype.getKeyboardValueMutator=function(t){var i=this;switch(t.keyCode){case 38:case 39:return function(t){return i.calculateNextValue("increase",t)};case 40:case 37:return function(t){return i.calculateNextValue("decrease",t)};case 35:return function(t){return i.MU.max};case 36:return function(t){return i.MU.min}}},S.prototype.calculateNextValue=function(t,i){var n,e,e,e,n={increase:function t(i,n){return i+n},decrease:function t(i,n){return i-n}},e=Object.keys(this.MU.marks).indexOf(String(i)),e=n[t](e,1),e=Object.keys(this.MU.marks)[e];return this.MU.step?n[t](i,this.MU.step):!M.isEmptyObject(this.MU.marks)&&this.MU.marks[e]?this.MU.marks[e]:i},S.prototype.JV=function(t){var t=isFinite(this.XV(t))?this.XV(t):0;return this.MU.step===a?t:parseFloat(t.toFixed(this.qV()))},S.prototype.qV=function(){var t,i;if(c(this.MU.precision)){for(i in t=l(C(this.MU.max),C(this.MU.min),C(this.MU.step)),this.MU.marks)t=l(C(parseFloat(i)),t);this.MU.precision=t}return this.MU.precision},S.prototype.XV=function(i){var t,n,n,n,n,t=Object.keys(this.MU.marks).map(parseFloat);return this.MU.step!==a&&(n=Math.ceil((this.MU.max-this.MU.min)/this.MU.step),n=h((i-this.MU.min)/this.MU.step,n),n=Math.round(n)*this.MU.step+this.MU.min,t.push(h(n,this.MU.max))),n=t.map(function(t){return g(i-t)}),t[n.indexOf(h.apply(void 0,n))]},S.prototype.SV=function(){return{prefixCls:this.MU.prefixCls,className:"".concat(this.MU.prefixCls,"-step"),direction:this.MU.direction,marks:this.MU.marks,dots:this.MU.dots,step:this.MU.step,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.TV=function(){var n=this;return{className:"".concat(this.MU.prefixCls,"-mark"),onClickLabel:this.MU.disabled?M.noop:function(t,i){n.$V(t,i)},direction:this.MU.direction,marks:this.MU.marks,included:this.MU.included,max:this.MU.max,min:this.MU.min}},S.prototype.$V=function(t,i){},S.prototype.QV=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===r.LayoutDirection.vertical?t.top:t.left},S.prototype.tY=function(){var t=this.Wc.getBoundingClientRect();return this.MU.direction===r.LayoutDirection.vertical?t.height:t.width},S.prototype.KV=function(t){var i,n,t,i=this.MU.min,n=this.MU.max,t=g(l(t,0)/this.tY());return(t=this.MU.direction===r.LayoutDirection.vertical?l(1-t,0):t)*(n-i)+i},v=S,A=s.BaseDropdown,e(k,A),k.prototype.setValue=function(t){var i,n,i;this._V.disabled||(this._V.showNumberRange?(c(this.W1e)&&(this.W1e={}),i=t.start,n=t.end,i=parseFloat(i),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),h(this._V.max,i)),this._V.numberRange.start=i,this.W1e.start=i,this.Y1e.setOffset(this.calcOffset(i),i),n=parseFloat(n),n=isNaN(n)?this._V.max:(n=l(this._V.min,n),h(this._V.max,n)),n=l(i,n),this._V.numberRange.end=n,this.W1e.end=n,this.yV.setLength(this.calcRangeOffset(),this.calcOffset(i)),this.Z1e.setOffset(this.calcOffset(n),n)):(i=parseFloat(t),i=isNaN(i)?this._V.min:(i=l(this._V.min,i),h(this._V.max,i)),this._V.value=i,this.DV=this._V.value,this.yV.setLength(this.calcOffset()),this.wV.setOffset(this.calcOffset(),i)))},k.prototype.calcOffset=function(t){var t,t,t=c(t)?this._V.value:t,t=l(t-this._V.min,0)/(this._V.max-this._V.min);return 100*(t=h(t,1))},k.prototype.calcRangeOffset=function(){var t,t,t=this._V.numberRange.end-this._V.numberRange.start,t=l(t,0)/(this._V.max-this._V.min);return 100*(t=h(t,1))},k.prototype.setOptions=function(t){this.init(t)},k.prototype.init=function(t){var t,i,t,n,n;this.nY(t),this.eY(),this.Ti.innerHTML="",(t=y("div")).className="gc-slider-container",this.Ti.appendChild(t),this._V.direction===r.LayoutDirection.vertical?(t.classList.add("".concat(this._V.prefixCls,"-vertical")),t.style.height=this._V.height+"px"):t.style.width=this._V.width+"px",(i=y("div")).className=this.UV(),t.appendChild(i),this.yV=new I(this.iY(),i),this._V.showNumberRange?((t=this.rY()).value=this._V.numberRange.start,n=y("div"),i.appendChild(n),this.Y1e=new d(t,n),t.tabIndex++,t.value=this._V.numberRange.end,n=y("div"),i.appendChild(n),this.Z1e=new d(t,n),this.AV=new v(i,this.yV,this.Y1e,this.Z1e,this.oY())):(this.wV=new d(this.rY(),i),this.AV=new v(i,this.yV,this.wV,a,this.oY())),this.AV.render(),this.aY(i)},k.prototype.aY=function(t){this._V.disabled||(t.addEventListener("mousedown",this.IV),t.addEventListener("pointerdown",this.IV),t.addEventListener("MSPointerDown",this.IV),t.addEventListener("touchstart",this.EV),t.addEventListener("keyup",this.Mme))},k.prototype.Cme=function(t,i){var n,e,n,s,i,o,r,o,r,n=this._V.numberRange,e=n.start,n=n.end,s=g(i-e),i=g(n-i),o=this.Y1e,r=this.Z1e;e===n?(n<t?(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})):t<e&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})),o.isSelectedByMouse(!1),r.isSelectedByMouse(!1)):(o=this.Z1e.isSelectedByMouse(),r=this.Y1e.isSelectedByMouse(),(o&&s<i||i<s&&!r)&&n!==t&&(this.setValue({start:e,end:t}),this._V.onChange({start:e,end:t})),(r&&i<s||s<i&&!o)&&e!==t&&(this.setValue({start:t,end:n}),this._V.onChange({start:t,end:n})))},k.prototype.kV=function(t,i){var n=0,n;return n=this._V.direction===r.LayoutDirection.vertical?this.AV.calcValueByPosition(t.clientY,i):this.AV.calcValueByPosition(t.clientX,i)},k.prototype.uY=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:r.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General",showNumberRange:!1,numberRange:{start:0,end:100}}},k.prototype.eY=function(){(M.isEmpty(this._V)||M.isEmptyObject(this._V))&&(this._V={}),this._V=M.extend(this.uY(),this._V)},k.prototype.nY=function(t){var n=this;t&&(c(t.scaleVisible)||(this._V.dots=t.scaleVisible),c(t.direction)||(this._V.direction=t.direction),c(t.formatString)||(this._V.formatString=t.formatString),this.sY(t.min,"min"),this.sY(t.max,"max"),this.sY(t.step,"step"),this.sY(t.width,"width"),this.sY(t.height,"height"),this._V.step<=0&&(this._V.step=1),this._V.min>this._V.max&&(this._V.max=this._V.min),c(t.tooltipVisible)||(this._V.tooltipVisible=t.tooltipVisible),c(t.showNumberRange)||(this._V.showNumberRange=!!t.showNumberRange),this._V.marks={},t.marks)&&t.marks.forEach(function(t){var t,i,t=parseFloat(t);isNaN(t)||t>=n._V.min&&t<=n._V.max&&(i=new o.Formatter.GeneralFormatter(n._V.formatString),n._V.marks[t]={label:i.format(t)})})},k.prototype.sY=function(t,i){var t;c(t)||(t=parseFloat(t),isNaN(t))||(this._V[i]=t)},k.prototype.iY=function(){return{className:"".concat(this._V.prefixCls,"-track"),included:this._V.included,direction:this._V.direction,offset:0,length:0}},k.prototype.rY=function(){return{prefixCls:this._V.prefixCls,className:"".concat(this._V.prefixCls,"-handle"),direction:this._V.direction,disabled:this._V.disabled,min:this._V.min,max:this._V.max,value:this._V.value,offset:0,tabIndex:0,tooltipVisible:this._V.tooltipVisible,formatString:this._V.formatString,showNumberRange:this._V.showNumberRange,numberRange:this._V.numberRange}},k.prototype.oY=function(){return{prefixCls:this._V.prefixCls,min:this._V.min,max:this._V.max,value:this._V.value,disabled:this._V.disabled,direction:this._V.direction,dots:this._V.dots,step:this._V.step,included:this._V.included,marks:this._V.marks,showNumberRange:this._V.showNumberRange}},k.prototype.UV=function(){var t="".concat(this._V.prefixCls);return this._V.direction===r.LayoutDirection.vertical&&(t+="  ".concat(this._V.prefixCls,"-vertical")),M.isEmptyObject(this._V.marks)||(t+=" ".concat(this._V.prefixCls,"-with-marks")),this._V.disabled&&(t+=" ".concat(this._V.prefixCls,"-disabled")),t},k.prototype.dispose=function(){var t=this.yV.Wc;t&&(t.removeEventListener("mousedown",this.IV),t.removeEventListener("pointerdown",this.IV),t.removeEventListener("MSPointerDown",this.IV),t.removeEventListener("touchstart",this.EV),t.removeEventListener("keyup",this.Mme)),this.yV.Wc=a,this.wV&&this.wV.dispose(),this.wV=a,this.Y1e&&this.Y1e.dispose(),this.Y1e=a,this.Z1e&&this.Z1e.dispose(),this.Z1e=a,A.prototype.dispose.call(this)},i.Slider=k},"./dist/plugins/celltype/editor/timepicker.js":function(t,i,n){var e,s,o,r,c,u,a,l,h;function g(t,i){var t=h.call(this,t)||this;return t.Hc(),t.setOptions(i),t}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.TimePicker=void 0,s=n("./dist/plugins/celltype/editor/listControl.js"),o=n("./dist/plugins/celltype/editor/baseControl.js"),r="undefined",c=n("Common"),u=c.Common.lt.ht,h=o.BaseDropdown,e(g,h),g.prototype.setOptions=function(t){var i,i,i,i;t&&(null!==(i=this.cY(t.min))&&(this.MU.min=i),null!==(i=this.cY(t.max))&&(this.MU.max=i),null!==(i=this.cY(t.step))&&(this.MU.step=i),u(t.formatString)||(this.MU.formatString=t.formatString),u(t.height)||(i=parseInt(t.height,10),isNaN(i))||(this.MU.height=i),this.MU.height=Math.max(1,this.MU.height)),this._6()},g.prototype.setValue=function(t){void 0!==t&&(this.Bz={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.fY=t,this.yz(),this.scrollToSelect())},g.prototype.scrollToSelect=function(){var t,t,t=this.gz.querySelector(".selected");null!==t&&(t=t.offsetTop,this.Wc.scrollTop=t)},g.prototype.Hc=function(){var i=this;this.MU={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.gz=document.createElement("div"),this.gz.classList.add("gc-time-picker-outer-div"),this.gz.addEventListener("click",function(t){i.pz(t)}),this.Ti.appendChild(this.gz)},g.prototype.cY=function(t){var i,n,n,n,i=null;return u(t)||(i={},u(t.hour)||(n=parseInt(t.hour,10),isNaN(n))||(i.hour=n),u(t.minute)||(n=parseInt(t.minute,10),isNaN(n))||(i.minute=n),u(t.second))||(n=parseInt(t.second,10),isNaN(n))||(i.second=n),i},g.prototype._6=function(){this.gz.innerHTML="",new s.List(this.gz,this.lY()),this.yz()},g.prototype.yz=function(){var t,i,n,e,s,t=this.gz.querySelectorAll(".gc-time-picker-li");if(0<t.length)for(i=0;i<t.length;i++)t[i].classList.remove("selected"),n=+t[i].getAttribute("hour"),e=+t[i].getAttribute("minute"),s=+t[i].getAttribute("second"),this.hY(this.Bz,{hour:n,minute:e,second:s})&&t[i].classList.add("selected")},g.prototype.lY=function(){var s=this;return{items:function(){var t,i,n,e,t=s.dY(),i=document.createElement("div");for(i.classList.add("gc-time-picker-container"),s.Wc=i,s.MU.height<0?i.style.height="auto":i.style.maxHeight=s.MU.height+"px",(n=document.createElement("ul")).classList.add("gc-time-picker-ul"),e=0;e<t.length;e++)n.appendChild(s.vY(t[e]));return 24*t.length>s.MU.height&&0<=s.MU.height?i.style.overflowY="scroll":i.style.overflowY="hidden",i.appendChild(n),i}}},g.prototype.vY=function(t){var i=document.createElement("li");return i.classList.add("gc-time-picker-li"),i.setAttribute("hour",t.hour.toString()),i.setAttribute("minute",t.minute.toString()),i.setAttribute("second",t.second.toString()),i.innerText=this.mY(t),i},g.prototype.dY=function(){for(var t,i,n,t=this.gY(this.MU.min),i=this.gY(this.MU.max),n=[];t<=i;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.pY(t,this.MU.step);return n},g.prototype.pY=function(t,i){return typeof i.hour!=r&&t.setHours(t.getHours()+i.hour),typeof i.minute!=r&&t.setMinutes(t.getMinutes()+i.minute),typeof i.second!=r&&t.setSeconds(t.getSeconds()+i.second),t},g.prototype.mY=function(t){var i,n,t,i=new Date;return i.setHours(t.hour),i.setMinutes(t.minute),i.setSeconds(t.second),(t=(n=new c.Formatter.GeneralFormatter(this.MU.formatString)).format(i))&&""!==t&&null!==t?t:this.bY(i)},g.prototype.bY=function(t){var i,t,n,e,s,i=t.getHours(),t=t.getMinutes(),n,e,s;return(i<12?"AM":"PM")+" "+(0===i||12===i?"12":(i%12).toString())+":"+(t<10?"0"+t.toString():t.toString())},g.prototype.gY=function(t){var i=new Date;return i.setHours(t.hour||0),i.setMinutes(t.minute||0),i.setSeconds(t.second||0),i},g.prototype.hY=function(t,i){return!(!t||!i)&&(t=this.yY(t),i=this.yY(i),t.hour===i.hour)&&t.minute===i.minute&&t.second===i.second},g.prototype.yY=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},g.prototype.pz=function(t){var t,i,n,t,e,s,s,t=t.target;t&&(i=+t.getAttribute("hour"),n=+t.getAttribute("minute"),t=+t.getAttribute("second"),(e=this.fY||new Date).setHours(i),e.setMinutes(n),e.setSeconds(t),e.setMilliseconds(0),s=(new c.Common.CultureInfo).DateTimeFormat,s=new c.Formatter.GeneralFormatter(s.defaultDatePattern).format(e),this.fire(o.BaseDropdown.Event_ValueChanged,{value:e,text:s}),this.Bz={hour:i,minute:n,second:t},this.yz())},i.TimePicker=g},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,i,n){var e,s,o,n,u,r,c,a;function l(t,i){var n=a.call(this,t)||this;return n.wY=new o.List(t),n.wY.on(s.BaseDropdown.Event_ValueChanged,function(t){n.fire(s.BaseDropdown.Event_ValueChanged,t)}),n.setOptions(i),n}function h(t,i){var e,s,o,n,r,c,e={items:[]},s=t.items,o=s.filter(function(t){return t.value===i})[0];if(u(o)&&s&&0<s.length)(n=e.items).push({text:s[0].value,value:s[0].value});else if(o&&o.transitions&&0<o.transitions.length)for(r=function(t){var i,t,n,i=o.transitions[t];"number"==typeof i&&s[i]&&(i=s[i].value),(t=s.filter(function(t){return t.value===i})[0])&&(n=e.items).push({text:t.value,value:t.value})},c=0;c<o.transitions.length;c++)r(c);return e}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.WorkFlow=void 0,s=n("./dist/plugins/celltype/editor/baseControl.js"),o=n("./dist/plugins/celltype/editor/listControl.js"),n=n("Common"),u=n.Common.lt.ht,a=s.BaseDropdown,e(l,a),l.prototype.setOptions=function(t){this.MU=t},l.prototype.setValue=function(t){var t;this.MU&&(t=h(this.MU,t),this.wY.setOptions(t))},l.prototype.updateStyle=function(t,i,n){this.wY.updateStyle(t,i,n)},i.WorkFlow=l},"./dist/plugins/celltype/hyperlinkcelltype.js":function(G,t,i){var n,e,b,i,N,i,s,v,o,r,A,y,c,u,a,j,d,C,l,h,g,M,I,z,f,D,w,m,T,U,p,E,B,x,Q,L,S,k,e,R;function P(t,i){t.removeChild(i)}function O(){var t,n,t=R.call(this)||this;return t.typeName="8",(n=t)._id=t.MY(),u(L,function(t,i){n["_"+t]=i}),t._onAction=function(t){var i,n,e,t,i,n,i=t&&t.sheet,n=t.row,e=t.col,t=t.sheetArea,i=i.getValue(n,e,t),n=Y(this._target);i&&l(o(i),n)},t}function Y(t){return["_blank","_self","_parent","_top"][t]}function H(t,i,n,e,s,o){var r,c,u,t,r=0,c=0,u=t.width,t=t.height;return r=o=o||0,1===e?r=(u-i)/2:2===e&&(r=u-i-o),1===s?c=(t-n)/2:2===s&&(c=t-n),{x:r,y:c}}function W(t,i,n,e){var t,n,t=J(t,n),n=t.width;return n+=!0==(1!==i&&!v(e))?e:0,t.width=n,t}function V(t,i,n,e,s,o){var t,e,t=J(t,e),e=H(s,t.width,t.height,i,n,o);return t.x=e.x,t.y=e.y,t}function J(t,i){var n,e,s,n=r(i),e,s;return{x:0,y:0,width:Math.max(0,b.q.Wt(t,i,!0)),height:t.split(/\r\n|\r|\n/).length*n}}function X(t,i,n,e,s,o){var r,c,s,u,a,l,s,h,g,M,I,f,N,r=s.sheet,c=r.Dn;if(!v(n)&&(o=o||(s=r.getValue(s.row,s.col,s.sheetArea),v(s))?o:s+""))for(e=n.cellType.An(e,n,r.zoom()),o=o.replace(/\s+/g," "),u=n&&n.font?n.font:c.Nn(),u=c._n(u),a=[o],l=Z(n),s=V(o=n.wordWrap?(a=b.q.un(o,e.width-3-l,u)).join("\r\n"):o,n.hAlign,n.vAlign,u,e,l),h=e.y+s.y,g=0;g<a.length;g++)if(M=V(a[g],n.hAlign,n.vAlign,u,e,l),I=e.x+M.x,f=d(I+M.width,e.x+e.width),h=d((N=h)+M.height,e.y+e.height),I<=t&&t<f&&N<=i&&i<h)return!0;return!1}function Z(t){return 8*(t.textIndent||0)}function F(t,i,n,e,s){var o,e,r,r,c,n,r,u,a,l,h,g,M,I,f,r,o=e&&e.sheet;if(o){if(r=o.Dn,c=i.font||r.Nn(),1<n&&(c=r._n(c)),n=Z(i),i.wordWrap||s){if(i.wordWrap){if(r=e.row,u=e.col,a=e.sheetArea,l=0,h=o.Ut.findSpan(r,u,a)){if(h.row>=r&&h.rowCount<=1&&h.col>=u&&u===h.col&&(l=o.nn(u,a),1<h.colCount))for(g=u+1;g<u+h.colCount;g++)l+=o.nn(g,a)}else l=o.nn(u,a);if(e=N(i,1),0<(r=N(i,3))&&(l-=r),0<e&&(l-=e),M=b.q.un(t,l-3-n,c),s&&1<t.split(/\r\n|\r|\n/).length){for(f=I=0;f<M.length;f++)I=Math.max(I,W(M[f],i.hAlign,c,Z(i)).width);return I}s||(t=M.join("\r\n"))}}else t=t.replace(/\s+/g," ");return r=W(t,i.hAlign,c,Z(i)),s?r.width:r.height}return 0}n=this&&this.__extends||(k=function(t,i){return(k=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}k(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=t.HyperLinkTargetType=void 0,e=i("Common"),i=(b=i("Core")).CellTypes.Context,N=i.gn,i=b.CellTypes.Base,s=b.mt.En,v=e.Common.lt.ht,o=e.Common.zf.TY,r=b.mt.vt,A=b.mt.Tt,y=A.mozilla,c=b.GC$,u=c.each,a=null,j=Math.max,d=Math.min,C=Math.floor,l=window.open,h="position",g="absolute",M="margin",I="font",z="left",f="top",D="padding",w="border",m="box-sizing",T="background-color",U="content-box",p="default",E="white",B="div",x="hyperlinkInfo",(e=Q=t.HyperLinkTargetType||(t.HyperLinkTargetType={}))[e.blank=0]="blank",e[e.self=1]="self",e[e.parent=2]="parent",e[e.top=3]="top",L={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},n(O,R=i),O.prototype.MY=function(){var t,i;return v(this._id)&&(this._id="0"),i="id_"+(t=parseInt(this._id,10)),this._id=++t+"",i},O.prototype.AY=function(t,i,n,e,s,o,r,c,u,a){var l,h,g,M,I,f,g,s,N,d,i,D,v,w,b,l=1,h=z,g=r.hAlign,M=r.vAlign,I=c.lineHeight,f=u.length;for(l+=i,1===g?(l=s/2,h="center"):2===g&&(l=s-1,l-=i,h="right"),t.textAlign!==h&&(t.textAlign=h),g=1,s="alphabetic",g+=I-(i=I/2-(N=parseInt(c.fontInfo.fontSize,10))/2+(d=8<N?C((N-8)/5+2):1)-1),1===M?I<o&&(g=y?(o-a)/2+1:A.msie?(o-a)/2+.5:(o-a)/2,C(g)!==g&&(g+=.5),g+=I/2-i):2===M&&(g=o-a-2.5-i),t.textBaseline!==s&&(t.textBaseline=s),D=e+g,v=0;v<f;v++)t.fillText(u[v],n+l,D),w=t.measureText(u[v]).width,(b=r.textDecoration)&&this.le(t,b,n+l,D,w,N,d),D+=I},O.prototype.IY=function(t,i,n,e,s,o,r,c,u){var a,l,h,g,M,I,g,f,N,d,D,v,r,c,w,a=r.hAlign,l=r.vAlign,h=c.lineHeight,M=u.length,f=0,N=0,D=0,v=0;for(2!==a&&(D=1),2===r.vAlign&&(v=-2.5),v-=j(0,Math.round(h/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),r=c.fontInfo.fontSize,c=C((r-12)/21+1),t.lineWidth=c,t.beginPath(),w=0;w<M;w++)g=t.measureText(u[w]).width,g=(I=D+n+(d=H(new b.Rect(n,e,s,o),g,h*M,a,l,i)).x)+g,f=v+e+d.y+h,C(f)===f&&(f+=.5),N=f,t.moveTo(I,f),t.lineTo(g,N),t.stroke(),v+=h},O.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,i,a,l,h,g,M,I,f,N,N,g,M,d,I,f,h,N,D,u=this;if(t&&(i=u.getText(i,c),!v(i))){for(a=(i+="").split(/\r\n|\r|\n/),l=0;l<a.length;)a[l]=a[l].replace(/\s+/g," "),l++;i=a.join("\r\n"),h=!1,g=c.sheet.Ut,M=c.row,I=c.col,f=c.sheetArea,(N=g.getValueForKey(M,I,x,f))&&(u._id===N.id?h=N.visited:g.do("setValueForKey",M,I,x,void 0,f)),t.save(),t.beginPath(),(N=h?u._visitedLinkColor:u._linkColor)&&t.fillStyle!==N&&(t.fillStyle=N),(g=r.font)&&t.font!==g&&b.mt.bt(t,g),M=Z(r),c.sheet.outlineColumn&&c.sheet.outlineColumn.Un(c.col)&&(M=0),I=[],h=f=0,(d=r.wordWrap)?(N=s-3-M,1<(f=(I=b.q.un(i,--N,g)).length)&&0!==r.vAlign&&(h=(f-1)*(D=c.lineHeight))):I.push(i),t.rect(n,e,s,o),t.clip(),t.beginPath(),u.AY(t,M,n,e,s,o,r,c,I,h),u.IY(t,M,n,e,s,o,r,c,I),t.restore()}},O.prototype.getText=function(t,i){return this._text||t},O.prototype.j3=function(t,i,n,e){var s;t.Ai||(s=t.parent)&&s.j3(t,i,n,e)},O.prototype.getHitInfo=function(t,i,n,e,s){var o,r,o=this;return s&&(r=s.sheetArea,v(r)&&(r=3),n)&&e?{x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:r,isFocusAware:!0,sheet:s.sheet,isReservedLocation:X(t,i,n,e,s,o._text)}:a},O.prototype.processMouseDown=function(t){var i=t&&t.sheet,n=this;i&&!i.isEditing()&&t.isReservedLocation&&(n.xY=!0)},O.prototype.processMouseUp=function(t){var i,i,i=t&&t.sheet;i&&!i.isEditing()&&(i=this,t.isReservedLocation&&i.xY&&i.NY(t),i.xY=!1)},O.prototype.processMouseMove=function(t){var i,n,e,s,i,i=t.row,n=t.col,e=t.sheet,s=this;!e||e.isEditing()&&e.getActiveRowIndex()===i&&e.getActiveColumnIndex()===n||(i=e.Dg(),t.isReservedLocation?i&&(s.kY(e,t),i.style.cursor="pointer"):(s.DY(e),i&&(i.style.cursor=p)))},O.prototype.processMouseLeave=function(t){var t,i,i,t=t.sheet,i=this;i.xY=!1,i.DY(t),t&&(i=t.Dg())&&(i.style.cursor=p)},O.prototype.kY=function(t,i){var n,e,s,n,o,n,i,n=this;n._linkToolTip&&(e=n._Y(),(s=c(e)).text(n._linkToolTip),o=(n=t.rt.it()).left+i.x,n=n.top+i.y+20,0===s.parent().length)&&((i=t&&t.qc())&&i.insertBefore(e,a),s.css(f,n).css(z,o))},O.prototype.DY=function(t){var i,t,i=this;i.EY&&((t=t&&t.qc())&&i.EY.parentElement===t&&P(t,i.EY),i.EY=a)},O.prototype._Y=function(){var t,i,t=this;return t.EY||(i=s(B),c(i).css(h,g).css(M,0).css(D,2).css(w,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(m,U).css(T,E).css(I,"9pt Arial"),t.EY=i),t.EY},O.prototype.isReservedKey=function(t,i){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},O.prototype.processKeyUp=function(t,i){var n,e;return!!i.sheet&&(this.NY(i),!0)},O.prototype.getAutoFitWidth=function(t,i,n,e,s){return F(this._text||t,n,e,s,!0)},O.prototype.getAutoFitHeight=function(t,i,n,e,s){return F(this._text||t,n,e,s)},O.prototype.isImeAware=function(t){return!1},O.prototype.NY=function(t){var i,n,e,s,o,r,i=t&&t.sheet,n=this,e=t.row,s=t.col,o=t.sheetArea,r;n.onClickAction().call(this,t),i.Ut.do("setValueForKey",e,s,x,{id:n._id,visited:!0},o),i.repaint(i.getCellRect(e,s,1===o?-1:a,2===o?-1:a)),n.j3(i,e,s,o)},O.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},O.prototype.Je=function(t){var t={linkColor:t.linkColor,visitedLinkColor:t.visitedLinkColor,text:t.text,linkToolTip:t.linkToolTip,target:t.target&&Q[t.target],activeOnClick:t.activeOnClick};this.fromJSON(t)},O.prototype.toJSON=function(){var n,e,s,n=this,e={typeName:n.typeName};return u(L,function(t,i){(s=n["_"+t])!==i&&(e[t]=s)}),e},O.prototype.fromJSON=function(n){var e=this;u(L,function(t){var i=n[t];v(i)||(e["_"+t]=i)})},O.prototype.jn=function(t){},O.prototype.Ke=function(){var n,e,s,n=this,s=new O;return u(L,function(t,i){(e=n["_"+t])!==i&&(s["_"+t]=e)}),s._onAction=n._onAction,s},S=O,t.HyperLink=S,u(L,function(i){S.prototype[i]=function(t){return 0===arguments.length?this["_"+i]:(this["_"+i]=t,this)}}),b.CellTypes.ti[8]=S},"./dist/plugins/celltype/radiochecklistcelltype.js":function(b,t,i){var n,Q,i,A,y,R,P,a,it,h,l,g,M,nt,i,e,r,Y,H,v,j,o,W,V,J,c,s,e,i,C,u,I,z,e,e,m,T,p,f,N;function X(t,i){return t.hasOwnProperty(i)}function d(t,i){return t instanceof Date&&i instanceof Date?y(t)===y(i):!M(t)&&!M(i)&&t.toString&&i.toString?t.toString()===i.toString():t===i}function x(t){var i,t,n,e,s,i=["0","0","0","0"];return typeof t===j&&(s=e=void 0,1===(n=(t=t.split(" ",4)).length)?i=[e=t[0],e,e,e]:2===n?i=[e=t[0],s=t[1],e,s]:3===n?(s=t[1],i=[t[0],s,t[2],s]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function D(){var t,n,t=m.call(this)||this;return t.typeName="11",t.defaultPadding=5,n=t,r(c,function(t,i){n["_"+t]=i="items"===t?[]:i}),t}function L(){return null!==T&&T.apply(this,arguments)||this}function S(){var t=null!==p&&p.apply(this,arguments)||this;return t.typeName="12",t}function w(){var t,n,t=N.call(this)||this;return t.typeName="13",t.defaultPadding=0,n=t,r(u,function(t,i){n["_"+t]=i="items"===t?[]:i}),n._boxSize=0,delete n.boxSize,t}function k(t,i,n,e,s,o){var r,r,s,r=i.getValue(n,e,o),r=t.wG(r,s),s={cmd:"editCell",sheetName:i.name(),row:n,col:e,newValue:r,autoFormat:!1};i.Qy().execute(s),t.triggerButtonClicked(i,n,e,o)}function F(t,i,n,e,s){var i,o,n,r,c,i=i.zoom(),o=K(t._boxSize,n.font,i),n=st(t,n),r,c=e;return P(n,o)*(c=t._items.length<e?t._items.length:c)+t._itemSpacing.vertical*i*(c-1)}function _(t,i,n,e,s){var o,r,c,i,u,o=i.zoom(),r=K(t._boxSize,n.font,o),c=t.defaultPadding*o,i=et(t,i,n,e,s),u=0;return i.forEach(function(t){u+=t}),u+=s*(r+c)+(s-1)*t._itemSpacing.horizontal*o}function et(t,i,n,e,s){for(var o,r,c,c,u,u,o=[],r=0;r<t._items.length;r++)c=X(t._items[r],H)?t._items[r].text:t._items[r],c=i.Qt(c,n.font),(u=t.jY()).hasMargin&&(c=c+u.paddingLeft+u.paddingRight),u=R(r%s),o[u=t._direction===V.vertical?R(r/e):u]=o[u]===g?c:Math.max(o[u],c);return o}function K(t,i,n){var e=W*n;return"number"==typeof t&&0<=t?e=t*n:"auto"===t&&(e=Y(i)/2),e}function st(t,i){var i,t,i=Y(i.font),t=t.jY();return i=t.hasMargin?i+t.paddingTop+t.paddingBottom:i}function q(t,i,n,e){var n,s,n=O(t)*n,s=n;return 1===t.hAlign?s=(i.width-e)/2:2===t.hAlign&&(s=i.width-n-e),s}function $(t,i,n,e){var n,s,n=2*n,s=n;return 1===t.vAlign?i.height-n>e&&(s=(i.height-e-n)/2+n):2===t.vAlign&&(s=i.height-e-n),s}function tt(t,i,n,e,s){var o,r,c,u;if(t._direction===V.vertical){if(t._isFlowLayout){if(s!==g)for(o=t._items.length;0<o;){if(!(s<(r=F(t,i,n,o,a(t._items.length/o)))))return[o=P(o,1),a(t._items.length/o)];o-=1}return[t._items.length,1]}return[o=P(1,t._maxRowCount),a(t._items.length/o)]}if(t._isFlowLayout){if(e!==g)for(c=t._items.length;0<c;){if(!(e<(u=_(t,i,n,a(t._items.length/c),c))))return c=P(c,1),[a(t._items.length/c),c];c-=1}return[1,t._items.length]}return c=P(1,t._maxColumnCount),[a(t._items.length/c),c]}function O(t){var i=t.textIndent;return 1===t.hAlign||0===i||i===l||i===g?2:8*i}function Z(c,u){for(var t,i,a,l,n,n,t,h,g,M,I,f,N,i,t,d,D,e,s,o,t=u.cellRect.width,i=u.cellRect.height,a=u.sheet,l=a.zoom(),n=a.Z_(u.row,u.col),n=n&&n.font,t=tt(c,a,u.cellStyle,t-1,i),h=t[0],g=t[1],M=et(c,a,u.cellStyle,h,g),I=K(c._boxSize,n,l),f=c.defaultPadding*l,N=P(st(c,u.cellStyle),I),i=_(c,a,u.cellStyle,h,g),t=F(c,a,u.cellStyle,h,g),d=q(u.cellStyle,u.cellRect,l,i),D=$(u.cellStyle,u.cellRect,l,t),e=function(t){var i,i,n,e,s,o,r,n,n,i,i=X(c._items[t],H)?c._items[t].text:c._items[t],i=a.Qt(i,u.cellStyle.font),n=R(t/g),e=t%g;if(c._direction===V.vertical&&(n=t%h,e=R(t/h)),s=new Q.Rect,o=0,(r=M.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=d+o+e*(I+f+c._itemSpacing.horizontal*l),s.y=D+n*N+c._itemSpacing.vertical*l*n,n=c.jY(),s.width=(c._textAlign!==J.right||n.hasMargin?M[e]:i)+I+f,s.height=N,n=u.x-u.cellRect.x,i=u.y-u.cellRect.y,s&&s.contains(n,i))return{value:{value:X(c._items[t],v)?c._items[t].value:c._items[t]}}},s=0;s<c._items.length;s++)if("object"==typeof(o=e(s)))return o.value}function G(t,i){var n,e,s,n=!1,e=X(t,v)?t.value:t;if(i!==l)if(Array.isArray(i)){for(s=0;s<i.length;s++)if(d(i[s],e)){n=!0;break}}else n=d(i,e);return n}function U(t,i,n,e){var s,o,r,c,u;if(e)return i;for(t===l&&(t=[]),Array.isArray(t)||(t=[t]),s={},n.forEach(function(t){s[X(t,v)?t.value:t]=!0}),o=t.length-1;0<=o;o--)s[t[o]]||t.splice(o,1);if(-1===(c=(r=t.slice()).indexOf(i)))r.push(i);else for(o=r.length-1;0<=o;o--)d(r[o],i)&&r.splice(o,1);return u=[],n.forEach(function(t){-1!==r.indexOf(t.value)&&u.push(t.value)}),u}n=this&&this.__extends||(z=function(t,i){return(z=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}z(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonList=t.CheckBoxList=t.RadioButtonList=t.SelectionMode=t.TextAlign=t.Direction=void 0,Q=i("Core"),i=i("Common"),A=i.Common.lt.tv,y=i.Common.ct.o0,R=Math.floor,P=Math.max,a=Math.ceil,it="left",h="alphabetic",l=null,g=void 0,M=i.Common.lt.ht,nt=Q.mt.bt,i=Q.CellTypes.Base,e=Q.GC$,r=e.each,Y=Q.mt.vt,H="text",v="value",j="string",o="number",W=12,(e=V=t.Direction||(t.Direction={}))[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical",(e=J=t.TextAlign||(t.TextAlign={}))[e.left=2]="left",e[e.right=3]="right",c={items:l,direction:V.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:J.right,boxSize:W},n(D,m=i),D.prototype.paintValue=function(t,i,n,e,s,o,r,c){var u,a,G,l,h,g,M,I,f,N,d,D,g,v,w,b,A,y,j,C,z,M,m,T,U,p,x,L,S,k,O,Z,Z,E,B,u=this;if(t){for(t.save(),t.rect(n+1,e+1,s-2,o-2),t.clip(),t.beginPath(),G=a=0,h=(l=c.sheet).zoom(),g=r.font,M=c.isPrinting,I=c.printZoomFactor,f=K(u._boxSize,g,h=M&&"number"==typeof I&&1!==I?I:h),N=u.defaultPadding*h,d=f/2,D=new Q.Rect(n+1,e+1,s-2,o-2),b=_(u,l,r,v=(g=tt(u,l,r,s-2,o-2))[0],w=g[1]),A=F(u,l,r,v,w),y=et(u,l,r,v,w),j=st(u,r),C=n+q(r,D,h,b),z=e+$(r,D,h,A),(M=r.font)&&t.font!==M&&nt(t,c.fontInfo.font),r.foreColor&&(t.fillStyle=r.foreColor),m=r.textDecoration,U=8<(T=c.fontInfo.fontSize)?R((T-8)/5+2):1,p=0,p=(G=Y(r.font))/2-T/2+U-1,x=C,L=z,k=S=0,f<T&&(S=u.OY(f),k=(j-p-W)/2+1),O=0;O<u._items.length;O++)n+s<C||e+o<z||(Z=X(u._items[O],H)?u._items[O].text:u._items[O],a=l.Qt(Z,r.font),t.textAlign=it,Z=u._direction===V.vertical?y[R(O/v)]:y[O%w],E=0,E=u._textAlign===J.left?(u.RY(t,u._items[O],i,a,C,z+S,Z,j,p),C=C+Z+N,t.save(),u.BY(t,i,u._items[O],C,z+k,d),t.restore(),f):(t.save(),u.BY(t,i,u._items[O],C,z+k,d),C=C+f+N,t.restore(),u.RY(t,u._items[O],i,a,C,z+S,Z,j,p),Z),m&&(B=this.jY(),u.le(t,m,C-(u._textAlign===J.right?0:Z+N)+B.paddingLeft,z+j-p-B.paddingBottom,a,T,U)),u._direction===V.vertical?(z+=P(j,f)+u._itemSpacing.vertical*h,(O+1)%v==0&&(x=x+Z+f+N+u._itemSpacing.horizontal*h,z=e+$(r,D,h,A)),C=x):(C=C+E+u._itemSpacing.horizontal*h,(O+1)%w==0&&(C=n+q(r,D,h,b),L=L+P(j,f)+u._itemSpacing.vertical*h),z=L));t.restore()}},D.prototype.OY=function(t){return(t-W)/2},D.prototype.getText=function(t,i){return t},D.prototype.RY=function(t,i,n,e,s,o,r,c,u){var i=X(i,H)?i.text:i;t.textBaseline!==h&&(t.textBaseline=h),t.fillText(i,s,o+c-u)},D.prototype.getItemsBound=function(c,t,i,n){var u,a,l,e,s,o,r,h,t,i,n,g,M,I,f,N,d,t,i,D,v,w,b,A,u=this,a=c.zoom(),l=c.getActualStyle(t,i,n),e,s=Q.W.V("11pt "+c.currentTheme().bodyFont(),a);for(l.font&&(s=Q.W.V(l.font,a)),l.font=s.font,t=(h=c.getCellRect(t,i,o=1===n?-1:void 0,r=2===n?-1:void 0)).width,i=h.height,n=tt(u,c,l,t-1,i),g=n[0],M=n[1],I=et(u,c,l,g,M),f=K(u._boxSize,s.font,a),N=u.defaultPadding*a,d=P(st(u,l),f),t=_(u,c,l,g,M),i=F(u,c,l,g,M),D=q(l,h,a,t),v=$(l,h,a,i),w=[],b=function(t){var i,i,n,e,s,o,r,n,i=X(u._items[t],H)?u._items[t].text:u._items[t],i=c.Qt(i,l.font),n=R(t/M),e=t%M;u._direction===V.vertical&&(n=t%g,e=R(t/g)),s=new Q.Rect,o=0,(r=I.filter(function(t,i){return i<e})).forEach(function(t){o+=t}),s.x=D+o+e*(f+N+u._itemSpacing.horizontal*a)+h.x,s.y=v+n*d+u._itemSpacing.vertical*a*n+h.y,n=u.jY(),s.width=(u._textAlign!==J.right||n.hasMargin?I[e]:i)+f+N,s.height=d,s.x>h.x+h.width||s.y>h.y+h.height?w[t]=null:w[t]=s},A=0;A<u._items.length;A++)b(A);return w},D.prototype.BY=function(t,i,n,e,s,o){},D.prototype.jY=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},D.prototype.getAutoFitWidth=function(t,i,n,e,s){var s,o,r,c,u,s=s&&s.sheet,o=O(n),r=tt(this,s,n),c,u;return(_(this,s,n,r[0],r[1])+o)/e},D.prototype.getAutoFitHeight=function(t,i,n,e,s){var o,s,r,c,o=s&&s.sheet,s=tt(this,o,n,+o.getColumnWidth(s.col)*e),r,c;return F(this,o,n,s[0],s[1])/e},D.prototype.getHitInfo=function(t,i,n,e,s){var o,r,c,t,i,s,r,s,u,o,c,r,a,o=this;return s&&(r=s.sheetArea,c=s.sheet,e=n.cellType.An(e,n,c.zoom()),M(r)||3===r)&&e?(t={x:t,y:i,row:s.row,col:s.col,cellStyle:n,cellRect:e,sheetArea:r,sheet:c},i=c.zoom(),n.font&&(n.font=Q.W.V(n.font,i).font),u=_(o,c,n,r=(s=tt(o,c,n,e.width-1,e.height-2))[0],s=s[1]),o=F(o,c,n,r,s),c=e.x+q(n,e,i,u),r=e.y+$(n,e,i,o),(a=new Q.Rect(c,r,u,o)).contains(t.x,t.y)&&(t.isReservedLocation=!0),t):l},D.prototype.processMouseDown=function(t){if(!t)return!1;t.isReservedLocation&&(this.pG=!0)},D.prototype.processMouseLeave=function(t){if(m.prototype.processMouseLeave.call(this,t),!t)return!1;this.pG=!1},D.prototype.processMouseUp=function(t){var i,n,e,s,o,r;return!!t&&(n=t.sheet,!!((i=this).pG&&n&&t.isReservedLocation&&(i.pG=!1,e=t.row,s=t.col,o=t.sheetArea,r=Z(i,t))))&&(k(i,n,e,s,r.value,o),!0)},D.prototype.wG=function(t,i){return U(t,i,this._items,!0)},D.prototype.triggerButtonClicked=function(t,i,n,e){var s=t.parent;s&&s.j3(t,i,n,e)},D.prototype.Je=function(t){var t={items:t.items,direction:t.direction&&V[t.direction],maxColumnCount:t.maxColumnCount,maxRowCount:t.maxRowCount,isFlowLayout:t.isFlowLayout,itemSpacing:t.itemSpacing,textAlign:t.textAlign&&J[t.textAlign],boxSize:t.boxSize};this.fromJSON(t)},D.prototype.toJSON=function(){var e,s,o,e=this,s={typeName:e.typeName};return r(c,function(t,i){var n;o=e["_"+t],("items"===t?o&&0<o.length:o!==i)&&(s[t]="object"==typeof o?A(o,!1):o)}),s},D.prototype.fromJSON=function(n){var e=this;r(c,function(t){var i=n[t];M(i)||(e["_"+t]=i)})},n(L,T=s=D),L.prototype.BY=function(t,i,n,e,s,o){var n=X(n,v)?n.value:n;t.beginPath(),t.fillStyle="white",t.arc(e+o,s+o,o,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,o,0,2*Math.PI),t.stroke(),i!==l&&d(i,n)&&(t.beginPath(),t.strokeStyle="black",t.arc(e+o,s+o,.5*o,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},t.RadioButtonList=e=L,n(S,p=s),S.prototype.BY=function(t,i,n,e,s,o){t.strokeStyle="black",t.strokeRect(e+.5,s+.5,2*o+.05,2*o+.05),t.fillStyle="white",t.fillRect(e+1,s+1,2*o-1,2*o-1);var n=G(n,i);i!==l&&n&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(e+3,s+o),t.lineTo(e+o,s+2*o-3.5),t.lineTo(e+2*o-1.5,s+3),t.stroke())},S.prototype.wG=function(t,i){return U(t,i,this._items,!1)},t.CheckBoxList=i=S,(f=C=t.SelectionMode||(t.SelectionMode={}))[f.single=0]="single",f[f.multiple=1]="multiple",u={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:l,itemSpacing:{horizontal:5,vertical:5},selectionMode:C.multiple},n(w,N=s),w.prototype.RY=function(t,i,n,e,s,o,r,c,u){var n,i,a,l,n;t.save(),t.beginPath(),n=G(i,n),i=X(i,H)?i.text:i,a=this._selectedBackColor,l=this._selectedForeColor,n&&(t.fillStyle=a,t.fillRect(s+1,o+1,r-1,c-1),t.fillStyle=l),t.textAlign="center",t.textBaseline!==h&&(t.textBaseline=h),n=this.jY(),t.fillText(i,s+n.paddingLeft+(r-n.paddingLeft-n.paddingRight)/2,o+n.paddingTop+c-n.paddingTop-n.paddingBottom-u),t.restore()},w.prototype.wG=function(t,i){return U(t,i,this._items,this._selectionMode===C.single)},w.prototype.jY=function(){var t,i,n,e,s,t=0,i=0,n=0,e=0;return this._padding&&(s=x(this._padding),t=typeof(t=parseInt(s[0],10))==o&&0<t?t:0,e=typeof(e=parseInt(s[1],10))==o&&0<e?e:0,i=typeof(i=parseInt(s[2],10))==o&&0<i?i:0,n=typeof(n=parseInt(s[3],10))==o&&0<n?n:0),{hasMargin:!0,paddingTop:t,paddingBottom:i,paddingLeft:n,paddingRight:e}},w.prototype.OY=function(t){return 0},w.prototype.toJSON=function(){var e,s,o,e=this,o=N.prototype.toJSON.call(this);return r(u,function(t,i){var n;s=e["_"+t],("items"===t?s&&0<s.length:s!==i)&&(o[t]="object"==typeof s?A(s):s)}),o},w.prototype.fromJSON=function(n){N.prototype.fromJSON.call(this,n);var e=this;r(u,function(t){var i=n[t];M(i)||(e["_"+t]=i)})},I=w,t.ButtonList=I,r(c,function(c){s.prototype[c]=function(t){var i,n,e,s,o,r,r,r,i="_"+c,n=this;if(0===arguments.length)return n[i];if("items"===c){for(e=[],s=0;s<t.length;s++)o=t[s],M(o.text)||M(o.value)?M(o.text)?M(o.value)?M(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}if("itemSpacing"===c)r=n[i],n[i]={horizontal:r.horizontal,vertical:r.vertical},M(t.horizontal)||(r=parseInt(t.horizontal,10),isNaN(r))||(n[i].horizontal=r),M(t.vertical)||(r=parseInt(t.vertical,10),isNaN(r))||(n[i].vertical=r);else if("boxSize"===c){if(M(t))return n[i];"number"==typeof t&&0<=t&&(n[i]=t),"auto"===t&&(n[i]=t)}else n[i]=t;return n}}),Q.CellTypes.ti[11]=e,Q.CellTypes.ti[12]=i,r(u,function(c){I.prototype[c]=function(t){var i,n,e,s,o,r,r,r,i="_"+c,n=this;if(0===arguments.length)return n[i];if("items"===c){for(e=[],s=0;s<t.length;s++)o=t[s],M(o.text)||M(o.value)?M(o.text)?M(o.value)?M(o)||"object"==typeof o||e.push({text:o,value:o}):(o.text=o.value,e.push(o)):(o.value=o.text,e.push(o)):e.push(o);t=e}return"itemSpacing"===c?(r=n[i],n[i]={horizontal:r.horizontal,vertical:r.vertical},M(t.horizontal)||(r=parseInt(t.horizontal,10),isNaN(r))||(n[i].horizontal=r),M(t.vertical)||(r=parseInt(t.vertical,10),isNaN(r))||(n[i].vertical=r)):n[i]=t,n}}),Q.CellTypes.ti[13]=I},"./dist/plugins/celltype/rangecelltype.js":function(t,i,n){var e,dt,s,u,Dt,vt,n,wt,bt,At,r,c,e,o,a;function g(t){return t.map(function(t){return{start:t.start,size:t.size}})}function l(){this.FY=0,this.PY=0,this.Sx=0,this.Tx=0}function h(){}function M(t,i,n,e,s){var o,i,o=a.call(this)||this;return o.allowOverflow=!1,o.typeName="16",i=1===arguments.length?new dt.Range(0,0,t.getRowCount(),t.getColumnCount()):new dt.Range(i,n,e,s),t&&i&&(o.GY=(new r).yN(t,i),o.UY=(new c).yN(t,i)),o}function I(t,i,G,n,e,s,U){var o,r,c,u,a,E,l,B,Q,h,g,M,R,I,P,Y,H,f,N,d,W,i,D,V,v,J,X,F,_,K,q,w,$,tt,b,A,y,j,A,it,C,z,m,T,p,x,L,A,T,p,nt,et,st,S,k,ot,rt,ct,ut,at,lt,O,j,p,ht,p,j,Z,gt,Mt,It,ft,Nt,Z;for(void 0===U&&(U=1),o=i.x,r=i.y,c=i.width,u=i.height,a=n.sheet,E=n.sheetArea,l=n.isPrinting,B=n.needTopGridline,Q=n.needLeftGridline,h=[],g=[],M=[],R=!0,I=[],P=a.BO(),Y=s.rowCount,H=s.colCount,f=s.rowSize,N=s.colSize,d=s.cellStyleList,W=s.sparklines,e.HY(G),D=(i=e.zY()).baseRow,V=i.baseCol,J=(v=e.VY).hl,v.cg(new dt.Rect(0,0,c,u)),X=new dt.Yx(v,v._y(1,3),v.Yy(1,3),3),F=e.YY(!0),r+=1,--u,o+=1,--c,K=_=0,f=f.map(function(t){var i=t.size*u,n=At(i);return 1<=(K+=i-n)&&(n++,K--),{start:At(t.start*u),size:n}}),N=N.map(function(t){var i=t.size*c,n=At(i);return 1<=(_+=i-n)&&(n++,_--),{start:At(t.start*c),size:n}}),q=v.conditionalFormats,w=0;w<Y;w++){for($={row:w+D,y:r,height:u},tt=[],b=0;b<H;b++)if(d[w][b]&&(y=(A=d[w][b]).style,j=A.isSpan,A=A.span,it=!1,C=F[w][b],!j||A)){if(y=y.clone(!0),z=At(o+N[b].start),m=At(r+f[w].start),p=T=void 0,x=j?A.colCount:1,L=j?A.rowCount:1,T=N[b+x]?N[b+x].start:c,A=At(T-N[b].start),p=f[w+L]?f[w+L].start:u,T=At(p-f[w].start),$.y=m,$.height=T,C.formatStyle&&(C.formatStyle.h5(y),y=C.formatStyle),y.v5(J),p=bt,j){for(p={row:w,col:b,x:At(z),y:At(m),width:At(A),height:At(T),rowCount:L,colCount:x},nt={},et={},st=[],k=S=void 0,S=rt=ot=0;S<x-1;S++)ut=(ct=N[b+S])?ct.size:0,ot+=et[S]=ut;for(et[S]=At(A)-ot,k=0;k<L-1;k++)ut=(at=f[w+k])?at.size:0,rt+=nt[k]=ut;for(nt[k]=At(T)-rt,k=0;k<L;k++){for(lt=[],O=0;O<x;O++)d[k+w]&&d[k+w][b+O]&&lt.push(d[k+w][b+O].style);st.push(lt)}p.spanSizeInfo={styleList:st,rowSizes:nt,colSizes:et}}X.PN(w,b,At(z),At(m),At(A),At(T),y,p,B&&0===w,Q&&0===b),(j=y.formatter)&&dt.util.St(j)&&(!(p=a.parent&&a.parent.xO(j))||!(ht=p.getExpression())||(p=(0,vt.evaluateFormula)(a,j.replace("@",JSON.stringify(C.value))))instanceof Dt.CalcError||(C.value=p)),j=null,W[w][b]&&(j=W[w][b].clone())&&(j.ZY=v.name(),j.WY=j.QY(v),j.KY=j.JY(v),j.XY=v),C&&C.value&&"SparklineExValue"===C.value.typeName&&(I.push({value:C.value,x:z,y:m,width:A,height:T,option:n}),it=!0),C.validStyle&&g.push({style:C.validStyle,x:z,y:m,width:A,height:T}),tt.push({col:b+V,x:z,y:m,width:A,height:T}),h.push({data:it?null:C.value,row:w,col:b,x:z,y:m,width:A,height:T,style:y,sparkline:j,baseRow:w+D,baseCol:b+V,conditionalFormats:q,imageLoader:P,cellLayout:{row:w,col:b,x:z,y:m,width:A,height:T}}),y&&y.decoration&&y.decoration.icons&&0<y.decoration.icons.length&&M.push({style:y,x:z,y:m,width:A,height:T})}0<tt.length&&v.Dn.mfe(M,tt,$,l,a,E)}for(t.save(),B&&(r-=2,u+=4),Q&&(o-=2,c+=4),t.rect(o,r,c,u),t.clip(),0<h.length&&v.Dn.eO(t,h,E,l,1,a,D,V,U),X.paint(t),0<g.length&&v.Dn.EO(t,g),0<M.length&&v.Dn.que(t,M,{isPrinting:l,printZoomFactor:1,sheet:a,imageLoader:P}),t.restore(),w=0;w<I.length;w++)gt=(Z=I[w]).value,Mt=Z.x,It=Z.y,ft=Z.width,Nt=Z.height,Z=Z.option,wt.dn(t,gt,Mt,It,ft,Nt,Z)}e=this&&this.__extends||(o=function(t,i){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}o(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.paintRangeTemplate=i.RangeTemplate=i.qY=i.$Y=void 0,dt=n("Core"),s=n("Bindings"),u=n("Sparkline"),Dt=n("CalcEngine"),vt=n("SheetsCalc"),n=dt.CellTypes.Base,wt=dt.CellTypes.Context,bt=null,At=Math.floor,l.prototype.yN=function(t,i){var n=this,e=i.row,s=i.col,o=i.rowCount,r=i.colCount;return n.FY=e,n.PY=s,n.Sx=o,n.Tx=r,n.TP=n.ZF(t,i),n.tZ=n.nZ(t,i),n},l.prototype.eZ=function(){return this.tZ},l.prototype.nZ=function(t,i){for(var n,e,s,o,r,c,u,a,l,h,g,M,I,f,e,s,N,d,D,n=this,e=i.row,s=i.col,o=i.rowCount,r=i.colCount,c=0,u=[],a=0,l=[],h=0,g=e+o,M=s+r,I=e;I<g;I++)h=t.getRowHeight(I),a+=h,l.push(h);for(f=s;f<M;f++)h=t.getColumnWidth(f),c+=h,u.push(h);return h=0,e=l.map(function(t){var i=h/a,n;return h+=t,{start:i,size:t/a}}),h=0,s=u.map(function(t){var i=h/c,n;return h+=t,{start:i,size:t/c}}),N=n.ZF(t,i),{rowCount:o,colCount:r,rowSize:e,colSize:s,cellStyleList:d=n.iZ(t,i,N,e,s),sparklines:D=n.rZ(t,i),totalHeight:a,totalWidth:c}},l.prototype.oZ=function(t,i,n,e,s){for(var o,r,c,u,a,l,h,g,M,o=null,r=0,c=s;r<c.length;r++)if(a=(u=c[r]).rowOffset,l=u.colOffset,h=u.rowCount,g=u.colCount,(M=new dt.Range(a+n,l+e,h,g)).contains(t,i)){o=u;break}return o},l.prototype.aZ=function(t,i,n){for(var e,s,o,e,r,c,u,a,l,h,e=[0,0],s=e[0],o=e[1],e=t.rowOffset,r=t.colOffset,c,u,a=e+t.rowCount,l=r+t.colCount,h=e;h<a;h++)o+=i[h]?i[h].size:0;for(h=r;h<l;h++)s+=n[h]?n[h].size:0;return{width:s,height:o}},l.prototype.iZ=function(t,i,n,e,s){for(var o,r,c,u,a,l,h,g,M,I,o=i.row,r=i.col,c=i.rowCount,u=i.colCount,a=[],l=o;l<o+c;l++){for(h=[],g=r;g<r+u;g++)(M=this.oZ(l,g,o,r,n))&&M.rowOffset+o===l&&M.colOffset+r===g?(I=this.aZ(M,e,s),h.push({style:t.getActualStyle(l,g,3,!0),spanWidth:I.width,spanHeight:I.height,isSpan:!0,span:M})):h.push(M?{style:t.getActualStyle(l,g,3,!0),isSpan:!0}:{style:t.getActualStyle(l,g,3,!0)});a.push(h)}return a},l.prototype.ZF=function(t,i){for(var t,n,e,s,o,r,c,u,a,t=t.Ut.getSpans(),n=[],e=i.row,s=i.col,o=i.rowCount,r=i.colCount,c=0,u=t;c<u.length;c++)(a=u[c]).intersect(e,s,o,r)&&n.push({rowOffset:a.row-e,colOffset:a.col-s,rowCount:a.rowCount,colCount:a.colCount});return n},l.prototype.rZ=function(t,i){for(var n,e,s,o,r,c,u,a,l,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=n;c<n+o;c++){for(u=[],a=e;a<e+s;a++)l=t.getSparkline(c,a),u.push(l?l.clone():null);r.push(u)}return r},l.prototype.toJSON=function(){var t,i,n,e,s,o,r,c,t,u,a,l,h,t=this.eZ(),i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,r=t.sparklines,c=t.totalWidth,t=t.totalHeight,u,a,l,h;return{rowCount:i,colCount:n,rowSize:g(e),colSize:g(s),cellStyleList:o.map(function(t){return t.map(function(t){var i,n,e,s,t;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,{style:i.toJSON(),spanWidth:n,spanHeight:e,isSpan:s,span:t}):null})}),sparklines:r.map(function(t){return t.map(function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}})}),totalWidth:c,totalHeight:t}},l.prototype.fromJSON=function(t){var i,n,e,s,o,r,c,t,e,s,o,r;t&&(i=t.rowCount,n=t.colCount,e=t.rowSize,s=t.colSize,o=t.cellStyleList,r=t.sparklines,c=t.totalWidth,t=t.totalHeight,e=g(e),s=g(s),o=o.map(function(t){return t.map(function(t){var i,n,e,s,t,o;return t?(i=t.style,n=t.spanWidth,e=t.spanHeight,s=t.isSpan,t=t.span,o=null,i&&(o=new dt.Style).fromJSON(i),{style:o,spanWidth:n,spanHeight:e,span:t,isSpan:s}):null})}),r=r.map(function(t){return t.map(function(t){var i,n;if(t&&u.SparklineSetting)return i=new u.Sparkline,n=new u.SparklineSetting(t.setting),i.fromJSON(t.sp),i.setting(n),i.sparklineType(t.sparklineType),i})}),this.tZ={rowCount:i,colCount:n,rowSize:e,colSize:s,cellStyleList:o,sparklines:r,totalWidth:c,totalHeight:t})},l.prototype.L0=function(){this.tZ=null},r=l,i.$Y=r,h.prototype.yN=function(t,i,n){var e=this;return e.Z5=i,e.VY=new dt.Worksheet,e.uZ=t.parent&&t.parent.options.allowDynamicArray,e.VY.getCalcService&&(e.VY.getCalcService().allowDynamicArray=e.uZ,e.sZ=e.cZ(t)),e.fZ(t,n),e},h.prototype.cZ=function(t){for(var i,n,e,s,o,r,c,u,a,l,h,g,M,I,h,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=t.b3&&t.b3(),u=n;u<n+o;u++)for(a=e;a<e+s;a++)(l=t.getFormula(u,a))&&(h=c&&c.sT(u,a))&&h.isDynamicArray&&(g=h.row,M=h.col,I=h.rowCount,h=h.colCount,1<I&&r.push({row:g+1,col:M,rowCount:I-1,colCount:h}),1<h)&&r.push({row:g,col:M+1,rowCount:1,colCount:h-1});return r},h.prototype.lZ=function(){var t,i,n,e,s,o,r,c,u,o,t,i=this.sZ,n=this.VY;if(i)for(e=0,s=i;e<s.length;e++)r=(o=s[e]).row,c=o.col,u=o.rowCount,o=o.colCount,n.clear(r,c,u,o,3,1)},h.prototype.HY=function(t){var i,t;s.CellBindingSource&&((i=this.VY).suspendEvent(),t=new s.CellBindingSource(t),this.lZ(),i.setDataSource(t),i.resumeEvent())},h.prototype.fZ=function(t,i){var n,e,t,n,e=this.VY,t=t.toJSON({includeBindingSource:!0,ignoreFormula:!!i});delete t.charts,delete t.shapes,e.suspendCalcService(),e.fromJSON(JSON.parse(JSON.stringify(t))),e.resumeCalcService(),this.hZ()},h.prototype.hZ=function(){for(var t,i,n,e,s,o,r,c,u,a,l,t=this,i=t.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=[],u=[],a=n;a<n+o;a++){for(u=[],l=e;l<e+s;l++)u.push(t.dZ(a,l,3));c.push(u)}this.vZ=c},h.prototype.zY=function(){var t=this.Z5,i,n;return{baseRow:t.row,baseCol:t.col}},h.prototype.YY=function(t){for(var i,n,e,s,o,r,c,u,a,l,h,g,M,I,f,N,i=this.VY,n=this.Z5,e=n.row,s=n.col,o=n.colCount,r=n.rowCount,c=[],u=e;u<e+r;u++){for(a=[],h=l=void 0,g=s;g<s+o;g++)M=i.getText(u,g),I=i.getValue(u,g,3,1),f=i.Jt.$t(u,g,3,1),N=i.getBindingPath(u,g),l=this.mZ(u,g,3),h=this.gZ(i,u,g,I,t),a.push({value:f,formatStyle:l,text:M,validStyle:h,bindingPath:N});c.push(a)}return c},h.prototype.dZ=function(t,i,n){var e,t,e;return this.VY.b8&&(t=this.VY.getDataValidator(t,i,n))?t.highlightStyle():null},h.prototype.gZ=function(t,i,n,e,s){var s,t,e;return s&&t.isValid&&!t.isValid(i,n,e)?(t=(s=this.Z5).row,e=s.col,this.vZ[i-t][n-e]):null},h.prototype.mZ=function(t,i,n){var e=this.VY.conditionalFormats;return e?e.bL(new dt.Style,t,i,n):null},h.prototype.getCellValueInfo=function(t){for(var i,n,e,s,o,r,c,u,a,l,i=this.Z5,n=i.row,e=i.col,s=i.colCount,o=i.rowCount,r=[],c=t.Ut,u=n;u<n+o;u++){for(a=[],l=e;l<e+s;l++)a.push({bindPath:t.getBindingPath(u,l),formula:t.getFormula(u,l),value:c.getValue(u,l,3,bt,1)});r.push(a)}return r},h.prototype.setValueToDataStruct=function(t,i,n,e){e[t]||(e[t]={}),e[t][i]=n},h.prototype.toJSON=function(){var t,i,n,e,s,o,r,c,t=this.VY,i=this.uZ,n=this.sZ.map(function(t){var i,n,e,s;return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}),e=this.Z5,s,o,r,c;return{spillRanges:n,allowDynamicArray:i,range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},h.prototype.fromJSON=function(t){var i,n,t,e,s,o,t;t&&((n=(i=this).VY=new dt.Worksheet).suspendCalcService&&n.suspendCalcService(),i.sZ=t.spillRanges||t.spillRangs,i.uZ=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=i.uZ),n.fromJSON(JSON.parse(t.templatejson)),i.lZ(),e=(t=t.range).row,s=t.col,o=t.rowCount,t=t.colCount,i.Z5=new dt.Range(e,s,o,t),this.hZ(),n.resumeCalcService)&&n.resumeCalcService()},h.prototype.L0=function(){this.VY.L0(),this.VY=null,this.Z5=null},c=h,i.qY=c,e(M,a=n),M.prototype.getAutoFitWidth=function(){return this.GY.tZ.totalWidth},M.prototype.getAutoFitHeight=function(){return this.GY.tZ.totalHeight},M.prototype.updateTemplate=function(t,i){t&&i&&(this.GY.yN(t,i),this.UY.yN(t,i))},M.prototype.paintContent=function(t,i,n,e,s,o,r,c){var u,a,a,u=this.UY,a=this.GY;u&&a&&(a=this.GY.eZ(),r.cellPadding&&(c.needTopGridline=!0,c.needLeftGridline=!0),I(t,{x:n,y:e,width:s,height:o},i,c,u,a))},M.prototype.toJSON=function(){return{typeName:this.typeName,layout:this.GY.toJSON(),resolver:this.UY.toJSON()}},M.prototype.fromJSON=function(t){t.layout&&(this.GY=new r,this.GY.fromJSON(t.layout)),t.resolver&&(this.UY=new c,this.UY.fromJSON(t.resolver))},i.RangeTemplate=e=M,dt.CellTypes.ti[16]=e,i.paintRangeTemplate=I},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},Bindings:function(t){t.exports=GC.Spread.Sheets.Bindings},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t){t.exports=GC.Spread.Sheets.Sparklines}},e={},t=s("./dist/plugins/celltype/celltypes.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CellTypes=t}();