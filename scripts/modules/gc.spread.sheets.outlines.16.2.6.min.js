/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var i,r,n;function o(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,o)),t.exports}i={"./dist/plugins/group/group-actions.js":function(E,n,t){var i,r,a,x,n,F,o,e,u,f,s,c,v,h,l,t,d,p,r,w,g,t,m,C,r,O,b,j,y,_,R,L,M,G,S,D,J,P,T,H,Y;function k(n){var t=n.Mf;return n.v2t?t.rowOutlines:t.columnOutlines}function $(n){var t,i,r,o,e,u,n,t=this,i=!1;return(n?t.canExecute():t.canUndo())&&(r=t.Mf,o=t.tT.index,e=t.tT.count,u=k(t),r)&&u&&!l(o)&&!l(e)&&(n=n?u.group:u.ungroupRange,t.X5(r,!0),n.call(u,o,e),t.q5(r,!0),i=!0),i}function U(n,t,i){var n=_.call(this,n,t)||this;return n.v2t=i,n}function q(n,t){return R.call(this,n,t,!1)||this}function z(n,t){return L.call(this,n,t,!0)||this}function A(n,t,i){var n=M.call(this,n,t)||this;return n.v2t=i,n}function B(n,t){return G.call(this,n,t,!1)||this}function K(n,t){return S.call(this,n,t,!0)||this}function Q(n,t,i,r,o){for(var e=0,u,u=t;u<=i&&u<r;u++)e+=o.call(n,u)*n.zoom();return e}function V(n,t,i,r,o){for(var e=0,u,u=t;u<r&&e<i;u++)t++,e+=o.call(n,u)*n.zoom();return r<=t?r-1:t}function W(n,t,i,r,o){if(t<r)return r;if(o<t)return o;for(var e=t;e<=o;e++)if(i.call(n,e))return e;return-1}function X(n,t,i){var r,o,e,u,f,r,s,s,a,c,v,h,c,l,d,p,w,p,g,m,C,r,a,i,r=this,o=r.Mf,e=i.index,u=t?o.getRowCount():o.getColumnCount(),f=void 0,r=k(r),s=r.KMi;e<0||u<=e||s||(s=1===r.direction(),(0,x.isIndexValid)(r,a=s?e-1:e+1)&&(c=o.Fi(),v=t?o.frozenRowCount():o.frozenColumnCount(),h=t?o.frozenTrailingRowCount():o.frozenTrailingColumnCount(),c=t?c.Ty:c.Uy,l=t?o.Ny:o.Vy,d=t?o.getRowHeight:o.getColumnWidth,p=t?o.getViewportTopRow:o.getViewportLeftColumn,w=t?o.getViewportHeight:o.getViewportWidth,p=p.call(o,1),r=r.find(a,i.level))&&(a=s?r.start:e,i=s?e:r.end,s?(n?a=e:a<v&&(a=v),a<p&&(p=a),u-h<=i&&(i=u-h-1),g=w.call(o,1),C=W(o,p=(g+=l?0:c)<(m=Q(o,p,i,u,d))?V(o,p,m-g,u,d):p,d,v,u-1)):(n?i=e:u<=i&&(i=u-1),u-h<=i&&(i=u-h-1),(a<p||(g=w.call(o,1),(g+=l?0:c)<(m=Q(o,p,i,u,d))))&&(C=W(o,a,d,v,u-1))),t&&C!==f?(o.Tb=C,o.tw()):t||C===f||(o.Ab=C,o.ow())))}function Z(n){var t,i,r,o,e,u,f,s,a,n,t=this,i=!1;return(n?t.canExecute():t.canUndo())&&(r=t.Mf,o=t.tT,e=k(t),u=o.collapsed,f=o.index,s=o.level,!r||!e||l(u)||l(f)||l(s)||(t.X5(r,!0),n||(u=!u),(a=1===e.direction()?0<=f-1&&e.find(f-1,s):f+1<e.items.length&&e.find(f+1,s))&&e.setCollapsed(f,u),l(o.index)&&(o.index=(0,x.getExtendIndex)(r,t.v2t,s)),X.call(t,u,t.v2t,o),(n=r.getCalcService()).Vct="filter",r.recalcRange(0,0,r.getRowCount(),r.getColumnCount()),delete n.Vct,r.resumeCalcService(!1),n.Zct(),t.q5(r,!0),i=!0)),i}function I(n,t,i){var n=D.call(this,n,t)||this;return n.v2t=i,n}function nn(n,t){return J.call(this,n,t,!1)||this}function tn(n,t){return P.call(this,n,t,!0)||this}function N(n,t,i){var n=T.call(this,n,t)||this;return n.v2t=i,n}function rn(n,t){return H.call(this,n,t,!1)||this}function on(n,t){return Y.call(this,n,t,!0)||this}i=this&&this.__extends||(y=function(n,t){return(y=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}y(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Commands=void 0,r=t("Common"),a=t("Core"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return a.Commands}}),x=t("./dist/plugins/group/group.js"),n=a.Commands.ActionBase,F=a.GC$,o="outlineColumn",e="removeColumnOutline",u="expandColumnOutline",f="expandColumnOutlineForLevel",s="outlineRow",c="removeRowOutline",v="expandRowOutline",h="expandRowOutlineForLevel",l=r.Common.lt.ht,i(U,_=n),U.prototype.execute=function(){var n,t,i,r,n,o,n=this,t=n.Mf,i=n.tT,r=t.Ut;return r.startTransaction(),n=$.call(n,!0),i[o=a.Commands.TI(t.name())]=r.endTransaction(),n},U.prototype.undo=function(){return $.call(this,!1)},i(q,R=t=U),d=q,i(z,L=t),p=z,i(A,M=n),A.prototype.execute=function(){var n,t,i,r,o,e,u,f,s,n=this,t=n.Mf,i=t.Ut,r=!1;return n.canExecute()&&(e=(o=n.tT).index,u=o.count,f=k(n),t)&&f&&!l(e)&&!l(u)&&(i.startTransaction(),n.X5(t,!0),f.ungroupRange(e,u),n.q5(t,!0),o[s=a.Commands.TI(t.name())]=i.endTransaction(),r=!0),r},A.prototype.undo=function(){var n,t,i,r,r,n=this,t=!1,i=n.Mf;return n.canUndo()&&(r=a.Commands.TI(i.name()),r=n.tT[r],i)&&r&&(n.X5(i,!0),i.Ut.undo(r),n.q5(i,!0),t=!0),t},i(B,G=r=A),w=B,i(K,S=r),g=K,i(I,D=n),I.prototype.canExecute=function(){var n,t,i,r,n,n=this,t,i=n.Mf.NMi;return!i||(r=n.tT.level,n=k(n),i.detailColumnsVisible())||r<n.getMaxLevel()},I.prototype.execute=function(){var n,t,i,r,n,o,n=this,t=n.Mf,i=n.tT,r=t.Ut;return r.startTransaction(),n=Z.call(n,!0),i[o=a.Commands.TI(t.name())]=r.endTransaction(),n},I.prototype.undo=function(){return Z.call(this,!1)},i(nn,J=t=I),m=nn,i(tn,P=t),C=tn,i(N,T=n),N.prototype.canExecute=function(){var n,t,i,r,n,n=this,t,i=n.Mf.NMi;return!i||(r=n.tT.level,n=k(n),i.detailColumnsVisible())||r<=n.getMaxLevel()},N.prototype.execute=function(){var n,t,i,r,o,e,u,u,u,n=this,t=n.Mf,i=!1;if(n.canExecute()&&(r=void 0,o=n.tT.level,e=k(n),t)&&e&&!l(o)){for(t.Ut.startTransaction(),n.X5(t,!0),t.suspendCalcService(),t.Ut.m2t(n.v2t),e.Xst(),r=0;r<o;r++)e.expand(r,!0,!0);e.expand(o,!1,!0),e.$st(),t.Ut.m2t(n.v2t,!0),u=n.tT.index,l(u)&&(u=(0,x.getExtendIndex)(t,n.v2t,o)),X.call(n,!1,n.v2t,{level:o-1,index:u}),(u=t.getCalcService()).Vct="filter",t.recalcRange(0,0,t.getRowCount(),t.getColumnCount()),delete u.Vct,t.resumeCalcService(!1),u.Zct(),n.q5(t,!0),u=a.Commands.TI(t.name()),n.tT[u]=t.Ut.endTransaction(),i=!0}return i},N.prototype.undo=function(){var n,t,i,r,r,n=this,t=!1;return n.canUndo()&&(i=n.Mf,r=a.Commands.TI(i.name()),r=n.tT[r],i)&&r&&(n.X5(i,!0),i.Ut.undo(r),n.q5(i,t=!0)),t},i(rn,H=r=N),O=rn,i(on,Y=r),b=on,j=a.Commands.zA,a.Commands[o]={canUndo:!0,execute:function(n,t,i){return j(n,d,t,i)}},a.Commands[s]={canUndo:!0,execute:function(n,t,i){return j(n,p,t,i)}},a.Commands[e]={canUndo:!0,execute:function(n,t,i){return j(n,w,t,i)}},a.Commands[c]={canUndo:!0,execute:function(n,t,i){return j(n,g,t,i)}},a.Commands[u]={canUndo:!0,execute:function(n,t,i){return j(n,m,t,i)}},a.Commands[v]={canUndo:!0,execute:function(n,t,i){return j(n,C,t,i)}},a.Commands[f]={canUndo:!0,execute:function(n,t,i){return j(n,O,t,i)}},a.Commands[h]={canUndo:!0,execute:function(n,t,i){return j(n,b,t,i)}},a.Commands.g2t=function(n){n.register(o,a.Commands[o]),n.register(s,a.Commands[s]),n.register(e,a.Commands[e]),n.register(c,a.Commands[c]),n.register(u,a.Commands[u]),n.register(v,a.Commands[v]),n.register(f,a.Commands[f]),n.register(h,a.Commands[h])}},"./dist/plugins/group/group.entry.js":function(n,t,i){var r,o,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,o)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),o=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),o(i("./dist/plugins/group/group-actions.js"),t),o(i("./dist/plugins/group/group.js"),t),o(i("./dist/plugins/group/group.ns.js"),t)},"./dist/plugins/group/group.js":function(m,c,n){var x,t,L,O,n,i,R,C,T,H,_,Y,a,M,$,d,v,h,q,N,b,j,f,G,y,E,F,S,D,J,k,z,K,Q,B,P,l,V,p,W,X,Z,nn,tn,t,rn,n,on,en,un,n,w,U,r,fn,sn,t,t;function an(n,t){n.ki(L.Events.RangeGroupStateChanging,t)}function cn(n,t){n.ki(L.Events.RangeGroupStateChanged,t)}function vn(n,t){var n,i,n,n=n.options,i;return!n.isProtected||(n=n.protectionOptions,t?n.allowOutlineRows:n.allowOutlineColumns)}function hn(n,t){var i,r,t,r,o,e,i=t.what===l,r=vn(n,i);n.isEditing&&n.isEditing()||!r?r||n.jT(L.InvalidOperationType.groupProtected,(0,c.getSR)().Exp_GROUP_PROTECTED):(r=i?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",an(n,o=dn(n,i,-1,t=t.info.index,!0)),e=pn(n,i,t-1),o&&!1===o.cancel&&(n.Qy().execute({cmd:r,sheetName:n.name(),level:t,index:e}),cn(n,dn(n,i,-1,t,!1))))}function ln(n,t){var i,r,r,t,o,e,u,f,i=t.what===p,r=vn(n,i);n.isEditing&&n.isEditing()||!r?r||n.jT(L.InvalidOperationType.groupProtected,(0,c.getSR)().Exp_GROUP_PROTECTED):A(i,n)&&(o=t=(r=t.info).index,e=r.level,f=i?"expandRowOutline":"expandColumnOutline",1===r.lineDirection?t--:t++,an(n,u=dn(n,i,t,e,!(u=void 0))),u)&&!1===u.cancel&&(n.Qy().execute({cmd:f,sheetName:n.name(),index:o,level:e,collapsed:r.isExpanded}),cn(n,dn(n,i,t,e,!1)))}function dn(n,t,i,r,o){var n={sheet:n,sheetName:n.name(),isRowGroup:t,index:i,level:r};return o&&(n.cancel=!1),n}function pn(n,t,i){var r,o,e,u,r=t?n.rowOutlines:n.columnOutlines;if(r)for(o=r.items,e=!1,u=0;u<o.length;u++)if(o[u])if(o[u].level===i)e=!0;else if(e)return u;return t?n.getActiveRowIndex():n.getActiveColumnIndex()}function wn(n,t){var i,r,o,e,u,o,u,f,i=this,r=i.gj(),o=r.width,e=r.height;return(o||e)&&(u=i.Fi(),o=new L.Rect(r.x,r.y,o,u.height),u=new L.Rect(r.x,r.y,u.width,e),o.contains(n,t)||u.contains(n,t))?(f=(f=gn(i,n,t,r.rowMaxLevel,!0))||gn(i,n,t,r.colMaxLevel,!1))||{what:"empty",info:R}:R}function o(n,t,i){var r=this;r.PADDING=2,r.Mf=n,r.v2t=t,r.$X=f(i)?i:A(t,n).getMaxLevel()}function e(n,t,i,r){var o=this;o.PADDING=2,o.LINE_SIZE=2,o.START_LINE_SIZE=6,o.p2t=[],o.b2t=[],o.y2t=[],o.Mf=n,o.v2t=t,o.w2t=i,o.$X=f(r)?r:A(t,n).getMaxLevel()}function gn(n,t,i,r,o){var e,u,f,s,e,u=new on(n,o,r).M2t(t,i,o);if(u)return{what:o?l:V,info:u};for(f=mn(n,o,r),s=0;s<=2;s++)if(u=f[s].C2t(t,i,o))return{what:o?p:W,info:u};return R}function mn(n,t,i){for(var r=[new en(n,t,0,i),new en(n,t,1,i),new en(n,t,2,i)],o,o=0;o<=2;o++)r[o].S2t();return r}function Cn(n,t){var t=t?n.width:n.height;return T(0,(t-2*this.PADDING)/(this.$X+2))}function A(n,t){return n?t.rowOutlines:t.columnOutlines}function xn(n,t,i,r){var o=this;o.children=[],o.parent=R,o.model=n,o.start=t,o.end=i,o.level=r}function On(n){this.level=n?n.level:0,this.collapsed=!!n&&n.collapsed,this.viewCollapsed=!!n&&n.viewCollapsed}function bn(n,t,i){var r,o,e,u;if(0<i){for(r=n.items,e=o=void 0,u=[],o=0;o<i;o++)u.push(R);if(n.items=r=r.slice(0,t).concat(u,r.slice(t)),n.T2t<=0&&0<t&&(e=r[t-1]))for(o=0;o<i;o++)r[t+o]=new U(e);Ln(n)}}function jn(n,t,i){var i,i,r;0<i&&(i=n.items.splice(t,i),0<t&&0<i.length&&(i=i[0],r=n.items[t],i)&&i.collapsed&&(r?i.level===r.level&&(r.collapsed=i.collapsed):n.items.length>t&&(n.items[t]=new U(i))),Ln(n))}function yn(n,t,i){for(var r,o,e,e,u,f,s,a,r=R,o=n.items,u=t,f=q(o);u<f&&(!(e=o[u])||e.level<i||(r=r||new w(n,u,u,i),e.level>i&&(u=(e=yn(n,u,i+1)).index,r.addChild(e.g)),u>r.end&&(r.end=u),!n.isGroupEnd(u,i)));u++);if(r)for(s=r.end+1,a=r.start;a<s;a++)o[a].groupInfo||(o[a].groupInfo=r);return{g:r,index:u}}function u(n,t){return-1<=t&&t<q(n.items)}function _n(n,t,i){var n,r,o,n=n&&n.items;if(n)for(r=n[t]&&n[t].groupInfo;r;){if((o=r.level)===i)return r;if(!(i<o))break;r=r.parent}return R}function Rn(n,t){switch(n){case"head":case"tail":return t===R;case"direction":return 1===t;case"itemsData":return 0===q(t);default:return}}function Ln(n){n.A2t=R,n.refresh()}function I(n,t){!t&&n.I2t||(n.A2t=n.createRangeGroup(),Gn(n))}function Mn(n){n.I2t&&!n.A2t&&(n.A2t=n.createRangeGroup())}function Gn(n,t){!n.I2t&&n.groupChangeHandler&&n.groupChangeHandler(t)}function Sn(n,t,i){if(kn(n,t),!u(n,t+i-1))throw new Error((0,c.getSR)().Exp_InvalidCount)}function kn(n,t){if(!u(n,t))throw new Error((0,c.getSR)().Exp_InvalidIndex)}function Un(n,t){for(var i,r,i=n.parent;i&&(r=t?n.end===i.end:n.start===i.start);)i=(n=i).parent;return n}function s(n,t,i){var r=this;r.head=R,r.tail=R,r.A2t=R,r.items=new Array(n),r.T2t=0,r.x2t=!0,r.Mf=t,r.v2t=i}function g(n){return n&&new U(n)}function An(n){return{items:n.items.map(g),head:g(n.head),tail:g(n.tail),x2t:n.x2t,direction:n.direction()}}function In(n,t){n.items=t.items.map(g),n.head=g(t.head),n.tail=g(t.tail),n.x2t=t.x2t,n.direction(t.direction),I(n,!0)}function Nn(n,t,i,r,o){var e,u,f,s,a,c,v,h,l,d,p,w,g,m,C,x,g;if(n)for(e=0===r,u=n.rowItems,s=function(n){return e?n<t.rowCount:0<=n},a=function(n){return e?n+1:n-1},c=function(n){return e?n-1:n+1},v=function(n,t){var n=u[n];if(n)return n.level===t?n:v(n.parentIndex,t)},h=(f=function(){return e?0:t.rowCount-1})(),l=void 0;s(h);h=a(h))(d=u[h])&&-1!==d.level?(p=c(h),g=!(w=u[p])&&"number"==typeof d.level||w&&w.level<d.level,m=w&&w.level>d.level,x=C=void 0,g?(C=p,x=!!w&&(w.collapsed||w.viewCollapsed)):m?-1===d.level?x=!1:(g=void 0,(g=w.parentIndex===l?w:v(w.parentIndex,d.level))&&(C=g.parentIndex,x=g.viewCollapsed)):(C=w.parentIndex,x=w.viewCollapsed),d.parentIndex=C,!(d.viewCollapsed=x)&&i[h].hidden&&(i[h].visible=!1,G(o.infos[h])&&(o.infos[h]={}),o.infos[h].visible=!1)):l=h}function En(n,t,i,r,o,e){var u,f,s,a,c,u=n.itemsData;u&&(f=u[u.length-1],s=u[u.length-2],a=f&&f.info,c=s&&s.info,a)&&(r&&o&&1===f.count?c&&s.index===f.index-1&&c.level===a.level-1?c.collapsed=!0:0<t?u.splice(u.length-2,0,{index:f.index-1,count:1,info:{level:a.level-1,collapsed:!0}}):n.head={collapsed:!0,level:i-1}:!r&&e&&(c&&f.index===s.index+1&&a.level===c.level-1?f.collapsed=!0:t>=f.index+f.count&&u.push({index:f.index+f.count,count:1,info:{level:a.level-1,collapsed:!0}})))}x=this&&this.__spreadArray||function(n,t,i){if(i||2===arguments.length)for(var r=0,o=t.length,e;r<o;r++)!e&&r in t||((e=e||Array.prototype.slice.call(t,0,r))[r]=t[r]);return n.concat(e||Array.prototype.slice.call(t))},Object.defineProperty(c,"__esModule",{value:!0}),c.Outline=c.isIndexValid=c.OutlineInfo=c.OutlineState=c.OutlineDirection=c.getExtendIndex=c.getSR=void 0,t=n("Common"),L=n("Core"),O=n("./dist/plugins/group/group-actions.js"),n=n("./dist/plugins/group/group.ns.js"),i={},R=null,C=void 0,T=Math.max,H=Math.min,_=Math.round,Y=Math.ceil,a=L.GC$,M=a.each,$=L.I.fl,d=t.Common.Uf,v=d.N2t,h=d.d5,q=d.tR,N=8.25,b=17,j=4,f=L.mt.T1,G=t.Common.lt.ht,y=L.mt.p0,E=L.mt.vt,F=L.mt.o1,S=L.mt.xr,D=L.mt.go,J="rangegroup",K=(z=(k="gc-group")+"-box")+"-expand",Q=z+"-collapsed",B=k+"-line",P=k+"-dot",l="rgh",V="cgh",p="rg",W="cg",X=L.XFileConstants.Su,Z=L.XFileConstants.bo,nn="1",tn="0",t=new t.Common.ResourceManager(n.SR,"Outlines"),c.getSR=t.getResource.bind(t),rn=L.NodeHelper.ur,n={gj:function(){var n,t,i,t,t,r,o,e,u,n=this,t=n.k2t;return t||(t={x:(t=(i=n.options).sheetAreaOffset).left,y:t.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},r=n.rowOutlines,o=n.columnOutlines,e=17*n.zoom(),n.showRowOutline()&&r&&!r.Oy()&&0<=(u=r.getMaxLevel())&&(t.width=e*(u+2)+4,t.rowMaxLevel=u),n.showColumnOutline()&&o&&!o.Oy()&&0<=(u=o.getMaxLevel())&&(t.height=e*(u+2)+4,t.colMaxLevel=u),n.k2t=t)},showRowOutline:y("showRowOutline",!0,function(){this.zw()}),showColumnOutline:y("showColumnOutline",!0,function(){this.zw()})},a.extend(L.Worksheet.prototype,n),c.getExtendIndex=pn,o.prototype.D2t=function(n){var t,i,r,o,e,u,f,r,s,a,c,v,h,e,l,d,p,w,g,e,l,a,m,C,x,d,O,b,j,y,t=this,i=t.Mf,r=t.$X;if(!(r<0)&&(o=t.v2t,e=i.gj(),u=Cn.call(t,e,o))){if(f=r+2,r=t.PADDING,s=i.options,a=e.width,c=e.height,v=e.x,h=e.y,l=(e=i.Fi()).width,d=e.height,p=e.qC,w=e.XC,g=e.BA,e=e.LA,n.save(),n.fillStyle=$(k).backgroundColor,n.strokeStyle=$(k).borderTopColor,n.lineWidth=1,n.fillRect(v,h,o?a:l,o?d:c),n.strokeRect(v-.5,h-.5,o?a:l+1,o?d+1:c),o?n.strokeRect(v-.5,e-.5,a,p):n.strokeRect(g-.5,h-.5,w,c),m=T(0,(o?e-s.sheetAreaOffset.top:g-s.sheetAreaOffset.left)+(l=(o?p:w)-u)/2),C=r,o&&(d=m,m=C,C=d),n.restore(),a=o?s.colHeaderVisible:s.rowHeaderVisible,n.save(),a&&0<=l)for(x=0;x<f;x++)O=u-1,b=void 0,j=v+m,y=h+C,o?j=_(j)+.5:y+=.5,n.fillStyle=$(z).backgroundColor,n.fillRect(j,y,O,O),n.font=N*i.zoom()+"pt Arial",n.strokeStyle=$(z).borderTopColor,n.strokeRect(j,y,O,O),n.fillStyle=$(z).color,b=E(n.font),t._2t(n,j,y,O,u,x+1,b),o?m+=u:C+=u;n.restore()}},o.prototype._2t=function(n,t,i,r,o,e,u){var e=""+e,f=n.measureText(e).width;f<=r&&u<=o&&(n.textBaseline="middle",n.fillText(e,t+(r-f)/2,i+r/2))},o.prototype.M2t=function(n,t,i){var r,o,e,e,u,f,s,r=this,o=r.Mf,e=r.$X;return e<0?R:(e=e+2,u=o.Fi(),s=(f=o.options).sheetAreaOffset,i?r.E2t(o,n,t,i,f.colHeaderVisible,u.qC,u.LA-s.top,e):r.E2t(o,n,t,i,f.rowHeaderVisible,u.XC,u.BA-s.left,e))},o.prototype.E2t=function(n,t,i,r,o,e,u,f){var s,a,c,n,v,h,l,d,e,s=this,a=n.gj(),c=Cn.call(s,a,r),n=e-c;if(c&&o&&0<=n)for(v=T(0,u+n/2),h=s.PADDING,r&&(e=v,v=h,h=e),d=0;d<f;d++){if((l=new L.Rect(a.x+v,a.y+h,c,c)).contains(t,i))return{index:d};r?v+=c:h+=c}return R},on=o,e.prototype.S2t=function(){var i,n,i=this;-1!==i.$X&&(n=i.j2t(0,i.v2t),M(n,function(n,t){i.O2t(t)}))},e.prototype.O2t=function(n){var e,t,i,t,u,r,o,i,f,s,a,c,v,h,l,d,h,p,w,g,m,C,x,O,b,j,x,y,_,e=this,t=e.Mf,i=e.v2t,t=A(i,t).direction(),u=1===t,r=0===t,o=e.R2t(!0,i),i=e.R2t(!1,i),f=n.start,s=n.end,a=n.level;if(u?c=s+1:r&&(c=f-1),0===n.state()){if(v=!0,(v=(h=n.parent)&&(r&&f===h.start||u&&s===h.end)?!1:v)&&e.B2t(!0,a,c,o,i,t),f<=i&&o<=s){for(l=T(o,f),d=H(i,s),p=h=void 0,v&&(h={start:l,end:d,level:a,startLine:R},(u&&l===f||r&&d===s)&&(h.startLine=!0),e.p2t.push(h)),g=[],m=n.children,p=l;p<=d;p++)g.push(!1);for(M(m,function(n,t){var i=t.start,r=t.end,o;if(1===t.state())for(w=i;w<=r;w++)g[w-l]=!0;g[(o=u?r+1:r-1)-l]=!0,e.O2t(t)}),C=!0,p=0;p<q(m);p++){if(O=(x=m[p]).start,x=(b=x.end)===s,(j=O===f)&&x){C=!1;break}if(u&&x||r&&j)for(w=O;w<=b;w++)g[w-l]=!0}if(C)for(y=l;y<=d;y++)g[y-l]||e.b2t.push(_={index:y,level:a+1})}}else 1===n.state()&&e.B2t(!1,a,c,o,i,t)},e.prototype.B2t=function(n,t,i,r,o,e){var t={isExpanded:n,level:t};n&&(t.paintLine=!0),r<=i&&i<=o&&(t.index=i,t.lineDirection=e,this.y2t.push(t))},e.prototype.L2t=function(n){var t=this,i=t.Mf,r=t.w2t;return t.v2t?i._y(r).findRow(n):i.Yy(r).findCol(n)},e.prototype.F2t=function(n){var t,i,r,o,e,u,f,s,a,i,c,v,h,l,t=this;-1!==t.$X&&(r=(i=t.Mf).gj(),o=t.v2t,e=Cn.call(t,r,o))&&(u=parseInt($(B).borderTopWidth,10),u=isNaN(u)?2:u,f=_(e/3),a=(e-u)/2+(s=t.PADDING),n.save(),n.fillStyle=$(k).color,i=i.Fi(),v=c=0,h=r.width,l=r.height,o?(v+=i.y+i.qC,l=i.height-i.qC):(c+=i.x+i.XC,h=i.width-i.XC),n.rect(c,v,h,l),n.clip(),t.P2t(n,t.b2t,o,r,e,a,u),o?t.G2t(n,t.p2t,o,r,e,a,u,f):t.U2t(n,t.p2t,o,r,e,a,u,f),t.H2t(n,t.y2t,o,r,e,a,u,s),n.beginPath(),n.restore())},e.prototype.P2t=function(e,n,u,f,s,a,c){var v,h,l,t,i,r,o,d,p,w,l=this,t=2,i,r,o=l.Mf.options.sheetAreaOffset,d=o.left,p=o.top;e.save(),e.fillStyle=$(P).color,w=l.p2t,M(n,function(n,t){var i,r,o,i,r,o,i,r,i=t.index,r=t.level,o=l.L2t(i);o&&!l.z2t(w,i,r)&&(i=u?o.y:o.x,0<=(r=(u?o.height:o.width)-c))&&(v=i+T(0,r/2),h=t.level*s+a,u?(o=v,v=h+.5,h=o,h-=p):(h+=.5,v-=d),e.strokeStyle="transparent",e.lineWidth=0,(i=f.x+v)%1!=0&&(i+=.5),(r=f.y+h)%1!=0&&(r+=.5),e.strokeRect(i,r,2,2),e.fillRect(i,r,2,2))}),e.restore()},e.prototype.z2t=function(n,t,i){for(var r,o,e,r=!1,o=q(n),e=0;e<o;e++)if(n[e].level===i&&n[e].start<=t&&n[e].end>=t){r=!0;break}return r},e.prototype.G2t=function(n,t,i,r,o,e,u,f){var s,i,a,c,v,h,l,d,p,w,g,m,C,x,O,b,O;for(n.save(),n.strokeStyle=$(B).borderTopColor,n.fillStyle=$(B).borderTopColor,n.lineWidth=u,a=A(i,i=(s=this).Mf).direction(),l=(h=(v=i.options).sheetAreaOffset).top,c=0;c<q(t);c++){for(p=(d=t[c]).start,w=d.end,m=g=void 0;g=s.L2t(p),p++,!g&&p<=w;);for(;m=s.L2t(w),w--,!m&&p<=w;);(g||m)&&(g?m=m||g:g=m,C=g.y,x=d.level*o+e,O=u,b=T(0,m.y+m.height-g.y),1===a?C+=1:--C,C-=l,n.beginPath(),O=r.x+x+O/2,O=Y(O),n.moveTo(O,r.y+C),n.lineTo(O,r.y+C+b),n.stroke(),d.startLine)&&0<o/2-2*u&&(C=0===a?C+b-u-l:C)>=g.y-l&&C<m.y+m.height-l&&n.fillRect(Y(r.x+x),r.y+C,f,u)}n.restore()},e.prototype.U2t=function(n,t,i,r,o,e,u,f){var s,i,a,c,v,h,l,d,p,w,g,m,C,x,O,b;for(n.save(),n.strokeStyle=$(B).borderTopColor,n.fillStyle=$(B).borderTopColor,n.lineWidth=u,a=A(i,i=(s=this).Mf).direction(),l=(h=(v=i.options).sheetAreaOffset).left,c=0;c<q(t);c++){for(p=(d=t[c]).start,w=d.end,m=g=void 0;g=s.L2t(p),p++,!g&&p<=w;);for(;m=s.L2t(w),w--,!m&&p<=w;);(g||m)&&(g?m=m||g:g=m,C=g.x,x=d.level*o+e,O=T(0,m.x+m.width-g.x),1===a&&(C+=1),C-=l,b=r.y+x+u/2,b=Y(b),n.beginPath(),n.moveTo(r.x+C,b),n.lineTo(r.x+C+O,b),n.stroke(),d.startLine)&&0<o/2-2*u&&(C=0===a?C+O-u-l:C)>=g.x-l&&C<m.x+m.width-l&&n.fillRect(r.x+C,Y(r.y+x),u,f)}n.restore()},e.prototype.V2t=function(n){var n=$(n).backgroundImage;return n=(n="none"===n?"":n)&&(n=(n=n.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()},e.prototype.H2t=function(n,t,i,r,o,e,u,f){var s,a,c,v,h,l,E,F,D,J,P,v,d,p,w,c,v,g,m,C,x,O,b,b,j,y,_,R,L,M,G,S,k,U,L,y,A,I,N,j,j,I,b,G,S,R,S,s=this,c=s.Mf,v=c.options,h=v.sheetAreaOffset.left,l=v.sheetAreaOffset.top,E=$(z).borderTopColor,F=$(z).backgroundColor,D=$(z).color,J=$(B).borderTopColor,P=1,v=c.BO(),d=s.V2t(K),p=s.V2t(Q);for(d&&!v.jt(d)&&v.Rt(d),p&&!v.jt(p)&&v.Rt(p),w=p&&v.Ot(p),c=d&&v.Ot(d),v=$(K),g=$(Q),m=c?v.backgroundColor:"",C=w?g.backgroundColor:"",x=c?v.borderTopColor:"",O=w?g.borderTopColor:"",a=0;a<q(t);a++)n.save(),_=t[a],!(R=s.L2t(_.index))||(L=i?R.height:R.width)<=0?n.restore():(M=T(0,(L-o)/2),k=(i?R.y-l:R.x-h)+M,U=_.level*o+f,I=A=S=G=void 0,N=L-(L=H(y=o,L)),I=i?(j=k,k=U,U=j,j=L,L=y,y=j,A=.5,0):(A=0,.5),j=_.isExpanded?x:O,n.strokeStyle=j||E,n.lineWidth=1,b=_.isExpanded?m:C,n.fillStyle=b||F,n.fillRect(r.x+k,r.y+U,L,y),G=r.x+k+A,S=r.y+U+I,n.strokeRect(G,S,L,y),n.fillStyle=D,b=_.isExpanded?d:p,s.Y2t(n,_.isExpanded,b,G,S,L,y),n.restore(),_.paintLine&&0<N&&(n.save(),n.strokeStyle=J,k=i?R.y-l:R.x-h,U=_.level*o+e,I=0===_.lineDirection,b=i?u:M,G=i?M:u,i?(S=k,k=U,U=S,I&&(U+=M+y,G=N-M)):I&&(k+=M+L,b=N-M),n.beginPath(),n.lineWidth=u,R=Y(r.x+k+u/2),S=Y(r.y+U+u/2),i?(n.moveTo(R,r.y+U),n.lineTo(R,r.y+U+G-1)):(y=0,w&&!_.isExpanded&&(y=1),n.moveTo(r.x+k,S),n.lineTo(r.x+k+A+b+y,S)),n.stroke(),n.restore()))},e.prototype.Y2t=function(n,t,i,r,o,e,u){var f,s,a,a,i,c,f=this,s,a=this.Mf.BO();if(i&&a.jt(i)){i=(a=a.Ot(i)).width,c=a.height;try{n.drawImage(a,0,0,i,c,_(r),_(o),e-1,u-1)}catch(n){}}else f.Z2t(n,t,r,o,e,u)},e.prototype.Z2t=function(n,t,i,r,o,e){var u,f,t,s,u=_(o/4),f=_(o/2);t||(t=_(e/4),s=_(e/2),n.fillRect(i+o/2-1,r+t,2,e-s)),n.fillRect(i+u,r+e/2-1,f,2)},e.prototype.j2t=function(n,t){var i,r,o,e,u,f,s,a,i,c,v,i,i=this,r=i.Mf,o=[],u=-1,f=-1,s=A(t,r),a,i=(t?r._y:r.Yy).call(r,i.w2t),c=q(i);for(c&&(v=i[0],i=i[c-1],u=T(0,(t?v.row:v.col)-1),f=t?H(r.getRowCount(),i.row+2):H(r.getColumnCount(),i.col+2));u<f;)(e=s.find(u,n))?(u=e.end+1,o.push(e)):u++;return o},e.prototype.R2t=function(n,t){var i=-1,r=this,o=r.Mf,r=r.w2t,e=o.frozenRowCount(),u=o.frozenColumnCount(),f=o.frozenTrailingRowCount(),s=o.frozenTrailingColumnCount(),a=o.getRowCount(),o=o.getColumnCount();return 0===r?i=n?0:(t?e:u)-1:1===r?i=n?t?e:u:(t?a-f:o-s)-1:2===r&&(i=n?t?a-f:o-s:(t?a:o)-1),i},e.prototype.W2t=function(n){n&&this.Mf.Oi&&(n.x-=2,n.y-=2,n.width+=4,n.height+=4)},e.prototype.C2t=function(n,t,i){var r,o,e,u,f,s,a,c,v,h,l,d,p,w,l,w,g,w,h,m,C,C,r=this,o=r.$X,e=r.Mf,u=e.options,f=u.sheetAreaOffset.left,s=u.sheetAreaOffset.top;if(!(o<0)&&(a=e.gj(),c=Cn.call(r,a,i)))for(v=r.y2t,d=0;d<q(v);d++)if(w=(p=v[d]).index,l=p.level*c+r.PADDING,(w=r.L2t(w))&&!((h=i?w.height:w.width)<=0)&&(g=H(c,h),h=(i?w.y-s:w.x-f)+T(0,(h-(w=c))/2),m=l,i&&(C=g,g=w,w=C,C=h,h=l,m=C),l=new L.Rect(a.x+h+.5,a.y+m+.5,g,w),r.W2t(l),l.contains(n,t)))return p;return R},en=e,(t=un=c.OutlineDirection||(c.OutlineDirection={}))[t.backward=0]="backward",t[t.forward=1]="forward",i.OutlineDirection=un,(t=n=c.OutlineState||(c.OutlineState={}))[t.expanded=0]="expanded",t[t.collapsed=1]="collapsed",i.OutlineState=n,xn.prototype.state=function(n){var t=this,i=t.model;if(!arguments.length)return i?i.getState(t):0;i&&i.expandGroup(t,0===n)},xn.prototype.contains=function(n){return this.start<=n&&n<=this.end},xn.prototype.addChild=function(n){n&&(this.children.push(n),n.parent=this)},w=xn,c.OutlineInfo=w,i.OutlineInfo=w,U=On,c.isIndexValid=u,s.prototype.L0=function(){this.Mf=R},s.prototype.getUsedRange=function(n){var n,t,i,r,o,n,e,t,u,o,f,u,f;if(n&L.UsedRangeType.axis)return t=(n=this).items,i=n.v2t,o=(r=Object.keys(t)).length,n=n.Mf,0<o&&n?(u=t[+r[e=0]],f=t[+r[o=(t=o)-1]],u&&-1===u.level&&(e=1),f&&-1===f.level&&(t=o),i?(u=n.getColumnCount()-1,{minRow:+r[e],minCol:0,maxRow:+r[t-1],maxCol:u}):(f=n.getRowCount()-1,{minRow:0,minCol:+r[e],maxRow:f,maxCol:+r[t-1]})):void 0},s.prototype.group=function(n,t){var i=this,r,o;for(Sn(i,n,t),i.Mf.Ut.m2t(i.v2t),r=0;r<t;r++)i.items[o=n+r]?i.items[o].level++:i.items[o]=new U;i.I2t&&i.A2t&&(i.A2t=R),i.Mf.Ut.m2t(i.v2t,!0),I(i),i.x2t=!1},s.prototype.Xst=function(){this.I2t=!0,this.A2t=R},s.prototype.$st=function(){var n=this;n.I2t=!1,n.refresh()},s.prototype.ungroupRange=function(n,t){var i=this,r,o;for(Sn(i,n,t),i.Mf.Ut.m2t(i.v2t),r=0;r<t;r++)(o=i.items[n+r])&&-1<o.level&&o.level--;i.Mf.Ut.m2t(i.v2t,!0),I(i)},s.prototype.ungroup=function(){var n=this,t=q(n.items);n.Mf.Ut.m2t(n.v2t),n.items=new Array(t),I(n),n.x2t=!0},s.prototype.expand=function(n,t,i){var r,o,e,u,f,s,a;if(n<-1)throw new Error((0,c.getSR)().Exp_InvalidLevel);for(o=(r=this).items,(u=r.Mf).Ut.m2t(r.v2t),Mn(r),f=u.op(),u.suspendPaint(),f.suspend(),s=0,a=o.length;s<a;s++)o[s]&&(e=r.find(s,n))&&(r.expandGroup(e,t,!0),s=e.end);i||r.Mf.Ut.m2t(r.v2t,!0),f.resume(!1),u.resumePaint()},s.prototype.expandGroup=function(n,t,i){if(!n)throw new Error((0,c.getSR)().Exp_GroupInfoIsNull);var r=this,o=r.direction(),e=-1;i||r.Mf.Ut.m2t(r.v2t),0===o?e=n.start-1:1===o&&(e=n.end+1),r.setCollapsed(e,!t,n.level,i),i||r.Mf.Ut.m2t(r.v2t,!0),r.Mf.zw()},s.prototype.tF=function(n){return!(!this.x2t&&u(this,n)&&this.isCollapsed(n))},s.prototype.isCollapsed=function(n){var n=this.items[n];return!!(n&&n.viewCollapsed&&-1<n.level)},s.prototype.find=function(n,t){var i=this,r;return Mn(i),r=-1===t?i.A2t:(i.Mf.NMi||kn(i,n),_n(i,n,t))},s.prototype.getLevel=function(n){var n=this.items[n];return n?n.level:-1},s.prototype.getCollapsed=function(n){var n=this.items[n];return!!n&&!!n.collapsed},s.prototype.Q2t=function(n,t,i,r){for(var o,e,o=t;o<=i;o++)(e=n[o])||((e=n[o]=new U).level=-1),e.viewCollapsed=r},s.prototype.setCollapsed=function(n,t,i,r){var o,e,u,f,s,a,s,u,c,v,h,o=this,e=!1,u=o.items,s=o.Mf.Ut,a=[];if(r||s.m2t(o.v2t),Mn(o),n<0?f=(f=o.head)||(o.head=new U):n<q(u)?(f=u[n])||((f=u[n]=new U).level=-1):f=(f=o.tail)||(o.tail=new U),s=1===o.direction(),(u=i!==C)||f.collapsed===t?u&&(f.level===i-1&&(f.collapsed=t),e=!0,o.K2t(n,t,i)):(f.collapsed=t,e=!0,o.K2t(n,t,i)),e&&(v=o.find(n+=s?-1:1,o.getLevel(n)))){for(h=v.start;h<=v.end;h++)a.push(h);c={indexes:a}}Gn(o,c),r||o.Mf.Ut.m2t(o.v2t,!0)},s.prototype.J2t=function(n,t){var i,i,i=this.items;i[n]?i[n].collapsed!==t&&(i[n].collapsed=t):((i=i[n]=new U).level=-1,i.collapsed=t)},s.prototype.K2t=function(n,t,i){var r,o,e,u,f,s,a,s,c,i,v,h,l,d,p,w,g,m,r=this,o=r.items,e=1===r.direction(),u,f=i!==C,s=n+(e?-1:1),a=f?i:r.getLevel(s),s=_n(r,s,a);if(s&&(c=e?s.end+1:s.start-1)!==n&&(s=null),G(s)&&(a=f?i:r.getLevel(n),s=_n(r,n,a)),s)if(i=void 0,v=s.parent,t)f||(i=e?s.end+1:s.start-1,r.J2t(i,!0),s=Un(s,e)),r.Q2t(o,s.start,s.end,!0);else{for(h=!1,l=void 0;v;){if(o[l=e?v.end+1:v.start-1]&&o[l].collapsed&&-1<o[l].level){h=!0;break}v=v.parent}if(!h)for(f||(i=e?s.end+1:s.start-1,r.J2t(i,!1),s=Un(s,e)),r.Q2t(o,s.start,s.end,!1),d=[s],p=0;0<=p;)if(w=d[p],p--,o[l=e?w.end+1:w.start-1]&&o[l].collapsed&&-1!==o[l].level)r.Q2t(o,w.start,w.end,!0);else for(g=w.children,m=0;g&&m<g.length;m++)d[++p]=g[m]}},s.prototype.getMaxLevel=function(){var i=-1,n=this.items,r;return M(n,function(n,t){t&&(r=t.level,i<r)&&(i=r)}),i},s.prototype.PB=function(n,i,t,r){var o,e,u,f,s;if(!(t<=0||n===i)){for((o=this).Mf.Ut.m2t(o.v2t),i<0&&(i=0),e=[],u=o.items,f=v(u,(n=n<0?0:n)-1);0<=f&&f<n+t;)s=new U(u[f]),e.push({index:f-n,value:s}),f=v(u,f);r&&h(u,n,t),h(u,i,t),M(e,function(n,t){u[i+t.index]=t.value}),Ln(o),o.Mf.Ut.m2t(o.v2t,!0)}},s.prototype.FB=function(n,t,i,r,o){var e,u,f,e=this;if(e.Mf.Ut.m2t(e.v2t),t<0&&(t=0),i<0&&(i=0),u=[],n)for(f=v(n.items,t-1);0<=f&&f<t+r;)u[f-t]=new U(n.items[f]),f=v(n.items,f);h(e.items,i,r),0<u.length&&u.forEach(function(n,t){e.items[i+t]=n}),o&&h(n.items,t,r),e.Mf.Ut.m2t(e.v2t,!0)},s.prototype.refresh=function(){this.x2t||I(this)},s.prototype.X2t=function(n){var t=this,i=t.items,r,o=n-q(i);o<0?i.splice(n,-o):t.items=i.concat(new Array(o)),Ln(t)},s.prototype.getState=function(n){var t=this,i=t.items,r,r=t.direction(),o=-1;return 0===r?o=n.start-1:1===r&&(o=n.end+1),(r=o<0?t.head:o<q(i)?i[o]:t.tail)&&r.collapsed?1:0},s.prototype.q2t=function(n,t){var i=this,r=i.items;n<0?(i.head||(i.head=new U),i.head.level=t):n<q(r)?(r[n]||(r[n]=new U),r[n].level=t):(i.tail||(i.tail=new U),i.tail.level=t),Ln(i)},s.prototype.suspendAdding=function(){this.T2t++},s.prototype.resumeAdding=function(){this.T2t--},s.prototype.createRangeGroup=function(){for(var n,t,i,r,o,e,u,n=this,t=n.items,i=q(n.items),r=new w(n,0,i-1,-1),o=0;o<i;)t[o]&&(t[o].groupInfo=R),o++;for(o=0;o<i;)t[o]?(u=(e=yn(n,o,0)).g,o=e.index+1,u&&-1<u.level&&r.addChild(u)):o++;return r},s.prototype.$2t=function(n,t){return 1===this.direction()?t===n.end+1:t===n.start-1},s.prototype.tpt=function(n,t,i,r){var o=this,e=-1,u=0;if(1===o.direction()&&(e=0,u=1),n===t)return o.$2t(n,i)||o.$2t(n,r)?{start:n.start,end:n.end,level:n.level}:{start:i,end:r,level:n.level};for(;n.level>t.level;){if(t===n.parent)return o.$2t(t,r)?{start:t.start,end:t.end,level:t.level}:{start:n.start+e,end:r,level:n.level-1};n=n.parent}for(;n.level<t.level;){if(n===t.parent)return o.$2t(n,i)?{start:n.start,end:n.end,level:n.level}:{start:i,end:t.end+u,level:t.level-1};t=t.parent}for(;0<=n.level;){if(n.parent===t.parent)return{start:n.start+e,end:t.end+u,level:t.level-1};n=n.parent,t=t.parent}return{start:n.start+e,end:t.end+u,level:t.level-1}},s.prototype.npt=function(n){var t,i,r,t,o,e,t=this,i=t.items,r=i[n],t=1===t.direction()?i[n-1]:i[n+1],o,e;return(r?r.level:-1)<(t?t.level:-1)?t&&t.groupInfo:r&&r.groupInfo},s.prototype.lB=function(n,t){var i,r,o,e,i,i=this,r=i.npt(n),o=i.npt(n+t-1);if(G(r)&&G(o))return{start:n,end:n+t-1,count:t,level:-1};if(!r||!o){for(e=r||o;e&&-1!==e.level;)e=e.parent;r=r||e,o=o||e}return(i=i.tpt(r,o,n,n+t-1)).count=i.end-i.start+1,i},s.prototype.kB=function(n,t){for(var i,r,o,e,i,i,i=this,r=i.items,o=n;o<n+t;o++)if(e=r[o]&&r[o].groupInfo&&r[o].groupInfo.level,!G(e)&&0<=e)return!0;return i=r[i=1===i.direction()?n-1:n+t]&&r[i].groupInfo&&r[i].groupInfo.level,!G(i)&&0<=i},s.prototype.ept=function(n){var t,i,i,t,i=this.items,i=i[n]&&i[n].groupInfo&&i[n].groupInfo.level;return G(i)?-1:i},s.prototype.ipt=function(n,t,i){for(var r,o,e,u,f,r=this,o=[],e=[],u=n;u<n+t;u++)(f=r.ept(u))===i&&e.push(u),r.ept(u+1)<i&&0<e.length&&(o.push(e),e=[]);return 0<e.length&&o.push(e),o},s.prototype.hB=function(n,t){var i,r,o,e,u,i=this;if(1===t)return i.ipt(n.start,n.count,n.level);for(r=[],o=i.getMaxLevel(),e=2===t?n.level+1:n.level,u=o;e<=u&&-1<=u;u--)r=r.concat(i.ipt(n.start,n.count,u));return r},s.prototype.vB=function(n,t,i){for(var r,o,e,u,r=this,o=n.length-1;0<=o;o--)(e=n[o]).collapse&&r.setCollapsed(e.head,!1),r.ungroupRange(e.start,e.count);for(o=n.length-1;0<=o;o--)e=n[o],u=d.hD(t,e.head)+i,1===r.direction()?r.group(u-e.count,e.count):r.group(u+1,e.count),e.collapse&&r.setCollapsed(u,e.collapse)},s.prototype.dB=function(n,t,i){var r,o,e,u,i,f,s,a,c,v,h,l,r=this,o=r.items;if(1===i)for(e=r.getMaxLevel(),u=t.level+1;u<=e;u++)n.splice.apply(n,x([0,0],r.ipt(t.start,t.count,u),!1));else 2===i&&n.push.apply(n,r.ipt(t.start,t.count,t.level));for(f=n[(i=n.length)-1].concat([]),s=[],u=i-2;0<=u;u--)c=(a=o[n[u][0]]).groupInfo,1===r.direction()?(v=c.end+1,h=d.hD(f,v),f.splice.apply(f,x([h,0],n[u],!1)),s.push({head:v,start:c.start,count:v-c.start,collapse:a.viewCollapsed})):(v=c.start-1,h=d.hD(f,v),f.splice.apply(f,x([h+1,0],n[u],!1)),s.push({head:v,start:c.start,count:c.end-v,collapse:a.viewCollapsed}));for(l=!1,u=0;u<t.count;u++)if(f[u]!==u+t.start){l=!0;break}return{array:f,isChanged:l,groupSwap:s}},s.prototype.isGroupEnd=function(n,t){var i,r,o,i,i,r,o,e,n,i=this,r=i.items,o=n+1;return!u(i,o)||!(i=r[o])||(o=!1,(i=i.level)<(r=r[n].level)&&0<=(n=r-t)&&n<(e=r-i))||o},s.prototype.hitTest=function(n,t,i){return wn.call(n,t,i)},s.prototype.getBtnRectangle=function(){var n,t,i,r,o,e,u,n,f,r,i,s,a,c,o,v,h,l,d,n,n=this.Mf,t=this.v2t,i=n.Fi(),r=n.options,o=r.sheetAreaOffset,e=t?i.qC:i.XC,u=n.gj(),n=t?u.rowMaxLevel:u.colMaxLevel,f=t?u.width:u.height,r=t?r.colHeaderVisible:r.rowHeaderVisible,i=t?i.LA-o.top:i.BA-o.left,s=2,a=n+2,c=T(0,(f-4)/a),o=e-c,v=[];if(c&&r&&0<=o)for(h=T(0,i+o/2),l=2,t&&(n=h,h=l,l=n),d=0;d<a;d++)v.push({x:u.x+h,y:u.y+l,width:c,height:c}),t?h+=c:l+=c;return v},s.prototype._e=function(n,t,i,r){var o,e,u,f,s,f,e,a,s,c,v,h;if(!this.Oy()&&(o=n.gj(),e=n.Fi(),u=n.Jt,f=o.width,s=o.height,f||s)){if(f=r?f:e.width,e=r?e.height:s,a=r?o.rowMaxLevel:o.colMaxLevel,s=r?u.kl:u._l,t.save(),t.beginPath(),!i||i.intersect(o.x,o.y,f,e))for(h=v=void 0,(c=new on(n,r,a)).D2t(t),v=s.call(n.Jt,function(){return mn(n,r,a)}),h=0;h<=2;h++)v[h].F2t(t);t.beginPath(),t.restore()}},s.prototype.rpt=function(n,t){var i;t&&((i=t.what)===l||i===V?hn(n,t):i!==p&&i!==W||ln(n,t))},s.prototype.Oy=function(){return this.x2t},s.prototype.Ry=function(){var n=parseInt($(B).borderTopWidth,10);return isNaN(n)?2:n},s.prototype.fromJSON=function(n,t){var t,i,r,o,t,e,u,n,f,s,a,c,v,h,l,t=t&&t.ignoreStyle;if(n&&!t){if(r=(i=this).items,o=n.items,t=n.itemsData,e=n.direction,u=n.head,n=n.tail,c=[],G(e)||i.direction(e),u&&(i.head=u),n&&(i.tail=n),v=!1,o&&0<o.length)for(l=0;l<o.length;l++)G(o[l])||(h=new U(o[l]),i.direction()===un.forward&&(v=!!h.viewCollapsed||v&&!(h.collapsed=!0)),r[l]=h,i.x2t=!1);else M(t,function(n,t){if(f=t.index,s=t.info,0<=f&&s){for(a=0;a<t.count&&!(f+a>=q(r));a++)t.info.collapsed&&c.push(t),r[f+a]=new U(s);i.x2t=!1}});for(I(i,!0),l=0;l<c.length;l++)i.K2t(c[l].index,!0)}},s.prototype.toJSON=function(n){var n,n,t,i,r,o,e,u,f,n,s,n=n&&n.ignoreStyle;if(!n){for(t=[],i=(n=this).items,o=-1,e=[],r=0;r<q(i);r++)u=t[o],(f=i[r])&&(e[r]={level:f.level,collapsed:f.collapsed,viewCollapsed:f.viewCollapsed},0<=o&&r===u.count+u.index&&f.level===u.info.level&&f.collapsed===u.info.collapsed?t[o].count++:t[++o]={index:r,count:1,info:{level:f.level,collapsed:f.collapsed}});return n={items:e,itemsData:t,direction:n.direction(),head:n.head,tail:n.tail},s={},M(n,function(n,t){Rn(n,t)||(s[n]=t)}),a.isEmptyObject(s)?C:s}},r=s,(c.Outline=r).prototype.direction=y("direction",1),i.Outline=r,a.extend(L.Y8.prototype,{m2t:function(n,t){var i,r,i=this,r=i.G8;r&&(r.originalOutlines||(r.originalOutlines=[]),!n||!t&&r.originalOutlines[0]?n||!t&&r.originalOutlines[1]||(r.originalOutlines[t?3:1]=An(i.opt)):r.originalOutlines[t?2:0]=An(i.apt))},upt:function(n,t,i){var r,t,r=this;void 0!==t&&(this.Mf.outlineColumn.NB=t),n&&((t=n[i?2:0])&&In(r.apt,t),t=n[i?3:1])&&In(r.opt,t)}}),L.Y8.ch(J,{init:function(){var n=this,t=n.Mf;n.opt=new r(n.getColumnCount(),t,!1),n.apt=new r(n.getRowCount(),t,!0)},applyChanges:function(n){var t,i,n,r,t,i=n.changes,n=n.isUndo,r=i&&i.originalOutlines;(r||i.oldOptions)&&this.upt(r,i.oldOptions,!n)},undo:function(n){var t=n.originalOutlines;(t||n.oldOptions)&&(this.upt(t,n.oldOptions),this.Mf.zw())},dispose:function(n){var t=this,i;!1!==(n&&n.clearCache)&&(t.opt&&(t.opt.L0(),t.opt=R),t.apt)&&(t.apt.L0(),t.apt=R)}}),L.Worksheet.ch(J,fn={init:function(){var o=this;o.rowOutlines=o.Ut.apt,o.columnOutlines=o.Ut.opt,o.rowOutlines.groupChangeHandler=function(n){var n,t,t,i,r,t,n=n&&n.indexes;n&&o.recalcRows&&(t=o.getCalcService())&&!t.IsSuspended()&&o.recalcRows(n),(t=o.parent)&&o!==t.getActiveSheet()||o.iP(),t=n?(i=n[0],r=n[n.length-1],!0):(i=0,r=o.getRowCount()-1,!1),L.Worksheet.et(o,"onGroupChanged",{start:i,end:r,isRow:!0,fromSetCollapsed:t})},o.columnOutlines.groupChangeHandler=function(n){var t,t,i,r,n,t=o.parent;t&&o!==t.getActiveSheet()||o.rP(),n=(t=n&&n.indexes)?(i=t[0],r=t[t.length-1],!0):(i=0,r=o.getColumnCount()-1,!1),L.Worksheet.et(o,"onGroupChanged",{start:i,end:r,isRow:!1,fromSetCollapsed:n})},o.$L.push(o.rowOutlines),o.nF.push(o.columnOutlines)},dispose:function(n){var t=this;!1!==n.clearCache&&(t.rowOutlines&&(t.rowOutlines.groupChangeHandler=R),t.columnOutlines)&&(t.columnOutlines.groupChangeHandler=R),a(t.Dg()).unbind("mousedown.group")},setHost:function(n){var i;n&&(i=this,n.bind("mousedown.group",function(n){var t,n,t,t=i.uw(),n=wn.call(i,n.pageX-t.left,n.pageY-t.top);n&&((t=n.what)===p||t===l?i.rowOutlines.rpt(i,n):t!==W&&t!==V||i.columnOutlines.rpt(i,n))}))},preProcessMouseDbClick:function(n){var t=this;G(t.sw)||G(t.sw.outlineHitInfo)||(n.r=!0)},onPaintSuspend:function(n){var t=this;n.suspend?(t.rowOutlines.Xst(),t.columnOutlines.Xst()):(t.rowOutlines.$st(),t.columnOutlines.$st())},beforeLayoutChanged:function(n){var t,i;"invalidateLayout"===n.changeType&&(this.k2t=R)},onLayoutChanged:function(n){var t,i,r,o,e,u,n,f,s,a,c,t=this,i=n.changeType,r=n.row,o=n.rowCount,e=n.col,u=n.colCount,n=n.sheetArea,f=t.rowOutlines,s=t.columnOutlines,a=G(n)||3===n,c=this.Ut;"addRows"===i&&a?(c.m2t(!0),bn(f,r,o),c.m2t(!0,!0)):"deleteRows"===i&&a?(c.m2t(!0),jn(f,r,o),c.m2t(!0,!0)):"addColumns"===i&&a?(c.m2t(!1),bn(s,e,u),c.m2t(!1,!0)):"deleteColumns"===i&&a?(c.m2t(!1),jn(s,e,u),c.m2t(!1,!0)):"invalidateLayout"===i?t.k2t=R:"setColumnCount"===i?(c.m2t(!1),3!==n&&1!==n||s.X2t(u),c.m2t(!1,!0)):"setRowCount"!==i||3!==n&&2!==n||(c.m2t(!0),f.X2t(o),c.m2t(!0,!0))},paint:function(n){var t,n,i,r,o,t=n.ctx,n=n.clipRect,i=this,r=i.rowOutlines,o=i.columnOutlines;r&&r._e(i,t,n,!0),o&&o._e(i,t,n,!1)},fromJson:function(n,t,i){var r,o,e,u,e,u;n&&(r=this,o=void 0,e=n.showRowRangeGroup,u=n.showColumnRangeGroup,e=f(e)?e:n.showRowOutline,u=f(u)?u:n.showColumnOutline,G(e)||r.showRowOutline(e),G(u)||r.showColumnOutline(u),(o=n.rowRangeGroup||n.rowOutlines)&&r.rowOutlines.fromJSON(o,i),o=n.colRangeGroup||n.columnOutlines)&&r.columnOutlines.fromJSON(o,i)},toJson:function(n,t){var i,r,o,e,e,i=this,r=i.rowOutlines,o=i.columnOutlines,e=i.showRowOutline();!0!==e&&(n.showRowOutline=e),!0!==(e=i.showColumnOutline())&&(n.showColumnOutline=e),n.rowOutlines=r?r.toJSON(t):C,n.columnOutlines=o?o.toJSON(t):C},wh:function(n,t,i){var i,i,r,o,e,e,i,e,i,e,u,f,u,s,a,c,v,h,l,d,p,w,g,m,i=i&&!1===i.includeStyles;if(!i){for(r=(i=this).rowOutlines,o=i.columnOutlines,!0!==(e=i.showRowOutline())&&(n.lossless.showRowOutline=e),!0!==(e=i.showColumnOutline())&&(n.lossless.showColumnOutline=e),0!==r.direction()&&0!==o.direction()||((i=S(n,X))||n.c_.push(i={n_:X,c_:[]}),i.c_.push(e={n_:"outlinePr"}),0===r.direction()&&(e.summaryBelow="0"),0===o.direction()&&(e.summaryRight="0")),i=S(n,L.XFileConstants._u),e=r.getMaxLevel(),u=-1!==(u=o.getMaxLevel())?u+1:C,i.outlineLevelRow=f=-1!==e?e+1:C,i.outlineLevelCol=u,s=n.tempCols,a=o.items,c=i.defaultColWidth,v=0;v<a.length;v++)(h=a[v])&&(l=h.viewCollapsed,(d=s[v]||{width:c,hidden:C,collapsed:C,outlineLevel:C}).hidden!==nn&&!l||(d.hidden=nn),!0===h.collapsed&&(d.collapsed=nn),-1!==h.level&&(d.outlineLevel=h.level+1),s[v]=d);for(p=S(n,Z),w=r.items,v=0;v<w.length;v++)(g=w[v])&&(l=g.viewCollapsed,(m=p[v]||{}).v===C&&!1===l&&(m.v=0),m.f=!0===g.collapsed?1:0,m.l=g.level+1,p[v]=m)}},yh:function(n,t,i){var i,i,r,i,o,f,r,r,r,s,a,e,u,c,v,h,l,d,p,w,g,m,C,x,O,b,b,C,C,j,y,_,R,i=i&&!1===i.includeStyles;if(!i&&(n.lossless&&(i=n.lossless.showRowOutline,r=n.lossless.showColumnOutline,G(i)||this.showRowOutline(i),G(r)||this.showColumnOutline(r)),o=(i=this).rowOutlines,f=i.columnOutlines,(r=F(n,X+"&outlinePr"))&&("0"===r.summaryBelow&&o.direction(0),"0"===r.summaryRight)&&f.direction(0),(r=(r=S(n,L.XFileConstants.Eu))&&r.c_)&&0<r.length&&(s=f.items,a=i.getColumnCount(),r.forEach(function(n){var t,i,r,o,e,u;if((0<n.outlineLevel||!G(n.collapsed))&&(f.x2t=!1,t=n.min-1,i=n.max-1,r=+n.outlineLevel||0,o=rn(n.hidden,!1),e=rn(n.collapsed,!1),0<=t)&&0<=i)for(i===L.MAX_COLUMN_COUNT-1&&(i=Math.max(a,t)),u=t;u<=i;u++)s[u]=new U({level:r-1,collapsed:e,viewCollapsed:o}),a<u+2&&!(r<=0&&(!s[u-1]||s[u-1]&&s[u-1].level<0))&&(a=u+2)}),a>i.getColumnCount())&&i.setColumnCount(a),e=S(n,Z))){for(u=i.Ut.Q_(!0),v=[],h=o.items,l=(c={rowItems:[],itemsData:[]}).rowItems,d=c.itemsData,p=e.rowCount,w=0===o.direction(),g=i.getRowCount(),m=0;m<p;m++)(C=e[m])?(x=!!C.f,(0<(O=+C.l||0)||x)&&(l[m]={level:O-1,collapsed:x},(b=d[d.length-1])&&m===b.index+b.count&&b.info.level===O-1&&b.info.collapsed===x?b.count++:d.push({index:m,count:1,info:{level:O-1,collapsed:x}})),b=!!C.v,C=v[m-1]&&v[m-1].hidden,d&&En(c,m,O,w,b,C),((C={}).hidden=b)&&0===O&&(C.visible=!1),v.push(C),g<+m+2&&(0<O||x)&&(g=+m+2)):v.push({});if(Nn(c,e,v,o.direction(),u),j=!1,y=void 0,_=[],l&&0<l.length)for(R=0;R<l.length;R++)G(l[R])||(y=new U(l[R]),o.direction()===un.forward&&(j=!!y.viewCollapsed||j&&!(y.collapsed=!0)),h[R]=y,o.x2t=!1);for(I(o,!0),R=0;R<_.length;R++)o.K2t(_[R].index,!0);for(g>i.getRowCount()&&i.setRowCount(g),R=0;R<v.length;R++)!1===v[R].visible&&u.R8.push(R)}}}),L.Workbook.ch(J,sn={init:function(){O.Commands.g2t(this.commandManager())},onCultureChanged:function(){(0,c.getSR)()}})},"./dist/plugins/group/group.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.SR=void 0;var i=i("./dist/plugins/group/group.res.en.js");t.SR={en:i}},"./dist/plugins/group/group.res.en.js":function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Exp_GROUP_PROTECTED=t.Exp_GroupInfoIsNull=t.Exp_InvalidLevel=t.Exp_InvalidCount=t.Exp_InvalidIndex=void 0,t.Exp_InvalidIndex="Invalid index",t.Exp_InvalidCount="Invalid count",t.Exp_InvalidLevel="Invalid level",t.Exp_GroupInfoIsNull="groupInfo is null",t.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=o("./dist/plugins/group/group.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Outlines=n}();