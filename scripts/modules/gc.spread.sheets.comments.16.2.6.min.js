/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var o,i,t;function e(t){var n,n,n=i[t];return void 0!==n||(n=i[t]={exports:{}},o[t].call(n.exports,n,n.exports,e)),n.exports}o={"./dist/plugins/comment/comment-actions.js":function(R,t,n){var o,i,c,a,e,u,r,n,s,f,h,l,v,m,d,p,w,g,b,_,C,y,k,x,S,M,N,j,F;function z(t,n,o){var i,e,r,i=!1,e=t.Ut.pI.pZ();return e?(r=e.location(),t.Qy().execute({cmd:v,sheetName:t.name(),row:e.bZ,col:e.yZ,oldValue:r.clone(),newValue:new c.Point(r.x+n,r.y+o),propertyName:"location"})):i}function T(t){var n=t.comment;n&&(r(t.row)||r(t.col))&&(t.row=n.bZ,t.col=n.yZ)}function D(t,n){var o=N.call(this)||this;return T(n),o.Mf=t,o.tT=n,o}function V(t,n){var o=j.call(this)||this;return T(n),o.Mf=t,o.tT=n,o}function I(t,n){var o,i,e;if((n?t.canUndo():t.canExecute())&&(o=t.wZ)){for(i=0;i<o.length;i++)(e=o[i])&&(n?e.undo():e.execute());return!0}return!1}function O(t,n){var o,i,e,r,o=F.call(this)||this,i=o;if(i.wZ=[],i.Mf=t,e=(i.tT=n).commands)for(r=0;r<e.length;r++)i.add(e[r]);return o}o=this&&this.__extends||(M=function(t,n){return(M=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}M(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),Object.defineProperty(t,"__esModule",{value:!0}),t.CommentPropertyUndoAction=t.CommentDeleteUndoAction=void 0,i=n("Common"),c=n("Core"),a=n("Core"),e=c.GC$,u=c.Events,r=i.Common.lt.ht,n=a.Commands.ActionBase,s="deleteComment",f="deleteCommentByKey",h="deleteCommentByBackspaceKey",l="deactivateComment",v="moveComment",m="moveCommentUp",d="moveCommentDown",p="moveCommentLeft",w="moveCommentRight",g="changeComment",b="changeCommentTransaction",_=null,C=a.Commands.zA,o(D,N=n),D.prototype.execute=function(){var t,n,o,i,e,r,r,t=this;return!!t.canExecute()&&(n=t.Mf,t.X5(n,!0),o=n.comments.get(t.tT.row,t.tT.col),e=(i=n.Ut).pI,r={sheet:n,sheetName:n.name(),comment:o,cancel:!1},n.ki(u.CommentRemoving,r),r.cancel||(i.startTransaction(),e.remove(o.bZ,o.yZ),e.MZ=_,n.cR(),n.ki(u.CommentRemoved,{sheet:n,sheetName:n.name(),comment:o}),r=a.Commands.TI(n.name()),t.tT[r]=i.endTransaction()),t.q5(n,!0),!0)},D.prototype.undo=function(){var t,n,o,t=this,n=t.Mf;return t.X5(n,!0),o=a.Commands.TI(n.name()),n.Ut.undo(t.tT[o]),n.e4(),t.q5(n,!0),!0},t.CommentDeleteUndoAction=y=D,o(V,j=n),V.prototype.execute=function(){var t,n,o,i,e,t=this,n=t.tT,o=t.Mf,i=o.comments.get(n.row,n.col);return!(!t.canExecute()||!i||(t.X5(o,!0),i[e=n.propertyName](n.newValue),"location"===e&&(n.displayMode?i.displayMode(n.displayMode):n.displayMode=i.displayMode()),t.q5(o,!0),0))},V.prototype.undo=function(){var t,n,o,i,t=this,n=t.tT,o=t.Mf;return t.X5(o,!0),!!(i=o.comments.get(n.row,n.col))&&(i[n.propertyName](n.oldValue),t.q5(o,!0),!0)},V.prototype.toJSON=function(){return this.tT},t.CommentPropertyUndoAction=k=V,a.Commands.ChangeComment=k,o(O,F=n),O.prototype.execute=function(){return I(this,!1)},O.prototype.undo=function(){return I(this,!0)},O.prototype.add=function(t){this.wZ.push(t)},x=O,a.Commands[f]={canUndo:!1,execute:function(t,n){var t,n,t=a.Commands.Tp(t,n),n=t.Ut.pI.pZ();return!!n&&t.Qy().execute({cmd:s,sheetName:t.name(),row:n.bZ,col:n.yZ})}},a.Commands[l]={canUndo:!1,execute:function(t,n){var t,n,t=a.Commands.Tp(t,n),n=t.Ut.pI;return!!n.pZ()&&(n.CZ(),t.cR(),t.repaint(),!0)}},a.Commands[m]={canUndo:!1,execute:function(t,n){var o;return z(a.Commands.Tp(t,n),0,-1)}},a.Commands[d]={canUndo:!1,execute:function(t,n){var o;return z(a.Commands.Tp(t,n),0,1)}},a.Commands[p]={canUndo:!1,execute:function(t,n){var o;return z(a.Commands.Tp(t,n),-1,0)}},a.Commands[w]={canUndo:!1,execute:function(t,n){var o;return z(a.Commands.Tp(t,n),1,0)}},a.Commands[s]={canUndo:!0,execute:function(t,n,o){return C(t,y,n,o)}},a.Commands[v]={canUndo:!0,execute:function(t,n,o){return C(t,k,n,o)}},a.Commands[g]={canUndo:!0,execute:function(t,n,o){return C(t,k,n,o)}},a.Commands[b]={canUndo:!0,execute:function(t,n,o){return C(t,x,n,o)}},a.Commands.SZ=S=function(t){t.register(f,a.Commands[f],46,!1,!1,!1,!1),t.register(h,a.Commands[f],8,!1,!1,!1,!1),t.register(l,a.Commands[l],27,!1,!1,!1,!1),t.register(m,a.Commands[m],38,!1,!1,!1,!1),t.register(d,a.Commands[d],40,!1,!1,!1,!1),t.register(p,a.Commands[p],37,!1,!1,!1,!1),t.register(w,a.Commands[w],39,!1,!1,!1,!1),t.register(s,a.Commands[s]),t.register(g,a.Commands[g]),t.register(b,a.Commands[b]),t.register(v,a.Commands[v])}},"./dist/plugins/comment/comment-touch.js":function(t,n,o){var i,n,e,c,r,a,u,o,s,f,h,l,v,m,d;function p(t,n){return v.call(this,t,n)||this}function w(t,n,o){return m.call(this,t,n,o,new h(t,n))||this}function g(t,n,o){return d.call(this,t,n,o,new u(t,n))||this}function b(t,n,o,i){var e,r,n,e=this,r=e.TZ=n.TZ;e.AZ=new c.IZ(e),e.xZ=new c.NZ(t,"Comment"+r.bZ+r.yZ,e.AZ,2,200),e.kZ=o,e.DZ=i,(n=e.xZ)._Z=function(){return 3!==r.commentState()},n.EZ=function(){return!0},n.jZ=function(t){return i.OZ(t)},n.RZ=function(t){return i.BZ(t)},n.LZ=function(t){return i.FZ(t)},n.PZ=function(t){return i.GZ(t)},n.UZ=function(t){return i.HZ(t)}}function _(t,n){var o=this;o.zZ=t,o.VZ=n,o.TZ=n.TZ,o.Mf=o.TZ.Mf,o.YZ=new c.ZZ(o.Mf)}i=this&&this.__extends||(l=function(t,n){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),Object.defineProperty(n,"__esModule",{value:!0}),n=o("Core"),e=o("./dist/plugins/comment/comment.js"),c=o("Touch"),n.Of.touch&&(r=n.GC$,a=n.mt.vi,_.prototype.WZ=function(t){var t,n,o,t=new c.QZ(t.X,t.Y),n=r(this.zZ).offset();return n&&(o=document.body,t.X+=n.left+o.clientLeft||0,t.Y+=n.top+o.clientTop||0),t},_.prototype.OZ=function(t){t.KZ=35},_.prototype.BZ=function(t){var n,o,n=this,o=n.WZ(t.JZ);n.VZ.XZ({target:t.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),n.YZ.$Z()},_.prototype.FZ=function(t){var n,o,i,e,e,i,n=this,o=t.nW.tW,i=n.Mf,e=i.parent;1!==o&&e&&e.options.allowUserZoom?(i.rt.s9=!1,e=n.VZ,r(e.eW).remove(),n.YZ.iW(o)):(i=n.WZ(t.JZ),n.VZ.pg({target:t.qZ,isTouch:!0,button:0,pageX:i.X,pageY:i.Y,stopPropagation:function(){}}))},_.prototype.GZ=function(t){var n,o,i,e,e,n=this,o=t.nW.tW,i,e=n.Mf.parent;1!==o&&e&&e.options.allowUserZoom?n.YZ.rW(o):(e=n.WZ(t.JZ),n.VZ.bg({target:t.qZ,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}))},_.prototype.HZ=function(t){var n=this,o=n.TZ,n=n.Mf;try{n.suspendPaint(),3===o.commentState()?o.commentState(1):1===o.commentState()&&o.commentState(2)}finally{n.resumePaint()}},u=_,b.prototype.oW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!0)},b.prototype.uW=function(){var t=this,n=t.kZ;n&&n.aW(t.xZ,!1)},b.prototype.sW=function(t){return this.AZ.sW()},b.prototype.cW=function(t){return this.AZ.cW()},b.prototype.fW=function(t){return this.AZ.fW()},i(g,d=o=b),s=g,i(w,m=o),f=w,i(p,v=u),p.prototype.BZ=function(t){var n,o,n=this,o=n.WZ(t.JZ);n.VZ.lW({target:t.qZ,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),n.YZ.$Z()},h=p,e.hW.ch("touch",{init:function(t){var n,o,i,n=this,o,i=n.TZ.Mf.parent.kZ;n.dW=new s(t[0],n,i),n.dW.oW(),n.vW=new f(t[1],n,i),n.vW.oW()},detachEditor:function(t){var n=this,o=n.TZ.Mf;n.vW=new f(t,n,o.parent.kZ),n.vW.oW()},preProcessMouseDownEdit:function(t){var n,o,n=t.e,o=this.vW;o&&!n.isTouch&&o.sW(n)&&(a(n),t.r=!0)},preProcessMouseDownDragResize:function(t){var n,o,n=t.e,o=this.dW;o&&!n.isTouch&&o.sW(n)&&(a(n),t.r=!0)},preProcessMouseMove:function(t){var n,o,i,e,n=t.e,o=n.isTouch,i=this.dW,e=this.vW;i&&!o&&i.fW(n)&&(a(n),t.r=!0),e&&!o&&e.fW(n)&&(a(n),t.r=!0)},preProcessMouseUp:function(t){var n,o,i,e,n=t.e,o=n.isTouch,i=this.dW,e=this.vW;i&&!o&&i.cW(n)&&(a(n),t.r=!0),e&&!o&&e.cW(n)&&(a(n),t.r=!0)},dispose:function(){var t=this;t.dW.uW(),t.dW=null,t.vW.uW(),t.vW=null}}))},"./dist/plugins/comment/comment.entry.js":function(t,n,o){var i,e,i=this&&this.__createBinding||(Object.create?function(t,n,o,i){void 0===i&&(i=o);var e=Object.getOwnPropertyDescriptor(n,o);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[o]}}),Object.defineProperty(t,i,e)}:function(t,n,o,i){t[i=void 0===i?o:i]=n[o]}),e=this&&this.__exportStar||function(t,n){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(n,o)||i(n,t,o)};Object.defineProperty(n,"__esModule",{value:!0}),e(o("./dist/plugins/comment/comment.js"),n),e(o("./dist/plugins/comment/comment-actions.js"),n),o("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(i,t,P){var U,u,S,L,l,v,A,M,N,E,x,G,P,e,W,B,J,p,H,s,X,j,Y,K,q,$,Q,Z,tt,h,nt,ot,k,it,et,rt,ct,at,ut,st,ft,ht,lt,vt,mt,dt,pt,wt,gt,bt,_t,Ct,yt,w,g,kt,xt,m,d,r,c,a,St,Mt,Nt,jt,Ft,zt,Tt,f,b,Dt,Vt,It,_,C,y,F,Ot,Rt,Pt,Ut,Lt,At,Et,Gt,Wt,Bt,Jt,Ht,Xt,Yt,Kt,qt,$t,Qt,z,Zt,tn,nn,on,en,rn,cn,an,un,sn,fn,hn,ln,vn,T,mn,dn,pn,wn,gn,bn,_n,Cn,yn,kn,xn,n,Sn,Mn,n,n,n;function D(t,n){return new S.Point(t,n)}function V(t,n,o,i){return new S.Rect(t,n,o,i)}function I(t){return t.height}function O(t){return t.width}function Nn(t,n){var t=t.options;return!t.isProtected||t.protectionOptions.allowEditObjects||n&&!n.locked()}function jn(t,n){var t=t.options;return!t.isProtected||t.protectionOptions.allowEditObjects||n&&!n.lockText()}function Fn(t){var n=96,o=72,i=37.7952755905512;try{return-1!==t.indexOf("pt")?parseFloat(t.replace("pt","")):-1!==t.indexOf("in")?72*parseFloat(t.replace("in","")):-1!==t.indexOf("cm")?parseFloat(t.replace("cm",""))*i*72/96:parseFloat(t)}catch(t){return 0}}function zn(t){var n,o,i,e,r,c,a,u,s,f,h,n=t.itemsData,o=t.collapseIndexMap={},i=n.length,s=!1;if(0===t.direction){for(e=i-1;0<=e;e--)if((r=n[e])&&1===r.count&&r.info&&r.info.collapsed){for(c=r.index+r.count,a=e+1;a<i;a++)(u=n[a])&&u.info&&u.info.level>r.info.level&&u.index===c&&(c=u.index+u.count);for(f=r.index+1;f<c;f++)o[f]=!0}}else for(e=0;e<i;e++)if((r=n[e])&&1===r.count&&r.info&&r.info.collapsed){if((c=r.index-1)<0&&-1===r.info.level)break;for(h=e-1;0<=h;h--)(u=n[h])&&u.info&&u.info.level>r.info.level&&u.index+u.count-1===c&&(c=u.index-1);for(f=c+1;f<r.index;f++)o[f]=!0}}function Tn(t,n){var o;return n&&(n.items?n.items[t]&&n.items[t].viewCollapsed:n.itemsData&&(n.collapseIndexMap||zn(n),n.collapseIndexMap[t]))}function Dn(t,n,o,i){var t=t[n];return!t||i&&Tn(n,i)?void 0:!1===t.visible||t.size}function Vn(t,n,o,i){var t=t[n];return!t||i&&Tn(n,i)?void 0:!1===t.visible||t.size}function In(t,o,i){function n(t){var t,n,t,t=k(t,"ClientData");return(!t||"Note"===t.ObjectType)&&(n=parseInt(k(t,"Row").c_[0],10),t=parseInt(k(t,"Column").c_[0],10),n===o)&&t===i}return t.filter(n)[0]}function On(t,n){for(var o,i,e,r,c,a,o=t.defaults.rowHeight,i=0,e=0,c=t.getRowCount()||S.XmlConstants.Io;i<n&&e<c;)i+=r=t.Ut.getSize(!0,3,e)||o,e++;return 0<(a=i-n)?(e--,(a=r-a)<0&&(e+=1)):(a=n-i,e+=1),{row:e,rowOffset:a}}function Rn(t,n){for(var o,i,e,r,c,a,o=t.defaults.colWidth,i=0,e=0,c=t.getColumnCount()||S.XmlConstants.xo;i<n&&e<c;)i+=r=t.Ut.getSize(!1,3,e)||o,e++;return 0<(a=i-n)?(e--,(a=r-a)<0&&(e+=1)):(a=n-i,e+=1),{col:e,colOffset:a}}function Pn(t,n){if(!ot(n))return"double";if(t)switch(t.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function Un(t){var n,o;if(t)switch(t.toLowerCase()){case"solid":n="solid";break;case"dotted":n="1 1";break;case"dashed":n="dash";break;case"double":o="thinThin"}return{dashStyle:n,lineStyle:o}}function Ln(t,n){var o,i,e,r,r,e,t,i,o=n.location()||{x:9,y:-18},i=n.bZ,e=n.yZ,r=t.getSpan(i,e);return r&&(e=r.col+r.colCount-1),r=Z(t,0,e+1),e=nt(t,0,i),t=["position:absolute"],0<=(i=h(r+o.x+7))&&t.push("margin-left:"+i+"pt"),0<=(i=h(e+o.y+7))&&t.push("margin-top:"+i+"pt"),(i=h(n.width()-14)+"pt")&&t.push("width:"+i),(i=h(n.height()-14)+"pt")&&t.push("height:"+i),t.push("z-index:"+n.zIndex()),t.push("visibility:"+(1===n.displayMode()?"visible":"hidden")),t.join(";")}function An(t){var n=S.ColorHelper.convertColorToHex(t);return n&&"string"==typeof n&&2<n.length?"#"+n.substring(2).toLowerCase():t}function En(t,n){var t=(t||"").trim().split(n);return{key:t[0],value:t[1]}}function Gn(t,n,o,i,e){var r,c,a,u,s,f,h,t,r,c=this.Ut.pI;if(t&&c)for(u=c.all(),s=0;s<u.length;s++)f=(a=u[s]).bZ,h=a.yZ,f===n&&h===o||n<=f&&f<n+i&&o<=h&&h<o+e&&c.remove(f,h);(a=c.get(n,o))&&(t=c.mW(a))&&t.gW()}function Wn(){var t=this,n=t.pW&&t.pW();n&&n.bW(t)}function Bn(t,n,o){var i=this,i=i.pW&&i.pW();i&&i.yW(t,n,o)}function Jn(t,n){var o,i,n,o=-1,i=-1;n&&0<=n.rowViewportIndex&&0<=n.colViewportIndex&&(o=n.row,i=n.col),!t.parent||o<0||i<0||(n=t.Ut.pI.get(o,i),t.Ut.pI.wW(n))}function Hn(t,n){return t&&t.getRowHeight(n)}function Xn(t,n){return t&&t.getColumnWidth(n)}function Yn(t,n){return t&&t.getViewportLeftColumn(n)}function Kn(t,n){return t&&t.getViewportTopRow(n)}function qn(t,n,o,i){var e=this;arguments.length<=1?e.top=e.right=e.bottom=e.left=t||0:(e.top=t,e.right=n,e.bottom=o,e.left=i)}function $n(t){var n=this;n.bZ=-1,n.yZ=-1,n.text(t||""),n.zIndex(Ut)}function Qn(t,n,o){return gn.push(t),u.mt.p0(t,n,Zn(t),o)}function Zn(t){var e=t;return function(t,n){var o=this,i=o.Mf;i&&(i.Ut.MW({type:"property",comment:o,name:e,value:n,newValue:t}),i.hP()&&i.My<=0&&(i.CW(),"indicatorColor"!==e&&"indicatorSize"!==e||i.repaint(i.getCellRect(o.bZ,o.yZ))),i.ki(s.CommentChanged,{sheet:i,sheetName:i.name(),comment:o,propertyName:e}))}}function to(t,n,o,i,e){var n=V(n,o,i,i);n.cursor=e,t.push(n)}function no(t,n,o,i){(0,S.GC$)(t.SW).css(n,o),(0,S.GC$)(t.TW).css(n,i)}function oo(t,n){for(var o,i,e,o=t.length,i=0,e=0;e<o;e++)i+=K(t[e],n);return i}function io(t,n){t&&t.P_(n)}function eo(t){var t=t;if(t){if("number"==typeof t)return 400<t;if("string"==typeof t)return-1!==t.toLowerCase().indexOf("bold")||400<parseInt(t,10)}}function ro(t){var t=t;return t&&-1!==["italic","oblique"].indexOf(t.toLowerCase().trim())}function R(t,n){var o,i,i,o=this,i=t&&t.Mf;o.AW=1,o.IW=1,o.TZ=t,o.xW(),o._zoomFactor=i.zoom(),o.NW=n,o.li=n.kW,o.Hc(),i=o.DW(o._W(),t.width(),t.height()),o.EW=D(i.x,i.y),o.jW(),o.OW()}function o(t){var n=this;n.Mf=t,n.RW={BW:!1,x:0,y:0,LW:l,FW:-1},n.kW=l,n.PW=l,n.MZ=l,n.wB=[],n.GW=0,n.UW=[],n.HW(),n.zW(),n.cE={}}function co(t){var n=this;n.Mf=l,n.VW=!0,n.YW=n.ZW(),t.appendChild(n.YW)}function ao(t,n){if(t){var t=t.trim().toLowerCase();if(-1!==["false"].indexOf(t))return!1;if(-1!==["true"].indexOf(t))return!0}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.hW=t.Comment=t.Padding=t.DisplayMode=t.CommentState=void 0,U=P("Common"),u=P("Core"),S=P("Core"),L=u.Commands,l=null,v=void 0,A=Math.max,M=Math.min,N=Math.floor,E=Math.atan2,x=Math.abs,G="default",P=u.GC$.extend,e=u.mt.En,W=U.Common.Uf,B="comment",J=u.hi,p=u.Bf,H=u.mt,s=u.Events,X=H.vi,j=H.w0,Y=H.M0,K=H.bi,q=parseFloat,$=U.Common.zf,Q=u.Lf,Z=S.ExcelHelper.getActualColumnWidth,tt=S.ExcelHelper.pointToPixel,h=S.ExcelHelper.pixelToPoint,nt=S.ExcelHelper.getActualRowHeight,ot=U.Common.lt.ht,k=S.mt.xr,it=S.mt.go,et=S.mt.c1,rt=S.mt.n1,ct=S.mt.vo,at=S.mt.d1,ut=S.mt.h1,st=S.IndexHelper.nr,ft=S.Util.wr,ht=S.Util.ho,lt=7,vt=document,mt=window,dt=S.UsedRangeUtil.vh,pt=S.XFileConstants.Rr,wt=S.XFileConstants.Lr,gt=S.XFileConstants.ou,_t="mouse",Ct="move",yt="DOMMouseScroll",w="left",g="top",kt="right",xt="bottom",m="width",d="height",r="position",c="absolute",a="overflow",St="visible",Mt="z-index",Nt="hidden",jt="box-sizing",Ft="content-box",zt="padding",Tt="px",f="div",b=".comment",Dt=".floatBlockCanvas",Vt=".hostContainer",It=".lineCanvasContainer",_=".host",C=".editor",y="gc-spread-",F="className",Ot="cursor",Rt="text",Pt=701,Ut=898,Lt="gc-no-user-select",At=" ",Et="unselectable",Gt="on",Wt="comment_editor",Bt="comment_indicator",Jt="font-family",Ht="font-style",Xt="font-size",Yt="font-weight",Kt="color",qt="textArea",$t=".lineCanvas",Qt=".commentDocument",z="-resize",Zt="line-height",tn="background-color",nn="text-align",on="mousedown",en="mousemove",rn="mouseup",cn="mousewheel",an="text-decoration",un="black",(n=sn=sn||{})[n.none=0]="none",n[n.single=1]="single",n[n.double=2]="double",n[n.singleaccounting=3]="singleaccounting",n[n.doubleaccounting=4]="doubleaccounting",u.GC$.extend(S.Worksheet.prototype,{CW:function(t){var n,o,i,e,r,c,a,n=this,o=n.pW&&n.pW();if(n.hP()&&!n.D_)for(i=n.Fi(),e=void 0,r=0;r<=2;r++)for(c=0;c<=2;c++)!(e=i.c9(r,c))||0===O(e)||0===I(e)||t&&!e.intersectRect(t)||(a=n.Ut.pI,o&&a&&o.WW(a))}}),(fn=u.CellRange).prototype.comment=function(t){var n=this,o=n.sheet,i=n.row,e=n.col;return 0===arguments.length?o.Ut.pI.get(i,e):(t instanceof pn&&o.Ut.pI.WB(i,e,t),n)},hn=function(t,n){var o,n;!t.Ut.pI.Oy()&&(o=t.uw(),n=t.hitTest(n.pageX-o.left,n.pageY-o.top))&&Jn(t,n)},ln=function(t,o){o.bind(s.FloatingElementSelected+b,function(t,n){var n;"comments"!==n.type&&((n=o.Ut.pI).CZ(),n.wW(l))}),t.bind(on+b,function(t){o.Ut.pI.CZ(),hn(o,t)}).bind(cn+b,function(t){hn(o,t)}).bind(en+b,function(t){hn(o,t)})},vn=function(t,n){n.unbind(b),t.unbind(b)},s.CommentChanged="CommentChanged",(n=T=t.CommentState||(t.CommentState={}))[n.active=1]="active",n[n.edit=2]="edit",n[n.normal=3]="normal",(n=mn=t.DisplayMode||(t.DisplayMode={}))[n.alwaysShown=1]="alwaysShown",n[n.hoverShown=2]="hoverShown",qn.prototype.clone=function(){var t=this;return new qn(t.top,t.right,t.bottom,t.left)},qn.prototype.toString=function(){var n=this,o="",t;return[g,kt,xt,w].forEach(function(t){o+=n[t]+Tt+At}),o.trim()},dn=qn,t.Padding=dn,$n.prototype.clone=function(){var o,i,o=this,i=new $n;return gn.forEach(function(t){var n=o[t]();o[t].isDefault&&o[t].isDefault(n)||i[t](n&&n.clone?n.clone():n)}),i.Mf=o.Mf,i.bZ=o.bZ,i.yZ=o.yZ,i},$n.prototype.toJSON=function(){var o,i,o=this,i={rowIndex:o.bZ,colIndex:o.yZ};return gn.forEach(function(t){var n=o[t]();o[t].isDefault&&o[t].isDefault(n)||(i[t]=n&&n.clone?n.clone():n)}),i},$n.prototype.wh=function(t){var n,o,i,e,r,r,r,c,a,u,a,r,t,o,e,i,c,a,u,s,f,n=this,o=n.Mf,i={n_:"fill",color2:"#ffffe1"},e={n_:"stroke"},r=Un(n.borderStyle());return r.dashStyle?e.dashStyle=r.dashStyle:r.lineStyle&&(e.lineStyle=r.lineStyle),r=n.opacity(),ot(r)||1===r||(i.opacity=Math.floor(65535*r)+"f"),r=["Left","Center","Right"][n.horizontalAlign()||0]||"Left",!(c={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[n.bZ]},{n_:"Column",c_:[n.yZ]},{n_:"AutoFill",c_:["False"]}]})===n.dynamicMove()&&c.c_.push({n_:"MoveWithCells"}),!1===n.dynamicSize()&&c.c_.push({n_:"SizeWithCells"}),!1===n.locked()&&c.c_.push({n_:"Locked",c_:["False"]}),!1===n.lockText()&&c.c_.push({n_:"LockText",c_:["False"]}),"Left"!==r&&c.c_.push({n_:"TextHAlign",c_:[r]}),1===n.displayMode()&&c.c_.push({n_:"Visible"}),(a=n.padding())&&(u=[h(a.left)+"pt",h(a.top)+"pt",h(a.right)+"pt",h(a.bottom)+"pt"].join(",")),a={n_:"textbox",style:"mso-direction-alt:auto"+(n.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+r}]},r={n_:"shape",id:"_x0000_s"+t,type:"#_x0000_t202",style:Ln(o,n),fillcolor:An(n.backColor()),strokecolor:An(n.borderColor()),strokeweight:h(n.borderWidth()||1)+"pt",c_:[e,i,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},a,c]},u?a.inset=u:r["o:insetmode"]="auto",t=[],eo(n.fontWeight())&&t.push({n_:"b"}),ro(n.fontStyle())&&t.push({n_:"i"}),1&(o=n.textDecoration())?t.push({n_:"u"}):8&o?t.push({n_:"u",val:"double"}):2&o&&t.push({n_:"strike"}),(e=-1!==(e=n.fontSize()||"9pt").indexOf("px")?h(parseFloat(e)):e.replace("pt",""))&&t.push({n_:"sz",val:e}),(i=n.foreColor())?(i=ut(i),t.push(i)):t.push({n_:"color",indexed:"81"}),n.fontFamily()&&t.push({n_:"rFont",val:n.fontFamily()}),t.push({n_:"family",val:"2"}),c={n_:"t"},a=n.text(),(s=(u=ot(a)?"":a).length!==u.trim().length)&&(c["xml:space"]="preserve"),c.c_=[ct(u)],{vmlDrawingData:r,commentData:f={n_:"comment",ref:st(n.yZ)+(n.bZ+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:t},c]}]}]}}},$n.prototype.fromJSON=function(o,t){var i;o&&(i=this,gn.forEach(function(t){var n=o[t];n!==v&&("location"===t?i.location(new S.Point(n.x,n.y),!1):"padding"===t?i.padding(new dn(n.top,n.right,n.bottom,n.left),!1):i[t](n,!1))}),o.rowIndex!==v&&(i.bZ=o.rowIndex),o.colIndex!==v)&&(i.yZ=o.colIndex)},$n.prototype.yh=function(f,t,h,l,v){var m,d,p,n,t,w,g,b,_,C,y;t&&(d=Z(f,0,(m=this).yZ+1),p=nt(f,0,m.bZ),t=(n=k(t,"text")).c_)&&(w=1===t.length,g=[],t.forEach(function(t){var n,o,i,i,e,e,r,e,r,c,i,e,a,n,r,u,s,t,i,e,r,n,o,r,n=k(t,"rPr");n&&w&&((o=(i=k(n,"rFont"))?i.val:o)&&m.fontFamily(o),i=0,(e=k(n,"u"))&&(r=1,i|=2===(r=(e=e.val)?sn[e]:r)?8:1),k(n,"strike")&&(i|=2),i&&m.textDecoration(i),k(n,"b")&&m.fontWeight("bold"),k(n,"i")&&m.fontStyle("italic"),(o=k(n,"color"))&&(e=at(o),m.foreColor(e)),o=k(n,"sz").val)&&m.fontSize(o+"pt"),(r=k(t,"t"))?r.c_&&g.push(r.c_[0]):"t"===t.n_&&t.c_&&g.push(t.c_[0]),(o=h.fillcolor)&&m.backColor(o.split(" ")[0]),(o=h.strokecolor)&&m.borderColor(o.split(" ")[0]),(o=h.strokeweight)&&m.borderWidth(tt(parseFloat(o.replace("pt","")))),(o=h.style)&&(c=o.split(";")).forEach(function(t){var t=En(t,":"),n=t.key,o=t.value;if(!ot(o))switch(n){case"margin-left":b=Fn(o);break;case"margin-top":_=Fn(o);break;case"width":C=o;break;case"height":y=o;break;case"z-index":m.zIndex(parseInt(o,10))}}),(o=k(h,"fill"))&&(i=o.opacity)&&("f"===i.substr(-1)?m.opacity(parseFloat(i.substr(0,i.length-1))/65535):m.opacity(parseFloat(i))),(o=k(h,"stroke"))&&m.borderStyle(Pn(o.dashStyle,o.lineStyle)),(o=k(h,"textbox"))&&((e=o.style)&&-1!==e.indexOf("mso-fit-shape-to-text:t")&&m.autoSize(!0),a=[0,0,0,0],o.inset&&o.inset.trim().split(",").forEach(function(t,n){var t=t||["0.1in","0.05in"][n%2];a[n]=tt(parseFloat(t.replace("pt","")))}),m.padding(new dn(a[1],a[2],a[3],a[0]))),n=k(h,"ClientData"),k(n,"SizeWithCells")&&m.dynamicSize(!1),k(n,"MoveWithCells")&&m.dynamicMove(!1),(o=k(n,"Locked"))&&m.locked(ao(o.c_[0],!0)),(o=k(n,"LockText"))&&m.lockText(ao(o.c_[0],!0)),(o=et(k(n,"TextHAlign")))&&-1!==(r=["left","center","right"].indexOf(o.toLowerCase()))&&m.horizontalAlign(r),k(n,"Visible")&&m.displayMode(1),(o=et(k(n,"Anchor")))?(t=o.split(",").map(function(t){return parseInt(t,10)}),i=Z(f,0,t[0])+t[1]-7,e=nt(f,0,t[2])+t[3]-7,r=Z(f,0,t[4])+t[5]+7,n=nt(f,0,t[6])+t[7]+7,m.location(new S.Point(i-d,e-p),!1),m.width(r-i),m.height(n-e),t&&(u=t[6]+1,s=t[4]+1)):(o=tt(b)-d-7,r=tt(_)-p-7,m.location(new S.Point(o,r)),m.width(tt(parseFloat(C.replace("pt","")))+14),m.height(tt(parseFloat(y.replace("pt","")))+14),u=On(f,m.location().y+p+m.height()).row+1,s=Rn(f,m.location().x+d+m.width()).col+1),S.Util.Co(l)&&S.Util.So(f,u,s,v)}),m.text(rt(g.join(""))))},pn=$n,t.Comment=pn,wn={},gn=[],(bn=[[Rt,""],["location",D(9,-18)],[m,160,function(t){return 0<t}],[d,100,function(t){return 0<t}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(t){return/^\d+pt$/.test(t)&&0<parseInt(t,10)}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(t){return"boolean"==typeof t&&this.dynamicMove()}],["dynamicMove",!0,function(t){return t||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(t){return 0<=t&&t<=1}],["borderWidth",1,function(t){return 1<=t}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(t){return"string"==typeof t}],["indicatorSize",6,function(t){return"number"==typeof t&&1<t}]]).forEach(function(t){wn[t[0]]=Qn(t[0],t[1],t[2])}),_n=wn.zIndex,wn.zIndex=function(){var t,n,o,t=_n.apply(this,arguments);return 0===arguments.length&&t===Ut&&(n=this.Mf.comments.GW,o=this.lp,t=Ut-(n-1-o)),t},Cn=wn.commentState,wn.commentState=function(t,n){var o,i,o=Cn.apply(this,arguments);return n&&(i=this.Mf).Rj("comment",null,null,S.SheetArea.viewport,this,this),o},P(pn.prototype,wn),R.prototype.Hc=function(){var t=this,n=t.TZ.Mf;t.QW=y+"floatBlockCanvas",t.KW=y+"host-container",t.JW=y+"host",t.XW=y+"lineCanvas",t.qW=e(f),(0,S.GC$)(t.qW).addClass(y+"floatBlockCanvas-container").css([r,a,jt],[c,Nt,Ft]),t.SW=e("canvas"),p.Wl(t.SW,null,n),(0,S.GC$)(t.SW).addClass(t.QW).css([w,g,r],[0,0,c]),t.TW=e(f),(0,S.GC$)(t.TW).addClass(t.KW).css([r,jt,a],[c,Ft,Nt]),t.Ti=e(f),(0,S.GC$)(t.Ti).addClass(t.JW+At+Lt).css([w,g,m,d,r,"word-wrap","word-break","white-space",a,jt,Et,Zt],[0,0,"100%","100%",c,"break-word","normal","pre-wrap",Nt,Ft,Gt,"normal"]),(0,S.GC$)(t.TW).append(t.Ti),(0,S.GC$)(t.qW).append(t.SW).append(t.TW),t.$W=e(f),(0,S.GC$)(t.$W).addClass(y+"lineCanvas-container").css([r,a,"pointer-events"],[c,Nt,"none"]),t.tQ=e("canvas"),p.Wl(t.tQ,l,n),(0,S.GC$)(t.tQ).addClass(t.XW).css([w,kt,r],[0,0,c]),(0,S.GC$)(t.$W).append(t.tQ),t.nQ=[],t.eQ=7,t.iQ=!1,t.Eb=!1,R.et(t,"init",[t.SW,t.Ti])},R.prototype.rQ=function(){var t=this,n=t.TZ.Mf;!t.YW&&n&&n.pW&&(t.YW=n.pW().YW),t.YW&&(t.YW.appendChild(t.$W),t.oQ(),t.YW.appendChild(t.qW),t.aQ(t.SW,Dt),t.aQ(t.TW,Vt),t.uQ()?t.sQ():t.cQ(),t.EW=t._W(),t.fQ())},R.prototype.lQ=function(){var t=this;t.qW&&t.$W&&t.YW&&(t.hQ(t.SW,Dt),t.hQ(t.TW,Vt),t.dQ(),t.vQ(),t.mQ(),(0,S.GC$)(t.qW).remove(),(0,S.GC$)(t.$W).remove())},R.prototype.gQ=function(){return this.TZ.width()*this._zoomFactor},R.prototype.pQ=function(){return this.TZ.height()*this._zoomFactor},R.prototype._W=function(){var t=this,n=t.TZ;return n!==t.NW.PW||n.commentState()!==T.normal||n.ignoreDefaultLocation()?t.bQ(n.location()):(n.yQ=t.bQ(D(9,-18)),n.yQ)},R.prototype.bQ=function(t){var n,o,i,e,r,o,n,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r=D(0,0);return i&&(o=n.wQ(i,o.bZ,o.yZ,n.AW,n.IW)).x!==l&&void 0!==o.x&&o.y!==l&&void 0!==o.y&&O(o)&&I(o)&&(n=i.Fi(),r.x=o.x+O(o)+t.x*e-n.XC,r.y=o.y+t.y*e-n.qC),r},R.prototype.wQ=function(t,n,o,i,e){var r,c,a,u,s,f,h,r,u,h,s,r=this,c=V(0,0,0,0),a=t.Fi(),u=Kn(t,i),s=Yn(t,e),r=r._zoomFactor,f=j(t,s,o,!1,v,v,!0);return s===t.Ab&&(f+=t.my),h=j(t,u,n,!0,v,v,!0),u===t.Tb&&(h+=t.ly),c.y=u<=n?h:-h,c.x=s<=o?f:-f,(u=t.getSpan(n,o))!==v&&u!==l?(c.height=0===i&&Y(t,n,n+u.rowCount,!0)||j(t,n,n+u.rowCount,!0),c.width=0===e&&Y(t,o,o+u.colCount,!1)||j(t,o,o+u.colCount,!1)):(c[d]=Hn(t,n)*r,c[m]=Xn(t,o)*r),c.x+=a.XC,c.y+=a.qC,h=a.F6,s=a.L6,1===i?c.y+=s:2===i&&(c.y+=s+t.Sy(a)),1===e?c.x+=h:2===e&&(c.x+=h+t.Gy(a)),c},R.prototype.MQ=function(t){var n,o,i,e,r,o,n,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r=D(0,0);return i&&(o=n.wQ(i,o.bZ,o.yZ,n.AW,n.IW)).x!==l&&o.x!==v&&o.y!==l&&o.y!==v&&O(o)&&I(o)&&(n=i.Fi(),r.x=(t.x-(o.x+O(o)-n.XC))/e,r.y=(t.y-(o.y-n.qC))/e),r},R.prototype.CQ=function(){var t=this;t.EW=t._W(),t.jW(),t.OW(),t.fQ()},R.prototype.SQ=function(){var t,n,t=this,n=t.DW(t._W(),t.TZ.width(),t.TZ.height());t.EW=D(n.x,n.y),t.OW()},R.prototype.TQ=function(){var t,n,t,t=this,n=t.TZ;n.dynamicMove()?n.dynamicSize()?t.AQ():(t.IQ(),t.OW()):(t.jW(),t.OW(),t=t.MQ(t.EW===n.yQ?t._W():t.EW),n.location(t))},R.prototype.gW=function(){var t=this;t.EW=t._W(),t.fQ()},R.prototype.IQ=function(){var t,n,o,t=this,n=t.TZ,o=t.xQ();t.EW=o,n.location(t.MQ(o),!1),t.fQ()},R.prototype.xQ=function(){for(var t,n,o,n,i,e,r,c,a,i,u,s,a,i,t=this,n=t.TZ,o=n&&n.Mf,n=t._zoomFactor,i=Yn(o,t.IW),e=Kn(o,t.AW),r=0,c=0;c<t.IW;c++)r+=o.getViewportWidth(c);for(a=j(o,i,t.NQ,!1,v,v,!0),i<t.NQ?r+=a:r-=a,(i=Xn(o,t.NQ))<t.kQ&&(t.kQ=i),r+=t.kQ*n,s=u=0;s<t.IW;s++)u+=o.getViewportHeight(s);return a=j(o,e,t.DQ,!0,v,v,!0),e<t.DQ?u+=a:u-=a,(i=Hn(o,t.DQ))<t._Q&&(t._Q=i),D(r,u+=t._Q*n)},R.prototype.EQ=function(){var t,n,o,i,e,e,e,r,r,t=this,n=t.TZ,o=n&&n.Mf,i=j(o,t.NQ,t.jQ,!1,v,!0),e=Xn(o,t.NQ);e<t.kQ&&(t.kQ=e),(e=Xn(o,t.jQ))<t.OQ&&(t.OQ=e),i=i-t.kQ+t.OQ,e=j(o,t.DQ,t.RQ,!0,v,!0),(r=Hn(o,t.DQ))<t._Q&&(t._Q=r),(r=Hn(o,t.RQ))<t.BQ&&(t.BQ=r),e=e-t._Q+t.BQ,n.width(i),n.height(e)},R.prototype.AQ=function(){var t=this;t.EQ(),t.IQ()},R.prototype.jW=function(){var t,n,o,i,n,e,r,c,a,u,s,f,h,l,v,t=this,n=t.TZ,o=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=Yn(o,t.IW),e=Kn(o,t.AW),0===t.IW?r=t.EW.x:1===t.IW?r=t.EW.x-o.getViewportWidth(0):2===t.IW&&(r=t.EW.x-(o.getViewportWidth(0)+o.getViewportWidth(1))),0===t.AW?c=t.EW.y:1===t.AW?c=t.EW.y-o.getViewportHeight(0):2===t.AW&&(c=t.EW.y-(o.getViewportHeight(0)+o.getViewportHeight(1))),a=D(r,c),s=u=0,f=n;f<o.getColumnCount();f++){if(!(u+(h=Xn(o,f)*i)<a.x)){t.NQ=f,t.kQ=(a.x-u)/i;break}u+=h}for(l=e;l<o.getRowCount();l++){if(!(s+(v=Hn(o,l)*i)<a.y)){t.DQ=l,t._Q=(a.y-s)/i;break}s+=v}}},R.prototype.OW=function(){var t,n,o,i,n,e,r,c,a,u,s,f,h,l,v,t=this,n=t.TZ,o=n&&n.Mf,i=t._zoomFactor;if(t.EW){for(n=Yn(o,t.IW),e=Kn(o,t.AW),0===t.IW?r=t.EW.x+t.gQ():1===t.IW?r=t.EW.x+t.gQ()-o.getViewportWidth(0):2===t.IW&&(r=t.EW.x+t.gQ()-(o.getViewportWidth(0)+o.getViewportWidth(1))),0===t.AW?c=t.EW.y+t.pQ():1===t.AW?c=t.EW.y+t.pQ()-o.getViewportHeight(0):2===t.AW&&(c=t.EW.y+t.pQ()-(o.getViewportHeight(0)+o.getViewportHeight(1))),a=D(r,c),s=u=0,f=n;f<o.getColumnCount();f++){if(!(u+(h=Xn(o,f)*i)<a.x)){t.jQ=f,t.OQ=(a.x-u)/i;break}u+=h}for(l=e;l<o.getRowCount();l++){if(!(s+(v=Hn(o,l)*i)<a.y)){t.RQ=l,t.BQ=(a.y-s)/i;break}s+=v}}},R.prototype.JO=function(t,n){var o=this,i=o.TZ;t<=o.DQ?i.dynamicMove()&&(o.DQ+=n,o.RQ+=n):t>o.DQ&&t<=o.RQ&&i.dynamicSize()&&(o.RQ+=n),o.AQ()},R.prototype.qO=function(t,n){var o=this,i=o.TZ;t<=o.NQ?i.dynamicMove()&&(o.NQ+=n,o.jQ+=n):t>o.NQ&&t<=o.jQ&&i.dynamicSize()&&(o.jQ+=n),o.AQ()},R.prototype.xP=function(t,n){var o,i,e,o=this,i=o.TZ,e=t+n-1;t<o.DQ?e<o.DQ?i.dynamicMove()&&(o.DQ-=n,o.RQ-=n):e<o.RQ&&i.dynamicMove()&&(i.dynamicSize()?o.RQ-=n:o.RQ-=o.DQ-t+1,o.DQ=t,o._Q=0):t<=o.RQ&&(e<o.RQ?i.dynamicSize()&&(o.RQ-=n):i.dynamicSize()&&(o.RQ=t,o.BQ=0)),o.AQ()},R.prototype.NP=function(t,n){var o,i,e,o=this,i=o.TZ,e=t+n-1;t<o.NQ?e<o.NQ?i.dynamicMove()&&(o.NQ-=n,o.jQ-=n):e<o.jQ&&i.dynamicMove()&&(i.dynamicSize()?o.jQ-=n:o.jQ-=o.NQ-t+1,o.NQ=t,o.kQ=0):t<=o.jQ&&(e<o.jQ?i.dynamicSize()&&(o.jQ-=n):i.dynamicSize()&&(o.jQ=t,o.OQ=0)),o.AQ()},R.prototype.fQ=function(){var t,n,o,o,t=this,n=t.TZ,o=n.Mf;t.LQ()&&(o=o.zoom(),t._zoomFactor!==o?(t._zoomFactor=o,t.EW=t.xQ()):(t._zoomFactor=o,t.EW!==n.yQ||1!==n.displayMode()&&2!==n.commentState()||(t.EW=t._W())),t.xW(),t.FQ(),t.PQ(),t.GQ(),t.UQ(),H.Tt.chrome)&&t.HQ()},R.prototype.FQ=function(){var t,n,n,t=this,n=t.TZ.Mf,n=n.parent&&n.parent.options.useTouchLayout;t.eQ=n?11:7},R.prototype.xW=function(){var t=this,n=t.TZ,o=n.Mf;t.AW=o.C0(n.bZ),t.IW=o.S0(n.yZ)},R.prototype.PQ=function(){var t,n,o,t=this,n,o=2===t.TZ.commentState()?t.li:t.Ti;t.zQ(),t.VQ(o),t.YQ(o),t.ZQ(o),t.WQ()},R.prototype.YQ=function(t){var n=this,o=n.TZ;t===n.Ti&&(t.innerHTML=$.j0(o.text()))},R.prototype.ZQ=function(t,n){var o,i,e,r,e,c,r,a,e,u,s,f,h,l,u,v,m,d,u,m,v,f,d,s,h,a,e,n,f,m,v,u,s,c,o=this,i=o.TZ,e=n||2===i.commentState()||1===i.displayMode()?o._W():o.EW,r=o._zoomFactor;e&&(e=o.Eb?o.DW(e,i.width(),i.height()):o.DW(e),o.QQ(e),c=O(e)*r,r=I(e)*r,u=(a=e.x)+c,s=(e=e.y)+r,f=o.eQ,h=o.KQ(o.AW,o.IW),l=2*(f+i.borderWidth()),a<h.x?(no(o,w,a-h.x,a+f-h.x),c+=a-h.x,a=h.x):(no(o,w,0,f),u>h.x+O(h)&&(c+=h.x+O(h)-1-u)),(c=M(O(h)-1,c))<0&&(u=i.Mf,v=i.yZ,m=u.r6(u.getColumnCount()-u.lL),d=u.getViewportRightColumn(1),!1===u.Vy)&&v===m&&v===d&&(a=h.x+O(h)-1-i.width(),c=i.width()),e<h.y?(no(o,g,e-h.y,e+f-h.y),r+=e-h.y,e=h.y):(no(o,g,0,f),s>h.y+I(h)&&(r+=h.y+I(h)-1-s)),r=M(I(h)-1,r),(u=(0,S.GC$)(o.qW)).css({left:a,top:e}),m=u.height(),v=u.width(),d=!1,(f=o.JQ(c,r))&&(c=f.adjustedWidth,r=f.adjustedHeight,d=!n&&f.needReposition),r<=0&&m<=0||c<=0&&v<=0||((1<x(r-m)||1<x(c-v))&&(u.css({width:c,height:r}),p.$l(o.SW,c,r)),h=(s=(0,S.GC$)(o.TW)).width(),a=s.height(),e=A(0,c-l),n=A(0,r-l),(1<x(a-n)||1<x(h-e))&&(0,S.GC$)(o.TW).css({width:e,height:n}),m=(f=(0,S.GC$)(t)).width(),v=f.height(),u=e,s=n,(c=i.padding())&&(u-=Math.ceil(q(c.left)+q(c.right)),s-=Math.ceil(q(c.top)+q(c.bottom))),(1<x(v-s)||1<x(m-u))&&(0,S.GC$)(t).css({width:A(0,u),height:A(0,s)}),d&&o.ZQ(t,!0)))},R.prototype.QQ=function(t){var n,o,i,i,e,r,c,n=this,o=n.TZ,i=n.EW;t.x===i.x&&t.y===i.y&&O(t)===o.width()&&I(t)===o.height()||(i=n.MQ(D(t.x,t.y)),e=O(t),r=I(t),c=o.location(),i.x===c.x&&i.y===c.y||o.location(i,!1),e!==o.width()&&o.width(e,!1),r!==o.height()&&o.height(r,!1),o.dynamicMove()&&(n.EW=D(t.x,t.y)))},R.prototype.WQ=function(){var t=this,n=t.TZ,o;Nn(n&&n.Mf)?(t.aQ(t.SW,Dt),t.aQ(t.TW,Vt),t.oQ(),t.cQ(),t.sQ()):(n.locked()?(t.hQ(t.SW,Dt),t.XQ(t.SW),t.hQ(t.TW,Vt),t.XQ(t.TW),t.SW.style.cursor=G,t.TW.style.cursor=G):(t.aQ(t.SW,Dt),t.aQ(t.TW,Vt)),n.lockText()?(t.dQ(),t.XQ(t.Ti),t.mQ(),t.XQ(t.li),!n.locked()&&n.commentState()===T.active||n.commentState(3),t.Ti.style.cursor=n.locked()?G:Ct):(t.cQ(),t.sQ()),t.oQ())},R.prototype.zQ=function(){var t=this,n=t.TZ,o=t.NW,i=n&&n.Mf;switch(n.commentState()){case T.active:o.qQ(n),t.uQ()&&t.$Q(),0<i.getSelections().length&&i.e4(),J.F1(i);break;case T.edit:o.qQ(n),t.uQ()||t.tK(),0<i.getSelections().length&&i.e4(),J.F1(l);break;case T.normal:n===o.pZ()&&(o.CZ(),0===i.getSelections().length)&&i.cR()}},R.prototype.VQ=function(t){var n,o,i,e,i;function r(t,n,o){var o,i;return o?((i=(o=U.Common.ft)._(t)).a=n,o.j(i)):t}o=(n=this).TZ,(i=(0,S.GC$)(t)).css("font-family",o.fontFamily()).css("font-style",o.fontStyle()).css("font-size",parseInt(o.fontSize(),10)*n._zoomFactor+"pt").css("font-weight",o.fontWeight()),i.css("text-decoration",u.W.A5(o.textDecoration())),i.css("text-align",(e={0:"left",1:"center",2:"right",3:"general"})[o.horizontalAlign()]),o.padding()?i.css(zt,o.padding().toString()):i.css(zt,"0px"),i.css("background-color",r(o.backColor(),o.opacity(),t===n.Ti)).css("color",o.foreColor()),(0,S.GC$)(n.TW).css("border-width",o.borderWidth()).css("border-style",o.borderStyle()).css("border-color",o.borderColor()),i=n.NW.nK(o),(0,S.GC$)(n.$W).css(Mt,i),(0,S.GC$)(n.qW).css(Mt,i)},R.prototype.HQ=function(){var t,n,o,n,i,n,t,n=this.TZ.Mf,o=(0,S.GC$)(this.TW);n&&o&&(i=.5<=(n=n.uw()).left-N(n.left)?.5:0,n=.5<=n.top-N(n.top)?.5:0,o.css(w,q(o.css(w))+i),o.css(g,q(o.css(g))+n))},R.prototype.GQ=function(){var t,n,o,n,o,i,e,n,r,o,c,r,o,c,a,u,o,s,f,h,t=this,n=t.TZ,o=n.Mf,n=t.wQ(o,n.bZ,n.yZ,t.AW,t.IW),o=o.Fi(),i,e,n=D(n.x+O(n)-o.XC,n.y-o.qC),o=(0,S.GC$)(t.qW).position(),c=(0,S.GC$)(t.TW).position(),r=(0,S.GC$)(t.TW),r=o.left+c.left>n.x?D(o.left+c.left,o.top+c.top):o.top+c.top+r.height()<n.y?D(o.left+c.left+r.width(),o.top+c.top+r.height()):D(o.left+c.left+r.width(),o.top+c.top),o=t.eQ,c=x(n.x-r.x)+2*o,a=x(n.y-r.y)+2*o,u=M(n.x,r.x)-o,o=M(n.y,r.y)-o,s=u+c,f=o+a,h=t.KQ(t.AW,t.IW);u<h.x&&(c-=h.x-u,u=h.x),s>h.x+O(h)&&(c-=s-(h.x+O(h))),c=M(O(h),c),o<h.y&&(a-=h.y-o,o=h.y),f>h.y+I(h)&&(a-=f-(h.y+I(h))),a=M(I(h),a),(0,S.GC$)(t.$W).css(w,u).css(g,o).css(m,c).css(d,a),p.$l(t.tQ,c,a),n.x=n.x-u,n.y=n.y-o,r.x=r.x-u,r.y=r.y-o,t.eK(n,r)},R.prototype.eK=function(t,n){var o,i,e,o,o=this;o.iK||(o.iK=o.tQ.getContext("2d")),i=o.iK,e=o.TZ.borderColor(),i.strokeStyle=e,i.clearRect(0,0,p.Xl(o.tQ),p.ql(o.tQ)),i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(n.x,n.y),i.stroke(),i.save(),Q.Yl(i,t.x,t.y),i.fillStyle=e,i.beginPath(),o=E(n.y-t.y,n.x-t.x),i.rotate(o),i.moveTo(0,0),i.lineTo(7,-4),i.lineTo(7,4),i.lineTo(0,0),i.fill(),Q.Yl(i,-t.x,-t.y),i.closePath(),i.restore()},R.prototype.UQ=function(){var t,n,o,i,e,r,c,a,u,s,t=this,n=t.TZ,o=n.Mf;t.rK=t.TZ.commentState(),t.oK||(t.oK=t.SW.getContext("2d")),i=t.oK,e=p.Xl(t.SW),r=p.ql(t.SW),c=(0,S.GC$)(t.TW).outerWidth(),a=(0,S.GC$)(t.TW).outerHeight(),u=t.eQ,i.clearRect(0,0,e,r),t.TZ.showShadow()&&(t.aK(i,e,r),i.clearRect(u,u,e-(s=2*(u+2)),r-s),t.uK(i,u,c,a)),Nn(o,n)&&t.sK(i,u,e,r,c,a),i.restore()},R.prototype.uK=function(t,n,o,i){t.save(),t.fillStyle=un,t.fillRect(n+2,i+n,o,2),t.fillRect(o+n,n+2,2,i),t.restore()},R.prototype.aK=function(t,n,o){var i,e,r;switch(t.save(),t.strokeStyle=un,this.rK){case T.active:for(t.beginPath(),e=0;e<o;e++)for(i=e%2==0?1:3;i<n;)t.moveTo(i,e),t.lineTo(i+1,e+1),i+=4;t.stroke(),t.closePath();break;case T.edit:for(t.beginPath(),e=i=0,r=4;i<n+o;)t.moveTo(i+4,0),t.lineTo(0,e+4),i+=4,e+=4;t.stroke(),t.closePath()}t.restore()},R.prototype.sK=function(r,t,n,o,i,e){var c=this,a=c.nQ;c.rK!==T.active&&c.rK!==T.edit||(a.splice(0,a.length),to(a,0,0,t,"nw"+z),to(a,n-t,0,t,"ne"+z),to(a,0,o-t,t,"sw"+z),to(a,n-t,o-t,t,"se"+z),3*t<=e?(to(a,0,N(o/2-t/2),t,"w"+z),to(a,n-t,N(o/2-t/2),t,"e"+z)):(a.push(l),a.push(l)),3*t<=i?(to(a,N(n/2-t/2),0,t,"n"+z),to(a,N(n/2-t/2),o-t,t,"s"+z)):(a.push(l),a.push(l)),r.restore(),r.fillStyle="white",r.strokeStyle="#939393",r.lineWidth=1,Q.Yl(r,.5,.5),S.GC$.each(a,function(t,n){var o,i,e,n;n&&(o=n.x,i=n.y,e=O(n),n=I(n),r.beginPath(),r.fillRect(o,i,e-1,n-1),r.strokeRect(o,i,e-1,n-1),r.stroke(),r.closePath())}),Q.Yl(r,-.5,-.5))},R.prototype.cK=function(){var n,t,o,i,o,n=this,t=n.KQ(n.AW,n.IW);n.eW?(0,S.GC$)(n.eW).remove():n.eW=e(f),o=(0,S.GC$)(n.eW),i=(0,S.GC$)(n.TW),o.addClass("gc-spread-moveResizeContainer").css([r,w,g,m,d,"border"],[c,n.EW.x+n.eQ-t.x,n.EW.y+n.eQ-t.y,i.outerWidth()-2,i.outerHeight()-2,"gray solid thin"]),n.fK?(0,S.GC$)(n.fK).remove():n.fK=e(f),(o=(0,S.GC$)(n.fK)).bind("mousemove",function(t){n.pg(t)}).bind(rn,function(t){n.bg(t)}).css([r,a,g,w,m,d,"background",Mt],[c,Nt,t.y,t.x,O(t),I(t),"rgba(255,255,255,0.01)",901]),o.append(n.eW),n.YW&&n.YW.appendChild(n.fK)},R.prototype.lK=function(t){var n,o,i,e,r,c,a,t,c,u,s,u,f,f,n=this,o=n.eQ,i=n._zoomFactor,e,r=n.NW.RW;r.BW&&(c=n.hK(),a=t.pageX/i-r.x+c.x,t=t.pageY/i-r.y+c.y,0===a&&0===t||(c=n.KQ(n.AW,n.IW),s=(0,S.GC$)(n.eW),r.FW<0?(u=r.LW.x+a,f=r.LW.y+t,u=n.bQ(D(u,f)),s.css([w,g],[u.x+o-c.x,u.y+o-c.y])):(f=n.dK(a,t,r.FW),u=n.bQ(D(f.x,f.y)),s.css([w,g,m,d],[u.x+o-c.x,u.y+o-c.y,O(f)*i-2*o-2,I(f)*i-2*o-2]))))},R.prototype.tK=function(){var t,n,o,t=this,n=t.TZ;t.uQ()||(o=t.NW.kW,(0,S.GC$)(t.Ti).remove(),t.dQ(),(0,S.GC$)(o).remove(),(0,S.GC$)(t.TW).append(o),t.vK(o),t.ZQ(o),(0,S.GC$)(o).focus(),o.selectionStart=o.value.length,t.sQ(),2!==n.commentState()&&n.commentState(2,!0))},R.prototype.$Q=function(){var t,n,o,i,t=this,n=t.TZ,o=n.Mf;t.uQ()&&(i=t.NW.kW,t.mQ(),(0,S.GC$)(i).remove(),(0,S.GC$)(t.TW).append(t.Ti),t.vK(t.Ti),t.cQ(),R.et(t,"detachEditor",t.Ti),2===n.commentState()&&n.commentState(3),(0,S.GC$)(i).val()!==n.text())&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,S.GC$)(i).val(),propertyName:Rt})},R.prototype.mK=function(t){var n,o,i,n,o=this.TZ.Mf,i=-1;return 0===t||2===t?i=o.getViewportHeight(t):1===t&&(i=j(o,o.getViewportBottomRow(0)+1,Kn(o,2)+1,!0)),i},R.prototype.gK=function(t){var n,o,i,n,o=this.TZ.Mf,i=-1;return 0===t||2===t?i=o.getViewportWidth(t):1===t&&(i=j(o,o.getViewportRightColumn(0)+1,Yn(o,2)+1,!1)),i},R.prototype.KQ=function(t,n){var o,i,e,r,c,i,o,i=this.TZ.Mf,e=i.Fi(),r=e.c9(t,n),c=i.Gy(e),i=i.Sy(e);return 0===t&&0===n||0===t&&2===n||2===t&&0===n||2===t&&2===n?r=V(0,0,e.F6+c+e.zy,e.L6+i+e.Iy):0===t&&1===n||2===t&&1===n?r=V(e.F6,0,c,e.L6+i+e.Iy):1===t&&0===n||1===t&&2===n?r=V(0,e.L6,e.F6+c+e.zy,i):1===t&&1===n&&(r=V(e.F6,e.L6,c,i)),r},R.prototype.vK=function(t){var n=this,o=n.TZ,i=(0,S.GC$)(t);t!==n.li&&t!==n.Ti||(t===n.li?t.value=o.text():t.innerHTML=$.j0(o.text()),i.css([Jt,Ht,Xt,Yt,Kt,tn,nn,an],[o.fontFamily(),o.fontStyle(),o.fontSize(),o.fontWeight(),o.foreColor(),o.backColor(),o.horizontalAlign(),o.textDecoration()]),o.padding()?i.css(zt,o.padding().toString()):i.css(zt,"0px"))},R.prototype.LQ=function(){return!(!this.qW||!this.qW.parentNode)},R.prototype.uQ=function(){var t=this;return t.LQ()&&t.TZ===t.NW.pZ()&&0<(0,S.GC$)(t.TW).find(qt).length},R.prototype.pK=function(){var t,n,o,n,t=this,n=t.TZ.Mf,o=l;return t.LQ()&&(n=n.Fi(),o=V(t.EW.x+n.BA+n.XC,t.EW.y+n.LA+n.qC,t.gQ(),t.pQ())),o},R.prototype.bK=function(){var t,n,o,i,e,r,c,a,t,u,t=this,n=t.TZ,o=t._zoomFactor;return t.LQ()&&(i=t.pK())?(a=c=r=e=void 0,t=(t.eQ+n.borderWidth())*o,V(e=i.x+t,r=i.y+t,c=O(i)-2*t,a=I(i)-2*t)):l},R.prototype.yK=function(t){var n,o,i,e,r,c,a,r,n=this,o=n.TZ,i=o.Mf,e=t.target,r=n.NW.RW,c=e.style,a=G;r.BW?e[F]!==n.JW&&e[F]!==n.QW&&e[F]!==n.XW&&e[F]!==y+"floatPanel"||(a=0<=r.FW?"crosshair":Ct):e[F]===n.JW?!Nn(i)&&o.lockText()?o.locked()||(a=Ct):a=Rt:e[F]!==n.QW&&e[F]!==n.KW||Nn(i,o)&&(a=0<=(r=n.wK(t))&&r<n.nQ.length?n.nQ[r].cursor:Ct),c[Ot]=a},R.prototype.lW=function(t){var n,o,i,e,n=this,o=n.TZ,i=o&&o.Mf;if(i&&i.endEdit()&&o&&i.comments.get(o.bZ,o.yZ)&&(R.et(n,"preProcessMouseDownEdit",e={e:t,r:l}),!e.r))return i.ki(s.FloatingElementSelected,{type:"comments"}),n.NW.qQ(o),o.commentState(2,!0),n.bg(t),X(t)},R.prototype.XZ=function(t){var n,o,i,e,r,c,a,a,e,r,o,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r=n.NW,c=r.RW;i.endEdit()&&(R.et(n,"preProcessMouseDownDragResize",a={e:t,r:l}),a.r||(i.ki(s.FloatingElementSelected,{type:"comments"}),c.x=t.pageX/e,c.y=t.pageY/e,c.LW=V(o.location().x,o.location().y,o.width(),o.height()),c.FW=n.wK(t),n.Fg(),c.BW=!0,n.yK(t),r.qQ(o),o.commentState(T.active,!0),Nn(i,o)&&(n.CK={},n.CK.SK=Kn(i,n.AW),n.CK.TK=Yn(i,n.IW),n.cK(),c.FW<0?n.iQ=!0:n.Eb=!0),a=i.rt,e=i.uw(),r=D(t.pageX-e.left,t.pageY-e.top),o=i.hitTest(r.x,r.y),a.Rk={e9:o.rowViewportIndex,r9:o.colViewportIndex,Bk:o.hitTestType},a.fk=r,a.Ok(),a.s9=!0,t.stopPropagation()))},R.prototype.DW=function(t,n,o){var i,e,r,c,a,u,s,f,n,o,h,l,v,m,d,t,m,p,w,g,b,_,b,u,b,C,e,y,k,u,i=this,e=i.TZ,r=e&&e.Mf,c=i.eQ,a=i._zoomFactor,u=i.IW,s=i.AW,f=i.KQ(s,u),n=void 0!==n?n*a:i.gQ(),o=void 0!==o?o*a:i.pQ(),h=t.x,l=t.y,v=r.Fi(),m=i.wQ(r,0,0,s,u),d=t.x+(0-(m.x-v.XC))+n-c,t=t.y+(0-(m.y-v.qC))+o-c,m=0,p=0,w=0,g=0;return 0===u?(m=0-c,w=O(v)-v.XC):1===u?(b=j(r,r.getViewportRightColumn(0)+1,Yn(r,1),!1),m=f.x-c-b,w=_=i.gK(2)):2===u&&(m=0-c),h<m&&(i.Eb?n-=m-h:d+=m-h,h=m),1!==u&&2!==u||(w+=j(r,0,r.getColumnCount(),!1,d)),w<d&&(i.Eb?n-=d-w:i.iQ?h-=d-w:(b=i.NW.PW&&!e.ignoreDefaultLocation()?9:e.location().x,m<(b=h-(u=2*x(b)+Xn(r,e.yZ)+e.width()))?h=b:h<w?n-=d-w:(b=h-u,h=m<(C=d-u)?b<m?(n-=m-b,m):b:(b=h-(d-w))<m?(n-=m-b,m):b))),0===s?(p=0-c,g=I(v)-v.qC):1===s?(e=j(r,r.getViewportBottomRow(0)+1,Kn(r,1),!0),p=f.y-c-e,g=y=i.mK(2)):p=0-c,l<p&&(i.Eb?o-=p-l:t+=p-l,l=p),1!==s&&2!==s||(g+=j(r,0,r.getRowCount(),!0,t)),g<t&&(i.Eb?o-=t-g:i.iQ?l-=t-g:g<t&&(l=(u=l-(k=t-g))<p?(o-=p-u,p):u)),V(h,l,n/a,o/a)},R.prototype.hK=function(){var t,n,o,i,e,r,e,c,t,a,n,t=this,n=t.TZ.Mf,e=t.CK,r=e.SK,e=e.TK,c=Kn(n,t.AW),t=Yn(n,t.IW),a=j(n,r,c,!0),n=j(n,e,t,!1),o,i;return D(e<t?n:-n,r<c?a:-a)},R.prototype.AK=function(t){var n,o,i,e,r,c,a,u,s,t,e,u,f,f,h,h,s,n=this,o=n.TZ,i=o&&o.Mf,e=n._zoomFactor,r,c=n.NW.RW,a=L.ChangeComment;c.BW&&(u=n.hK(),s=t.pageX/e-c.x+u.x,t=t.pageY/e-c.y+u.y,0===s&&0===t||(u=e=void 0,c.FW<0?(f=c.LW.x+s,h=c.LW.y+t,e=n.bQ(D(f,h)),u=n.DW(e),(f=n.MQ(D(u.x,u.y))).x===o.location().x&&f.x===o.location().y||i.Qy().execute({cmd:"moveComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.location().clone(),newValue:f,propertyName:"location"})):(o.autoSize(!1),h=n.dK(s,t,c.FW),e=n.bQ(D(h.x,h.y)),u=n.DW(e,O(h),I(h)),s=[],(f=n.MQ(D(u.x,u.y))).x===o.location().x&&f.y===o.location().y||s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.location().clone(),newValue:f,propertyName:"location"})),O(u)!==o.width()&&s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.width(),newValue:u.width,propertyName:m})),I(u)!==o.height()&&s.push(new a(i,{cmd:"changeComment",sheetName:i.name(),row:o.bZ,col:o.yZ,oldValue:o.height(),newValue:u.height,propertyName:d})),0<s.length&&i.Qy().execute({cmd:"changeCommentTransaction",sheetName:i.name(),commands:s}))))},R.prototype.pg=function(t){var n,o,i,i,e,r,o,o,n=this,o=n.TZ.Mf,i={e:t,r:l};if(R.et(n,"preProcessMouseMove",i),!(i.r||(this.yK(t),o.getSelections()&&0<o.getSelections().length)))return i=n.NW,e=t.target,r=o.rt,o=o.uw(),o=D(t.pageX-o.left,t.pageY-o.top),e&&i.RW.BW&&(n.eW&&n.lK(t),1===n.AW&&(r.fk.y=o.y),1===n.IW&&(r.fk.x=o.x),r.a9()),X(t)},R.prototype.bg=function(t){var n,o,i,i,e,o,n=this,o=n.TZ.Mf,i={e:t,r:l};if(R.et(n,"preProcessMouseUp",i),!(i.r||o.getSelections()&&0<o.getSelections().length))return i=t.target,e=n.NW,(o=o.rt).s9=!1,o.l9(),i&&(n.AK(t),n.fK&&((0,S.GC$)(n.fK).remove(),n.fK=null,n.iQ=!1,n.Eb=!1),n.u2(),e.RW.BW=!1,n.yK(t)),X(t)},R.prototype.wK=function(t){var n,o,n,i,e,r,c,n=this,o=n.nQ;if(0<o.length&&(n.rK===T.active||n.rK===T.edit))for(n=n.SW,i=t.pageX-(0,S.GC$)(n).offset().left,e=t.pageY-(0,S.GC$)(n).offset().top,r=0;r<o.length;r++)if((c=o[r])&&c.contains(i,e))return r;return-1},R.prototype.dK=function(t,n,o){var i,e,r,o,t,i=this,e=-1,r=-1;switch(o){case 0:r=e=0;break;case 1:e=2,r=0;break;case 2:e=0,r=2;break;case 3:r=e=2;break;case 4:e=0,r=1;break;case 5:e=2,r=1;break;case 6:e=1,r=0;break;case 7:e=1,r=2}return o=i.IK(t,e),t=i.oh(n,r),V(o.x,t.y,o.w,t.h)},R.prototype.IK=function(t,n){var o,i,o,e,r,t,o=this,i=2*o.eQ,o=o.NW.RW,e=O(o.LW)-i;return 0===n?e-=t:2===n&&(e+=t),r=o.LW.x,0<=e?0===n&&(r+=t):0===n?r+=O(o.LW)-i:2===n&&(r+=e),t=O(o.LW),{x:r,w:t=1!==n?x(e)+i:t}},R.prototype.oh=function(t,n){var o,i,o,e,r,t,o=this,i=2*o.eQ,o=o.NW.RW,e=I(o.LW)-i;return 0===n?e-=t:2===n&&(e+=t),r=o.LW.y,0<=e?0===n&&(r+=t):0===n?r=I(o.LW)-i:2===n&&(r+=e),t=I(o.LW),{y:r,h:t=1!==n?x(e)+i:t}},R.prototype.XQ=function(t){var n,o,i,n,n=this,o=n.TZ.Mf;if(t){switch(i=v,t){case n.SW:i=Dt;break;case n.TW:i=Vt;break;case n.$W:i=It;break;case n.Ti:i=_;break;case n.li:i=C}i&&((0,S.GC$)(t).unbind(cn+i).unbind(yt+i),n=function(t){o.P_(t),X(t)},(0,S.GC$)(t).bind(cn+i,n).bind(yt+i,n))}},R.prototype.aQ=function(t,n){var o,i,e,i,o=this,i=o.TZ,e=i&&i.Mf;o.hQ(t,n),i=function(t){io(e,t)},(0,S.GC$)(t).bind(on+n,function(t){o.XZ(t)}).bind(en+n,function(t){o.pg(t)}).bind(rn+n,function(t){o.bg(t)}).bind(cn+n,i).bind(yt+n,i)},R.prototype.hQ=function(t,n){(0,S.GC$)(t).unbind(n)},R.prototype.oQ=function(){var r,t,c,a,u,t,r=this,t=r.TZ,c=t&&t.Mf,a=r.NW;r.vQ(),c&&(u=c.uw(),t=function(t){c.P_(t)},(0,S.GC$)(r.tQ).bind(on+$t,function(t){var n,o,o,n=c.Ut.pI.hitTest(t.pageX-u.left,t.pageY-u.top);n?(o=n.comment,o=a.mW(o),n.area===Wt?o.lW(t):n.area===Bt&&o.XZ(t),(0,S.GC$)(o.qW).css(Mt,parseInt((0,S.GC$)(r.$W).css(Mt)+1,10))):c.B_(t)}).bind(en+$t,function(t){var n,o,i,e,i,n=c.Ut.pI.hitTest(t.pageX-u.left,t.pageY-u.top),o=r.tQ.style;n?(i=n.comment,(e=a.mW(i)).pg(t),n.area===Wt?o.cursor=Rt:n.area===Bt&&(o.cursor=Ct)):(c.L_(t),r.NW.wW(l),(i=c.Dg())&&(o.cursor=i.style.cursor))}).bind(rn+$t,function(t){var n,n,o,n=c.Ut.pI.hitTest(t.pageX-u.left,t.pageY-u.top);n?(n=n.comment,(o=a.mW(n)).bg(t)):c.F_(t)}).bind("dblclick"+$t,function(t){c.U_(t)}).bind(cn+$t,t).bind(yt+$t,t))},R.prototype.vQ=function(){var t;(0,S.GC$)(this.tQ).unbind($t)},R.prototype.cQ=function(){var n,t,o,t,n=this,t=n.TZ,o=t&&t.Mf;t.commentState()!==T.edit&&n.Ti&&(n.dQ(),t=function(t){io(o,t)},(0,S.GC$)(n.Ti).bind(on+_,function(t){n.lW(t)}).bind(en+_,function(t){n.pg(t)}).bind(rn+_,function(t){n.bg(t)}).bind(cn+_,t).bind(yt+_,t))},R.prototype.dQ=function(){var t=this,n;t.TZ.commentState()!==T.edit&&t.Ti&&(0,S.GC$)(t.Ti).unbind(_)},R.prototype.sQ=function(){var t,n,o,i,t=this,n=t.TZ,o=n&&n.Mf,i=t.li;n.commentState()===T.edit&&i&&(this.mQ(),(0,S.GC$)(i).bind(on+C,function(t){t.stopPropagation()}).bind(en+C,function(t){t.stopPropagation()}).bind(rn+C,function(t){t.stopPropagation()}).bind("keydown"+C,function(t){27!==t.keyCode&&9!==t.keyCode||(n.commentState(T.active,!0),X(t),J.F1(o))}).bind("focusout"+C,function(){(0,S.GC$)(i).val()!==n.text()&&o.Qy().execute({cmd:"changeComment",sheetName:o.name(),row:n.bZ,col:n.yZ,oldValue:n.text(),newValue:(0,S.GC$)(i).val(),propertyName:Rt})}))},R.prototype.JQ=function(t,n){var o,i,e,r,e,c,a,u,s,f,h,l,h,v,m,d,p,w,g,b,_,C,y,k,x,v,o=this,i=o.TZ,e=o.eQ,r=i.padding(),e=2*(e+i.borderWidth());if(!(!i.autoSize()||o.Eb||o.xK||n<=0)){if(o.xK=!0,a=(c=i.Mf).Fi(),u=c.qc()&&c.qc().getBoundingClientRect(),f=i.commentState()===T.edit?(s=o.li).value:(s=o.Ti,$.dI(s.innerHTML)),l="",(h=s.style).font?l+=h.font:(i.fontStyle()&&(l+=At+i.fontStyle()),i.fontWeight()&&(l+=At+i.fontWeight()),i.fontSize()&&(l+=At+parseInt(i.fontSize(),10)*o._zoomFactor+"pt"),i.fontFamily()&&(l+=At+i.fontFamily())),h=s.getBoundingClientRect(),v=i.location().x<0,m=!1,w=d=K("M",l),g=p=5,b=a.x+a.width-(h.left-u.left),_=a.y+a.height-(h.top-u.top),v&&(b=h.left-u.left+h.width-a.x,m=!0),(C=S.q.un(f,b,l))&&0<C.length){for(k=y=0;k<C.length;k++)y<(x=c.Gi(C[k],l))&&(y=x);v=oo(C,l),r&&(y+=(r.left||0)+(r.right||0),v+=(r.top||0)+(r.bottom||0)),g=N(M(b,A(y,5))),w=N(M(_,v))}return 2===i.commentState()&&i.text(s.value),n=w+e,t=g+e,i.width(g,!1),i.height(w,!1),m&&i.location().x+g<=0&&(m=!1),o.xK=!1,{adjustedWidth:t,adjustedHeight:n,needReposition:m}}},R.prototype.mQ=function(){var t,n=this.li;n&&(0,S.GC$)(n).unbind(C)},R.prototype.Fg=function(){var n=this,t=n.NW.RW;t.BW||((0,S.GC$)(vt).bind(en+Qt,function(t){n.pg(t)}).bind(rn+Qt,function(t){n.bg(t)}),t.BW=!0)},R.prototype.u2=function(){var t=this.NW.RW;t.BW&&(t.BW=!1,S.GC$)(vt).unbind(Qt)},yn=R,t.hW=yn,u.$e(yn),o.prototype.getUsedRange=function(){var t,n,o,i,e,r,c,a,t,n=this.all(),o={};if(n)for(e=i=void 0,r=0,c=n;r<c.length;r++)i=(a=c[r]).bZ,e=a.yZ,dt(o,{minRow:i,minCol:e,maxRow:i,maxCol:e});return o},o.prototype.dispose=function(t){var n,o,n=this,o;n.all().forEach(function(t){n.NK(t)}),n.kK(),!1!==t&&(n.Mf=l)},o.prototype.add=function(t,n,o){var i,e,r,r,o,i=this,e=i.Mf,r=e.getSpan(t,n);return!r||r.row===t&&r.col===n?(r=i.get(t,n),o="string"==typeof o?new pn(o):o,i.WB(t,n,o),e.Rj("comment",t,n,S.SheetArea.viewport,r,o),e.ki(s.WorksheetDataChanged,{type:"comment"}),o):l},o.prototype.WB=function(t,n,o,i){var e=this,r=e.Mf,c=e.wB;e.DK(t,n),o&&(o.bZ=t,o.yZ=n,o.Mf=r,c.push(o),o.lp=e.GW,r.Ut.MW({type:"add",row:t,col:n,comment:o}),e.GW++,e._K(t,n,o),i||r.zw())},o.prototype.get=function(t,n){return this.cE[t+"_"+n]||l},o.prototype._K=function(t,n,o){this.cE[t+"_"+n]=o},o.prototype.EK=function(t,n,o){var i=t.bZ,e=t.yZ;this.get(i,e)===t&&this._K(i,e,v),this.Mf.Ut.MW({type:"rowcol",comment:t,row:i,col:e,newRow:n,newCol:o}),t.bZ=n,t.yZ=o,this._K(n,o,t)},o.prototype.remove=function(t,n){var o=this,i=o.DK(t,n),o=o.Mf;i&&(o.Rj(B,t,n,S.SheetArea.viewport,i,v),o.ki(s.WorksheetDataChanged,{type:"comment"}),o.zw())},o.prototype.DK=function(t,n){var o,i,e,i,o=this,i=o.Mf,e=o.get(t,n);return e&&(i.Ut.MW({type:"remove",row:t,col:n,comment:e}),o.NK(e),W.VP(o.wB,e),(i=o.mW(e))&&(yn.et(i,"dispose"),W.VP(o.UW,i)),o._K(t,n,v)),e},o.prototype.clear=function(t){var n,o,i,e,r,c,r,n=this,o=n.Mf,i=n.wB;for(o.suspendPaint(),e=i.length-1;0<=e;e--)c=(r=i[e]).bZ,r=r.yZ,(!t||c>=t.row&&c<t.row+t.rowCount&&r>=t.col&&r<t.col+t.colCount)&&n.remove(c,r);o.resumePaint()},o.prototype.all=function(){return this.wB.concat()},o.prototype.CB=function(t,n,o,i,e,r){(t||i)&&(t&&this.EK(t,e,r),i)&&this.EK(i,n,o)},o.prototype.getOuterContainer=function(t){var t=this.mW(t);return t?t.qW:l},o.prototype.HW=function(){var t=e(qt);(0,S.GC$)(t).addClass("gc-comment-editor").css(w,0).css(g,0).css(r,c).css("margin",0).css(zt,0).css("word-wrap","break-word").css("word-break","normal").css(a,Nt).css("resize","none").css("outline","none").css("border","0px").css(jt,Ft).css(Zt,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.kW=t},o.prototype.zW=function(){var i=this,t=i.Mf;t&&(t.D3(s.ColumnChanged+b,function(t,n){var n=n.propertyName;n!==m&&"isVisible"!==n||i.jK()}),t.D3(s.RowChanged+b,function(t,n){var n=n.propertyName;n!==d&&"isVisible"!==n||i.jK()}),t.D3(s.ColumnWidthChanged+b,function(){i.jK()}),t.D3(s.RowHeightChanged+b,function(){i.jK()}),t.D3(s.CommentChanged+b,function(t,n){var o,n,n;n&&(o=n.propertyName,n=n.comment,n=i.mW(n))&&("location"===o?n.CQ():o!==m&&o!==d||n.SQ())}))},o.prototype.kK=function(){var t,n=this.Mf;n&&n._3(b)},o.prototype.mW=function(t){var n,o,i,e,n,o=this.UW;if(t)for(i=0;i<o.length;i++)if((e=o[i]).TZ===t)return e;return l},o.prototype.Oy=function(){return 0===this.wB.length},o.prototype.RK=function(){var t,n,o,i,e,t,n=this.wB;if(0<n.length){for(o=n[0].zIndex(),i=1;i<n.length;i++)o<(e=n[i]).zIndex()&&(o=e.zIndex());return o}return 0},o.prototype.JO=function(t,n){for(var o,i,e,r,c,a,u,o=this,i=o.wB,e=o.UW,r=0;r<i.length;r++)t<=(c=i[r]).bZ&&o.EK(c,c.bZ+n,c.yZ);for(a=0;a<e.length;a++)(u=e[a]).LQ()&&u.JO(t,n)},o.prototype.qO=function(t,n){for(var o,i,e,r,c,a,u,o=this,i=o.wB,e=o.UW,r=0;r<i.length;r++)t<=(c=i[r]).yZ&&o.EK(c,c.bZ,c.yZ+n);for(a=0;a<e.length;a++)(u=e[a]).LQ()&&u.qO(t,n)},o.prototype.xP=function(t,n){for(var o,i,e,r,c,a,u,s,o=this,i=o.wB,e=o.UW,r=i.length-1;0<=r;r--)a=(c=i[r]).bZ,u=c.yZ,t<=a&&a<t+n&&o.remove(a,u);for(r=0;r<i.length;r++)t<(c=i[r]).bZ&&o.EK(c,c.bZ-n,c.yZ);for(r=0;r<e.length;r++)(s=e[r]).LQ()&&s.xP(t,n)},o.prototype.NP=function(t,n){for(var o,i,e,r,c,a,u,s,o=this,i=o.wB,e=o.UW,r=i.length-1;0<=r;r--)a=(c=i[r]).bZ,t<=(u=c.yZ)&&u<t+n&&o.remove(a,u);for(r=0;r<i.length;r++)t<(c=i[r]).yZ&&o.EK(c,c.bZ,c.yZ-n);for(r=0;r<e.length;r++)(s=e[r]).LQ()&&s.NP(t,n)},o.prototype.pZ=function(){return this.MZ},o.prototype.qQ=function(t){var n=this;t&&t!==n.MZ&&(n.CZ(),n.MZ=t)},o.prototype.CZ=function(){var t,n,o,t=this,n=t.MZ;n&&(o=t.mW(n))&&!o.iQ&&!o.Eb&&(o.uQ()&&o.$Q(),n.commentState(T.normal),t.MZ=l)},o.prototype.$c=function(t){var n,o,n=this,o=n.mW(t);o||(o=new yn(t,n),n.UW.push(o)),o.rQ()},o.prototype.wW=function(t){var n=this,o=n.MZ;if(o)if(1===o.displayMode()){if(o.commentState()===T.edit)return}else if(o.commentState()===T.edit||o.commentState()===T.active)return;t!==n.PW&&(n.PW&&n.NK(n.PW),t&&2===t.displayMode()?n.RW.BW||t.BK||((n.PW=t).BK=mt.setTimeout(function(){n.$c(t)},200)):n.PW=l)},o.prototype.NK=function(t){var n=this,o=n.mW(t);o&&o.LQ()&&(o.lQ(),t===n.MZ)&&n.Mf.cR(),clearTimeout(t.BK),delete t.BK},o.prototype.LK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,S.GC$)(t.YW).show()},o.prototype.FK=function(){var t=this.Mf.pW&&this.Mf.pW();t&&(0,S.GC$)(t.YW).hide()},o.prototype.PK=function(t,n,o){var t,t,t=this.mW(t);return!(!t||!(t=t.pK()))&&t.contains(n,o)},o.prototype.GK=function(t,n,o){var t,t,t=this.mW(t);return!(!t||!(t=t.bK()))&&t.contains(n,o)},o.prototype.hitTest=function(t,n){for(var o,i,e,r,o=this,i=l,e=0;e<o.wB.length;e++)r=o.wB[e],Nn(o.Mf,r)&&o.PK(r,t,n)&&(!i||r.zIndex()>i.zIndex())&&(i=r);return i?{x:t,y:n,comment:i,area:o.GK(i,t,n)?Wt:Bt}:l},o.prototype.nK=function(t){var n=this,o=n.RK();return t===n.PW?o+2:t===n.MZ?o+1:t.zIndex()},o.prototype.jK=function(){this.UW.forEach(function(t){t.TQ()})},o.prototype.fromJSON=function(t,n){var o,i,e,r,o=this;if(t&&0!==t.length){for(i=o.GW=0;i<t.length;i++)e=t[i],(r=new pn).fromJSON(e,n),3!==r.commentState()&&(o.MZ=r),o.Mf.Ut.pI.WB(r.bZ,r.yZ,r,!0);o.Mf.zw()}},o.prototype.yh=function(t,n,o,i){var e,r,c,a,u,s,f,h,l,e=this;if(t&&n){for(e.GW=0,r=k(t,"commentList"),c=it(n,"shape"),r=r.c_,a=0;a<r.length;a++)u=r[a],l=In(c,f=(s=new pn).bZ=S.IndexHelper.qi(u.ref),h=s.yZ=S.IndexHelper.$i(u.ref)),u.lossless&&(s.showShadow(u.lossless.showShadow),s.indicatorSize(u.lossless.indicatorSize),s.indicatorColor(u.lossless.indicatorColor),s.ignoreDefaultLocation(u.lossless.ignoreDefaultLocation),s.commentState(u.lossless.commentState)),s.yh(e.Mf,u,l,o,i),3!==s.commentState()&&(e.MZ=s),e.Mf.Ut.pI.WB(s.bZ,s.yZ,s,!0);e.Mf.zw(),e.Pfe=k(t,"authors")}},o.prototype.toJSON=function(){var t,n,o,t=this.wB;if(!t||0===t.length)return v;for(n=[],o=0;o<t.length;o++)n.push(t[o].toJSON());return 0===n.length?v:n},kn=o,co.prototype.L0=function(){this.Mf=l},co.prototype.ZW=function(){var t=e(f);return(0,S.GC$)(t).addClass("gc-comment-layoutPanel"+At+Lt).css([r,w,g,d,m,a,Mt,Et],[c,0,0,0,0,St,Pt,Gt]),t},co.prototype.bW=function(t){var n,o,i,o,n=this;t.Ut.pI.Oy()||(o=t.Fi(),(0,S.GC$)(n.YW).css(w,o.x+o.XC).css(g,o.y+o.qC),n.Mf!==t&&(n.Mf&&(o=(i=n.Mf.Ut).pI.pZ())&&o.commentState()===T.edit&&o.commentState(T.active,!0),n.Mf=t))},co.prototype.yW=function(t,n,o){var i,e,r,c,a,o,u,n,u,i,i=o.row,e=o.col,r=o.x,c=o.y,a=O(o),o=I(o),u=this;n===S.SheetArea.viewport&&u.Mf&&(n=u.Mf.Ut.pI.get(i,e))&&(u=this.Mf,i=(n.indicatorSize()||6)*(u?u.zoom():1),t)&&0<a&&0<o&&(t.save(),t.rect(r,c,a,o),t.clip(),t.fillStyle=n.indicatorColor()||"red",t.beginPath(),t.moveTo(r+a-i,c),t.lineTo(r+a,c),t.lineTo(r+a,c+i),t.lineTo(r+a-i,c),t.fill(),t.restore())},co.prototype.WW=function(t){var n,o,i,e,r,c,c;if(this.VW){for(t.LK(),n=this.Mf,o=t.all(),i=0;i<o.length;i++)e=o[i],r=t.mW(e),this.UK(t,e)?(1===e.displayMode()&&e===t.PW&&(t.PW=l),r&&r.LQ()?r.fQ():t.$c(e)):r&&r.LQ()&&t.NK(e);(c=t.pZ())&&(c=t.mW(c))&&c.LQ()&&0<n.getSelections().length&&n.Ut.do("clearSelection")}else t.FK()},co.prototype.UK=function(t,n){var o=t.Mf;if(o&&Xn(o,n.yZ)&&Hn(o,n.bZ))switch(n.displayMode()){case 1:return!0;case 2:if(3!==n.commentState())return t&&n!==t.PW&&(t.PW=n),!0;if(n===t.PW)return!0}return!1},xn=co,n=u.Y8,u.GC$.extend(n.prototype,{MW:function(t){var n,o,n=this.G8;n&&(o=(o=n.commentChanges)||(n.commentChanges=[])).push(t)},HK:function(t,n){var o,i,e,r,c,a,a,u,o,i=this.pI;if(t)for(e=0;e<t.length;e++)c=(r=t[e]).comment,"add"===r.type?((a=new pn).fromJSON(c),(c=a).commentState(3)):c=i.get(c.rowIndex,c.colIndex),"add"===r.type?i.WB(r.row,r.col,c):"remove"===r.type?i.DK(r.row,r.col):"property"===r.type?(a=r.name,u=r.newValue,"commentState"!==a&&c[a](u)):"rowcol"===r.type&&i.EK(c,r.newRow,r.newCol);else n&&"changeComment"===n.cmd&&"commentState"!==n.propertyName&&(c=i.get(n.row,n.col))[n.propertyName](n.newValue)},zK:function(t){var n,o,i,e,r,c,a;if(t)for(o=(n=this).pI,i=t.length-1;0<=i;i--)r=(e=t[i]).comment,"add"===e.type?o.DK(e.row,e.col):"remove"===e.type?o.WB(e.row,e.col,e.comment):"property"===e.type?(c=e.name,a=e.value,r[c](a)):"rowcol"===e.type&&o.EK(r,e.row,e.col)},OL:function(t,n,o,i){for(var e,r,c,e=this,r=0;r<o;r++)for(c=0;c<i;c++)0===r&&0===c||e.getCell(t+r,n+c).comment()&&e.comments.remove(t+r,n+c)}}),n.ch("comments",{init:function(){this.pI=new kn(this.Mf)},applyChanges:function(t){var n,o,i,t,i,n=this,o=t.command,i=t.changes,t=t.isUndo,i=i&&i.commentChanges;(i||o)&&(t?n.zK(i):n.HK(i,o))},undo:function(t){var t=t.commentChanges;t&&this.zK(t)},dispose:function(t){var n=this,t=t&&t.clearCache;n.pI&&n.pI.dispose(t),!1!==t&&(n.pI=l)}}),S.Worksheet.ch("comments",Sn={getUsedRange:function(t){var n,o,i;t.type&S.UsedRangeType.comment&&(i=(o=(n=this).comments).getUsedRange(),dt(t.range,i))},init:function(){var n=this;n.comments=n.Ut.pI,n.pW=function(){var t=n.parent;if(t)return t.VK||(t.VK=new xn(t.j2())),(t.VK.Mf=n).parent.VK}},dispose:function(t){!1!==t.clearCache&&(this.pW=l,this.comments=l),vn(this,(0,S.GC$)(this.Dg()))},setHost:function(t){var n;t&&((n=this.Ut.pI)&&n.zW(),ln(t,this))},onLayoutChanged:function(t){var n,o,i,e,r,c,a;!ot(t.sheetArea)&&3!==t.sheetArea||(o=(n=this).Ut.pI,i=t.changeType,e=t.row,r=t.rowCount,c=t.col,a=t.colCount,"addRows"===i?o.JO(e,r):"deletingRows"===i?o.xP(e,r):"addColumns"===i?o.qO(c,a):"deletingColumns"===i?o.NP(c,a):t.sheetArea===S.SheetArea.viewport&&("clear"===i?4==(4&t.type)&&o.clear(new u.Range(e,c,r,a)):"addSpan"===i?Gn.call(n,!0,e,c,r,a):"removeSpan"===i&&Gn.call(n,!1,e,c)))},paint:function(t){this.Ut.pI.Oy()||(Wn.call(this),this.CW(t.clipRect))},paintCell:function(t){t.isPrinting||t.sheetArea!==S.SheetArea.viewport||Bn.call(this,t.ctx,t.sheetArea,t.cell)},toJson:function(t,n){var o;n&&n.ignoreStyle||(t.comments=this.Ut.pI.toJSON())},fromJson:function(t,n,o){var i,o,i;o&&o.ignoreStyle||t&&(o=n?t.commentManager:t.comments)&&this.Ut.pI.fromJSON(o,n)},lastNonNullRowAndCol:function(){var t,n,o,i,e,r,c,t=0,n=0,o=this.Ut.pI;if(o&&(i=o.UW)&&0<i.length)for(e=0,r=i.length;e<r;e++)(c=i[e])&&c.TZ&&(c.RQ>t&&(t=c.RQ),c.jQ>n)&&(n=c.jQ);return{lastNonNullRow:t,lastNonNullCol:n}},clearSelection:function(){this.Ut.pI.CZ()},processKeyDown:function(t){var n=this,o=n.Ut.pI.pZ();o&&n.rt.Pi(t.e)&&jn(n,o)&&(o.commentState(2,!0),t.r=!0)},yh:function(t,n,o){var i,t,e,e,r,i,c,a,u,s,f,r,t,h,i=k(t,"legacyDrawing"),t=t.rels,e=o&&!1===o.includeStyles;if(i&&!e){for(e=this,r=t.c_,i=i&&i["r:id"],a=0,u=r;a<u.length;a++)if(0<(f=(s=u[a]).Target).indexOf(gt)){c=f.split("/").pop().slice(0,-4);break}r=S.Util.Gr(t,i,n),t=n.comments&&n.comments[c],(h=e.comments).yh(t,r,o,n)}},wh:function(t,n,o){var o,i,e,i,r,c;!t||o&&!1===o.includeStyles||(o=t.rels,i=this.comments&&this.comments.all(),e=this.parent.Cp,o&&i&&0<i.length&&(i=ft(o),c=this.wp,o.c_.push({n_:wt,Id:r=pt+i,Type:S.RelationshipConstants.hc,Target:"../"+S.XFileConstants.ou+c+"."+S.XFileConstants.Cr}),S.Util.Hr(t,e)))}}),u.Workbook.ch("comments",Mn={init:function(){L.SZ(this.commandManager())},dispose:function(){this.VK&&(this.VK.L0(),this.VK=l)},wh:function(t,n,o){var i,e,r,c,a,u,s,f,a,h,l,v,m,d,i,e=this.sheets;if(!o||!1!==o.includeStyles)for(r=0;r<e.length;r++)if(c=e[r],a=ht(t,c.name()),(s=(u=c.comments)&&u.all())&&0<s.length)for((f=S.Util.Ur(t,a)).c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600",spt:"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),a=u.Pfe||{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},h=t[gt+c.wp]={n_:gt,r_:[13,14,15,16],c_:[a,{n_:"commentList",c_:[]}]},l=S.Util.qr(c.wp,f),v=0;v<s.length;v++)(d=(m=s[v]).wh(l)).commentData&&(d.commentData.lossless={showShadow:m.showShadow(),indicatorSize:m.indicatorSize(),indicatorColor:m.indicatorColor(),ignoreDefaultLocation:m.ignoreDefaultLocation(),commentState:m.commentState()}),l++,f.c_.push(d.vmlDrawingData),h.c_[1].c_.push(d.commentData)}})},Common:function(t){t.exports=GC.Spread},Core:function(t){t.exports=GC.Spread.Sheets},Touch:function(t){t.exports=GC.Spread.Sheets.Touch}},i={},t=e("./dist/plugins/comment/comment.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Comments=t}();