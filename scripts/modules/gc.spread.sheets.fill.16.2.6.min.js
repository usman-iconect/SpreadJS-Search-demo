/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var i,r,t;function e(t){var n,n,n=r[t];return void 0!==n||(n=r[t]={exports:{}},i[t].call(n.exports,n,n.exports,e)),n.exports}i={"./dist/plugins/fill/drag-fill.js":function(y,t,n){var i,c,T,h,t,n,s,x,k,b,v,n,R,j,r,l,M,u,S,O,I,A,g,e,o,f,t,d,C,a,D,F,p,B,W,$;function E(t){return t.rowCount}function N(t){return t.colCount}function V(t,n){return t.getRowCount(n)}function G(t,n){return t.getColumnCount(n)}function H(t,n,i,r){return t&&n&&n.containsRange(t)&&(!x(i)&&(1===i&&t.row===n.row&&E(t)===E(n)||0===i&&t.col===n.col&&N(t)===N(n))||!(x(r)||(2!==r&&3!==r||t.col!==n.col||N(t)!==N(n))&&(0!==r&&1!==r||t.row!==n.row||E(t)!==E(n))))}function w(t,n){var i,r,e,o,u,s,f,a,l,c,f,i=B.call(this)||this,r=i,e=n[A],o=0===e,u=o||1===e,s=n[O],f=n[S],a=f.row,l=f.col,c=E(f),f=N(f);return r.Mf=t,4===(r.Ftt=n)[I]?r.Ptt=new T.Commands.JI(t,{ranges:[n[O]]}):r.Gtt=u?v(a,o?s.col:l,c,f+N(s)):v(2===e?s.row:a,l,c+E(s),f),r.Utt=u?1:0,i}function m(t,n){var i,r,i=W.call(this)||this,r=i;return r.Mf=t,r.Htt=n,r.ztt=n[S],r.Vtt=n[O],r.Ytt=n[I],r.Ztt=n[A],i}function L(t,n,i,r,e,o){var u,r,e,n,u=t.getSelections();t.IA(),t.n4(n,i,r,e,!0),r=t.getSelections(),e=0<n?n:t.N9(),n=0<i?i:t.k9(),t.O6(e,n,t.R9,t.B9),t.jA(u),t.parent&&o.Z3&&t.parent.changeSelectionInCommandExecuting(o,null,null,r)}function P(t){var n,i,n,i=t.parent.getActiveSheet();i&&t!==i&&i.repaint()}function _(t,n){return $.call(this,t,n)||this}i=this&&this.__extends||(p=function(t,n){return(p=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}p(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),c=n("Common"),T=n("Core"),h=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),n=n("CalcEngine"),s=!!n,x=c.Common.lt.ht,k=null,b=void 0,v=T.Ec,n=T.GC$,R=Math.max,j=Math.floor,r=T.Commands.ActionBase,l=T.Commands.CI,M=T.Commands.SI,u=T.CopyToOptions.all,S="startRange",O="fillRange",I="autoFillType",A="fillDirection",g="cancel",e="fill",o="dragDrop",f=n.isEmptyObject,t=new c.Common.ResourceManager(t.SR,"Fill"),d=t.getResource.bind(t),n.extend(T.Worksheet.prototype,C={fillAuto:function(t,n,i){if(!n)throw new Error(d().Exp_RangeIsNull);var r=this,e=i.fillType,o=i.series,u=i.direction,s=i.step,f=i.stop,a=new h.Wtt(r),l=i.Qtt;if(H(t,n,u?k:o,u)){r.suspendPaint(),t&&(r.rt.Ktt=t);try{4===e?a.Jtt(n,o,!1,i.withTag,i.withoutStyle,l):0===e?a.Xtt(n,u):1===e||2===e?a.qtt(1===e,n,o,s,f):3===e&&a.$tt(n,o,3,s,x(f)?k:c.Common.ct.o0(f),i.unit)}finally{r.resumePaint()}}}}),T.Worksheet.ch(e,{init:function(){this.tnt=new h.nnt(this)},setHost:function(t){var t;t&&((t=this.Qy())[e]||t.register(e,T.Commands[e]),t[o]||t.register(o,T.Commands[o]))},dispose:function(t){var t;!1!==t.clearCache&&(t=this).tnt&&(t.tnt.L0(),t.tnt=k)}}),T.Workbook.ch(e,{onCultureChanged:function(){d()}}),i(w,B=r),w.prototype.canExecute=function(){var t=this,n=t.Mf,t=t.Ftt,i=t[S],r=t[O];return!(!n.PT(r.row,r.col,E(r),N(r),void 0,void 0,void 0,void 0,!0,T.SheetArea.viewport)||4!==t[I]&&r.intersect(i.row,i.col,E(i),N(i)))},w.prototype.execute=function(){var t,n,i,r,e,o,o,t=this;if(t.canExecute()){i=(n=t.Ftt)[O],e=(r=t.Mf).parent.i4(),T.Commands.II(e),t.X5(r,!0);try{s&&r.suspendCalcService(),o=r.getSelections(),r.isDirtySuspended()||(t.ent=new l(r,n[O],u)),4===n[I]?t.int(r):t.rnt(r),r.EA(o,r.getSelections())&&r.jA(o)}finally{t.q5(r,!0),s&&r.resumeCalcService(!1),T.Commands.xI(e,n),r.Q1i&&r.Q1i(i.row,i.col,E(i),N(i)),o=[],r.isDirtySuspended()||(t.ont=new l(r,i,u),t.ont.yI(t.ent.bI()),o=t.ont.MI()),M(r,i.row,i.col,E(i),N(i),o,1)}}},w.prototype.int=function(t){var n,i,r,i,n,e,o,e,o,n,n=this;n.Ptt.execute(t),r=(i=n.Ftt)[S],i=i[O],n=0===n.Utt,o=E(r),e=N(r),o=n?R(1,o-E(i)):o,n=n?e:R(1,e-N(i)),r.equals(i)||(e=v(r.row,r.col,o,n),t.O6(R(t.N9(),e.row),R(t.k9(),e.col),t.R9,t.B9),t.IA(),t.n4(e.row,e.col,E(e),N(e)))},w.prototype.rnt=function(t){var n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,w,m,_,y,C,r,D,F,n=this,i=n.Mf,r=n.Ftt,e=r[S],o=r[O],u=r[I],s=n.Gtt,l={fillType:4,series:n.Utt,withTag:!0,withoutStyle:!(i.lF&T.CopyToOptions.style)},c=i.tables,h=!1,v=new T.Range(s.row,s.col,s.rowCount,s.colCount);if(c)try{p=0===(g=r[A]),(d=2===g)&&(w=e.rowCount,m=0===c.AB(e.row,e.col,w,e.colCount).length)&&(h=!0,v.rowCount-=w),p&&(_=e.colCount,m=0===c.AB(e.row,e.col,e.rowCount,_).length)&&(h=!0,v.colCount-=_),y=[],c.yx(k,v,b,b,b,y,{applyDragFillAfterTableExpand:h}),0<y.length&&(l.Qtt=y)}catch(t){return i.jT(6,t.message),void i.resumePaint()}if(1===u){if(i.fillAuto(e,s,l),i.lF&T.CopyToOptions.style&&i.Ut.eE(e.row,e.col,e.rowCount,e.colCount))for(f=0;f<o.rowCount;f++)for(a=0;a<o.colCount;a++)(C=i.vI(e.row+j(f%e.rowCount),e.col+j(a%e.colCount)))&&C.clone&&(C=C.clone()),i.CL(o.row+f,o.col+a,C)}else 0===u?(r=i.lF&~T.CopyToOptions.comment,n.ant(e,o,r)):2===u?n.ant(e,o,4288):3===u&&((D=!(1!==E(e)||1!==N(e)||-1===e.row&&-1!==e.col||-1===e.col&&-1!==e.row))?n.ant(e,o,F=4283):(l.withoutStyle=!0,i.fillAuto(e,s,l)));i.O6(R(t.N9(),s.row),R(t.k9(),s.col),t.R9,t.B9),t.IA&&t.IA(),i.n4(s.row,s.col,E(s),N(s))},w.prototype.ant=function(t,n,i){var r=this,e=r.Mf,t=e.JS(t),n=e.JS(n),o=t.row,u=t.col,s=E(t),f=N(t),a=n.row,l=n.col,c=E(n),h=N(n),t=r.Ftt[A],v=3===t,g=1===t,d=j(c/s),n=c%s,p=j(h/f),t=h%f,w,m,_,y,C;if(e.HB=!0,0===r.Utt){for(w=0;w<d;w++)e.vT(o,u,y=v?a+w*s:a+c-(w+1)*s,l,s,f,i,!0,!0);0!=n&&e.vT(m=v?o:o+(d+1)*s-c,u,y=v?a+s*d:a+c-d*s-n,l,n,f,i,!0,!0)}else{for(w=0;w<p;w++)e.vT(o,u,a,C=g?l+w*f:l+h-(w+1)*f,s,f,i,!0,!0);0!=t&&e.vT(o,_=g?u:u+(p+1)*f-h,a,C=g?l+f*p:l+h-p*f-t,s,t,i,!0,!0)}delete e.HB,e.recalcRange(a,l,c,h)},w.prototype.undo=function(){var t,n,i,r,e,o,u,t=this,n=t.Mf,i=!1;if(t.canUndo()){t.X5(n,!0);try{s&&n.suspendCalcService(),r=n.getSelections(),e=t.Ftt,o=n.R_,u=e[O],i=4===e[I]?t.unt(n):t.snt(n),!n.cnt&&o&&o.close(),M(n,u.row,u.col,E(u),N(u),t.ont?t.ont.MI():[],1,b,!0),n.EA(r,n.getSelections())&&n.jA(r)}finally{t.q5(n,!0),s&&n.resumeCalcService(!1)}}return i},w.prototype.unt=function(t){var n,i,r,i,e,n=this,i=n.Ftt[S],r=i.row,i=i.col,e=T.Commands.TI(t.name());return t.Ut.undo(n.Ftt[e]),t.O6(R(t.N9(),r),R(t.k9(),i),t.R9,t.B9),!0},w.prototype.snt=function(t){var n,i,r,e,r,o,n,i=this.Ftt,r=i[S],e=r.row,r=r.col;s&&t.suspendCalcService();try{o=T.Commands.TI(t.name()),t.Ut.undo(i[o]),t.O6(R(t.N9(),e),R(t.k9(),r),t.R9,t.B9)}finally{s&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},a=w,i(m,W=r),m.prototype.execute=function(){var t,n,i,r,e,o,u,s,f,a,l,t=this,n=!1;if(t.canExecute()){r=(i=t.Mf).parent,e=t.Vtt,o=t.Htt,u=i.parent.i4(),T.Commands.II(u),t.XI(),t.X5(i,!0),i.QI=!0;try{s=i.getSelections(),f=void 0,a=i.rt,(l={sheet:i,sheetName:i.name(),cancel:!1})[O]=e,l[I]=t.Ytt,l[A]=t.Ztt,i.ki(T.Events.DragFillBlock,l),a.fnt=l[I],a.lnt=l[g],l[g]||(t.hnt(l),i.ki(T.Events.DragFillBlockCompleted,l)),n=!0,f=i.getSelections(),i.EA(s,f)&&i.jA(s),r&&o.Z3&&r.changeSelectionInCommandExecuting(o,null,null,f)}finally{t.q5(i,!0),i.QI=!1,t.dnt(i,e),T.Commands.xI(u,t.Htt)}}return n},m.prototype.hnt=function(t){var n,i,r,e,o,r,e,n=this,i=n.Mf,r=i.rt,e=n.Vtt,o=n.Ytt;r.fnt=o,r.lnt||((r={})[S]=n.ztt,r[O]=e,r[I]=5===t[I]?o:t[I],r[A]=n.Ztt,e=new a(i,r),i.suspendEvent(),e.execute(),i.resumeEvent(),n.Htt.vnt=e)},m.prototype.XI=function(){var t=this;t.Mf.isDirtySuspended()||(t.ent=new l(t.Mf,t.Vtt,u))},m.prototype.undo=function(){var t,n,i,r,e,o,u,s,t=this;if(t.canUndo()){n=t.Mf,i=t.Vtt,r=n.parent,e=t.Htt,t.XI(),t.X5(n,!0);try{o=n.getSelections(),n.suspendEvent(),u=T.Commands.TI(n.name()),n.Ut.undo(t.Htt[u]),n.resumeEvent(),s=e[S],n.EA(o,[s])&&n.jA(o),r&&e.Z3&&r.changeSelectionInCommandExecuting(e,null,null,[s])}finally{t.q5(n,!0),t.dnt(n,i,!0)}}return!0},m.prototype.dnt=function(t,n,i){var r,e,o,r=this,e=[];t.isDirtySuspended()||((o=new l(t,n,u)).yI(r.ent.bI()),e=o.MI()),M(t,n.row,n.col,E(n),N(n),e,1,b,i)},D=m,i(_,$=r),_.prototype.canExecute=function(){var t,n,i,r,e,o,u,s,f,a,l,c,h,a,v,g,d,p,a,t=this,n=t.Mf,i=t.tT,r=i.fromRow,e=i.fromColumn,o=E(i),u=i.columnCount,s=i.toRow,f=i.toColumn,a=!i.copy,l,c;if(n.tables&&n.tables.mx(n,{row:r,col:e,rowCount:o,colCount:u},n,{row:s,col:f,rowCount:o,colCount:u},a))return!1;if(!n.zT(r,e,o,u,V(n),G(n)))return!1;if(!i.insert&&!n.zT(s,f,o,u,V(n),G(n)))return!1;if(i.cmd===T.RangeChangedAction[0]&&n.tables&&(h=!1,0<(a=n.tables.AB(r,e,o,u)).length)){for(g=(v=a[0].range()).row;g<v.row+v.rowCount;g++)if(n.isRowFilterOut(g)){h=!0;break}return!(h&&v.contains(i.mouseTargetRow,i.mouseTargetCol,1,1))}return a=t.mnt(d=0<=s&&f<0&&0<=r&&e<0&&0<o&&u<0,p=s<0&&0<=f&&r<0&&0<=e&&o<0&&0<u),n.PT(s,f,o,u,k,k,a,k,k,T.SheetArea.viewport)&&n.PT(r,e,o,u,k,k,a,k,k,T.SheetArea.viewport)},_.prototype.mnt=function(t,n){var i,r,i,r,e,i,e,i,i=this,r=i.tT,i=i.Mf,r=r.insert,e=i.options.isProtected,i=i.options.protectionOptions;return!(!e||f(i)||(e=i.allowDragInsertRows,i=i.allowDragInsertColumns,!r)||!(e&&t||i&&n))},_.prototype.vx=function(t){var n=[].concat(t.parent.sheets);return t&&t.NMi&&n.push(t),n},_.prototype.execute=function(){var t,n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,F,b,R,j,t=this,n=!1;if(t.canExecute()){i=t.Mf,r=t.tT,t.XI(),u=o=e=void 0,s=r.fromRow,f=r.fromColumn,a=r.toRow,l=r.toColumn,c=E(r),h=r.columnCount,v=r.option,g=c,d=h,p=t.vx(i),(w=i.o5())&&(g+=i.lT(a,c,!0),d+=i.lT(l,h)),T.Commands.II(p),t.X5(i,!0),i.QI=!0,m=void 0;try{try{m={shiftCells:r.insert&&r.shiftCells===T.InsertShiftCell.down,isCopy:r.copy,isFirst:!0},i.tables&&i.tables.yx(i,new T.Range(a,l,g,d),new T.Range(s,f,c,h),k,k,k,{shiftInfo:m})}catch(t){return i.jT(6,t.message),void i.resumePaint()}r.insert?0<=f&&s<0?(e=f,u=h,_=o=l,i.addColumns(o,u),r.copy?i.copyTo(-1,o<=e?e+u:e,-1,o,-1,u,v):(i.moveTo(-1,o<=e?e+u:e,-1,o,-1,u,v),i.deleteColumns(o<=e?e+u:e,u),e<o&&(_=o-u)),L(i,-1,_,V(i),u,r)):0<=s&&f<0?(e=s,u=c,y=o=a,i.addRows(o,u),r.copy?i.copyTo(o<=e?e+u:e,-1,o,-1,u,-1,v):(i.moveTo(o<=e?e+u:e,-1,o,-1,u,-1,v),i.deleteRows(o<=e?e+u:e,u),e<o&&(y=o-u)),L(i,y,-1,u,G(i),r)):0<=s&&0<=f&&(C=r.shiftCells,D=new T.Range(a,l,1,1),F=[new T.Range(s,f,c,h)],x(C)||(b={cmd:"clipboardPaste",sheetName:i.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:F,fromSheet:i,isCutting:!r.copy,pasteOption:0,pastedRanges:[new T.Range(a,l,c,h)],cA:D,fA:F,sA:C,bx:!0,px:m&&m.ignoreFooterShiftIndex},i.Qy().execute(b),R=i.getSelections()[0],C===T.InsertShiftCell.down&&s<a&&!r.copy&&f===l?i.setSelection(R.row-c,R.col,R.rowCount,R.colCount):C===T.InsertShiftCell.right&&f<l&&!r.copy&&s===a&&i.setSelection(R.row,R.col-h,R.rowCount,R.colCount))):(r.copy?i.copyTo(s,f,a,l,c,h,v):i.moveTo(s,f,a,l,c,h,v),i&&(L(i,a,l,g,d,r),j=r.Kh,r.copy||i.isDirtySuspended()||(j.wx=t.gnt(i,j.qI,s,f,c,h)),i.isDirtySuspended()||(j.Mx=t.gnt(i,j.$I,a,l,c,h)))),n=!0}finally{i.rt.q6={},t.q5(i,!0),i.QI=!1,T.Commands.xI(p,r)}P(i)}return n},_.prototype.gnt=function(t,n,i,r,e,o){var u,s,u=new l(t,v(i,r,e,o),this.tT.option),s=t.tables&&t.tables.WI&&t.tables.WI(i,r,e,o);return s&&0<s.length&&(this.tT.tableNamesObj={r:i,c:r,rc:e,cc:o,tableNames:s}),u.yI(n.bI()),M(t,i,r,e,o,u.MI(),0,s),u},_.prototype.XI=function(){var t,n,t,i,r,e,o,u,s,f,a,o,u,r,e,t=this,n=t.Mf,t=t.tT,i=t.Kh={},r=t.fromRow,e=t.fromColumn,o=t.toRow,u=t.toColumn,s=t.option,f=r<0?0:r,a=e<0?0:e,o=o<0?0:o,u=u<0?0:u,r=r<0?V(n):E(t),e=e<0?G(n):t.columnCount;t.insert||n.isDirtySuspended()||(t.copy||(i.qI=new l(n,v(f,a,r,e),s)),i.$I=new l(n,v(o,u,r,e),s)),i.pnt=n.R9,i.bnt=n.B9,i.ynt=n.ui,i.wnt=n.ci},_.prototype.undo=function(){var t,n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,F,t=this;if(t.canUndo()){if(n=t.Mf,r=(i=t.tT).fromRow,e=i.fromColumn,o=i.toRow,u=i.toColumn,s=E(i),f=i.columnCount,!n.zT(r,e,s,f,V(n),G(n)))return!1;if(!i.insert&&!n.zT(o,u,s,f,V(n),G(n)))return!1;l=i.Kh,t.X5(n,!(a=void 0)),c=t.vx(n),T.Commands.NI(c,i);try{i.insert?0<=e&&0<=r||(0<=e?(a=f,n&&L(n,-1,e,V(n),a,i)):0<=r&&(a=s,n)&&L(n,r,-1,a,G(n),i)):(g=r<0?0:r,d=e<0?0:e,p=o<0?0:o,w=u<0?0:u,m=r<0?V(n):s,_=e<0?G(n):f,n&&(L(n,r,e,s,f,i),y=i.tableNamesObj,C=[],D=[],y&&(y.r===p&&y.c===w&&y.rc===m&&y.cc===_?D=y.tableNames:C=y.tableNames),M(n,p,w,m,_,l.Mx?l.Mx.MI():[],0,C,!0),M(n,g,d,m,_,l.wx?l.wx.MI():[],0,D,!0))),n&&(-1!==l.ynt&&-1!==l.wnt&&((F=n.getSelections()[0]).contains(l.ynt,l.wnt)?n.XA(l.ynt,l.wnt):n.XA(F.row,F.col)),-2!==l.pnt)&&-2!==l.bnt&&-1!==l.ynt&&-1!==l.wnt&&n.showCell(l.ynt,l.wnt,3,3)}finally{t.q5(n,!0)}P(n)}return!0},F=_,T.Commands[e]={canUndo:!0,execute:function(t,n,i){return T.Commands.zA(t,D,n,i)}},T.Commands[o]={canUndo:!0,execute:function(t,n,i){return T.Commands.zA(t,F,n,i)}}},"./dist/plugins/fill/fill-event.js":function(e,t,n){var p,D,d,r,w,t,m,_,v,y,a,C,F,b,g,R,i,o,l,c,h,j,n,T;function x(t){return t.rowViewportIndex}function k(t){return t.colViewportIndex}function u(t){return t.frozenRowCount()}function f(t){return t.frozenColumnCount()}function s(t){return t.hitTestType}function M(t,n){return t.getRowCount(n)}function S(t,n){return t.getColumnCount(n)}function O(t){return t.colCount}function I(t){return t.rowCount}function A(t){return t.height}function E(t){return t.width}function N(t){var n,t,n=7,t=t.parent;return n=t?2007<t.SC?2:7:n}function V(t,n,i,r,e,o,u){var s,f,a;t.save(),o=o||h,u=u||2,n===r?(t.rect(n-2,i,7,g(e-i)),t.clip(),t.beginPath(),i<e?(i-=3,e+=3):(i+=3,e-=3),s=(0,D.Zx)(n-1,i-1,r-1,e+1,o,u),f=(0,D.Zx)(n,i,r,e,o,u),a=(0,D.Zx)(n+1,i-1,r+1,e+1,o,u)):i===e&&(t.rect(n,i-2,g(r-n),7),t.clip(),t.beginPath(),n<r?(n-=3,r+=3):(n+=3,r-=3),s=(0,D.Zx)(n-1,i-1,r+1,e-1,o,u),f=(0,D.Zx)(n,i,r,e,o,u),a=(0,D.Zx)(n-1,i+1,r+1,e+1,o,u)),s&&s.qx(t),f&&f.qx(t),a&&a.qx(t),t.strokeStyle=o,t.stroke(),t.beginPath(),t.restore()}function G(t,n,i,r,e,o,u,s,f,a,l){var c=n?D.Events.DragDropBlock:D.Events.DragDropBlockCompleted,i={sheet:t,sheetName:t.name(),fromRow:i,fromCol:r,toRow:e,toCol:o,rowCount:u,colCount:s,copy:f,insert:a,copyOption:l};return n&&(i.cancel=!1),t.ki(c,i),i}function L(t,n,i,r,e){for(var o,u,s,o=0;o<i.rowCount;o++){for(u=0;u<i.colCount;u++){if(!(s=t.getSpan(i.row+o,i.col+u))||s.rowCount!==n.rowCount||s.colCount!==n.colCount)return!1;r&&(u+=n.colCount)}e&&(o+=n.rowCount)}return!0}function B(t,n,i){var r,e,o,u,s,f,a,l,e,u,r,r=n.row,e=n.rowCount,o=n.col,u=n.colCount,s=i.row,f=i.rowCount,a=i.col,l=i.colCount,e=r===s&&e===f,u=o===a&&u===l;return(e||u)&&(r=t.getSpan(r,o))&&L(t,r,n,e,u)&&!t.Ut.GT(s,a,f,l)&&L(t,r,i,e,u)}Object.defineProperty(t,"__esModule",{value:!0}),p=n("Common"),D=n("Core"),d=n("SheetsCalc"),r=n("./dist/plugins/fill/fill-ui.js"),w=n("./dist/plugins/fill/fill.js"),t=n("./dist/plugins/fill/fill.ns.js"),m=n("CalcEngine"),_=!!m,v=D.GC$,y=D.Ec,a=p.Common.lt.ht,C=null,F=void 0,b=Math.min,g=Math.abs,R=Math.max,i=5,o=3,l="drag",c="corner",h="black",j=p.Common.zf,n=new p.Common.ResourceManager(t.SR,"Fill"),T=n.getResource.bind(n),v.extend(D.nk.prototype,{bk:function(t){var n,i,r,e,e,o,u,u,o,e,u,i,n=this;n.zk||(i=n.Mf,r=C,1===(e=i.Ut.getSelections()).length?r=e[0]:e.length<1&&(r=i.Ut.getSpan(i.ui,i.ci)),r&&(n.zk=!0,n.rb=!0,n.Mnt=r,(e=i.tables&&i.tables.find(r.row,r.col))&&(o=n.Cnt=!0,u=e.range(),o=!(e.showHeader()&&r.row===u.row||e.showFooter()&&r.row===u.row+u.rowCount-1||r.col!==u.col||r.colCount!==u.colCount)&&o)&&(n.Snt=!0,n.e_=!0,n.Tnt=e.name()),u=i.getRangeRect(x(t),k(t),r),(o=n.q6).x=u.x,o.y=u.y,o.width=u.width-1,o.height=u.height-1,o.row=r.row,o.col=r.col,o.rowCount=I(r),o.colCount=O(r),e=i.JS(r),u=t.row,i=t.col,(u=u<e.row?e.row:u)>=e.row+I(e)&&(u=e.row+I(e)-1),(i=i<e.col?e.col:i)>=e.col+O(e)&&(i=e.col+O(e)-1),o.hitRow=u,o.hitCol=i,o.rowOffset=u-e.row,o.colOffset=i-e.col,n.Rk={e9:x(t),r9:k(t),Bk:s(t)},n.Ok()))},Vk:function(){var t,n,i,r,e,o,u,r,i,s,f,t=this;t.Rk&&t.rb&&t.zk&&t.Mnt&&(n=t.fk,i=t.q6,e=(r=t.Mf.getCellRect(i.hitRow,i.hitCol)).width/2,o=r.x+e,u=r.height/2,r=r.y+u,i.hitTarget={x:n.x,y:n.y},i=t.Q9(),s=t.K9(),f=!1,(g(o-n.x)>5+e||g(r-n.y)>5+u)&&(f=!0),0<=i&&0<=s&&f&&t.Ant(i,s),t.a9())},Ant:function(t,n){var i,r,e,o,u,s,f,a,l,c,h,c,u,l,a,c,u,t,n,o,i=this;i.zk&&i.Mnt&&(r=i.Mf,e=i.q6,o=r.o5(),u=r.U5(),s=M(r),f=S(r),a=b(f-O(e),n-e.colOffset),l=b(s-I(e),t-e.rowOffset),o&&(c=r.ox(n,e.colOffset+1),l-=h=r.ox(t,e.rowOffset+1,!0),0===r.getColumnWidth(a-=c)&&(a=r.r6(a)),0===r.getRowHeight(l))&&(l=r.nI(l)),-1===u.row&&-1!==u.col?(e.row=-1,e.col=R(0,a)):-1!==u.row&&-1===u.col?(e.row=R(0,l),e.col=-1):(e.row=e.row<0?-1:R(0,l),e.col=e.col<0?-1:R(0,a)),i.Snt&&(u=(c=r.tables&&r.tables.find(t,n))&&c.range(),!c||c.name()!==i.Tnt||t===u.row||c.showFooter()&&t===u.row+u.rowCount?i.e_=!1:i.e_=!0,i.e_?(e.col=u.col,i.i_=!i.isPressShiftKey):i.i_=i.isPressShiftKey),e.hitRow=t,e.hitCol=n,l=r.JS(e),o&&(a=r.lT(l.row,l.rowCount,!0),c=r.lT(l.col,l.colCount),l.rowCount+=a,l.colCount+=c,l.rowCount=b(s,l.rowCount),l.colCount=b(f,l.colCount),l.row+l.rowCount>s&&(l.row=s-l.rowCount,e.row=l.row),l.col+l.colCount>f)&&(l.col=f-l.colCount,e.col=l.col),(u=i.Int)&&l.row===u.row&&l.col===u.col&&I(l)===I(u)&&O(l)===O(u)&&l.row>r.N9()&&l.col>r.k9()&&l.row+I(l)-1<r.P6()&&l.col+O(l)-1<r.G6()||(i.xnt=l,r.Dn.o_(),i.Int=l,(t=r.parent)&&t.options.showDragDropTip&&(n=e.x+e.width+5,o=e.y+e.height+5,t.Tw(j.j0(i.Nnt(l)),n,o))))},Nnt:function(t){var n,i,r,e,o,u,s,f,a,l,c,h,v,g;return t&&_?(r=I(i=(n=this.Mf).U5()),e=O(i),o=n.getActiveRowIndex(),u=n.getActiveColumnIndex(),s=void 0,f=n.o5(),o=o<0?0:o,u=u<0?0:u,s=1===r&&1===e?m.knt(C,C,t.row-o,t.col-u,!0,!0):(h=c=l=a=void 0,g=v=0,-1===i.row&&0<=i.col?(a=c=d.BAND_INDEX_CONST,l=t.col-u,h=t.col-u+e-1,g=e):-1===i.col&&0<=i.row?(l=h=d.BAND_INDEX_CONST,a=t.row-o,c=t.row-o+r-1,v=r):0<=i.row&&0<=i.col&&(a=t.row-o,c=t.row-o+r-1,l=t.col-u,h=t.col-u+e-1,v=r,g=e),f&&(c+=n.lT(t.row,v,!0),h+=n.lT(t.col,g)),m.lJ(C,C,a,l,c,h,!0,!0,!0,!0,o,u)),n.op().unparse(n.Uw(),s,o,u)):F},kD:function(t){var n,i,r,e,o,u,u,s,f,a,l,c,h,v,u,g,d,p,w,w,m,w,m,m,n=this,i=!1,r="",e=!1,o=n.Mf;n.Rk=C,n.l9(),u=o.U5(),s=n.q6.row,f=n.q6.col,a=n.q6.hitRow,l=n.q6.hitCol,n.i_&&u.contains(a,l)||(u=u&&(0<I(u)||0<O(u))?{r:u.row,c:u.col,rc:I(u),cc:O(u)}:{r:o.ui,c:o.ci,rc:1,cc:1},!0===n.zk&&!0===n.rb&&(c=u.r,h=u.c,v=u.rc,u=u.cc,g=o.options.protectionOptions,d=o.lF,p=void 0,n.shiftCells=null,n.i_&&(n.shiftCells=n.Dnt?D.InsertShiftCell.right:D.InsertShiftCell.down),w={fromRow:c,fromColumn:h,rowCount:v,columnCount:u,toRow:s,toColumn:f,isDragInsert:n.i_,isDragCopy:n.t_},o.ki(D.Events.BeforeDragDrop,w),(r=w.invalidMessage)&&0!==r.length||(!n.i_||-1!==c&&-1!==h?s===c&&f===h||(w=o.GT(c,h,v,u),m=o.GT(s,f,v,u),!w&&!m||(m=!1,m=!(w||n.shiftCells!==D.InsertShiftCell.right&&n.shiftCells!==D.InsertShiftCell.down)||m)||(i=!0,r=T().Exp_ChangeMergedCell),i||_&&(o.KT(c,h,v,u)||o.KT(s,f,v,u))&&(i=!0,r=T().Exp_ChangePartOfArray),!i&&o.options.isProtected&&(!n.t_&&o.dA(y(c,h,v,u),!0,D.SheetArea.viewport)||o.dA(y(s,f,v,u),!0,D.SheetArea.viewport))&&(i=!0,r=o.FT()),i)||(n.i_&&(n.Dnt?f=n.q6.hitCol:s=n.q6.hitRow),(p=G(o,!0,c,h,s,f,v,u,n.t_,!1,d)).cancel)||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:c,fromColumn:h,toRow:s,toColumn:f,rowCount:v,columnCount:u,copy:n.t_,insert:n.i_,shiftCells:n.shiftCells,option:p.copyOption,mouseTargetRow:a,mouseTargetCol:l}),G(o,!1,c,h,s,f,v,u,n.t_,!1,p.copyOption)):0<=h?(n.t_&&(f<=h||h+u<=f)||!n.t_&&(f<h||h+u<f))&&((o.GT(-1,h,-1,u)||o.GT(-1,f,-1,0))&&(i=!0,r=T().Exp_ChangeMergedCell),w=g&&g.allowDragInsertColumns,!i&&o.options.isProtected&&!0!==w&&(i=!0,r=T().Exp_ColumnReadOnly),i||(p=G(o,!0,-1,h,-1,f,-1,u,n.t_,!0,d)).cancel||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:-1,fromColumn:h,toRow:-1,toColumn:f,rowCount:-1,columnCount:u,copy:n.t_,insert:!0,option:p.copyOption,mouseTargetRow:a,mouseTargetCol:l}),G(o,!1,-1,h,-1,f,-1,u,n.t_,!0,p.copyOption))):0<=c&&h<0&&(n.t_&&(s<=c||c+v<=s)||!n.t_&&(s<c||c+v<s))&&((o.GT(c,-1,v,-1)||o.GT(s,-1,0,-1))&&(i=!0,r=T().Exp_ChangeMergedCell),i||_&&(o.KT(c,-1,v,-1)||o.KT(s,-1,0,-1))&&(i=!0,r=T().Exp_ChangePartOfArray),m=g&&g.allowDragInsertRows,!i&&o.options.isProtected&&!0!==m&&(i=!0,r=T().Exp_RowReadOnly),i||(p=G(o,!0,c,-1,s,-1,v,-1,n.t_,!0,d)).cancel||(e=o.Qy().execute({cmd:"dragDrop",sheetName:o.name(),fromRow:c,fromColumn:-1,toRow:s,toColumn:-1,rowCount:v,columnCount:-1,copy:n.t_,insert:!0,option:p.copyOption,mouseTargetRow:a,mouseTargetCol:l}),G(o,!1,c,-1,s,-1,v,-1,n.t_,!0,p.copyOption)))))),n.rb=!1,n.zk=!1,n.Snt=!1,n.Cnt=!1,n.e_=!1,n.Tnt=C,n.Mnt=C,n.i_=!1,n.t_=!1,n.Int=C,n.xnt=C,n.iy(),e||(n.q6={},o.repaint()),i&&o.jT(3,r)},wk:function(t){var n=this;!0!==n.Yk&&!0!==n.rb&&(n._nt(),n.Ktt)&&(n.rb=!0,n.Yk=!0,n.hO=!0,n.Ent=t,n.jnt=k(t),n.Ont=x(t),n.Rnt=k(t),n.Bnt(),n.Rk={e9:x(t),r9:k(t),Bk:s(t)},n.Ok())},Bnt:function(){var t,n,i,r,n,t=this,n=u(t.Mf),i=f(t.Mf),r=t.Lnt();0<=r&&r<n?t.Fnt=0:n<=r&&r<=M(t.Mf)&&(t.Fnt=1),t.Pnt()?t.Gnt=1:t.Gnt=t.Ent,0<=(n=t.Unt())&&n<i?t.Hnt=0:i<=n&&n<=S(t.Mf)&&(t.Hnt=1),t.znt()?t.Vnt=1:t.Vnt=t.jnt},Zk:function(){var t,n,i,r,t=this;t.Rk&&t.Yk&&t.rb&&t.Ktt&&(t.Ont=t.nD(),t.Rnt=t.eD(),t.Ynt=t.Q9(),t.Znt=t.K9(),0<=t.Ynt&&0<=t.Znt&&(t.Wnt(),t.Qnt(),n=t.Mf.parent,i=!1,(r=t.Knt())&&(i=t.Jnt(t.Ktt,t.Xnt,!0)),n&&n.options.showDragFillTip&&i&&t.qnt(),t.$nt()),t.a9())},tet:function(){var t,n,i,r,e,e,o,u,s,s,f,u,a,l,c,h,v,h,v,g,d,t=this,n=t.Mf,i=t.Ktt,r=t.Xnt,e=n.parent.options.defaultDragFillType,e=t.net(3===e?5:e,3===e),o=t.eet(),u=t.Knt();return 1===e?(s=0===o||1===o?1:0,u=(f=new w.Wtt(n)).Jtt(u,s,!0),s=t.iet(o,r,i),l=(a=n.getActualStyle(s.row,s.col)).cellType||n.$f(),c=a.formatter||a._autoFormatter,h=p.Formatter&&p.Formatter.GeneralFormatter,u instanceof Date&&h&&(c=new h(p.Common.CultureManager.Fe().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),h=3,(v=t.Rk)&&(h=v.Bk),v={sheet:n,row:s.row,col:s.col,sheetArea:h,quotePrefix:a.quotePrefix},l.format(u,c,g={},v)):0!==e||(s=t.iet(o,r,i),d=n.getFormula(s.row,s.col))?C:n.getText(s.row,s.col)},iet:function(t,n,i){var r,e,o,i,u,s,r=i.row,e=i.col,o=I(i),i=O(i),u=y(r,e,1,1);return 3===t?(s=I(n)%o,u.row=s=0===s?r+o-1:r+s-1,u.col=e):1===t?(s=0===(s=O(n)%i)?e+i-1:e+s-1,u.row=r,u.col=s):0===t?(s=0===(s=O(n)%i)?e:e+i-s,u.row=r,u.col=s):2===t&&(s=I(n)%o,u.row=s=0===s?r:r+o-s,u.col=e),u},qnt:function(){var t,n,i,r,e,o,u,o,n,t=this,n=t.Mf,i;if(4===t.net()||t.znt()||t.Pnt())return t.iy(),C;u=t.eet(),o=t.Knt(),n=n.j1(o),o=t.tet(),3===u||1===u?(r=n.x+n.width+3,e=n.y+n.height+3):0===u?(r=n.x+3,e=n.y+n.height+3):2===u&&(r=n.x+n.width+3,e=n.y+3),t.Tw(o,r,e)},$nt:function(){var t=this;t.ret(),t.oet(),t.aet(),t.uet=t.Knt()},ret:function(){var t,n,t=this.Mf;this.uet&&((n=t.j1(this.uet)).x-=2,n.y-=2,n.width+=4,n.height+=4,t.Dn.O1(n))},oet:function(t){var n;this.Mf.Dn.E1(this.Ktt,C,t)},aet:function(){var t,n,i,r,i,e,t,t=this.Mf,n=t.Dn,i=this.Knt();i&&(r=n.J(),i=t.j1(i),e=t.getSelectionBorderColor(),t=N(t),r.save(),r.beginPath(),n.cet(r,i,e,t),r.restore())},Qnt:function(){this.Xnt=this.dO()},znt:function(){return-1===this.Ktt.col&&-1!==this.Ktt.row},Pnt:function(){return-1===this.Ktt.row&&-1!==this.Ktt.col},lO:function(){return 4===this.bO||5===this.bO},dO:function(){var t,n,i,r,e,t=this,n=-1,i=-1,r=-1,e=-1;switch(t.bO){case 0:r=t.Pnt()?n=-1:(n=t.Lnt(),I(t.Ktt)),i=t.Znt,e=t.Unt()-i;break;case 1:r=t.Pnt()?n=-1:(n=t.Lnt(),I(t.Ktt)),i=t.fet()+1,e=t.Znt-i+1;break;case 2:n=t.Ynt,r=t.Lnt()-n,e=t.znt()?i=-1:(i=t.Unt(),O(t.Ktt));break;case 3:n=t.let()+1,r=t.Ynt-n+1,e=t.znt()?i=-1:(i=t.Unt(),O(t.Ktt));break;case 5:n=t.Ynt,r=t.let()-n+1,e=t.znt()?i=-1:(i=t.Unt(),O(t.Ktt));break;case 4:r=t.Pnt()?n=-1:(n=t.Ktt.row,I(t.Ktt)),i=t.Znt,e=t.fet()-i+1}return y(n,i,r,e)},het:function(){var t=this.let();return-1!==t?this.Mf._y(this.Gnt).findRow(t):C},det:function(){return this.Mf._y(this.Ont).findRow(this.vet())},vet:function(){return this.Mf.getViewportBottomRow(this.Ont)},met:function(){var t=this.fet();return-1!==t?this.Mf.Yy(this.Vnt).findCol(t):C},pet:function(){return this.Mf.Yy(this.Rnt).findCol(this.bet())},bet:function(){return this.Mf.getViewportRightColumn(this.Rnt)},Wnt:function(){var t,n,i,r,e,o,u,s,e,r,f,a,l,c,o,u,c,l,o,u,f,a,l,o,u,f,l,u,a,h,t=this,n=t.znt(),i=t.Pnt(),r=v(t.Mf.Dg()).offset(),e=t.fk.e,o=t.fk.x,u=t.fk.y,s=e.pageX-r.left,e=e.pageY-r.top,r=!1;n||i?i?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=4:t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):n&&(t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.bO=5:t.Ynt<t.Lnt()?t.bO=2:t.Ynt>t.let()&&(t.bO=3)):t.Ynt>=t.Lnt()&&t.Ynt<=t.let()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?(f=g(t.Znt-t.fet()))<(a=g(t.Ynt-t.let()))?t.bO=5:a<f?t.bO=4:u>(l=(l=t.het())||t.det()).y+l.height?t.bO=3:(o=(c=(c=t.met())||t.pet()).x+c.width-o,u=l.y+l.height-u,s>=c.x&&s<=c.x+c.width&&e>=l.y&&e<=l.y+l.height?t.bO=u<=o?4:5:r=!0):t.Znt<t.Unt()?t.bO=0:t.Znt>t.fet()&&(t.bO=1):t.Ynt<t.Lnt()?t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=2:t.Znt<t.Unt()?(f=g(t.Znt-t.Unt()),a=g(t.Ynt-t.Lnt()),t.bO=f<=a?2:0):t.Znt>t.fet()&&(f=g(t.Znt-t.fet()),a=g(t.Ynt-t.Lnt()),t.bO=f<=a?2:1):t.Ynt>t.let()&&(t.Znt>=t.Unt()&&t.Znt<=t.fet()?t.bO=3:t.Znt<t.Unt()?(f=g(t.Znt-t.Unt()),a=g(t.Ynt-t.let()),t.bO=f<=a?3:0):t.Znt>t.fet()&&(f=g(t.Znt-t.fet()),a=g(t.Ynt-t.let()),t.bO=f<=a?3:1)),(c=t.Mf.Dn.yet)&&(u=(l=t.let())+1,f=(o=t.fet())+1,a=t.Mf.getRowHeight(l,3),l=t.Mf.getColumnWidth(o,3),o=t.Mf.getRowHeight(u,3),u=t.Mf.getColumnWidth(f,3),f=c.x+c.width/2-b(10,l/2),l=c.x+c.width/2+b(10,u/2),u=c.y+c.height/2-b(10,a/2),a=c.y+c.height/2+b(10,o/2),h=!1,(h=n||i?i?f<=s&&s<=l:u<=e&&e<=a:f<=s&&s<=l&&u<=e&&e<=a)||r?(t.hO=!0,t.bO=4):t.hO=!1)},Lnt:function(){return this.Ktt?-1===this.Ktt.row?0:this.Ktt.row:-1},let:function(){var t=this;return t.Ktt?-1===t.Ktt.row?M(t.Mf)-1:t.Ktt.row+I(t.Ktt)-1:-1},Unt:function(){return this.Ktt?-1===this.Ktt.col?0:this.Ktt.col:-1},fet:function(){var t=this;return t.Ktt?-1===t.Ktt.col?S(t.Mf)-1:t.Ktt.col+O(t.Ktt)-1:-1},wet:function(t,n){var n,i,r,e,e,r,e,t,n=y(n.row,n.col,n.rowCount,n.colCount),i=this.Mf;return i.Ut.findSpan(t.row,t.col)&&(r=t.rowCount,e=n.rowCount,0!==Math.floor(e%r)&&(e=Math.ceil(e/r)*r,n.row+e<=i.getRowCount())&&(n.rowCount=e),r=t.colCount,e=n.colCount,0!==Math.floor(e%r))&&(t=Math.ceil(e/r)*r,n.col+t<=i.getColumnCount())&&(n.colCount=t),n},DD:function(){var t,n,i,r,e,o,u,s,t=this,n=t.Mf;t.Rk=C,t.l9(),t.iy(),t.Yk&&t.rb?(t.Yk=!1,t.rb=!1,(i=t.Knt())&&(!(r=t.Jnt(t.Ktt,t.Xnt))||t.hO?(t.Met(),t.Ax(i)):(e=n.rt.Ktt,o=t.wet(e,t.Xnt),u=t.net(),n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:e,fillRange:o,autoFillType:u,fillDirection:n.rt.eet()}),!(s=t.lnt)&&t.Cet()&&n.parent.options.showDragFillSmartTag&&4!==t.fnt?t.Tet(t.fnt):t.Ax(i),t.Met()))):t.Met()},Tet:function(t){var n,i,i,n=this.Mf,i=n.Dn.yet,i={x:i.x+i.width,y:i.y+i.height,fillType:t};n.R_=new r.Aet(n.parent.j2(),n,i),n.R_.rQ()},_nt:function(){var t,n,n,i,t=this.Mf,n=t.Ut.getSelections();1===n.length?(n=n[0],(i=t.Ut.getSpans(n))&&0<i.length&&(n=t.kR(i,n)),this.Ktt=n):0<=t.ui&&0<=t.ci&&(this.Ktt=y(t.ui,t.ci,1,1))},Met:function(){this.rb=!1,this.Yk=!1},Ax:function(t){this.Mf.Dn.E1(t)},net:function(t,n){var i,r,t,e,i=this,r=i.Mf,t=t!==F?t:r.parent.options.defaultDragFillType;return i.lO()?4:5!==t?t:(e=1===I(i.Ktt)&&1===O(i.Ktt)&&!i.Pnt()&&!i.znt())?i.a_&&!n?1:0:i.a_&&!n?0:1},Knt:function(){var t,n,i,r,e,t=this;return t.Ktt?t.lO()?t.Ktt:t.Xnt?(e=r=i=n=0,e=t.Iet()?(n=(2===t.bO?t.Xnt:t.Ktt).row,i=I(t.Ktt)+I(t.Xnt),r=t.Ktt.col,O(t.Ktt)):(n=t.Ktt.row,i=I(t.Ktt),r=(0===t.bO?t.Xnt:t.Ktt).col,O(t.Ktt)+O(t.Xnt)),y(n,r,i,e)):C:C},Jnt:function(t,n,i){var r,e,o,r=this.Mf,e=!0,o="";return r.Ut.eE(n.row,n.col,I(n),O(n))&&!B(r,t,n)&&(e=!1,o=T().Exp_FillRangeContainsMergedCell),e&&r.options.isProtected&&r.dA(n,!0,D.SheetArea.viewport)&&(e=!1,o=r.FT()),e||i||r.ki(D.Events.InvalidOperation,{sheet:r,sheetName:r.name(),invalidType:D.InvalidOperationType.dragFill,message:o,fillRange:n}),e},Cet:function(){return this.xet()||this.Net()},xet:function(){return 3===this.bO||1===this.bO},Net:function(){return 0===this.bO||2===this.bO},Iet:function(){return 2===this.bO||3===this.bO||5===this.bO},eet:function(){var t=this.bO;return 0<=t&&t<=3?t:4===t?0:5===t?2:3},VL:function(t,n,i){var r,e,o,t,u,s,f,u,o,r=this,e=C,o=x(t),t=k(t),u=r.Mf,s=u.parent;if(!a(o)&&!a(t)&&(s.options.allowUserDragDrop||s.options.allowUserDragFill)&&(-1!==(f=u.U5()).row||-1!==f.col)){if(0<=o&&0<=t&&1===u.Ut.getSelections().length){if(r.yD(o,t,n,i))return e;(e=(u=u.getRangeRect(o,t,f)).x-4<n&&n<u.x+4&&u.y<=i&&i<u.y+u.height?{action:l,side:"left"}:e)||(o=r.Mf.Dn.yet)&&o.x<=n&&n<=o.x+o.width&&o.y<=i&&i<=o.y+o.height&&(e={action:l,side:c}),e||u.x+u.width-4<n&&n<u.x+u.width+4&&u.y<=i&&i<u.y+u.height&&(e={action:l,side:"right"}),e||u.y-4<i&&i<u.y+4&&u.x<=n&&n<u.x+u.width&&(e={action:l,side:"top"}),e||u.y+u.height-4<i&&i<u.y+u.height+4&&u.x<=n&&n<u.x+u.width&&(e={action:l,side:"bottom"}),e&&(n<u.x||n>u.x+u.width||i<u.y||i>u.y+u.height)&&(e.outside=!0)}s&&s.options.allowUserDragDrop||e&&e.side!==c&&(e.side=C),s&&s.options.allowUserDragFill||e&&e.side===c&&(e.side=C)}return e},ket:function(t,n){var i,r,e,i=this,r,e=i.Mf.getSpan(t,n,3);return e?!a(i.Mf.getValue(e.row,e.col,3,0)):!a(i.Mf.getValue(t,n,3,0))},Det:function(t,n){var i,r,e,e,i,r,e=this.Mf.tables;return!(!e||0===e.all().length)&&(e=e.AB(t,n,1,1)[0])&&e.footerIndex()===t},_et:function(t,n,i,r){for(var e,o,e=this,o=n;o<n+r;o++)if(!e.ket(t,o)||e.Det(t,o))return!1;return!0},Eet:function(t,n,i,r){for(var e,o,e=this,o=n;o<n+r;o++)if(e.ket(t,o))return!1;return!0},jet:function(t,n,i,r){var e,o,u,s,f,a,l,c,h,e=this,o=e.Mf;if("left"===r){for(u=0;u<n;u++)e.ket(t,u)&&(i.searchArray[u]=!0);for(s=n-1,f=1;i.searchArray[s];)s--,f++;i.searchLength=f}if("right"===r){for(a=o.getColumnCount(),l=n;l<a;l++)e.ket(t,l)&&(i.searchArray[l-n]=!0);for(c=0,h=1;i.searchArray[c];)c++,h++;i.searchLength=h}return i},Oet:function(t,n,i,r,e){for(var o,u,s,f,a,l,c,h,v,g,o=this,u=o.Mf,s=0,f={searchArray:new Array(r),searchLength:1},a={searchArray:new Array(u.getColumnCount()-e),searchLength:1},l=n;l<i;l++)f=o.jet(l,t.col,f,"left"),a=o.jet(l,t.col+t.colCount-1,a,"right");for(;o.Eet(i+s,t.col,1,t.colCount);){for(h=!(c=!0),f=o.jet(i+s,r,f,"left"),a=o.jet(i+s,e,a,"right"),v=r-1;v>=r-f.searchLength;v--)if(o.ket(i+s,v)){s++,c=!1;break}if(c){for(g=e+1;g<=e+a.searchLength;g++)if(o.ket(i+s,g)){s++,h=!0;break}if(!h)return s}}return s},Ret:function(t){for(var n,i,n=this,i=0;n._et(t.row+t.rowCount+i,t.col,1,t.colCount);)i++;return i},Bet:function(t){var n,i,r,e,o,n=this;return n._et(t.row+t.rowCount,t.col,1,t.colCount)?n.Ret(t):(e=t.row-2,o=t.row+t.rowCount,r=1===t.colCount?i=t.col:(i=t.col,t.col+t.colCount-1),n.Oet(t,e,o,i,r))},H_:function(){var t,n,i,r,r,e,o,t=this,n=t.Mf,i=n.rt.Ktt,r=t.Bet(i);0!==r&&(r=y(i.row+i.rowCount,i.col,r,i.colCount),t.bO=3,t.Xnt=r,e=t.net(),o=t.lnt,n.Qy().execute({cmd:"fill",sheetName:n.name(),startRange:i,fillRange:r,autoFillType:e,fillDirection:t.bO}),!o)&&n.parent.options.showDragFillSmartTag&&4!==t.fnt&&t.Tet(t.fnt)}}),v.extend(D.g7.prototype,{Let:function(t,n){var i,r,e,o,t,u,i,s,f,n,i=this.Mf,r=t.x,e=t.y,o=E(t),t=A(t),u=i.U5(),i=i.Fi(),s=4,f=-2.5;return 2007<n&&(s=5,f=-3),n=new D.Rect(-4,-4,s,s),-1===u.col?(n.x=i.b6,n.y=e+t+f):-1===u.row?(n.x=r+o+f,n.y=i.T6):(n.x=r+o+f,n.y=e+t+f),n},yO:function(t,n,i,r,e){var o,u,s,f,f,r,a,l,c,h,s,n,i,o=this,u=o.Mf,s=u.Fi(),f=u.parent,f=f&&f.SC,r=o.Let(r,f),a=r.x,l=r.y,c=E(r),h=A(r),s=s.c9(n,i);e&&!r.intersectRect(e)||r.intersectRect(s)&&(n=-1.5,(i=new D.Rect(a+(n=2007<f?-1:n),l+n,c+2,h+2)).x=R(i.x,s.x),i.y=R(i.y,s.y),o.O1(i),t.save(),e&&!e.containsRect(r)&&(t.rect(e.x,e.y,E(e),A(e)),t.clip()),t.beginPath(),t.fillStyle=D.Pf.vl(u,u.getSelectionBorderColor()),t.fillRect(a,l,c,h),o.yet=new D.Rect(r.x,r.y,4,4),t.beginPath(),t.restore())},cet:function(t,n,i,r){var e=n.x,o=n.y,u=e+E(n),n=o+A(n);V(t,e-2,o,u+1,o,i,r),V(t,e-1,n,u+1,n,i,r),V(t,e,o-1,e,n+1,i,r),V(t,u,o-1,u,n+1,i,r)},Fet:function(t,n){var i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,c,w,m,_,y,_,u,_,l,a,C,i=this,r=i.Mf,e=r.rt,o=e.q6,u=o.hitTarget;o&&u&&(s=o.hitCol,f=o.hitRow,a=o.row,l=o.col,c=e.i_,h=r.Pet,g=r.getSelectionBorderColor(),d=N(r),p=8,t.save(),!0===c?(c=r.Yy(0).findCol(s)||r.Yy(1).findCol(s)||r.Yy(2).findCol(s),w=r._y(0).findRow(f)||r._y(1).findRow(f)||r._y(2).findRow(f),-1===o.row&&-1!==o.col?c&&(m=c.x,_=E(c),o.col=s,u.x>m+_/2&&(o.col<r.rD()||o.col===r.G6())&&(m=c.x+E(c),o.col++),(h=h&&0===E(h)?h:e.q6)&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),r.Uet=new D.Rect(m,o.y,0,A(o)),t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),V(t,m-8,o.y,m+8,o.y,g,d),V(t,m,o.y,m,o.y+A(o),g,d),V(t,m-8,o.y+A(o),m+8,o.y+A(o),g,d)):-1!==o.row&&-1===o.col?w&&(y=w.y,_=A(w),o.row=f,u.y>y+_/2&&(o.row<r.iD()||o.row===r.P6())&&(y=w.y+A(w),o.row++),(h=h&&0===A(h)?h:e.q6)&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),r.Uet=new D.Rect(o.x,y,E(o),0),t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),V(t,o.x,y-8,o.x,y+8,g,d),V(t,o.x,y,o.x+E(o),y,g,d),V(t,o.x+E(o),y-8,o.x+E(o),y+8,g,d)):-1!==o.row&&-1!==o.col&&(u=r.Yy(0).findCol(l)||r.Yy(1).findCol(l)||r.Yy(2).findCol(l),_=r._y(0).findRow(a)||r._y(1).findRow(a)||r._y(2).findRow(a),w)&&c&&_&&u&&(m=u.x,y=_.y,h&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),l=!1,a=r.getCellRect(f,s),(l=!e.Cnt&&a?(C=o.hitTarget.x-a.x)<b(16,r.nn(s)/4):l)?m=c.x:y=w.y,r.Uet=new D.Rect(m,y,E(o),A(o)),r.U5().contains(f,s)||(t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),l?(V(t,m-8,y,m+8,y,g,d),V(t,m,y,m,y+A(o),g,d),V(t,m-8,y+A(o),m+8,y+A(o),g,d),e.Dnt=!0):(V(t,m,y-8,m,y+8,g,d),V(t,m,y,m+E(o),y,g,d),V(t,m+E(o),y-8,m+E(o),y+8,g,d),e.Dnt=!1)))):(h&&(v=new D.Rect(h.x-8,h.y-8,E(h)+16,A(h)+16),i.O1(v,n),i.E1(r.U5(),n)),t.rect(n.x,n.y,E(n),A(n)),t.clip(),t.beginPath(),i.cet(t,o,g,d)),t.beginPath(),t.restore())},o_:function(){var t,n,i,r,i,e,o,u,s,f,a,l,c,s,a,t=this,n=t.Mf,i=n.sw,r=n.rt.xnt;i&&i.dragInfo&&r&&(i=t.J(),e=n.Fi(),o=n.rt.q6,u=n.j1(r),s=n.frozenTrailingColumnCount(),f=n.frozenTrailingRowCount(),a=n.getColumnCount()-s,l=n.getRowCount()-f,c=e.c9(1,1),0<s&&r.col+r.colCount<=a&&u.x+E(u)>c.x+E(c)&&u.intersectRect(c)&&(u=u.getIntersectRect(c)),0<f&&r.row+r.rowCount<=l&&u.y+A(u)>c.y+A(c)&&u.intersectRect(c)&&(u=u.getIntersectRect(c)),s=new D.Rect(e.b6,e.T6,e.Hy+e.zy,e.Ay+e.Iy),0<=E(u)&&0<=A(u)&&(o.x=u.x,o.y=u.y,o.width=E(u),o.height=A(u),t.Fet(i,s)),a=n.rt.i_,n.Pet=!0===a?n.Uet:new D.Rect(o.x,o.y,E(o),A(o)))}})},"./dist/plugins/fill/fill-ui.js":function(N,t,n){var i,V,u,n,s,f,r,a,l,e,o,c,h,v,g,d,p,w,m,_,y,C,G,L,D,F,b,R,j,T,x,k,B,e,M,W,$,H,S,O;function I(t,n,i,r,e,o){var t=t.Oi,u=t?"160px":"150px",t=t?"25px":"20px",u=s(f("div")).css([C,L,D,"padding",F],["block",u,t,0,0]).addClass("gc-smartMenu-item-default "+i+" ui-state-default"+l),t=s(f("div")).addClass(d).appendTo(u),i=s(f("div")).addClass("gc-menu-item-text").appendTo(u),n=s(f("input")).attr({id:n,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(t);return s(f("span")).text(r).appendTo(i),o?(t.addClass(g),n.prop("checked","checked")):n.prop("checked",""),u}function A(t,n){var t,i,t=S.call(this,t,r(n.parent.Ti))||this;return t.Mf=n,t.Het=s("."+w),(i=t.g$=t.Xc()).addClass(c),I(n,"smartMenuCopyCells",o,M().CopyCells,"0",!0).appendTo(i),I(n,"smartMenuFillSeries",o,M().FillSeries,"1").appendTo(i),n.NMi||(I(n,"smartMenuFillFormattingOnly",o,M().FillFormattingOnly,"2").appendTo(i),I(n,"smartMenuFillWithoutFormatting",o,M().FillWithoutFormatting,"3").appendTo(i)),t}function E(t,n,i){var t,n,t=O.call(this,t,r(n.parent.Ti))||this;return t.Mf=n,t.zet=i,n=t.Vet=t.Xc().addClass("gc-smart-tag-default "+w+" gc-no-user-select ui-widget-header"+l),t.Yet=s(f("div")).attr("class","fillSmartTag").css(m,_).appendTo(n),t.Zet=s(f("div")).attr("class","fillSmartTagDown").css([m,C],[_,"none"]).appendTo(n),t}i=this&&this.__extends||(H=function(t,n){return(H=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}H(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Aet=void 0,V=n("Common"),u=n("Core"),n=n("./dist/plugins/fill/fill.ns.js"),s=u.GC$,f=u.mt.En,r=u.mt.gi,a=s(document),l=" btn btn-default",o="gc-fill-type-item",c="gc-fill-menu-container",h=(e="ui-state-hover ")+"gc-smartMenu-item-hover",v=e+"gc-smart-tag-hover",g="ui-icon ui-icon-check gc-check-image",d="gc-menu-item-input",p="ui-state-active gc-smart-tag-active",w="gc-tag-container",m="float",_="left",y="top",C="display",G="width",L="min-width",D="height",F="margin",b="change",R="input[type=radio]",j="mouseover",T="mouseout",x="click",k="fillTypeChanged",B="keydown.ui-fill",e=new V.Common.ResourceManager(n.SR,"Fill"),M=e.getResource.bind(e),S=u.zc,i(A,S),A.prototype.$c=function(){S.prototype.$c.call(this)},A.prototype.aY=function(){var e,t,n,e=this,t;s("."+o).bind(j,function(){s(this).addClass(h)}).bind(T,function(){s(this).removeClass(h)}).bind(x,function(){var t,n,i,r,i,t=s(this),n=e.Het,i=t.find(R),r=i[0];r.checked=!0,i.trigger(b),n.trigger(x),n.trigger(T),t.removeClass(h),i=parseInt(s(r).attr("value"),10),e.Wet(i)}),(n=e.g$.find(R)).bind(b,function(){s("."+d).removeClass(g),s(this).parent().addClass(g)})},A.prototype.Qet=function(){s("."+o).unbind(j).unbind(T).unbind(x),this.g$.find(R).unbind(b)},A.prototype.Wet=function(t){var n=this,i=n.Mf,r=i.rt;if(n.Ket!==t){n.Ket=t,i.cnt=!0,i.suspendEvent();try{u.Commands.undo.execute(i.parent,{sheetName:i.name()})}finally{i.resumeEvent()}i.cnt=!1,i.Qy().execute({cmd:"fill",sheetName:i.name(),startRange:r.Ktt,fillRange:r.Xnt,autoFillType:t,fillDirection:r.bO}),n.Het.trigger(k,t)}},A.prototype.Jet=function(){return!!s("."+c).length},W=A,O=u.zc,i(E,O),E.prototype.Xet=function(t,n,i){var r=this,e=r.Mf.Oi,n=s(n),o=r.qet,r=r.Zet,u=e?"38px":"32px",e=e?"24px":"18px";o&&o.Jet()||(t?n.addClass(v):n.removeClass(v),n.css([G,D],[t?u:e,e]),i)||(t?r.show():r.hide())},E.prototype.$et=function(){var e=this,t=e.Vet,n=u.mt.pi(),o=u.mt.Tt.safari&&(n.ipad||n.iphone);t.bind(j,function(){e.Xet(!0,this,o)}).bind(T,function(){e.Xet(!1,this,o)}),t.bind(x,function(){var t,n,i,r,n,i,t=s(this),n=e.qet,i=e.Zet,r;n&&n.Jet()?(o&&i.hide(),t.removeClass(p),e.tit()):(o&&i.show(),t.addClass(p),e.nit(),(i=(n=e.g$)&&n.find(R)[e.zet.fillType])&&!i.checked&&(i.checked=!0,s(i).trigger(b)))}),a.bind(B,function(t){27===t.keyCode&&(e.qet&&e.qet.Jet()?e.tit():e.close(),u.mt.vi(t))})},E.prototype.rQ=function(){var t=this,n=t.Vet,i=t.zet,r=t.Mf.Oi,e=r?"3px":"0px",r=r?"24px":"18px";n&&(n.css([_,y],[i.x,i.y]),t.$c(),t.$et(),t.Yet.css(F,e),t.Zet.css(D,r),t.c5())},E.prototype.nit=function(){var t,n,n,i,r,r,e,o,u,t=this,n=t.Mf;t.qet||(t.qet=new W(n.parent.j2(),n),t.g$=t.qet.Xc()),i=(n=t.Vet).css(_),r=n.css(y),r=parseFloat(r),o=t.qet,u=t.zet,o.Ket=u.fillType,isNaN(r)||(e=r+n.height()+2),t.g$.css([_,y],[i,e]),o.$c(),o.aY(),o.Het.unbind(k).bind(k,function(t,n){u.fillType=n})},E.prototype.tit=function(){var t=this.qet;t&&(t.Qet(),t.close())},E.prototype.c5=function(){var t=this,n=t.qet,t=t.Vet;n&&(n.Jet()&&t.trigger(x),t.trigger(T))},E.prototype.close=function(){var t,n,t,t=this,n=t.Mf;t.c5(),a.unbind(B),O.prototype.close.call(this),(t=n.fg)&&(t.style.cursor="default"),n&&n.Zg()},E.prototype.lf=function(t){var n;return!(!this.Wc||!O.prototype.hf.call(this,this.Wc.get(0),t))||this.g$&&O.prototype.hf.call(this,this.g$.get(0),t)},t.Aet=E},"./dist/plugins/fill/fill.entry.js":function(t,n,i){var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/fill/drag-fill.js"),i("./dist/plugins/fill/fill-event.js"),e(i("./dist/plugins/fill/fill-ui.js"),n),e(i("./dist/plugins/fill/fill.js"),n),e(i("./dist/plugins/fill/fill.ns.js"),n)},"./dist/plugins/fill/fill.js":function(j,t,n){var i,e,h,r,T,n,M,o,tt,y,C,D,nt,S,u,O,x,u,I,A,it,rt,et,E,u,k,N,V,G,L,B,W,ot,$,H,u,n,P,q,U,n,z,J,K,Q,X,Y,Z,ft,at,lt,ct,ht,n,u,n,u,n,vt,gt,dt,pt,wt,mt,_t,yt,Ct,s,f,Dt,Ft;function ut(t){return!st(t)&&o.q8(t)}function st(t){return"string"==typeof t}function bt(t,n){return-1!==t.lastIndexOf(n)}function Rt(t){var n=[t];return n.rowCount=1,n.colCount=x(t),n}function jt(t){return t}function Tt(t,n,i,r){var n=Rt(n),i=Rt(i),r=Rt([r]),t=t?e.Common.eit(n,i,r,!0,jt,tt,tt,tt):e.Common.iit(n,i,r,!0,tt,tt,tt),n=t&&t[0][0];return typeof n===it?e.Common.st.E8(n,13):n}function xt(t){return t.toLowerCase()}function a(t){this.rit=[],this.oit=[],this.ait=[],this.uit=tt,this.sit=[],this.cit=tt,this.lit=nt(t)?-1:t}function l(t){this.hit=-1,this.dit=[],this.MV=-1,this.Mf=t}function kt(){this.vit="",this.mit="",this.MV=0,this.git=1,this._padding=""}function c(t){var n,i,r,e,n=t.length,i=1;if(1<n)for(i=t[1]-t[0],e=2;e<n;e++)if(i!==(r=t[e]-t[e-1])){i=0;break}return i}function v(t,n){return 0<t?(t-1)%n:n-Math.abs(t)%n-1}function g(t){for(var n="",i=0;i<t;)n+="0",i++;return n}function d(t,n){return 12*(n.getFullYear()-t.getFullYear())+(n.getMonth()-t.getMonth())}function Mt(t){return t.every(function(t){var n;return 1===t.getDate()})}function St(t){return t.every(function(t){var n,i,r,e,n=t.getFullYear(),i=t.getMonth(),r,e;return t.getDate()===new Date(n,i+1,0).getDate()})}function Ot(t){var n,i,n=0,i;return t.every(function(t){var t=t.getDate();return(n=n||t)===t})?n:0}function It(t,n){for(var i,r,e,o,i=t.length,r=!0,o=2;o<i&&(r=n===(e=d(t[o-1],t[o])));o++);return r}function At(t){return t.every(function(t){var n=t.getHours(),i=t.getMinutes(),t=t.getSeconds();return 0!==n||0!==i||0!==t})}function Et(t,n){return new Date(t,n+1,0).getDate()}function p(t){return"0"===t[0]}function Nt(n,t,i){var r,e,o,e,o,u,s,u=i?1:2,s=i?2:1;return t.every(function(t){return!!(r=t.match(n.pit))&&(e=r[u],(o=e.length)>n.yit&&p(e)&&(n.yit=o),o=parseInt(e,10),e=r[s],nt(n.cit)&&(n.cit=e),e!==n.cit?(n.wit=!0,n.cit=tt,n.sit=[]):n.sit.push(o),!0)})}function w(){}function Vt(){var t=null!==vt&&vt.apply(this,arguments)||this;return t.Mit=0,t.uit=rt,t}function m(){return null!==gt&&gt.apply(this,arguments)||this}function _(){return null!==dt&&dt.apply(this,arguments)||this}function Gt(){return null!==pt&&pt.apply(this,arguments)||this}function Lt(){var t=wt.call(this)||this;return t.pit=tt,t.sit=[],t.cit=tt,t.wit=!1,t.yit=0,t.uit=et,t.Cit=!1,t.Sit=!1,t.Tit=new H,t}function F(t){var n=mt.call(this)||this;return n.Ait=new $(t),n}function Bt(){var t=null!==_t&&_t.apply(this,arguments)||this;return t.pit=/^\d+$/,t}function Wt(){var t=null!==yt&&yt.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)$/,t}function $t(){var t=null!==Ct&&Ct.apply(this,arguments)||this;return t.pit=/^(\d+)(\D+.*)$/,t}function b(){var t=null!==s&&s.apply(this,arguments)||this;return t.pit=/^(.*\D+)(\d+)(\D+.*)$/,t}function Ht(){return null!==f&&f.apply(this,arguments)||this}function Pt(){return null!==Dt&&Dt.apply(this,arguments)||this}function qt(){var t=null!==Ft&&Ft.apply(this,arguments)||this;return t.Cit=!0,t}function Ut(t){var n,i,i,t,r,e,o,n=this;n.Iit=[new P,new q,new U],n.xit=new ft,n.Nit=new at,i=N.culture(),i=N.Fe(i).isJCKCulture,t=new z(t),r=new J,e=new K,o=new Q,n.kit=i?[t,r,new Z,e,o,new X]:[t,r,e,o]}function zt(t){t.forEach(function(t){t&&t.dispose()})}function R(t){this.Mf=t,this.Dit=!1,this._it=[]}i=this&&this.__extends||(ht=function(t,n){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}ht(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.Wtt=t.nnt=t.FillDateUnit=t.FillType=t.FillSeries=t.FillDirection=t.AutoFillType=void 0,e=n("Common"),h=n("Core"),r=n("CalcEngine"),T=n("SheetsCalc"),n=n("./dist/plugins/fill/fill.ns.js"),M=!!r,o=e.Common.lt,tt=null,y=void 0,C=Math.floor,D=h.Ec,nt=o.ht,S=o.uJ,u=e.Common.Uf,O=u.Eit,x=u.tR,u=e.Common.ct,I=u.o0,A=u.Y0,it="number",rt="date",et="string",E="default",u=new e.Common.ResourceManager(n.SR,"Fill"),k=u.getResource.bind(u),N=e.Common.CultureManager,(n=V=t.AutoFillType||(t.AutoFillType={}))[n.copyCells=0]="copyCells",n[n.fillSeries=1]="fillSeries",n[n.fillFormattingOnly=2]="fillFormattingOnly",n[n.fillWithoutFormatting=3]="fillWithoutFormatting",n[n.clearValues=4]="clearValues",n[n.auto=5]="auto",(u=G=t.FillDirection||(t.FillDirection={}))[u.left=0]="left",u[u.right=1]="right",u[u.up=2]="up",u[u.down=3]="down",(n=L=t.FillSeries||(t.FillSeries={}))[n.column=0]="column",n[n.row=1]="row",(u=B=t.FillType||(t.FillType={}))[u.direction=0]="direction",u[u.linear=1]="linear",u[u.growth=2]="growth",u[u.date=3]="date",u[u.auto=4]="auto",(n=W=t.FillDateUnit||(t.FillDateUnit={}))[n.day=0]="day",n[n.weekday=1]="weekday",n[n.month=2]="month",n[n.year=3]="year",a.prototype.jit=function(){return x(this.rit)},a.prototype.Oit=function(){for(var t=this,n=[],i=t.oit,r,e,r=0;r<x(i);r++)e=i[r],n.push("object"===t.uit?t.r0(e):e);return n},a.prototype.Rit=function(){var t,n,i,r,e,t=this,n=t.rit;if(0<x(n)){for(r=[],e=void 0,-1===(i=t.lit)&&(i=n[0]),e=0;e<x(n);e++)r[e]=n[e]-i+1;return r}return tt},a.prototype.Bit=function(){var t=this.oit;return x(t)?t:tt},a.prototype.Eit=function(t,n,i){if(!ut(i))throw new Error(k().Exp_NumberOnly);var r=this;nt(r.uit)&&(r.uit=i instanceof Date?rt:it),O(r.rit,t,n),O(r.oit,t,S(i))},a.prototype.ZP=function(t,n){var i=this,r=nt(i.uit);ut(n)?(r&&(n instanceof Date?i.uit=rt:i.uit=it),i.oit.push(S(n))):r&&(i.uit=st(n)?et:E),i.rit.push(t),i.ait.push(n)},a.prototype.Lit=function(t){return this.uit===rt?this.r0(t):t},a.prototype.r0=function(n){var i=tt;if(n instanceof Date)i=n;else if(r)try{i=r.Convert.r0(n)}catch(t){i=n}return i},ot=a,l.prototype.L0=function(){this.Mf=tt},l.prototype.Fit=function(){var t=this.Mf;return t.parent&&t.parent.Ow()||[]},l.prototype.Pit=function(t){var n,i,r,e,o,u,s,f,a,l,c,h,v,g,d,p,n=t.length,i=!1;if(t&&0<n)for(r=xt(t[0]),e=this.Fit(),l=a=f=s=u=o=void 0,o=0;o<e.length;o++)if(0<=(f=(s=(u=e[o]).map(xt)).indexOf(r))){for(a=f,c=s.length,g=v=h=void 0,d=1;d<n;d++){if(v=xt(t[d]),!(0<=(h=s.indexOf(v)))){i=!1;break}if(g=h-a+c,l){if(l!==g){i=!1;break}}else i=!0,l=g,a=h}if(p=1===n,i||p){i=!0,this.hit=f,this.dit=u,this.MV=p?1:l;break}}return i},l.prototype.Sl=function(t){var n=this.dit,i=this.hit,r=this.MV,e=n.length,o,u,u;return n[(i+r*v(t,e))%e]},$=l,kt.prototype.Sl=function(t){var t=this.MV*(t-1)+this.git,n=this._padding.length,t=""+Math.abs(t),i,r=this._padding+t,e=r.length,t=n<t.length?t:r.substr(e-n);return this.vit+t+this.mit},H=kt,w.prototype.match=function(t){return!1},w.prototype.getTargetValue=function(t,n,i,r,e){},w.prototype.resetProp=function(){},w.prototype.Git=function(t,n){return t.indexOf(n+1)},w.prototype.dispose=function(){},i(Vt,vt=u=w),i(m,gt=n=Vt),m.prototype.match=function(t){var n,i,r,e,n=this.Mit=d(t[0],t[1]),i=Mt(t),r=t.length,e=!0;return i&&2<r&&(e=It(t,n)),i&&e},m.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1);return new Date(r+parseInt(t/12,10),t%12,1)},P=m,i(_,dt=n),_.prototype.match=function(t){var n,i,r,e,n=this.Mit=d(t[0],t[1]),i=St(t),r=t.length,e=!0;return i&&2<r&&(e=It(t,n)),i&&e},_.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1),n=r+parseInt(t/12,10),r=t%12;return new Date(n,r,Et(n,r))},q=_,i(Gt,pt=n),Gt.prototype.match=function(t){var n,i,r,e,o,u,n=!1;return At(t)||(i=this.Mit=d(t[0],t[1]),e=0<(r=Ot(t)),o=t.length,u=!0,this.Uit=r,e&&2<o&&(u=It(t,i)),n=e&&u),n},Gt.prototype.getTargetValue=function(t,n){var i,t=t.ait[0],r=t.getFullYear(),e,o,u,t=t.getMonth()+this.Mit*(n-1),n=r+parseInt(t/12,10),s;return new Date(n,t%12,this.Uit)},U=Gt,i(Lt,wt=u),Lt.prototype.resetProp=function(){this.sit=[],this.yit=0,this.cit=tt,this.wit=!1,this.Cit=!1,this.Sit=!1},Lt.prototype.getInternal=function(t){for(var n,i,r,e,n=!1,i=t[0],e=1;e<t.length;e++)if(r=t[e],1!==Math.abs(r-i)){n=!0;break}return n},i(F,mt=n=Lt),F.prototype.dispose=function(){var t=this;t.Ait&&(t.Ait.L0(),t.Ait=tt)},F.prototype.match=function(t){return this.Ait.Pit(t)},F.prototype.getTargetValue=function(t,n,i,r,e){var o,t=t.ait.length,i=this.Git(i,r),r=tt,u;return r=-1!==i?this.Ait.Sl(u=t*e+i+1):r},z=F,i(Bt,_t=n),Bt.prototype.match=function(t){var n=this,i,r,r;return t.every(function(t){return!!(i=t.match(n.pit))&&((r=t.length)>n.yit&&p(t)&&(n.yit=r),r=parseInt(t,10),n.sit.push(r),!0)})},Bt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,f=0!==s,n=f?0:v(n,o),i=this.Git(i,r),r=tt,a;return this.Cit=f,this.Sit=this.getInternal(t.rit),-1!==i&&(u.MV=s,u.git=this.sit[n],u._padding=g(this.yit),r=u.Sl(a=o*e+i+1)),r},J=Bt,i(Wt,yt=n),Wt.prototype.match=function(t){return Nt(this,t,!1)},Wt.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,f=0!==s,n=f?0:v(n,o),i=this.Git(i,r),r=tt,a;return this.Cit=f,this.Sit=this.getInternal(t.rit),-1!==i&&(u.vit=this.cit,u.MV=s,u.git=this.sit[n],u._padding=g(this.yit),r=u.Sl(a=o*e+i+1)),r},K=Wt,i($t,Ct=n),$t.prototype.match=function(t){return Nt(this,t,!0)},$t.prototype.getTargetValue=function(t,n,i,r,e){var o=t.ait,u=this.Tit,s=c(this.sit),o=o.length,f=0!==s,n=f?0:v(n,o),i=this.Git(i,r),r=tt,a;return this.Cit=f,this.Sit=this.getInternal(t.rit),-1!==i&&(u.mit=this.cit,u.MV=s,u.git=this.sit[n],u._padding=g(this.yit),r=u.Sl(a=o*e+i+1)),r},Q=$t,i(b,s=n),b.prototype.resetProp=function(){s.prototype.resetProp.call(this),this.Hit=tt},b.prototype.match=function(t){var n,i,r,i,n,r,e,e=this;return t.every(function(t){return!!(n=t.match(e.pit))&&(i=n[2],(r=i.length)>e.yit&&p(i)&&(e.yit=r),r=parseInt(i,10),i=n[1],nt(e.cit)&&(e.cit=i),n=n[3],nt(e.Hit)&&(e.Hit=n),i!==e.cit||n!==e.Hit?(e.wit=!0,e.cit=tt,e.Hit=tt,e.sit=[]):e.sit.push(r),!0)})},b.prototype.getTargetValue=function(t,n,i,r,e){var o=this,u=t.ait,s=o.Tit,f=c(o.sit),u=u.length,a=0!==f,n=a?0:v(n,u),i=o.Git(i,r),r=tt,l;return o.Cit=a,o.Sit=o.getInternal(t.rit),-1!==i&&(s.vit=o.cit,s.mit=o.Hit,s.MV=f,s.git=o.sit[n],s._padding=g(o.yit),r=s.Sl(l=u*e+i+1)),r},Y=["-","_",":",".",","],i(Ht,f=X=b),Ht.prototype.resetProp=function(){f.prototype.resetProp.call(this),this.zit=tt},Ht.prototype.match=function(t){var r,e,o,r,e,o,u,s,u=this;return t.every(function(n){var t,t,t,i,t=u.zit;if(s=nt(t)?Y.some(function(t){if(bt(n,t))return u.zit=t,!0}):bt(n,t)){if(t=u.zit,t=n.lastIndexOf(t),r=n.substring(0,t+1),nt(u.cit))u.cit=r;else if(u.cit!==r)return!1;if(t=n.substr(t+1),r=t.match(i=/^(\d+)(\D+.*)$/))return e=r[1],(o=e.length)>u.yit&&p(e)&&(u.yit=o),o=parseInt(e,10),e=r[2],nt(u.Hit)&&(u.Hit=e),e!==u.Hit?(u.cit=tt,u.Hit=tt,!(u.sit=[])):(u.sit.push(o),!0)}return!1})},Z=Ht,i(Pt,Dt=u),Pt.prototype.getTargetValue=function(t,n,i){return Tt(!0,t.Bit(),i,n)},ft=Pt,i(qt,Ft=u),qt.prototype.getTargetValue=function(t,n,i,r){var t=t.ait,e,o;return t[v(n,t.length)]},at=qt,Ut.prototype.getRule=function(t,n){var i,r,e,o,u,i=[],r=this.Nit;for(t===rt?(i=this.Iit,r=this.xit):t===et?i=this.kit:t===it&&(r=this.xit),e=0;e<i.length;e++)if(u=void 0,(o=i[e]).resetProp(),o.match(n)){if(u=o.wit,nt(u)||!1===u)return o;if(!0===u)return r}return r},Ut.prototype.L0=function(){var t=this;t.Iit&&(zt(t.Iit),t.Iit=tt),t.kit&&(zt(t.kit),t.kit=tt),t.xit&&(t.xit.dispose(),t.xit=tt),t.Nit&&(t.Nit.dispose(),t.Nit=tt)},t.nnt=Ut,R.prototype.qtt=function(t,n,i,r,e){var o=this,t=t?1:2;nt(r)&&nt(e)?o.$tt(n,i,t):o.$tt(n,i,t,r,e,tt)},R.prototype.$tt=function(t,n,i,r,e,o){var u,s,t,f,a,l,c,h,v,g,d,p,w,m,_,y,C,D,F,t,b,R,p,j,T,u=this,s=u.Mf,t=s.JS(t),f=t.row,a=t.col,l=t.rowCount,c=t.colCount;if(s.Ut.eE(f,a,l,c))throw new Error(k().Exp_RangeContainsMergedCell);for(m=0,y=(_=1===n)?c:l,D=_?f+l:a+c,F=(w=3<arguments.length)?1:y,b=(t=this.Mf.rt.Ktt).row===f&&t.rowCount===l&&t.col>a||t.col===a&&t.colCount===c&&t.row>f,h=C=_?f:a;h<D;h++)if(p=b&&w?f+l-1:f,(j=_?u.Vit(h,R=b&&w?a+c-1:a,1,F,n):u.Vit(p,h,F,1,n))&&j.jit())for(d=j.rit[0],w?(p=b?j.oit[x(j.oit)-1]:j.oit[0],v=u.Yit(b,p,y,i,r,e,o),b&&(m=y-x(v),d=j.rit[x(j.rit)-1])):v=u.Zit(j,y,i),g=0;g<x(v);g++)T=j.Lit(v[g]),_?u.Wit(s,h,d,h,a+m+g,T,i):u.Wit(s,d,h,f+m+g,h,T,i)},R.prototype.Vit=function(t,n,i,r,e){for(var o=tt,u=this.Mf,s,f=1===e,a=f?n+r-1:t+i-1,l=f?n:t;l<=a;)ut(s=f?u.getValue(t,a):u.getValue(a,n))&&(o=o||new ot(l)).Eit(0,a,s),a--;return o},R.prototype.Yit=function(t,n,i,r,e,o,u){for(var s,f,a,l,c,h,v,s=[],f=n,l=0<=e,c=nt(o),a=0;a<i;a++)h=o<=f,v=f<=o,t&&(c||l&&h||!l&&v)?(s.unshift(f),1===r?f-=e:2===r?f/=e:3!==r||nt(u)||(f=this.Qit(!0,u,n,f,e,a+1))):!t&&(c||l&&v||!l&&h)&&(s.push(f),1===r?f+=e:2===r?f*=e:3!==r||nt(u)||(f=this.Qit(!1,u,n,f,e,a+1)));return s},R.prototype.Zit=function(t,n,i){var r=[],e,o=1===i;if(o||2===i){for(1===t.jit()&&t.ZP(t.rit[0]+1,o?t.Lit(t.oit[0]+1):t.Oit()[0]),e=0;e<n;e++)r.push(Tt(!!o,t.Bit(),t.Rit(),e+1));return r}return tt},R.prototype.Jtt=function(t,n,i,r,e,o){var u,s,f,t,a,l,c,t,s,h,v,f,u=this,s=u.Mf,f=s.Ut,t=s.JS(t),a=t.row,l=t.col,c=t.rowCount,t=t.colCount,s=s.JS(s.rt.Ktt),h=s.row,v=s.col;if(f.GT(h,v,s.rowCount,s.colCount)||f.GT(a,l,c,t))throw new Error(k().Exp_ChangeMergedCell);return f=u.Kit(s,c,t,n,i,!(a<h||l<v),r,e,o),u.Jit&&u.Jit.IB&&(u.Jit.IB.reFilter(),delete u.Jit),f},R.prototype.Kit=function(t,n,i,r,e,o,u,s,f){var a=this,l=o?1:-1,c,h,v,g,d=t.row,p=t.col,w=t.rowCount,m=t.colCount;if(1===r){if(c=C(i/m),h=i%m,!e)for(g=1;g<c;g++)v=D(d,p+g*l*m,w,m),a.Tle(t,v,r,4,e,o,y,y,y,u,s),a.Xit(t,v,r,4,e,o,y,y,y,u,s);if(e&&1<c&&0===h&&(c-=1,h=m),0<c&&0<h)return v=D(d,o?p+c*m:p-c*m+m-h,w,h),a.Tle(t,v,r,4,e,o,tt,o?0:m-h,y,u,s),a.Xit(t,v,r,4,e,o,tt,o?0:m-h,y,u,s)}else{if(c=C(n/w),h=n%w,a.Dit||(v=D(d+l*w,p,n-w,i),a.qit(t,v,l,f)),!e)for(g=1;g<c;g++)v=D(d+g*l*w,p,w,m),a.Tle(t,v,r,4,e,o,tt,tt,!0,u,s),a.Xit(t,v,r,4,e,o,tt,tt,!0,u,s);if(e&&1<c&&0===h&&(c-=1,h=w),0<c&&0<h)return v=D(o?d+c*w:d-c*w+w-h,p,h,m),a.Tle(t,v,r,4,e,o,o?0:w-h,tt,!0,u,s),a.Xit(t,v,r,4,e,o,o?0:w-h,tt,!0,u,s)}},R.prototype.Xit=function(t,n,N,i,r,e,V,G,L,o,u){for(var s,f,B,a,W,l,c,h,v,$,H,P,g,q,U,z,d,p,w,m,_,y,C,D,F,b,R,j,T,x,J,k,M,l,S,O,K,Q,X,I,Y,Z,A,E,s=this,f=s.Mf,B=f.Ut,a=1===N,$=a?t.row:t.col,H=a?t.col:t.row,P=a?n.row:n.col,g=a?n.col:n.row,q=a?t.rowCount:t.colCount,U=a?t.colCount:t.rowCount,z=a?n.colCount:n.rowCount,h=0;h<q;h++){for(w=0,y=m=$+h,C=_=P+h,D=(a?G:V)||0,F=a?0:D,b=a?tt:L,R=p=d=tt;w<U;)if(x=tt,J=j=H+w,k=T=g+w-D,a||(m=j,j=y,_=T,T=C),c=B.findSpan(m,j),(W=f.hasFormula&&f.hasFormula(m,j))||(x=f.getValue(m,j)),(M=s.Dit)&&nt(R)&&(R=!1===e?f.getValue(H+U-1,j):f.getValue(m,j)),M||4!==i||!ut(x)&&!st(x)||(d=d||new ot,l=ut(x)?x instanceof Date?rt:it:et,(p=p||l)!==l))if(!M&&x&&d&&d.jit()){if(v=s.$it(a,t,n,y,C,d,r,e,F,b,o,u),r&&v)return v;p=d=tt}else{if(M||!c||c&&(a?c.row:c.col)===y)if(l=k===g+z-1,S=M?R:x,r){if(M)return S;if(c&&l||!c&&(l&&e||!e&&k===g))return x}else!(k<g+z&&g<=k)||!M&&!a&&(a||L&&f.XT&&f.XT(k))||M&&-1!==s._it.indexOf(_)||s.Wit(f,m,j,_,T,S,i,o,u);c?w+=a?c.colCount:c.rowCount:w++}else d.ZP(J,x),c?w+=a?c.colCount:c.rowCount:w++;if(s.Dit)for(O=t.row,K=t.col,Q=t.rowCount,X=t.colCount,Y=I=void 0,Z=!1===e?-1:1,A=1;A<Q;A++)for(I=O+Z*A,E=0;E<X;)Y=K+E,-1===s._it.indexOf(I)&&s.Wit(f,O,K,I,Y,R,i,o,u),E++;if(d&&d.jit()&&(v=s.$it(a,t,n,y,C,d,r,e,F,b,o,u),r)&&!nt(v))return v}return tt},R.prototype.Tle=function(t,n,N,i,r,e,V,G,L,o,u){var s,f,B,a,l,c,h,v,g,W,d,$,p,H,w,P,m,_,y,C,D,F,b,R,j,T,x,k,M,S,q,O,c,c,h,U,z,J,K,I,Q,X,A,E;if(!r){for(a=(B=(f=(s=this).Mf).Ut).yle(),W=(l=1===N)?t.row:t.col,d=l?t.col:t.row,$=l?n.row:n.col,p=l?n.col:n.row,H=l?t.rowCount:t.colCount,w=l?t.colCount:t.rowCount,P=l?n.colCount:n.rowCount,g=0;g<H;g++){for(y=0,F=C=W+g,b=D=$+g,R=(l?G:V)||0,j=l?0:R,T=l?tt:L,x=_=m=tt;y<w;)S=tt,q=k=d+y,O=M=p+y-R,l||(C=k,k=F,D=M,M=b),v=B.findSpan(C,k),c=f.getValueIgnoreDefault(C,k),nt(c)?y++:((c=a.getFormula(C,k))&&""!==c||(S=a.getValue(C,k)),(c=s.Dit)&&nt(x)&&(x=!1===e?f.getValue(d+w-1,k):f.getValue(C,k)),c||4!==i||!ut(S)&&!st(S)||(m=m||new ot,h=ut(S)?S instanceof Date?rt:it:et,(_=_||h)!==h)?!c&&S&&m&&m.jit()?(s.$it(l,t,n,F,b,m,r,e,j,T,o,u,!0),_=m=tt):((c||!v||v&&(l?v.row:v.col)===F)&&(h=c?x:S,!(O<p+P&&p<=O)||!c&&!l&&(l||L&&f.XT&&f.XT(O))||c&&-1!==s._it.indexOf(D)||s.Wit(f,C,k,D,M,h,i,o,u,!0)),v?y+=l?v.colCount:v.rowCount:y++):(m.ZP(q,S),v?y+=l?v.colCount:v.rowCount:y++));if(s.Dit)for(U=t.row,z=t.col,J=t.rowCount,K=t.colCount,Q=I=void 0,X=!1===e?-1:1,A=1;A<J;A++)for(I=U+X*A,E=0;E<K;)Q=z+E,-1===s._it.indexOf(I)&&s.Wit(f,U,z,I,Q,x,i,o,u,!0),E++;m&&m.jit()&&s.$it(l,t,n,F,b,m,r,e,j,T,o,u,!0)}return tt}},R.prototype.qit=function(t,n,i,r){var e,o,u,n,s,f,n,a,l,t,c,h,v,g,d,p,w,m,_,y,C,D,F,b,R,e=this,o=e.Mf,u=o.tables,n=t.union(n),s=n.row,f=n.rowCount,n=t.row,a=t.col,l=t.rowCount,t=t.colCount;if(u)for(h=0,v=c=u.AB(n,a,l,t);h<v.length;h++){if(d=(g=v[h]).Ky,p=g.iw,w=f,r)for(m=0,_=r;m<_.length;m++)if((y=_[m]).row===d&&y.col===p){w=y.rowCount,e.Jit=g;break}if(C=g.IB,D=e._it,F=void 0,C&&C.isFiltered&&C.isFiltered()){for(b=0;b<w;b++)C.isRowFilteredOut(F=s+i*b)&&e._it.push(F);if(0<D.length){e.Dit=!0;break}}}if(R=o.IB,!0!==e.Dit&&R&&R.isFiltered&&R.isFiltered()){for(D=e._it,F=void 0,b=0;b<f;b++)R.isRowFilteredOut(F=s+i*b)&&e._it.push(F);0<D.length&&(e.Dit=!0)}},R.prototype.Wit=function(t,n,i,r,e,o,u,s,f,a){var l,c,c,c,u,l=t.Ut;M&&(a?((c=l.yle().getExpression(n,i))&&t.hasFormula(n,i,3,!0)||!nt(t.getValueIgnoreDefault(n,i)))&&(0,h.copyDefaultFormula)(t,t,r,e,c):(t.hasFormula(n,i,3)||t.hasFormula(r,e,3))&&(t.setFormula(r,e,tt),0===u||4===u)&&(c=t.b3(),t.getFormula(n,i)||l.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Expression))&&T.CalcOperatorAdjustor.copyFormula(c,n,i,c,r,e,1,1,y,!0)),a||nt(t.getValueIgnoreDefault(n,i))&&!nt(l.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Value))?l.getDefaultValue(n,i,tt,h.DefaultChangeValueType.Expression)||l.setDefaultValue(r,e,o,tt,h.DefaultChangeValueType.Value):t.setValue(r,e,o),a||(u=f?0:64,s&&(u|=4224),t.vT(n,i,r,e,1,1,u|=1024,y,!0),t.removeSpan(r,e,3),(c=l.findSpan(n,i))&&n===c.row&&i===c.col&&t.EL(r,e,c.rowCount,c.colCount,3))},R.prototype.$it=function(t,n,i,r,e,o,u,s,f,a,l,c,h){var v,g,d,p,w,m,_,y,C,D,F,b,R,j,T,x,k,M,T,S,x,T,v=this,g=v.Mf,_=t?i.col:i.row,y=t?n.col:n.row,C=t?i.colCount:i.rowCount,D=t?n.colCount:n.rowCount;if(f=f||0,F=o.jit(),b=(_-y-f)/D,R=v.Cit(o.rit,o.oit),j=o.uit,R){for(w=[],p=0;p<F;p++)w[p]=p+1;d=F}else m=o.rit[0],d=o.rit[F-1]-m+1,1===F&&j!==et&&o.ZP(o.rit[0]+1,o.Lit(o.oit[0]+1)),w=o.Rit();for(p=0;p<d;p++)if(T=o.ait,M=k=x=void 0,S=_+C-1,T=(x=(M=(x=j!==rt&&j!==et?x:g.tnt&&g.tnt.getRule(j,T))?(k=x.getTargetValue(o,d*b+p+1,w,p,b),R=x.Cit||R,T=x.Sit||!1,R&&!T):(k=Tt(!0,o.Bit(),w,d*b+p+1),R))?o.rit[p]:m+p)+b*D,u){if(R&&(s&&T===S||!s&&T===_)||!R&&T+f===S)return o.Lit(k)}else T<_+C&&_<=T&&(t?v.Wit(g,r,x,e,T,o.Lit(k),4,l,c,h):a&&g.XT&&g.XT(T)||v.Wit(g,x,r,T,e,o.Lit(k),4,l,c,h));return tt},R.prototype.Cit=function(t,n){var i,r,e,o,i=x(n);if(i<=1||x(t)!==i)return!1;for(r=t[1]-t[0],e=n[1]-n[0],o=2;o<i;o++)if(t[o]-t[o-1]!=r||n[o]-n[o-1]!=e)return!1;return!0},R.prototype.Xtt=function(t,n){var i=this,r=this.Mf,e=r.Ut.getSpans(),t=r.JS(t),o=t.row,u=t.col,s=t.rowCount,t=t.colCount,f,f=0===n?D(o,u+t-1,s,1):1===n?D(o,u,s,1):D(2===n?o+s-1:o,u,1,t);(f=r.nR(e,f))&&i.trt(f,o,u,s,t,n)},R.prototype.trt=function(t,n,i,r,e,o){var u=this,s=t.row,f=t.col,a=t.rowCount,l=t.colCount,c,h,v,g,d,p,w,m=u.Mf.Ut,_,d=0===o?(_=m.eE(n,i,r,e-l),p=0,w=-1*l,v=e,g=l,1):1===o?(_=m.eE(n,i+l,r,e-l),p=0,v=e,g=w=l,1):w=(g=2===o?(_=m.eE(n,i,r-a,e),p=-1*a,v=r,a):(_=m.eE(n+a,i,r-a,e),v=r,p=a),0);if(_)throw new Error(k().Exp_TargetContainsMergedCells);if(v%g!=0)throw new Error(k().Exp_MergedCellsIdentical);for(c=C(v/g),h=1;h<c;h++)u.Xit(t,D(s+h*p,f+h*w,a,l),d,0,y,y,y,y,!0)},R.prototype.Qit=function(t,n,i,r,e,o){var u,t,s,f,u=t?-1:1,t=C(o*e),s=Math.abs(e),f=A(1<n?i:r);if(0===n)f.setDate(f.getDate()+u*e);else if(1===n)for(;0<s;)f.setDate(f.getDate()+u*(0<e?1:-1)),6!==f.getDay()&&0!==f.getDay()&&s--;else 2===n?f.setMonth(f.getMonth()+u*t):f.setFullYear(f.getFullYear()+u*t);return I(f)},t.Wtt=R},"./dist/plugins/fill/fill.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/fill/fill.res.en.js");n.SR={en:i}},"./dist/plugins/fill/fill.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_ChangePartOfArray=n.Exp_RangeIsNull=n.Exp_CellReadOnly=n.Exp_RowReadOnly=n.Exp_ColumnReadOnly=n.Exp_ChangeMergedCell=n.Exp_FillCellsReadOnly=n.Exp_FillRangeContainsMergedCell=n.Exp_MergedCellsIdentical=n.Exp_TargetContainsMergedCells=n.Exp_RangeContainsMergedCell=n.Exp_NumberOnly=n.FillWithoutFormatting=n.FillFormattingOnly=n.FillSeries=n.CopyCells=void 0,n.CopyCells="Copy Cells",n.FillSeries="Fill Series",n.FillFormattingOnly="Fill Formatting Only",n.FillWithoutFormatting="Fill Without Formatting",n.Exp_NumberOnly="Only works for Numbers",n.Exp_RangeContainsMergedCell="Range should not have merged cells.",n.Exp_TargetContainsMergedCells="Target range should not have merged cells.",n.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",n.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",n.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",n.Exp_ChangeMergedCell="Cannot change part of merged cell.",n.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",n.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",n.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",n.Exp_RangeIsNull="range is null",n.Exp_ChangePartOfArray="Cannot change part of an array."},Common:function(t){t.exports=GC.Spread},CalcEngine:function(t){t.exports=GC.Spread.CalcEngine},Core:function(t){t.exports=GC.Spread.Sheets},SheetsCalc:function(t){t.exports=GC.Spread.Sheets.CalcEngine}},r={},t=e("./dist/plugins/fill/fill.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Fill=t}();