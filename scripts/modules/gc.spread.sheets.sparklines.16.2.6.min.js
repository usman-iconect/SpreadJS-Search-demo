/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var e,r,n,t,i,o;function a(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},e[n].call(t.exports,t,t.exports,a)),t.exports}e={"./dist/plugins/sparkline/functions-sparkline.js":function(I,n,l){var t,A,k,h,d,T,v,D,b,S,i,o,y,H,e,K,e,G,p,O,B,W,c,g,a,r,f,_,C,X,Y,V,z,J,U,Z,q,Q,$,nn,tn,en,rn,on,an,un,cn,sn,fn,ln,hn,vn,w,pn,u,gn,wn,mn,dn,bn,kn,Sn,Cn,xn,An,yn,On,_n,m,Nn,En,Rn,Ln,Fn,jn,t,s,Mn,u,Pn,In,Tn,Dn,Hn,Kn,Gn,Bn,Wn,Xn,Yn,Vn,zn,Jn,Un,Zn,qn,Qn,$n,nt,tt;function x(n){return 0===n}function N(n){return 0===n||2===n}function et(n){return N(n)||8===n}function rt(n){return 0===n||1===n}function it(n){return 0<=n&&n<=2}function ot(n){return 2===n||3===n}function at(n){return 1===n||2===n}function E(n,t){var e,r,i,o,a,u,c,s,f,l,h,e=[];if(b(n))for(r=0,i=n.getRangeCount();r<i;r++)for(o=n.getRowCount(r),a=n.getColumnCount(r),u=0;u<o;u++)for(c=0;c<a;c++)e.push(n.getValue(r,u,c));else if(t&&S(n))for(s=n.getRowCount(),f=n.getColumnCount(),l=0;l<s;l++)for(h=0;h<f;h++)e.push(n.getValue(l,h));return e}function R(n,t,e){var r,i,o,a,u,c,s,f,l,h,r=[];if(b(n)){if(t<(i=n.getRangeCount()))for(o=n.getRowCount(t),a=n.getColumnCount(t),u=0;u<o;u++)for(r[u]=[],c=0;c<a;c++)r[u].push(n.getValue(t,u,c))}else if(e&&S(n))for(s=n.getRowCount(),f=n.getColumnCount(),l=0;l<s;l++)for(r[l]=[],h=0;h<f;h++)r[l][h]=n.getValue(l,h);return r}function L(n){var t;return b(n)?t=n.getValue(0,0,0):y(n)||(t=n),t}function ut(n,t){this.name=n,this.value=t,this.typeName="SparklineExValue"}function F(){var n,t,e,n=this.createFunction();n&&(t=n.name,e=n.evaluate,n.evaluate=function(){var n=e.call(this,arguments);return n instanceof A.CalcError?n:n?new pn(t,n):r},this.Zc=t)&&!A.Functions.findGlobalFunction(t)&&(A.Functions.Tmt[t]=n),this.typeName=""}function ct(){return Pn.call(this)||this}function st(){return In.call(this)||this}function ft(){return Tn.call(this)||this}function lt(){return Dn.call(this)||this}function ht(){return Hn.call(this)||this}function vt(){return Kn.call(this)||this}function pt(){return Gn.call(this)||this}function gt(){return Bn.call(this)||this}function wt(){return Wn.call(this)||this}function mt(){return Xn.call(this)||this}function dt(){return Yn.call(this)||this}function bt(){return Vn.call(this)||this}function kt(){return zn.call(this)||this}function j(){return Jn.call(this)||this}function St(){return Un.call(this)||this}function Ct(){return Zn.call(this)||this}function xt(n,p){function g(n){var t,e,r,i,o,a,u,c,s,f,t={},e=!1,r=!0,i="",o="";if(n){for(a=0,u=(n=n.substr(1,n.length-2)).length;a<u;a++)":"===(c=n.charAt(a))?r=!1:","!==c||e?"'"!==c&&'"'!==c&&("("===c?e=!0:")"===c&&(e=!1),r?i+=c:o+=c):(t[i]=o,r=!(o=i=""));for(s in i&&(t[i]=o),t)!t.hasOwnProperty(s)||y(f=t[s])||("TRUE"===f.toUpperCase()?t[s]=!0:"FALSE"===f.toUpperCase()?t[s]=!1:!_(f)&&isFinite(f)&&(t[s]=C(f)))}return t}function w(n){return new k.Range(n.getRow(0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))}function m(n){return new k.Range(0,0,n.getRowCount(),n.getColumnCount())}var n=new i(n,2,5);return n.evaluate=function(n){var t,e,r,i,e,o,a,u,c,s,f,l,h,v,f,n,t=n[0],e=S(t);if((b(t)||e)&&0<(r=e?1:t.getRangeCount())){for(v in i=(e?m:w)(t),e=e?"":t.getSource().getSheet().name(),o=n[1],a=n[2],s=c=u=void 0,f=S(a),(b(a)||f)&&(s=f?"":a.getSource().getSheet().name(),0<(r=f?1:a.getRangeCount()))&&(u=(f?m:w)(a),c=n[3]),l=g(n[4]||"{}"),h={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})h.hasOwnProperty(v)&&l.hasOwnProperty(v)&&(l[h[v]]=l[v]);return 1===(n=(f=new d.SparklineSetting(l)).options).maxAxisType&&(n.maxAxisType=0),1===n.minAxisType&&(n.minAxisType=0),{data:i,dataSheetName:e,dataOrientation:o,dateAxisData:u,dateAxisDataSheetName:s,dateAxisOrientation:c,sparklineType:p,displayDateAxis:u&&!y(c),setting:f,values:R(t,0,!0),dateValues:R(a,0,!0)}}},n.acceptsReference=N,n.acceptsArray=N,n}function At(n,t,e,r,i,o,a){var u,c,s,f,l,h,a,u=d.Sparkline.EMt,c=a.sheet,s=c.parent.getSheetFromName(t.dataSheetName),f=c.parent.getSheetFromName(t.dateAxisDataSheetName),l=t.setting,h=(l=l&&l.options?l:new d.SparklineSetting(l)).options.displayHidden,a={sparklineType:t.sparklineType,displayDateAxis:t.displayDateAxis,zoomFactor:a.zoomFactor,values:u(t.values,s||c,h,t.data,t.dataOrientation),dateValues:u(t.dateValues,f||c,h,t.dateAxisData,t.dateAxisOrientation,!0),settings:l,getColor:function(n){if(c&&n){var t=k.Pf.vl(c,n);if(t)return t}return n}};(new G).paint(n,a,e,r,i,o)}function yt(){return qn.call(this)||this}function Ot(){return Qn.call(this)||this}function _t(){return $n.call(this)||this}function Nt(){return nt.call(this)||this}function Et(){return tt.call(this)||this}function Rt(n,t,e,r,i,o,a,u){if(!(y(n)||y(t)||y(e)||y(r))&&!(_(n)||_(t)||_(e)||_(r))&&!(r<=e||t<e||r<t||n<e||r<n)&&(y(a)||0===a||1===a||2===a)){if(0===a||y(a)){if(!y(i)&&!y(o)&&(_(o)||_(i)||o<=i||i<-180||180<o))return;if(!y(u)&&(_(u)||1<u||u<0))return}return 1}}function M(n,t,e){return{value:n,font:t,label:e,normalFontHeight:B(t),normalFontWidth:W(e,t),fontAfterZoom:null}}function P(n){n&&(s[n.name()]=n)}t=this&&this.__extends||(Mn=function(n,t){return(Mn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}Mn(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.jMt=n.GaugeKPISparkline=n.RangeBlockSparkline=n.WinlossSparkline=n.ColumnSparkline=n.LineSparkline=n.ImageSparkline=n.HistogramSparkline=n.YearSparkline=n.MonthSparkline=n.ParetoSparkline=n.CascadeSparkline=n.BoxPlotSparkline=n.VariSparkline=n.VBarSparkline=n.HBarSparkline=n.StackedSparkline=n.SpreadSparkline=n.BulletSparkline=n.ScatterSparkline=n.AreaSparkline=n.PieSparkline=n.SparklineEx=n.SparklineExValue=void 0,A=l("CalcEngine"),k=l("Core"),h=l("Common"),d=l("./dist/plugins/sparkline/sparkline-wrapper.js"),b=A.Convert.LE,S=A.Convert.Nh,i=A.Functions&&A.Functions.Function,o=A.Functions&&A.Functions.Mmt,y=h.Common.lt.ht,H=h.Common.lt.OMt,K=(e=k.GC$).inherit,e=e.extend,G=h.Sparklines.SparklineRender,p=h.Sparklines.SparklineExRenders,O=A.Errors.Value,B=k.util.vt,W=k.q.Wt,c=k.W.V,g=Math.floor,a=Math.min,r=null,f=void 0,_=isNaN,C=parseFloat,X=NaN,Y="12px Calibri",V="PIESPARKLINE",z="AREASPARKLINE",J="SCATTERSPARKLINE",U="BULLETSPARKLINE",Z="SPREADSPARKLINE",q="STACKEDSPARKLINE",Q="HBARSPARKLINE",$="VBARSPARKLINE",nn="VARISPARKLINE",tn="BOXPLOTSPARKLINE",en="CASCADESPARKLINE",rn="PARETOSPARKLINE",on="MONTHSPARKLINE",an="YEARSPARKLINE",un="LINESPARKLINE",cn="COLUMNSPARKLINE",sn="WINLOSSSPARKLINE",fn="RANGEBLOCKSPARKLINE",ln="GAUGEKPISPARKLINE",hn="HISTOGRAMSPARKLINE",vn="IMAGE",(u=w=w||{})[u.fit=1]="fit",u[u.entireFit=2]="entireFit",u[u.originFit=3]="originFit",u[u.custom=4]="custom",ut.prototype.toString=function(){return""},pn=ut,n.SparklineExValue=pn,F.prototype.name=function(){return this.Zc},F.prototype.createFunction=function(){return r},F.prototype.paint=function(n,t,e,r,i,o,a){},F.prototype.toJSON=function(){var n,t,n={};for(t in this)this.hasOwnProperty(t)&&(n[t]=this[t]);return n},F.prototype.fromJSON=function(n){if(n)for(var t in n)y(n[t])||(this[t]=n[t])},n.SparklineEx=u=F,t(ct,Pn=u),e((n.PieSparkline=gn=ct).prototype,{createFunction:function(){var n=new i(V,1,255);return n.evaluate=function(n){var t,e,t=n[0],e=E(t,!0);return e.length<=0&&!y(t)&&e.push(t),{values:e,colors:Array.prototype.slice.call(n,1)}},n.acceptsReference=x,n.acceptsArray=x,n},paint:p[V]}),t(st,In=u),e((n.AreaSparkline=wn=st).prototype,{createFunction:function(){var n=new i(z,1,7);return n.evaluate=function(n){return{points:E(n[0],!0),mini:n[1],maxi:n[2],line1:n[3],line2:n[4],colorPositive:n[5],colorNegative:n[6]}},n.acceptsReference=x,n.acceptsArray=x,n},paint:p[z]}),t(ft,Tn=u),e((n.ScatterSparkline=mn=ft).prototype,{createFunction:function(){var n=new i(J,1,18);return n.evaluate=function(n){var t,e;return{points1:R(n[0],0,!0),points2:R(n[1],0,!0),minX:n[2],maxX:n[3],minY:n[4],maxY:n[5],hLine:n[6],vLine:n[7],xMinZone:n[8],xMaxZone:n[9],yMinZone:n[10],yMaxZone:n[11],tags:n[12],drawSymbol:n[13],drawLines:n[14],color1:n[15],color2:n[16],dash:n[17]}},n.acceptsReference=rt,n.acceptsArray=rt,n},paint:p[J]}),t(lt,Dn=u),e((n.BulletSparkline=dn=lt).prototype,{createFunction:function(){var n=new i(U,3,17);return n.evaluate=function(n){return{measure:L(n[0]),target:L(n[1]),maxi:L(n[2]),good:L(n[3]),bad:L(n[4]),forecast:L(n[5]),tickUnit:L(n[6]),colorScheme:n[7],vertical:n[8],measureColor:n[9],targetColor:n[10],maxiColor:n[11],goodColor:n[12],badColor:n[13],forecastColor:n[14],allowMeasureOverMaxi:n[15],barSize:n[16]}},n.acceptsReference=function(n){return 0<=n&&n<=6},n},paint:p[U]}),t(ht,Hn=u),e((n.SpreadSparkline=bn=ht).prototype,{createFunction:function(){function l(n){for(var t,e,r,i,o,t=[],r=0,i=0,o=n.length;r<o;r++)e=C(n[r]),!_(e)&&isFinite(e)&&(t[i]=e,i++);return t}function h(n){for(var t,e,r,i,o,a,t={},e=0,r=void 0,i=n.length;e<i;e++)t[r=n[e]]?t[r]++:t[r]=1;for(a in o=[],t)t.hasOwnProperty(a)&&o.push({key:C(a),value:t[a]});return o.sort(function(n,t){return n.key-t.key})}var n=new i(Z,1,7);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,f,t=E(n[0],!0),r=[];if(!y(t)&&(r=h(t=l(t)),3===(e=n[4])))for(i=0,o=r.length;i<o;i++){for(u=(a=r[i]).value,c=[],s=Math.max(100,10*u),f=0;f<s+u-1;f++)c.push(Math.random());a.randomNumbers=c}return{spreadData:r,showAverage:n[1],scaleStart:n[2],scaleEnd:n[3],style:e,colorScheme:n[5],vertical:n[6]}},n.acceptsReference=x,n.acceptsArray=x,n},paint:p[Z]}),t(vt,Kn=u),e((n.StackedSparkline=kn=vt).prototype,{createFunction:function(){var n=new i(q,1,13);return n.evaluate=function(n){return{points:E(n[0],!0),colorRange:E(n[1],!0),labelRange:E(n[2],!0),maximum:n[3],targetRed:n[4],targetGreen:n[5],targetBlue:n[6],targetYellow:n[7],color:n[8],highlightPosition:n[9],vertical:n[10],textOrientation:n[11],textSize:n[12]}},n.acceptsReference=it,n.acceptsArray=it,n},paint:p[q]}),t(pt,Gn=u),e((n.HBarSparkline=Sn=pt).prototype,{createFunction:function(){var n=new i(Q,1,4);return n.evaluate=function(n){return{value:L(n[0]),colorScheme:n[1],axisVisible:n[2],barHeight:n[3]}},n.acceptsReference=x,n},paint:p[Q]}),t(gt,Bn=u),e((n.VBarSparkline=Cn=gt).prototype,{createFunction:function(){var n=new i($,1,4);return n.evaluate=function(n){return{value:L(n[0]),colorScheme:n[1],axisVisible:n[2],barWidth:n[3]}},n.acceptsReference=x,n},paint:p[$]}),t(wt,Wn=u),e((n.VariSparkline=xn=wt).prototype,{createFunction:function(){var n=new i(nn,1,10);return n.evaluate=function(n){return{variance:L(n[0]),reference:L(n[1]),mini:L(n[2]),maxi:L(n[3]),mark:L(n[4]),tickUnit:L(n[5]),legend:n[6],colorPositive:n[7],colorNegative:n[8],vertical:n[9]}},n.acceptsReference=function(n){return 0<=n&&n<=5},n},paint:p[nn]}),t(mt,Xn=u),e((n.BoxPlotSparkline=An=mt).prototype,{createFunction:function(){function e(n,t){return b(n)&&!_(t)&&0<=t&&t<=100?o.PERCENTILE.evaluate(n,t/100):X}function r(n){return b(n)?o.STDEVP.evaluate(n):X}var n=new i(tn,1,10);return n.evaluate=function(n){var t=n[0];return{points:E(t,!0),boxPlotClass:n[1],showAverage:n[2],scaleStart:L(n[3]),scaleEnd:L(n[4]),acceptableStart:L(n[5]),acceptableEnd:L(n[6]),colorScheme:n[7],style:n[8],vertical:n[9],perc02:e(t,2),perc09:e(t,9),perc10:e(t,10),perc90:e(t,90),perc91:e(t,91),perc98:e(t,98),q1:e(t,25),q3:e(t,75),median:e(t,50),stDev:r(t)}},n.acceptsReference=x,n.acceptsArray=x,n},paint:p[tn]}),t(dt,Yn=u),e((n.CascadeSparkline=yn=dt).prototype,{createFunction:function(){var n=new i(en,1,10);return n.evaluate=function(n){return{points:E(n[0],!0),pointIndex:L(n[1]),labels:E(n[2],!0),minimum:L(n[3]),maximum:L(n[4]),colorPositive:n[5],colorNegative:n[6],vertical:n[7],itemTypeRange:E(n[8],!0),colorTotal:n[9]}},n.acceptsReference=et,n.acceptsArray=et,n},paint:p[en]}),t(bt,Vn=u),e((n.ParetoSparkline=On=bt).prototype,{createFunction:function(){var n=new i(rn,2,12);return n.evaluate=function(n){return{points:E(n[0],!0),pointIndex:L(n[1]),colorRange:E(n[2],!0),target:L(n[3]),target2:L(n[4]),highlightPosition:L(n[5]),label:n[6],vertical:n[7],targetColor:n[8],target2Color:n[9],labelColor:n[10],barSize:n[11]}},n.acceptsReference=N,n.acceptsArray=N,n},paint:p[rn]}),t(kt,zn=u),e((n.MonthSparkline=_n=kt).prototype,{createFunction:function(){var n=new i(on,3,7);return n.evaluate=function(n){var t,e,r,i,r,o,a,u,c,s,f,l,l,t=n[0],e=n[1],r=n[2],i=r;for((b(r)||S(r))&&(i=R(r,0,!0)),r=n[3],o=[],(b(r)||S(r))&&(o=R(r,0,!0)),a=[],u=[],c=0,s=i.length;c<s;c++)(f=i[c])&&(l="string"==typeof(l=f[0])?new Date(l):l)&&l.getFullYear()===t&&l.getMonth()+1===e&&(a[l=l.getDate()-1]=f[1],0<o.length)&&(u[l]=o[c][0]);return 0<o.length?{year:t,month:e,values:a,colors:u}:{year:t,month:e,values:a,emptyColor:r,startColor:n[4],middleColor:n[5],endColor:n[6]}},n.acceptsReference=ot,n.acceptsArray=ot,n},paint:p[on]}),t(j,Jn=u),j.daysOfMonth=function(n,t){switch(t){case 2:var e;return n%4==0&&n%100!=0||n%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},j.dayInYear=function(n){for(var t,e,r,i,t=n.getFullYear(),e=n.getMonth(),r=n.getDate(),i=1;i<e+1;i++)r+=j.daysOfMonth(t,i);return r},m=j,e((n.YearSparkline=m).prototype,{createFunction:function(){var n=new i(an,2,6);return n.evaluate=function(n){var t,e,r,e,i,o,a,u,c,s,f,f,t=n[0],e=n[1],r=e;for((b(e)||S(e))&&(r=R(e,0,!0)),e=n[2],i=[],(b(e)||S(e))&&(i=R(e,0,!0)),o=[],a=[],u=0,c=r.length;u<c;u++)(s=r[u])&&(f="string"==typeof(f=s[0])?new Date(f):f)&&f.getFullYear()===t&&(o[f=m.dayInYear(f)-1]=s[1],0<i.length)&&(a[f]=i[u][0]);return 0<i.length?{year:t,values:o,colors:a}:{year:t,values:o,emptyColor:e,startColor:n[3],middleColor:n[4],endColor:n[5]}},n.acceptsReference=at,n.acceptsArray=at,n},paint:p[an]}),t(St,Un=u),e((n.HistogramSparkline=Nn=St).prototype,{createFunction:function(){var f,n,f=this,n=new i(hn,1,9);return n.acceptsArray=function(){return!0},n.evaluate=function(n){var t,e,t,r,i,o,a,u,c,n,s,t=n[0],e=[];if(!(t instanceof A.CalcArray||t instanceof A.CalcReference))throw A.CalcError;if(e=f.RMt(t),t=n[1],y(t)&&(t=!0),r=!0===n[2],i=n[3],(i=y(i)?1:i)<=0)throw A.CalcError;if(o=n[4],1<(o=y(o)?1:o)||o<=0)throw A.CalcError;return a=n[5]||"#5B9BD5",u=n[6],c=n[7]||"#000000",n=n[8]||"#C0C0C0",{values:s=t?f.BMt(e,i):f.LMt(e),continuous:t,paintLabel:r,barWidth:o,barColor:a,labelFontStyle:u,labelColor:c,edgeColor:n}},n.acceptsReference=function(n){return 0===n},n},RMt:function(n){var t,e,r,t=[];if(n instanceof A.CalcArray)for(e=n.toArray(1),r=0;r<e.length;r++)t.push(e[r]);else(e=R(n,0)).forEach(function(n){n.forEach(function(n){y(n)||"number"!=typeof n||isNaN(n)||t.push(n)})});return t},BMt:function(n,t){var e,r,i,o,a,u,c,n,s,f,e=[],r=0,i=this;for(n.forEach(function(n){e[r]=n,r++}),o=[],a=c=e[0],e.forEach(function(n){a=Math.min(n,a),c=Math.max(n,c)}),u=g(a/t)*t,n=Math.ceil(c/t)*t,s=1!==e.length?Math.round((n-u)/t):1,r=0;r<s;r++)o[r]=h.Common.st.E8(r*t+u,15);for(o[r-1]<=c&&(o[r]=o[r-1]+t),f=[],r=0,s=o.length-1;r<s;r++)f[r]={value:0};for(0<f.length&&(f[0].axis="["+o[0]+","+o[1]+"]"),r=1;r<o.length-1;r++)y(o[r+1])?f[r].axis="("+o[r]+","+(o[r]+t)+"]":f[r].axis="("+o[r]+","+o[r+1]+"]";return e.forEach(function(n){var n=i.FMt(o,n);f[n].value++}),0<f.length&&0===f[0].value&&f.splice(0,1),f},LMt:function(n){for(var t,e,r,i,o,t,t=this,e={},r=0,i=n.length;r<i;++r)o=n[r],void 0===e[o]?e[o]=1:e[o]++;return(t=t.PMt(e)).sort(function(n,t){return n-t}),t.map(function(n){return{axis:n,value:e[n]}})},PMt:function(n){var t,e,t=[];for(e in n)n.hasOwnProperty(e)&&void 0!==n[e]&&null!==n[e]&&t.push(e);return t},FMt:function(n,t){var e,r,i,o,a,e=n.length;if(n[0]===t)return 0;if(0===e)return 0;r=0,o=g((i=e-1)/2);do{if(t>n[a=o]&&t<=n[o+1])return o}while(t<=n[o]?o=g(((i=o)+r)/2):t>n[o+1]&&(o=g(((r=o)+i)/2)),a!==o)},paint:function(n,t,e,r,i,o,a){var u,c,u,c,u=t.labelFontStyle,c=a.zoomFactor;y(u)&&(u=n.font),u=k.W.V(u,c),c=k.W.Ne(u.font),t.afterZoomFontStyle={fontStyle:c.fontStyle,fontFamily:c.fontFamily,fontSize:c.fontSize,fontWeight:c.fontWeight,fontPixelSize:u.fontSize},p[hn](n,t,e,r,i,o,a)}}),t(Ct,Zn=u),e((n.ImageSparkline=En=Ct).prototype,{createFunction:function(){var n=new i(vn,1,10);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,n,t=n[0],e=n[1]||w.fit,r=n[2],i=n[3],o=n[4]||0,a=n[5]||0,u=n[6],c=n[7],s=n[8],n=n[9];if(-1===[0,1,2].indexOf(s)&&(s=k.VerticalAlign.center),-1===[0,1,2].indexOf(n)&&(n=k.HorizontalAlign.center),e!==w.custom||r!==f&&i!==f)return r=r<0?0:r,i=i<0?0:i,a=a<0?0:a,o=o<0?0:o,u=u<0?0:u,c=c<0?0:c,{url:t,drawType:e=-1===[1,2,3,4].indexOf(e)?1:e,height:r,width:i,clipY:o,clipX:a,clipWidth:c,clipHeight:u,vAlign:s,hAlign:n};throw A.CalcError},n},GMt:function(n,t,e,r,i){var o,a,u,c,n,s,f,l,n,t,h,v,e,p,g,o=n.width,a=n.height,u=n.x,c=n.y,n=t.width,s,f={clipX:0,clipY:0,clipHeight:t.height,clipWidth:n,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if((l=o/a)<(n=(f=this.UMt(f,t,e)).clipWidth/f.clipHeight))switch(t=r.vAlign,f.paintWidth=o,f.paintHeight=h=o/n,f.paintX=u,t){case k.VerticalAlign.top:f.paintY=c;break;case k.VerticalAlign.center:f.paintY=c+(v=a-h)/2;break;case k.VerticalAlign.bottom:f.paintY=c+a-h}else switch(e=r.hAlign,f.paintHeight=a,f.paintWidth=p=a*n,f.paintY=c,e){case k.HorizontalAlign.left:f.paintX=u;break;case k.HorizontalAlign.center:f.paintX=u+(g=o-p)/2;break;case k.HorizontalAlign.right:f.paintX=u+o-p}return f},HMt:function(n,t,e,r,i){var n={cutX:0,cutY:0,cutHeight:t.width,cutWidth:t.height,paintX:n.x,paintY:n.y,paintHeight:n.height,paintWidth:n.width};return this.UMt(n,t,e)},UMt:function(n,t,e){var r,t,i,o,r=t.width,t=t.height,i=e.clipX||0,o=e.clipY||0;return y(e.clipX)||(n.clipX=a(e.clipX,r)),y(e.clipY)||(n.clipY=a(e.clipY,t)),y(e.clipWidth)?n.clipWidth=r-n.clipX:n.clipWidth=e.clipWidth+i>r?r-i:e.clipWidth,y(e.clipHeight)?n.clipHeight=t-n.clipY:n.clipHeight=e.clipHeight+o>t?t-o:e.clipHeight,n},zMt:function(n,t,e,r,i){var o,a,u,c,s,n,t,e,f,i,l,h,v,r,p,g,w,m,o=n.width,a=n.height,u=n.x,c=n.y,s={imgWidth:t.width,imgHeight:t.height,offsetX:0,offsetY:0},n=(s=this.VMt(s,t,e)).imgWidth,t=s.imgHeight,e=s.offsetX,f=s.offsetY,l=t*i,h={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},v=r.hAlign,r=r.vAlign;if(o<(i=n*i)){switch(h.paintWidth=o,h.paintX=u,p=(i-o)/i*n,v){case k.HorizontalAlign.left:h.clipX=s.offsetX;break;case k.HorizontalAlign.center:h.clipX=s.offsetX+p/2;break;case k.HorizontalAlign.right:h.clipX=s.offsetX+p}h.clipWidth=o}else{switch(h.clipWidth=n,h.clipX=0,g=o-(h.paintWidth=i),v){case k.HorizontalAlign.general:case k.HorizontalAlign.left:h.paintX=u;break;case k.HorizontalAlign.center:h.paintX=u+g/2;break;case k.HorizontalAlign.right:h.paintX=u+g}h.clipX+=e}if(a<l){switch(h.paintY=c,w=(l-(h.paintHeight=a))/l*t,r){case k.VerticalAlign.top:h.clipY=s.offsetY;break;case k.VerticalAlign.center:h.clipY=s.offsetY+w/2;break;case k.VerticalAlign.bottom:h.clipY=s.offsetY+w}h.clipHeight=a}else{switch(h.clipHeight=t,h.clipY=0,m=a-(h.paintHeight=l),r){case k.VerticalAlign.top:h.paintY=c;break;case k.VerticalAlign.center:h.paintY=c+m/2;break;case k.VerticalAlign.bottom:h.paintY=c+m}h.clipY+=f}return h},YMt:function(n,t,e,r,i){var o,a,i,u,c,s,f,l,n,t,h,v,p,r,g,w,m,g,d,b,o={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},a=t.customWidth*i,i=t.customHeight*i;if(!(null===a||a<0||null===i||a<0)){if(u=n.width,c=n.height,s=n.x,f=n.y,l={imgWidth:t.width,imgHeight:t.height,offsetX:0,offsetY:0},n=(l=this.VMt(l,t,e)).imgWidth,t=l.imgHeight,h=l.offsetX,v=l.offsetY,p=r.hAlign,r=r.vAlign,u<a){switch(o.paintWidth=u,o.paintX=s,w=(g=(a-u)/a)*n,p){case k.HorizontalAlign.left:o.clipX=l.offsetX;break;case k.HorizontalAlign.center:o.clipX=l.offsetX+w/2;break;case k.HorizontalAlign.right:o.clipX=l.offsetX+w}o.clipWidth=l.imgWidth*(1-g)}else{switch(o.clipWidth=n,o.clipX=0,m=u-(o.paintWidth=a),p){case k.HorizontalAlign.general:case k.HorizontalAlign.left:o.paintX=s;break;case k.HorizontalAlign.center:o.paintX=s+m/2;break;case k.HorizontalAlign.right:o.paintX=s+m}o.clipX+=h}if(c<i){switch(o.paintY=f,d=(g=(i-(o.paintHeight=c))/i)*t,r){case k.VerticalAlign.top:o.clipY=l.offsetY;break;case k.VerticalAlign.center:o.clipY=l.offsetY+d/2;break;case k.VerticalAlign.bottom:o.clipY=l.offsetY+d}o.clipHeight=l.imgHeight*(1-g)}else{switch(o.clipHeight=y(e.clipHeight)?t:l.imgHeight,o.clipY=0,b=c-(o.paintHeight=i),r){case k.VerticalAlign.top:o.paintY=f;break;case k.VerticalAlign.center:o.paintY=f+b/2;break;case k.VerticalAlign.bottom:o.paintY=f+b}o.clipY+=v}}return o},VMt:function(n,t,e){var r=t.width,t=t.height;return y(e.clipX)||(n.offsetX=a(r,e.clipX)),y(e.clipY)||(n.offsetY=a(t,e.clipY)),y(e.clipWidth)?n.imgWidth=r-n.offsetX:n.imgWidth=e.clipWidth+n.offsetX>r?r-n.offsetX:e.clipWidth,y(e.clipHeight)?n.imgHeight=t-n.offsetY:n.imgHeight=e.clipHeight+n.offsetY>t?t-n.offsetY:e.clipHeight,n},paint:function(n,t,e,r,i,o,a){var u,c,e,r,s;if(!y(t)&&!y(t.url)&&H(t.url)&&""!==t.url.trim()){u=this,e={x:e,y:r,width:i,height:o},r=(c=a.sheet).BO();try{s=t.url,r.jt(s)?u.ZMt(n,t,e,a):r.Rt(s)}catch(n){}}},ZMt:function(n,t,e,r){var i,o,a,u,a,a,c,s,f,l,h,v,i=this,o=t.url,a=r.sheet,u=t.drawType,a=a.MC;if(o&&"string"==typeof o&&a.qh(o)){switch(c={width:(a=a.Ot(o)).width,height:a.height},s={clipY:t.clipY,clipX:t.clipX,clipWidth:t.clipWidth,clipHeight:t.clipHeight},f={vAlign:t.vAlign,hAlign:t.hAlign},h=r.zoomFactor,u){case w.fit:l=i.GMt(e,c,s,f,h);break;case w.entireFit:l=i.HMt(e,c,s,f,h);break;case w.originFit:l=i.zMt(e,c,s,f,h);break;case w.custom:c.customWidth=t.width,c.customHeight=t.height,l=i.YMt(e,c,s,f,h)}l.img=a,p[v="IMAGESPARKLINE"](n,l,e.x,e.y,e.width,e.height,r)}}}),t(yt,qn=u),e((n.LineSparkline=Rn=yt).prototype,{createFunction:function(){return xt(un,0)},paint:At}),t(Ot,Qn=u),e((n.ColumnSparkline=Ln=Ot).prototype,{createFunction:function(){return xt(cn,1)},paint:At}),t(_t,$n=u),e((n.WinlossSparkline=Fn=_t).prototype,{createFunction:function(){return xt(sn,2)},paint:At}),t(Nt,nt=u),e((n.RangeBlockSparkline=jn=Nt).prototype,{createFunction:function(){var n=new i(fn,2,2);return n.evaluate=function(n){var t,e,e,r,i,o,a,u,c,r,t,s,t=n[0],e=t.source,e=e&&e.getSheet(),r=n[1],i=0,o=r.getSource().getSheet(),a=r.getRow(0),u=r.getColumn(0),c=r.getRowCount(0),r=r.getColumnCount(0),t=new k.Range(t.row,t.column,1,1),s=new k.Range(a,u,c,r);if(e&&e.name()===o.name()&&s.containsRange(t))throw A.CalcError;return{templateSheetName:o.name(),templateRange:{row:a,col:u,rowCount:c,colCount:r},bindingObject:n[2]}},n.isContextSensitive=function(){return!0},n.acceptsReference=x,n},paint:function(n,t,e,r,i,o,a){var u,c,s,f,f,u,u,f,u=t.templateSheetName,c=t.templateRange;if(u&&(f=(f=(s=a.sheet).parent)&&f.getSheetFromName(u))){if(!v){if(!(u=l("CellTypes")))return;v=u.qY,T=u.$Y,D=u.paintRangeTemplate}u=(new v).yN(f,c),f=(new T).yN(f,c),D(n,{x:e,y:r,width:i,height:o},t.bindingObject,a,u,f.tZ)}}}),t(Et,tt=u),e((n.GaugeKPISparkline=t=Et).prototype,{createFunction:function(){var n=new i(ln,4,255);return n.evaluate=function(n){var t,e,r,i,o,a,u,c,s,f,l,h,v,p,g,w,m,d,b,k,S,C,u,d,x,r,t=[],e=n.length,f=L(n[0]),l=L(n[1]),h=L(n[2]),v=L(n[3]),p=L(n[5]),g=L(n[6]),w=L(n[7]),m=L(n[8]),d=L(n[10]),b=L(n[11]),k=L(n[12]),S=n[4],C=n[13];if(!Rt(f,l,h,v,d,b,C,k))return O;for(n[9]instanceof A.CalcArray&&(i=(u=n[9].toArray(2))[0],o=u[1],a=u[2],u=u[3]),i=i||"16px Calibri",o=o||"bold 22px Calibri",a=a||Y,u=u||Y,p=y(p)?f:p,g=y(g)?l:g,w=y(w)?h:w,m=y(m)?v:m,d={minAngle:y(d)?-90:d,maxAngle:y(b)?90:b,radiusRatio:y(k)?0:k,targetValueOption:M(f,i,p),currentValueOption:M(l,o,g),minValueOption:M(h,a,w),maxValueOption:M(v,u,m),gaugeType:y(C)?0:C,ranges:void 0,showLabel:!!y(S)||Boolean(S)},x=14;x<e;x++)if((r=n[x])instanceof A.CalcArray){if(c=(r=r.toArray(0))[0],s=r[1],y(c)||y(s)||_(c)||_(s)||s<c||c<h||v<c||v<s||s<h)return O;t.push({start:c,end:s,color:r[2]})}return d.ranges=t,d},n.acceptsArray=function(n){return 9===n||14<=n},n.acceptsReference=function(n){return n<=3&&0<=n||5<=n&&n<=8||10<=n&&n<=12},n},paint:function(n,t,e,r,i,o,a){var u=a.zoomFactor;t.currentValueOption.fontAfterZoom=c(t.currentValueOption.font,u).font,t.targetValueOption.fontAfterZoom=c(t.targetValueOption.font,u).font,t.minValueOption.fontAfterZoom=c(t.minValueOption.font,u).font,t.maxValueOption.fontAfterZoom=c(t.maxValueOption.font,u).font,p[ln](n,t,e,r,i,o,a)}}),s={},n.jMt=s,i&&(P(new gn),P(new wn),P(new mn),P(new dn),P(new bn),P(new kn),P(new Sn),P(new Cn),P(new xn),P(new An),P(new yn),P(new On),P(new _n),P(new m),P(new Rn),P(new Ln),P(new Fn),P(new jn),P(new t),P(new Nn),P(new En)),e(k.Workbook.prototype,{addSparklineEx:function(n){this.WMt||(this.WMt={});var t=this.WMt;n&&(t[n.name()]=n)},getSparklineEx:function(n){var t,t,t=s[n];return t||(t=this.WMt)&&t[n]},removeSparklineEx:function(n){var t=this.WMt;t&&(t[n]=void 0)}}),k.Workbook.ch("sparklineEx",{toJson:function(n){var t,e,r,i,o,t=this.WMt,e=[];if(t){for(r in t)t.hasOwnProperty(r)&&(o=(i=t[r]).toJSON())&&o.typeName&&e.push(o);0<e.length&&(n.sparklineExs=e)}},fromJson:function(n){var t,e,r,i,i,t=n.sparklineExs;if(t)for(e=0;e<t.length;e++)r=t[e],(i=(0,k.getTypeFromString)(r.typeName))&&((i=new i).fromJSON(r),this.addSparklineEx(i))},wh:function(n,t,e){var r,i,o,a,u,r=this.WMt,i=[];if(r){for(o in r)r.hasOwnProperty(o)&&(u=(a=r[o]).toJSON())&&u.typeName&&i.push(u);0<i.length&&(n.workbook.lossless.sparklineExs=i)}},yh:function(n,t,e){var n,r,i,o,a,a,n=n.workbook.lossless,r=n&&n.sparklineExs;if(r)for(i=0;i<r.length;i++)o=r[i],(a=(0,k.getTypeFromString)(o.typeName))&&((a=new a).fromJSON(o),this.addSparklineEx(a))}})},"./dist/plugins/sparkline/sparkline-wrapper.js":function(I,n,t){var y,c,T,m,t,a,D,u,e,r,i,o,s,f,_,O,l,w,S,H,K,G,A,C,x,h,B,W,X,v,p,g,Y,V,z,J,U,t,l,d,b,Z,q,k,N,l,t,l,t,l,t,l;function Q(n,t,e,r){var i,n,t,i,n=m.formulaToRanges(n,t,e,r)[0],t=n&&n.ranges&&n.ranges[0];return t?{range:t,sheetName:n.sheetName}:A}function $(n,t,e,r){var i,o,i=this,o=i.RB;o._K(n,t,r),r&&o.add(r.group()),i.Rj("sparkline",n,t,3,e,r),i.ki(y.Events.WorksheetDataChanged,{type:"sparkline"})}function E(n){this.QMt=[],this.Mf=n,this.cE={},this.KMt=[],this.JMt=[]}function nn(n,t){return n+"_"+t}function tn(n,t,e){return e?n>e.row+e.rowCount-1?e:n>e.row?_(e.row,e.col,e.rowCount+t,e.colCount):_(e.row+t,e.col,e.rowCount,e.colCount):A}function en(n,t,e){return e?n>e.col+e.colCount-1?e:n>e.col?_(e.row,e.col,e.rowCount,e.colCount+t):_(e.row,e.col+t,e.rowCount,e.colCount):A}function rn(n,t,e,r,i){for(var o,a,u,c,s,f,l,h,v,p,g,w,m,d,b,o=new y.Rf,a=0;a<n.length;a++){if(c=(u=n[a]).XMt,u.displayDateAxis){if(O(u.dateAxisData())&&u.dateAxisData(u.qMt),s=void 0,(f=u.dateAxisData())instanceof y.Range)s=R(t,e,r,f);else for(l=0;l<f.length;l++)s.push.apply(s,R(t,e,r,f[l]));u.dateAxisData(s)}for(l=0;l<c.length;l++)h=c[l],t<=(v=r?h.row:h.column)&&(o.set(a,l,h),i._K(h.row,h.column,A),r?h.row+=e:h.column+=e),O(h.data())&&h.data(h.gI),p=void 0,(g=h.data())instanceof y.Range?(p=R(t,e,r,g),h.data(p)):h.data(h.gI)}for(w=0;w<n.length;w++)for(d=(m=n[w]).XMt,b=0;b<d.length;b++)i.$Mt(o.get(w,b))}function on(n,t,e,r,i,o){for(var a,u,c,s,f,l,h,v,p,g,w,m,d,b,a=0;a<r.length;a++)if((u=r[a]).displayDateAxis){if(s=(c=u.tCt()).Ut,f=!1,o&&!s.G8&&(s.G8=[],f=!0),O(u.dateAxisData())&&u.dateAxisData(u.qMt),l=void 0,(h=u.dateAxisData())instanceof y.Range)l=R(n,t,e,h);else for(v=0;v<h.length;v++)l.push.apply(l,R(n,t,e,h[v]));u.dateAxisData(l),f&&(o.push({sheetName:c.name(),changes:s.G8}),s.G8=C)}for(v=0;v<i.length;v++)w=(g=(p=i[v]).Tp()).Ut,m=!1,o&&!w.G8&&(w.G8=[],m=!0),O(p.data())&&p.data(p.gI),d=void 0,(b=p.data())instanceof y.Range?(d=R(n,t,e,b),p.data(d)):p.data(p.gI),m&&(o.push({sheetName:g.name(),changes:w.G8}),w.G8=C)}function R(n,t,e,r){var e,e=(e?tn:en)(n,t,r);return e}function an(n,t,e){var n=cn(e.col,e.col+e.colCount-1,n,n+t-1);return n?_(e.row,n.start,e.rowCount,n.end-n.start+1):A}function un(n,t,e){var n=cn(e.row,e.row+e.rowCount-1,n,n+t-1);return n?_(n.start,e.col,n.end-n.start+1,e.colCount):A}function cn(n,t,e,r){var i,o,a,u,u,c,s,i=-1;if(r<n)return{start:i=n-(u=r-e+1),end:o=t-u};if(t<e)return{start:i=n,end:o=t};if(e<=n){for(u=t-n+1,c=0,a=n;a<=r&&a<=t;a++)c++;return{start:i=e,end:o=i+u-c-1}}for(s=0,a=n;a<=t;a++)-1===i&&(a<e||r<a)&&(i=a),(a<e||r<a)&&s++;return-1!==i&&0<s?{start:i,end:o=i+s-1}:A}function sn(n,t,e,r,i){for(var o,a,u,c,s,f,l,h,v,p,g,w,w,m,d,b,k,o=new y.Rf,a=n.length,u=0,c=a-1;-1<c;c--){if((s=n[c]).displayDateAxis){if(O(s.dateAxisData())&&s.dateAxisData(s.qMt),f=void 0,(l=s.dateAxisData())instanceof y.Range)f=L(t,e,r,l);else for(h=0;h<l.length;h++)f.push.apply(f,L(t,e,r,l[h]));if(O(f)){s.clear(),i.remove(s);continue}s.dateAxisData(f)}for(v=(v=[]).concat(s.XMt),p=S(v),u=x(p,u),h=p-1;-1<h;h--)g=v[h],t<=(w=r?g.row:g.column)&&w<t+e&&O(g.gI)?(s.remove(g),i._K(g.row,g.column,A)):(t<=w&&(i._K(g.row,g.column,A),r?g.row-=e:g.column-=e,o.set(c,h,g)),O(g.data())&&g.data(g.gI),w=void 0,w=(m=g.data())instanceof y.Range?L(t,e,r,m):(g.data(g.gI),g.data()),O(w)?s.remove(g):g.data(w));s.count()<=0&&i.remove(s)}for(b=0;b<a;b++)for(k=0;k<u;k++)(d=o.get(b,k))&&i.$Mt(d)}function L(n,t,e,r){var e,e=(e?un:an)(n,t,r);return e}function fn(n,t,e,r,i,o){for(var a,u,c,s,f,l,h,v,p,g,w,m,d,b,k,S,S,a,u=r.length-1;-1<u;u--)if((c=r[u]).displayDateAxis){if(f=(s=c.tCt()).Ut,l=!1,o&&!f.G8&&(f.G8=[],l=!0),O(c.dateAxisData())&&c.dateAxisData(c.qMt),h=void 0,(v=c.dateAxisData())instanceof y.Range)h=L(n,t,e,v);else for(p=0;p<v.length;p++)h.push.apply(h,L(n,t,e,v[p]));O(h)?(c.clear(),c.RB.remove(c)):c.dateAxisData(h),l&&(o.push({sheetName:s.name(),changes:f.G8}),f.G8=C)}for(p=(g=i.length)-1;-1<p;p--)d=(m=(w=i[p]).Tp()).Ut,b=!1,o&&!d.G8&&(d.G8=[],b=!0),O(w.data())&&w.data(w.gI),k=void 0,k=(S=w.data())instanceof y.Range?L(n,t,e,S):(w.data(w.gI),w.data()),O(k)?((S=w.group()).remove(w),S.count()<=0&&S.RB.remove(S)):w.data(k),b&&(o.push({sheetName:m.name(),changes:d.G8}),d.G8=C)}function F(n){var t,e,t=this;for(e in t.options={},d)d.hasOwnProperty(e)&&(t.options[e]=(n&&n[e]?n:d)[e]);t.eJ=A}function j(n,t){var e=this;e.displayDateAxis=!1,e.RB=A,e.XMt=[],e.nCt=A,e.eCt=1,e.qMt=A,e.setting=t,e.sparklineType=n}function ln(n,t){var e=!1;return"setting"===n||"axisReference"===n?e=t===A:"displayDateAxis"===n?e=!1===t:"axisOrientation"===n?e=1===t:"sparklines"===n&&(e=0===t.length),e}function M(n,t,e,r,i,o,a){var u=this;u.row=n,u.column=t,u.iCt=r,u._data=e,u.rCt=new k(i,o),u.rCt.add(u),u.gI=a}function hn(n,t){var e,t,e=n.parent,t=n.getCustomName(t)||e.getCustomName(t);if(!O(t))return m.formulaToRanges(n,m.expressionToFormula(n,t.getExpression()),0,0,1===e.options.referenceStyle)}function P(n){var e,r,e=[],r=[];return n.forEach(function(n){e=e.concat(n.ranges);for(var t=0;t<n.ranges.length;t++)r.push(n.sheetName)}),{ranges:e,sheetName:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.Sparkline=n.DataOrientation=n.SparklineType=n.SparklineSetting=n.SparklineAxisMinMax=n.EmptyValueStyle=void 0,y=t("Core"),c=t("Common"),T=t("CalcEngine"),m=t("SheetsCalc"),t=y.mt,a=t.xr,D=t.Hue,u=y.range_parser.Dc,e=y.NodeHelper.ar,r=y.NodeHelper.ur,i=t.d1,o=t.h1,s=y.range_parser.Oc,f=y.GC$.isEmptyObject,_=y.Ec,O=c.Common.lt.ht,l=c.Common.Uf,w=l.VP,S=l.tR,H=l.OS,K=c.Sparklines.oCt,G=c.Sparklines.SparklineRender,A=null,C=void 0,x=Math.max,h=Number.MAX_VALUE,B=y.UsedRangeUtil.vh,W=t.vo,X=t.n1,(l=v=v||{})[l.line=0]="line",l[l.column=1]="column",l[l.stacked=2]="stacked",(t=p=p||{})[t.span=2]="span",t[t.gap=0]="gap",t[t.zero=1]="zero",(l=g=g||{})[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",y.GC$.extend(y.Y8.prototype,{aCt:function(n){var t,e,r,i,o,a,t,e=this.G8,r=arguments[1];if(e){switch(e.originalSparklines||(e.originalSparklines=[]),i={type:n},n){case 0:a=void 0,a=r&&r.sparkline?r.sparkline:A,i.changeInfo={row:r.row,col:r.col,sparkline:a};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:i.changeInfo=r}e.originalSparklines.push(i)}},uCt:function(n){var t,e,r,i,o,a,u,c,s,f,l,h,v,p,g,t=this,e=n.changeInfo;switch(n.type){case 12:e.sparkline?(e.sparkline.row=e.row,e.sparkline.column=e.col,t.RB._K(e.row,e.col,e.sparkline)):t.RB._K(e.row,e.col,A);break;case 0:t.RB._K(e.row,e.col,e.sparkline),e.sparkline&&!t.RB.contains(e.sparkline.group())&&t.RB.add(e.sparkline.group());break;case 1:for(a=o=i=void 0,u=S(e),c=0;c<u;c++)i=e[c].row,o=e[c].col,a=t.RB.sCt(i,o),0===c&&a.rCt.count()===u&&t.RB.remove(a.rCt),this.RB.add(a.group(e[c].group).rCt);break;case 2:for(s=[],f=0;f<S(e);f++)s.push(t.RB.sCt(e[f].row,e[f].col));t.RB.Mf.groupSparkline(s);break;case 3:(r=t.RB.sCt(e.row,e.col)).sparklineType(e.sparklineType);break;case 4:(r=t.RB.sCt(e.row,e.col)).setting(e.setting);break;case 5:e.sparkline.data(e.data);break;case 15:(r=t.RB.sCt(e.row,e.col)).dataSheetName(e.dataSheetName);break;case 6:(r=t.RB.sCt(e.row,e.col)).dataOrientation(e.dataOrientation);break;case 7:(r=t.RB.sCt(e.row,e.col)).displayDateAxis(e.displayDateAxis);break;case 8:l=void 0,l=(h=e.rangeInfo)&&_(h.row,h.col,h.rowCount,h.colCount),e.group.dateAxisData(l);break;case 16:e.group.dateAxisDataSheetName(e.dateAxisDataSheetName);break;case 9:e.group.dateAxisOrientation(e.dateAxisOrientation);break;case 10:for((v=e.group.XMt).forEach(function(n){t.RB.cCt(n)}),e.group.XMt=e.innerList,p=e.group.XMt,g=0;g<S(p);g++)p[g].group(e.group);p.forEach(function(n){t.RB.fCt(n)});break;case 11:(r=t.RB.sCt(e.row,e.col)).group(e.group);break;case 13:w(t.RB.groups(),e),t.RB.lCt(e);break;case 14:t.RB.groups().push(e),t.RB.hCt(e)}},dCt:function(n){for(var t,e,t,e=S(n)-1;0<=e;e--)this.uCt(n[e])},vCt:function(n,t){this.RB.JO(n,t)},mCt:function(n,t){this.RB.xP(n,t)},gCt:function(n,t){this.RB.qO(n,t)},pCt:function(n,t){this.RB.NP(n,t)},bCt:function(n,t,e,r){this.RB.clear(n,t,e,r)},yCt:function(){var n=this.G8;return n?(n.wCt||(n.wCt=[]),n.wCt):A}}),y.Y8.ch("sparkline",{init:function(){var n=this.Mf;this.RB=new z(n)},undo:function(n){var t,e,t,t=n.originalSparklines;t&&this.dCt(t),e=this.Mf,(t=n.wCt)&&t.forEach(function(n){var t;e.parent.getSheetFromName(n.sheetName).Ut.undo(n.changes)})}}),y.Worksheet.ch("sparkline",Y={init:function(){this.RB=this.Ut.RB},getUsedRange:function(n){var t,e,r;n.type&y.UsedRangeType.sparkLine&&(r=(e=(t=this).RB).getUsedRange(),B(n.range,r))},dispose:function(n){var n;!1!==n.clearCache&&((n=this).RB&&(n.RB.Mf=A,n.RB.evaluator=A,n.RB=A),n.Ut)&&(n.Ut.RB=A)},onLayoutChanged:function(n){var t,e,r,i,o,a,t;!O(n.sheetArea)&&3!==n.sheetArea||(t=n.changeType,e=n.row,r=n.rowCount,i=n.col,o=n.colCount,a=this.Ut,"addRows"===t?a.vCt(e,r):"deleteRows"===t?a.mCt(e,r):"addColumns"===t?a.gCt(i,o):"deleteColumns"===t?a.pCt(i,o):"clear"===t&&(t=n.type,3===n.sheetArea)&&16==(16&t)&&a.bCt(e,i,r,o))},toJson:function(n,t){var e;t&&t.ignoreStyle||(n.sparklineGroups=this.RB.toJSON())},wh:function(n,t,e){var r,e,n,r;(!e||!1!==e.includeStyles)&&(e=this.RB.wh(),n=a(n,y.XFileConstants.Au),0<e.c_.length)&&n.c_.push({n_:"ext",c_:[e],r_:[0,1]})},fromJson:function(n,t,e){var e,r,i,o,o,e=e&&e.ignoreStyle,r,i=this.RB,o=n.sparklineGroupManager,o=t?o&&o.groups:n.sparklineGroups;o&&!e&&i.AP(o,t)},yh:function(n,t,e){var r,i,o,n,n,r=e&&!1===e.includeStyles,i,o=this.RB,n=D(a(n,"extLst"),"sparklineGroups"),n=n&&n.c_;n&&!r&&(o.MCt(n,e),o.groups().forEach(function(n){n.XMt.forEach(function(n){o.$Mt(n)})}))},setName:function(n){var t=n.oldName,n=n.newName;this.RB.CCt(t,n)}}),y.GC$.extend(y.Worksheet.prototype,V={getSparkline:function(n,t){return this.RB?this.RB.sCt(n,t):A},setSparkline:function(n,t,e,r,i,o,a,u){var c,s,f,l,h,v,p,f,g,w,h,e,r,i,o,c=this,s;if(!c.RB)return A;if("string"==typeof e&&(h=Q(c,e,n,t),v=c.getCustomName(e)||c.parent.getCustomName(e),p=void 0,(p=O(v)?p:m.formulaToRanges(c,m.expressionToFormula(c,v.getExpression(),n,t,1===c.parent.options.referenceStyle)))?(l=e,e=g=(f=P(p)).ranges,f=w=f.sheetName):h&&(e=h.range,f=h.sheetName),!h)&&!p)return A;if(h=new N(n,t,e,r,i,o,l),f&&f!==c.name()&&h.dataSheetName(f),a&&!O(u)){if(e=void 0,"string"==typeof a&&(r=Q(c,a,n,t),v=c.getCustomName(a)||c.parent.getCustomName(a),p=void 0,(p=O(v)?p:m.formulaToRanges(c,m.expressionToFormula(c,v.getExpression(),n,t,1===c.parent.options.referenceStyle)))?(h.group().qMt=a,a=g=(i=P(p)).ranges,e=w=i.sheetName):r&&(a=r.range,e=r.sheetName),!r)&&!p)return A;h.dateAxisData(a),e&&e!==c.name()&&h.dateAxisDataSheetName(e),h.dateAxisOrientation(u),h.group().displayDateAxis=!0}return o=c.getSparkline(n,t),c.removeSparkline(n,t),$.call(c,n,t,o,h),c.zw(),h},SCt:function(n,t,e){var r,i=this.getSparkline(n,t);$.call(this,n,t,i,e)},removeSparkline:function(n,t){var e,r,i,o,a,e=this,r=e.RB;r&&(i=e.getSparkline(n,t),e.Ut.aCt(0,o={row:n,col:t,sparkline:i}),i&&((a=i.group()).remove(i),a.count()<=0&&r.remove(a),$.call(e,n,t,i,A)),e.zw())},groupSparkline:function(n){var t,e,r,i,o,a,u,c,t=this,e=t.RB;if(!e)return A;for(r=A,i=[],o=t.Ut.G8!==C,a=0;a<n.length;a++)(u=n[a])&&(o&&i.push({group:u.group().clone(),row:u.row,col:u.column}),r?((c=u.group()).remove(u),r.add(u),c.count()<=0&&e.remove(c)):r=u.group());return t.zw(),t.Ut.aCt(1,i),r},ungroupSparkline:function(n){var t,e,r,i,o,a,u,c,t=this,e=t.RB;if(e&&n){for(i=[],o=t.Ut.G8!==C,r=(r=[]).concat(n.XMt),a=0;a<r.length;a++)(u=r[a])&&(o&&i.push({row:u.row,col:u.column}),n.remove(u),(c=n.clone()).add(u),e.add(c));e.remove(n),t.Ut.aCt(2,i),t.zw()}}}),E.prototype.getUsedRange=function(){var n,t,e,r,i,o,a,u,c,s,n,t=this.cE,e={};if(t)for(a=o=i=void 0,u=0,c=r=Object.keys(t);u<c.length;u++)o=(i=t[s=c[u]]).row,a=i.column,B(e,{minRow:o,minCol:a,maxRow:o,maxCol:a});return e},E.prototype.AP=function(n,t){var e=this;e.fromJSON(n,t),e.groups().forEach(function(n){n.XMt.forEach(function(n){e.$Mt(n)})})},E.prototype.MCt=function(n,t){var e,r,e=this,r=e.Mf;e.yh(n,t),e.groups().forEach(function(n){n.XMt.forEach(function(n){e.$Mt(n),n.row>=r.getRowCount()&&r.setRowCount(n.row+1),n.column>=r.getColumnCount()&&r.setColumnCount(n.column+1)})})},E.prototype.$Mt=function(n){n&&this._K(n.row,n.column,n)},E.prototype._K=function(n,t,e){var r;this.Mf.Ut.G8&&(r={row:n,col:t,sparkline:this.sCt(n,t),newSparkline:e},this.Mf.Ut.aCt(12,r)),e?this.cE[n+"_"+t]=e:delete this.cE[n+"_"+t]},E.prototype.sCt=function(n,t){return this.cE[n+"_"+t]||A},E.prototype.groups=function(n){if(0===arguments.length)return this.QMt;this.QMt=n},E.prototype.add=function(n){var t=this;t.Mf.Ut.aCt(13,n),t.groups().push(n),n.RB=t,n.TCt(),t.hCt(n)},E.prototype.hCt=function(n){var t=this;t.ACt(n),n.all().forEach(function(n){t.fCt(n)})},E.prototype.remove=function(n){var t=this;t.Mf.Ut.aCt(14,n),w(t.groups(),n),t.lCt(n)},E.prototype.lCt=function(n){var t=this;t.ICt(n),n.all().forEach(function(n){t.cCt(n)})},E.prototype.contains=function(n){return H(this.groups(),n)},E.prototype.count=function(){return this.groups().length},E.prototype.JO=function(n,t){rn(this.QMt,n,t,!0,this),on(n,t,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.qO=function(n,t){rn(this.QMt,n,t,!1,this),on(n,t,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.xP=function(n,t){sn(this.QMt,n,t,!0,this),fn(n,t,!0,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.NP=function(n,t){sn(this.QMt,n,t,!1,this),fn(n,t,!1,this.JMt,this.KMt,this.Mf.Ut.yCt())},E.prototype.CCt=function(t,e){this.JMt.forEach(function(n){n.dateAxisDataSheetName()===t&&n.dateAxisDataSheetName(e)}),this.KMt.forEach(function(n){n.dataSheetName()===t&&n.dataSheetName(e)})},E.prototype.fCt=function(n){var t,e,t,e,t=this.Mf,e=n.dataSheetName();e&&e!==t.name()&&(t=t.parent&&t.parent.getSheetFromName(e))&&(e=t.RB.KMt).indexOf(n)<0&&e.push(n)},E.prototype.cCt=function(n){var t,t,t,n,t=n.dataSheetName();t&&(t=this.Mf.parent.getSheetFromName(t))&&0<=(n=(t=t.RB.KMt).indexOf(n))&&t.splice(n,1)},E.prototype.ACt=function(n){var t,e,t,e,t=this.Mf,e=n.dateAxisDataSheetName();e&&e!==t.name()&&(t=t.parent.getSheetFromName(e))&&(e=t.RB.JMt).indexOf(n)<0&&e.push(n)},E.prototype.ICt=function(n){var t,t,t,n,t=n.dateAxisDataSheetName();t&&(t=this.Mf.parent.getSheetFromName(t))&&0<=(n=(t=t.RB.JMt).indexOf(n))&&t.splice(n,1)},E.prototype.clear=function(n,t,e,r){var i,o,a,u,c,s,f,l,h,v,i=this;if(0===arguments.length){for(o=i.QMt,a=S(o)-1;-1<a;a--)if(u=o[a]){for(c=u.count()-1;-1<c;c--)s=u.XMt[c],i._K(s.row,s.column,A),u.remove(s);i.remove(u)}}else for(f=n;f<n+e;f++)for(l=t;l<t+r;l++)(h=i.Hq(f,l))&&(i._K(h.row,h.column,A),(v=h.group()).remove(h),0===v.count())&&i.remove(v)},E.prototype.Hq=function(n,t){for(var e,r,i,o,a,e=this.QMt,r=0;r<e.length;r++)for(i=e[r],o=0;o<i.count();o++)if((a=i.XMt[o])&&a.row===n&&a.column===t)return a;return A},E.prototype.tE=function(n,t,e,r,i,o,a,u){var c,s,f,l,h,v,p,g,w,m,d,b,k,S,C,x,x,A,A,c=this,s=c.Mf;if(s){for(f=new y.Rf,l=e-n,h=r-t,g=s.getRowCount(),w=s.getColumnCount(),b=i,k=o,S=s.RB,C=!u&&s.o5(),m=v=0;v<i&&e+v<g;v++)if(C&&0===s.getRowHeight(e+v))i++;else{if(!(a&&s.XT&&s.XT(e+v)))for(d=p=0,o=k;p<o&&r+p<w;p++)C&&0===s.getColumnWidth(r+p)?o++:((x=s.getSparkline(n+m,t+d))&&((x=x.clone()).row=e+v,x.column=r+p,O(x.dateAxisData())&&x.dateAxisData(x.group().qMt),A=x.dateAxisData(),C&&(l=e-n+v-m,h=r-t+p-d),!O(A)&&c.xCt(A,l,h,g,w)&&O(x.group().customName)&&x.dateAxisData(A.offset(h,l)),O(x.data())&&x.data(x.gI),A=x.data(),!O(A)&&c.xCt(A,l,h,g,w)&&O(x.gI)&&x.data(A.offset(h,l)),c.add(x.group()),f.set(v,p,x)),d++);m++}for(v=0,i=b;v<i&&e+v<g;v++)if(C&&0===s.getRowHeight(e+v))i++;else if(!(a&&s.XT&&s.XT(e+v)))for(p=0,o=k;p<o&&r+p<w;p++)C&&0===s.getColumnWidth(r+p)?o++:S._K(e+v,r+p,f.get(v,p))}},E.prototype.xCt=function(n,t,e,r,i){var n,o,a,u,n,n=this.NCt(n);return!(!n||(o=x(n.row,0),a=x(n.col,0),u=n.row<0?r:n.rowCount,n=n.col<0?i:n.colCount,o+t<0)||a+e<0||r<o+u+t||i<a+n+e)},E.prototype.iE=function(n,t,e,r,i,o){var a,u,c,s,f,l,h,v,p,g,w,m,d,a=this.Mf;if(a){for(s=a.o5(),f=o,l=i,this.kCt(n,t,e,r,i,o),h=a.RB,v=new y.Rf,w=a.getRowCount(),m=a.getColumnCount(),u=p=0;p<i&&p+e<w;p++)if(s&&0===a.getRowHeight(e+p))i++;else{for(c=g=0,o=f;g<o&&r+g<m;g++)s&&0===a.getColumnWidth(r+g)?o++:((d=a.getSparkline(n+u,t+c))&&(d.row=e+p,d.column=r+g,v.set(u,c,d)),h._K(n+u,t+c,A),c++);u++}for(u=p=0,i=l;p<i&&p+e<w;p++)if(s&&0===a.getRowHeight(e+p))i++;else{for(c=g=0,o=f;g<o&&r+g<m;g++)s&&0===a.getColumnWidth(r+g)?o++:(a.removeSparkline(e+p,r+g),h._K(e+p,r+g,v.get(u,c)),c++);u++}}},E.prototype.kCt=function(n,t,e,r,i,o,a){var u,c,a,s,f,l,h,v,p,g,w,m,d,b,k,S,C,x,A,y,O,u=this,a=(c=(u=a?a:u).Mf).o5(),s=_(n,t,i,o),h=o,m=c.getRowCount(),d=c.getColumnCount(),b=u.QMt;if(a)for(w=p=0;p<i&&p+e<m;p++)if(0===c.getRowHeight(e+p))i++;else{for(g=v=0,o=h;v<o&&v+r<d;v++)if(0===c.getColumnWidth(r+v))o++;else{if(k=c.getSparkline(n+w,t+g))for(f=e-n+p-w,l=r-t+v-g,C=(S=k.rCt).XMt,x=0;x<C.length;x++)(A=C[x])&&u.DCt(A,f,l,s);g++}w++}else for(f=e-n,l=r-t,x=0;x<b.length;x++)for(C=(y=b[x]).XMt,O=0;O<C.length;O++)(k=C[O])&&u.DCt(k,f,l,s)},E.prototype.DCt=function(n,t,e,r){var i,o,a,a,o,i=this;O(n.dateAxisData())&&n.dateAxisData(n.group().qMt),o=n.dateAxisData(),(a=i.NCt(o))&&r.containsRange(a)&&r.contains(n.row,n.column)&&n.dateAxisData(o.offset(e,t)),O(n.data())&&n.data(n.gI),a=n.data(),(o=i.NCt(a))&&r.containsRange(o)&&r.contains(n.row,n.column)&&n.data(a.offset(e,t))},E.prototype.NCt=function(n){return n},E.prototype.LB=function(n,t,e,r,i,o,a,u,c){var s,f,l,h,v,p,g,w,m,d,b,k,S,C,C,x,x,s=this,f=s.Mf;if(f)if(n===f)s.tE(t,e,r,i,o,a);else for(l=r-t,h=i-e,v=f.RB,p=!c&&f.o5(),g=f.getRowCount(),w=f.getColumnCount(),m=a,k=d=0;d<o&&r+d<g;d++)if(p&&0===f.getRowHeight(r+d))o++;else{if(!(u&&f.XT&&f.XT(r+d)))for(S=b=0,a=m;b<a&&i+b<w;b++)p&&0===f.getColumnWidth(i+b)?a++:((C=n.getSparkline(t+k,e+S))?((C=C.clone()).row=r+d,C.column=i+b,O(C.dateAxisData())&&C.dateAxisData(C.group().qMt),x=C.dateAxisData(),p&&(l=r+d-t-k,h=i-e+b-S),!O(x)&&s.xCt(x,l,h,g,w)&&C.dateAxisData(x.offset(h,l)),O(C.data())&&C.data(C.gI),x=C.data(),!O(x)&&s.xCt(x,l,h,g,w)&&C.data(x.offset(h,l)),s.add(C.group()),v._K(r+d,i+b,C)):v._K(r+d,i+b,A),S++);k++}},E.prototype.BB=function(n,t,e,r,i,o,a){var u,c,s,f,l,h,v,p,g,w,m,d,b,k,S,u=this,c=u.Mf;if(c)if(n===c)u.iE(t,e,r,i,o,a);else for(s=c.o5(),f=a,l=n.RB,h=c.RB,m=c.getRowCount(),d=c.getColumnCount(),u._Ct(n,t,e,r,i,o,a),g=v=0;v<o&&r+v<m;v++)if(s&&0===c.getRowHeight(r+v))o++;else for(w=p=0,a=f;p<a&&i+p<d;p++)s&&0===c.getColumnWidth(i+p)?a++:((b=n.getSparkline(t+0,e+0))?(b.row=r+v,b.column=i+p,S=(k=b.group()).clone(),k.remove(b),k.count()<=0&&l.remove(k),S.add(b),u.add(S),h._K(r+v,i+p,b)):h._K(r+v,i+p,A),l._K(t+0,e+0,A))},E.prototype._Ct=function(n,t,e,r,i,o,a){var u,c,u=this,c=u.Mf;n&&c&&u.kCt(t,e,r,i,o,a,n.RB)},E.prototype.toJSON=function(){for(var n,t,e,n=this.QMt,t=[],e=0;n&&e<n.length;e++)t.push(n[e].toJSON());return 0===t.length?C:t},E.prototype.wh=function(){for(var n,t,e,r,i,n=this.QMt,t={n_:"sparklineGroups",c_:[],r_:[2]},e=0;n&&e<n.length;e++)i=(r=n[e]).wh(),t.c_.push(i);return t},E.prototype.fromJSON=function(n,t){var e,r,i;for(this.QMt.length=0,this.cE={},e=0;n&&e<n.length;e++)r=n[e],(i=new k).fromJSON(r,t),this.add(i)},E.prototype.yh=function(n,t){var e,r,i;for(this.QMt.length=0,this.cE={},e=0;n&&e<n.length;e++)r=n[e],(i=new k).yh(r,t),this.add(i)},z=E,(t=J=n.EmptyValueStyle||(n.EmptyValueStyle={}))[t.gaps=0]="gaps",t[t.zero=1]="zero",t[t.connect=2]="connect",(l=U=n.SparklineAxisMinMax||(n.SparklineAxisMinMax={}))[l.individual=0]="individual",l[l.group=1]="group",l[l.custom=2]="custom",t=c.Common.ft.j(255,149,179,215),l=c.Common.ft.j(255,36,64,98),d={axisColor:"black",firstMarkerColor:t,highMarkerColor:"Blue",lastMarkerColor:t,lowMarkerColor:"Blue",markersColor:l,negativeColor:"Brown",seriesColor:l,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},F.prototype.clone=function(){return new F(this.options)},F.prototype.toJSON=function(){var n,t,e,r,n,t=this.options,e={};for(r in t)d[r]!==t[r]&&(e[r]=t[r]);return f(e)?C:e},b=F,n.SparklineSetting=b,(t=Z=n.SparklineType||(n.SparklineType={}))[t.line=0]="line",t[t.column=1]="column",t[t.winloss=2]="winloss",(l=q=n.DataOrientation||(n.DataOrientation={}))[l.vertical=0]="vertical",l[l.horizontal=1]="horizontal",j.prototype.tCt=function(){var n=this,t;return t=n.RB?n.RB.Mf:t},j.prototype.ECt=function(){var n,t,n,n=this,t=n.tCt();t&&t.Ut.G8&&(n={group:n,innerList:n.XMt.concat()},t.Ut.aCt(10,n))},j.prototype.add=function(n){var t,e,t=this;n&&(t.ECt(),t.XMt.push(n),n.group(t),t.TCt(),(e=t.RB)&&e.fCt(n),t.onGroupChanged())},j.prototype.clear=function(){this.ECt();var t=this.RB;t&&this.XMt.forEach(function(n){t.cCt(n)}),this.XMt=[]},j.prototype.all=function(){return this.XMt},j.prototype.remove=function(n){var t,e,r,t=this,e=t.XMt;return t.ECt(),w(e,n),n.onSparklineChanged(),n.rCt=t.clone(),t.TCt(),(r=t.RB)&&r.cCt(n),t.onGroupChanged(),e},j.prototype.contains=function(n){return H(this.XMt,n)},j.prototype.onGroupChanged=function(){var n,t,e,n=this.XMt;if(n)for(t=0;t<n.length;t++)(e=n[t])&&e.onSparklineChanged()},j.prototype.clone=function(){var n,t,t,n=this,t=n.setting?n.setting.clone():A,t=new j(n.sparklineType,t);return t.displayDateAxis=n.displayDateAxis,t.qMt=n.qMt,t.nCt=n.nCt,t.jCt=n.jCt,t.eCt=n.eCt,t},j.prototype.dateAxisData=function(n){var t,e,r,r,r,i,r,i,r,o,a,t=this;if(O(t.qMt)||t.OCt(),0===arguments.length)return t.nCt;if((e=t.tCt())&&e.Ut.G8){if("string"==typeof n){if(r=e.getCustomName(n)||e.parent.getCustomName(n),O(r))return t.nCt;r=m.formulaToRanges(e,m.expressionToFormula(e,r.getExpression()),0,0,1===t.tCt().parent.options.referenceStyle),t.qMt=n,i=(r=P(r)).ranges,r=r.sheetName,n=i,t.jCt=r}r=i=void 0,i=t.nCt?{row:t.nCt.row,col:t.nCt.col,rowCount:t.nCt.rowCount,colCount:t.nCt.colCount}:A,r=n?{row:n.row,col:n.col,rowCount:n.rowCount,colCount:n.colCount}:A,e.Ut.aCt(8,o={group:t,rangeInfo:i,newRangeInfo:r})}(a=t.nCt)!==(t.nCt=n)&&t.onGroupChanged()},j.prototype.OCt=function(){var n,t,t,e,t,n=this;O(n.tCt())||(t=hn(n.tCt(),n.qMt),O(t))||(e=(t=P(t)).ranges,t=t.sheetName,n.nCt=e,n.jCt=t)},j.prototype.dateAxisDataSheetName=function(n){var t,e,r,i,t=this;return 0===arguments.length?t.jCt:(e=t.jCt,(r=t.tCt())&&r.Ut.G8&&r.Ut.aCt(16,i={group:t,dateAxisDataSheetName:e,newDateAxisDataSheetName:n}),e!==n&&(e&&r&&r.RB.ICt(t),(t.jCt=n)&&r&&r.RB.ACt(t),t.onGroupChanged()),t)},j.prototype.dateAxisOrientation=function(n){var t,e,r,i,t=this;if(0===arguments.length)return t.eCt;(e=t.tCt())&&e.Ut.G8&&(r={group:t,dateAxisOrientation:t.eCt,newDateAxisOrientation:n},e.Ut.aCt(9,r)),(i=t.eCt)!==(t.eCt=n)&&t.onGroupChanged()},j.prototype.count=function(){return this.XMt.length},j.prototype.TCt=function(){var n,t,e,r,i,o,a,u,u,c,u,n=this,t=n.setting,e=n.XMt;if(t&&((r=t.options).groupMaxValue=-h,r.groupMinValue=h,i=1===r.maxAxisType,o=1===r.minAxisType,i||o))for(a=0;a<e.length;a++)u=e[a],c=(u=n.RCt(u)).min,u=u.max,i&&r.groupMaxValue<u&&(r.groupMaxValue=u),o&&r.groupMinValue>c&&(r.groupMinValue=c)},j.prototype.RCt=function(n){var t,e,r,i,o,a,u,c,s,t=-h,e=h;if(O(n.data())&&n.data(n.gI),r=n.data())for(o=(i=n.Tp())&&i.parent.getSheetFromName(n.dataSheetName()),a=n.BCt(r,n.dataOrientation(),!1,o||i),u=0;u<a.length;u++)"number"==typeof(c=(c=a[u])===K?0:c)&&(t=t<c?c:t,e=c<e?c:e);return{min:e,max:t}},j.prototype.toJSON=function(){var n,t,e,r,i,o,a,n=this,t={setting:n.setting?n.setting.toJSON():A,displayDateAxis:n.displayDateAxis,sparklineType:n.sparklineType,axisOrientation:n.eCt,sparklines:n.XMt.map(function(n){return n.toJSON()})},e=n.nCt,r=n.qMt;for(o in r?t.axisReference=r:e&&(t.axisReference={row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount,sheetName:n.jCt}),i={},t)!t.hasOwnProperty(o)||ln(o,a=t[o])||(i[o]=a);return f(i)?C:i},j.prototype.wh=function(){var n,t,e,r,r,e,n={n_:"sparklineGroup"},t=this,e=t.tCt();return O(t.sparklineType)||(n.type=v[t.sparklineType]),t.displayDateAxis&&(n.dateAxis="1"),r=t.setting.options,!O(r.lineWeight)&&.001<3*r.lineWeight.toString()/4-.75&&(n.lineWeight=3*r.lineWeight.toString()/4),r.displayEmptyCellsAs?n.displayEmptyCellsAs=p[r.displayEmptyCellsAs]:n.displayEmptyCellsAs=p[0],r.showMarkers&&(n.markers="1"),r.showHigh&&(n.high="1"),r.showLow&&(n.low="1"),r.showFirst&&(n.first="1"),r.showLast&&(n.last="1"),r.showNegative&&(n.negative="1"),r.displayXAxis&&(n.displayXAxis="1"),r.displayHidden&&(n.displayHidden="1"),r.rightToLeft&&(n.rightToLeft="1"),r.minAxisType&&(n.minAxisType=g[r.minAxisType]),r.maxAxisType&&(n.maxAxisType=g[r.maxAxisType]),r.manualMin&&(n.manualMin=r.manualMin),r.manualMax&&(n.manualMax=r.manualMax),n.c_=[o(r.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),o(r.negativeColor||"brown",!1,"colorNegative"),o(r.axisColor||"black",!1,"colorAxis"),o(r.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),o(r.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),o(r.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),o(r.highMarkerColor||"blue",!1,"colorHigh"),o(r.lowMarkerColor||"blue",!1,"colorLow")],(r=t.nCt)&&n.c_.push({n_:"f",c_:[(t.jCt?y.IndexHelper.ir(t.jCt):e.name())+"!"+s([_(r.row,r.col,r.rowCount,r.colCount)])]}),e={n_:"sparklines",c_:t.XMt.map(function(n){return n.wh()})},n.c_.push(e),n},j.prototype.fromJSON=function(n,t){var e,r,i,o,a,u,c,s,f;if(n&&(r=n.displayDateAxis,i=n.sparklineType,o=n.axisReference,a=n.axisOrientation,u=n.sparklines,(e=this).setting=new b(n.setting),O(r)||(e.displayDateAxis=r),O(i)||(e.sparklineType=i),O(o)||("string"==typeof o?e.qMt=o:(e.nCt=_(o.row,o.col,o.rowCount,o.colCount),e.jCt=o.sheetName)),O(a)||(e.eCt=a),u))for(e.XMt=[],c=0,s=u.length;c<s;c++)(f=new N).fromJSON(u[c]),e.add(f)},j.prototype.yh=function(n,e){var r,t,t,i,t,i,t,i,t,i,r=this,t=r.LCt(n);r.setting=new b(t),t="1"===n.dateAxis,i=v[n.type]||0,O(t)||(r.displayDateAxis=t),O(i)||(r.sparklineType=i),(t=a(n,"f"))&&(t=(i=t.c_&&t.c_[0])&&i.split("!"))&&(i=u(t[1])[0]||A,O(i)||(r.nCt=_(i.row,i.col,i.rowCount,i.colCount)),t=1===i.rowCount?1:0,O(t)||(r.eCt=t)),(i=a(n,"sparklines"))&&(r.XMt=[],i.c_.forEach(function(n){var t=new N;t.yh(n,e),r.add(t)}))},j.prototype.LCt=function(n){var t={};return O(n.manualMax)||(t.manualMax=e(n.manualMax,0)),O(n.manualMin)||(t.manualMin=e(n.manualMin,0)),O(n.lineWeight)||(t.lineWeight=4*e(n.lineWeight,1)/3),O(n.displayEmptyCellsAs)||(t.displayEmptyCellsAs=p[n.displayEmptyCellsAs]||0),O(n.markers)||(t.showMarkers=r(n.markers,!1)),O(n.high)||(t.showHigh=r(n.high,!1)),O(n.low)||(t.showLow=r(n.low,!1)),O(n.first)||(t.showFirst=r(n.first,!1)),O(n.last)||(t.showLast=r(n.last,!1)),O(n.negative)||(t.showNegative=r(n.negative,!1)),O(n.displayXAxis)||(t.displayXAxis=r(n.displayXAxis,!1)),O(n.displayHidden)||(t.displayHidden=r(n.displayHidden,!1)),O(n.rightToLeft)||(t.rightToLeft=r(n.rightToLeft,!1)),O(n.minAxisType)||(t.minAxisType=g[n.minAxisType]||0),O(n.maxAxisType)||(t.maxAxisType=g[n.maxAxisType]||0),n.c_.forEach(function(n){"colorSeries"===n.n_&&(t.seriesColor=i(n)||"rgba(36,64,98,255)"),"colorNegative"===n.n_&&(t.negativeColor=i(n)||"Brown"),"colorAxis"===n.n_&&(t.axisColor=i(n)||"Black"),"colorMarkers"===n.n_&&(t.markersColor=i(n)||"rgba(36,64,98,255)"),"colorFirst"===n.n_&&(t.firstMarkerColor=i(n)||"rgba(149,179,215,255)"),"colorLast"===n.n_&&(t.lastMarkerColor=i(n)||"rgba(149,179,215,255)"),"colorHigh"===n.n_&&(t.highMarkerColor=i(n)||"Blue"),"colorLow"===n.n_&&(t.lowMarkerColor=i(n)||"Blue")}),t},k=j,M.prototype.group=function(n){var t,e,e,r,i,t=this;return 0===arguments.length?((e=t.rCt)||((e=new k).add(t),t.rCt=e),e):(e=t.rCt,(r=t.Tp())&&r.Ut.G8&&(i={row:t.row,col:t.column,group:e,newGroup:n},r.Ut.aCt(11,i)),n!==e&&(e&&e.remove(t),(t.rCt=n)&&!n.contains(t)&&n.add(t),t.onSparklineChanged()),r&&r.zw(),t)},M.prototype.sparklineType=function(n){var t,e,r,e,r,t=this;return 0===arguments.length?t.group().sparklineType:((r=(e=t.group()).sparklineType)!==n&&(e.sparklineType=n,(e=t.Tp())&&e.Ut.G8&&(r={row:t.row,col:t.column,sparklineType:r,newSparklineType:n},e.Ut.aCt(3,r)),t.onSparklineChanged(),e)&&e.zw(),t)},M.prototype.onSparklineChanged=function(){var n,t,n=this,t=n.Tp();t&&t.ki(y.Events.SparklineChanged,{sheet:t,sheetName:t.name(),sparkline:n})},M.prototype.setting=function(n){var t,e,r,i,o,i,t=this,e=t.group(),r=t.Tp(),i=r&&r.Ut.G8;return 0===arguments.length?(o=void 0,i?y.GC$.extend(!0,{},e.setting):e.setting):(i&&(i={row:t.row,col:t.column,setting:y.GC$.extend(!0,{},e.setting),newSetting:y.GC$.extend(!0,{},n)},r.Ut.aCt(4,i)),e.setting=n,r&&r.zw(),t)},M.prototype.data=function(n){var t,e,r,i,r,i,r,i,t=this;if(O(t.gI)||t.FCt(),e=t.Tp(),0===arguments.length)return O(t.gI)?t._data:O(e)||(r=e.getCustomName(t.gI)||e.parent.getCustomName(t.gI),O(r))?[]:((i=m.formulaToRanges(e,m.expressionToFormula(e,r.getExpression()),t.row,t.column,1===e.parent.options.referenceStyle))[0]&&t._data!==i[0].ranges&&(t._data=i[0].ranges,t.onSparklineChanged()),t._data);if("string"==typeof n){if(t.gI=n,!e)return t;if(r=e.getCustomName(n)||e.parent.getCustomName(n),i=void 0,O(r))return t;i=(r=P(i=m.formulaToRanges(e,m.expressionToFormula(e,r.getExpression()),t.row,t.column,1===e.parent.options.referenceStyle))).ranges,r=r.sheetName,n=i,t.ZY=r}return e&&e.Ut.G8&&(i={row:t.row,col:t.column,sparkline:t,data:y.GC$.extend(!0,{},t._data),newData:y.GC$.extend(!0,{},n)},e.Ut.aCt(5,i)),t._data!==n&&(t._data=n,t.onSparklineChanged()),e&&e.zw(),t},M.prototype.dataSheetName=function(n){var t,e,r,i,t,e=this;return 0===arguments.length?e.ZY:(r=e.ZY,(i=e.Tp())&&(null==(t=i.name)?void 0:t.call(i))===n||(i&&i.Ut.G8&&(t={row:e.row,col:e.column,dataSheetName:r,newDataSheetName:n},i.Ut.aCt(15,t)),r!==n&&(r&&i&&i.RB.cCt(e),(e.ZY=n)&&i&&i.RB.fCt(e),e.onSparklineChanged())),e)},M.prototype.dataOrientation=function(n){var t,e,r,t=this;return 0===arguments.length?t.iCt:((e=t.Tp())&&e.Ut.G8&&(r={row:t.row,col:t.column,dataOrientation:t.iCt,newDataOrientation:n},e.Ut.aCt(6,r)),t.iCt!==n&&(t.iCt=n,t.onSparklineChanged()),e&&e.zw(),t)},M.prototype.dateAxisData=function(n){var t=this,e=t.group();return 0===arguments.length?(O(e.dateAxisData())&&e.dateAxisData(e.qMt),e.dateAxisData()):(e.dateAxisData(n),t)},M.prototype.dateAxisDataSheetName=function(n){var t=this,e=t.group();return 0===arguments.length?e.dateAxisDataSheetName():(e.dateAxisDataSheetName(n),t)},M.prototype.dateAxisOrientation=function(n){var t=this,e=t.group();return 0===arguments.length?e.dateAxisOrientation():(e.dateAxisOrientation(n),t)},M.prototype.displayDateAxis=function(n){var t,e,r,i,t=this,e=t.group();return 0===arguments.length?e.displayDateAxis:((r=t.Tp())&&r.Ut.G8&&(i={row:t.row,col:t.column,displayDateAxis:e.displayDateAxis,newDisplayDateAxis:n},r.Ut.aCt(7,i)),e.displayDateAxis=n,t)},M.prototype.clone=function(){var n,t,n=this,t=new M;return t.row=n.row,t.column=n.column,O(n.gI)?t.data(n.data()):t.gI=n.gI,t.dataSheetName(n.dataSheetName()),t.dataOrientation(n.dataOrientation()),t.group(n.group().clone()),t},M.prototype.paintSparkline=function(n,t,e,r,i){var o,a,u,c,s,f,s,o=this,a=o.Tp();this.XY&&(a=this.XY),O(o.data())&&o.data(o.gI),O(o.dateAxisData())&&o.dateAxisData(o.group().qMt),s=o.PCt(!0),f=o.PCt(!1),s={sparklineType:o.sparklineType(),displayDateAxis:o.displayDateAxis(),zoomFactor:a.zoom(),values:s,dateValues:f,settings:o.setting(),getColor:function(n){if(a&&n){var t=y.Pf.vl(a,n);if(t)return t}return n}},(new G).paint(n,s,t,e,r,i)},M.prototype.PCt=function(n){var t,e,r,i,o,a,u,c,s,f,l,h,t=this,e=[],r=n?t.dataSheetName():t.dateAxisDataSheetName(),i=n?t.WY:t.KY,o=n?t.dataOrientation():t.dateAxisOrientation(),a=n?t.data():t.dateAxisData(),c=t.Tp();if(this.XY&&(c=this.XY),i)e=i;else if("string"==typeof r)s=t.GCt(c,r),e=t.BCt(a,o,!n,s||c);else if("object"==typeof r)for(f=r,l=0;l<f.length;l++)s=t.GCt(c,f[l]),h=t.BCt(a[l],o,!n,s||c),e=e.concat(h);else O(r)&&(e=t.BCt(a,o,!n,c));return e},M.prototype.GCt=function(n,t){var e,n,r=/^\[\d+\].+/g,e=n.parent.getSheetFromName(t),n=n.parent._p;return e=r.test(t)&&n?n.parseSource(t,!0):e},M.prototype.QY=function(n){var t=this;return O(t.data())&&t.data(t.gI),t.BCt(t.data(),t.dataOrientation(),!1,n)},M.prototype.JY=function(n){var t=this;return O(t.dateAxisData())&&t.dateAxisData(t.group().qMt),t.BCt(t.dateAxisData(),t.dateAxisOrientation(),!0,n)},M.prototype.BCt=function(n,t,e,r){var i,o=this.setting().options.displayHidden;return M.EMt(C,r,o,n,t,e)},M.prototype.Tp=function(){var n=this.group(),n=n&&n.RB;return n?n.Mf:A},M.prototype.toJSON=function(){var n,t,n=this,t=O(n.gI)?{row:n._data.row,rowCount:n._data.rowCount,col:n._data.col,colCount:n._data.colCount,sheetName:n.ZY}:n.gI;return{row:n.row,col:n.column,orientation:n.iCt,data:t}},M.prototype.wh=function(){var n,t,e,t,r,n=this,t=n.Tp(),e=n._data,t=O(n.gI)?(r=y.IndexHelper.ir(n.ZY||t.name()))+"!"+s([_(e.row,e.col,e.rowCount,e.colCount)]):n.gI;return{n_:"sparkline",c_:[{n_:"f",c_:[W(t)]},{n_:"sqref",c_:[s([_(n.row,n.column,1,1)])]}],lossless:{iCt:n.iCt}}},M.prototype.fromJSON=function(n){var t,e,r,i,n,e;n&&(t=this,e=n.row,r=n.col,i=n.orientation,n=n.data,O(e)||(t.row=e),O(r)||(t.column=r),O(i)||(t.iCt=i),n)&&("string"==typeof n?t.gI=n:(t._data=_((e=n).row,e.col,e.rowCount,e.colCount),t.ZY=e.sheetName))},M.prototype.yh=function(n,t){var e,r,i,o,t,e=this,t=y.Util.ko(t)?void 0:1;n.c_.forEach(function(n){"f"===n.n_&&(1===(o=X(n.c_[0]).split("!")).length?e.gI=o[0]:r=u(o[1])[0]||A),"sqref"===n.n_&&(i=u(n.c_[0])[0]||A)}),O(i)||(O(i.row)||(e.row=i.row),O(i.col)||(e.column=i.col),r&&(t=1===r.rowCount?1:0,e._data=_(r.row,r.col,r.rowCount,r.colCount),e.ZY=o[0])),O(t)||(e.iCt=t),n.lossless&&(e.iCt=n.lossless.iCt)},M.prototype.FCt=function(){var n,t,t,e,t,n=this;O(n.Tp())||(t=hn(n.Tp(),n.gI),O(t))||(e=(t=P(t)).ranges,t=t.sheetName,n._data=e,n.ZY=t)},M.EMt=function(n,t,e,r,i,o){var a,u,a=[];if(!O(r)){if(!(r instanceof Array))return M.UCt(n,t,e,r,i,o);for(u=0;u<r.length;u++)a.push.apply(a,M.UCt(n,t,e,r[u],i,o,!0))}return a},M.UCt=function(n,t,e,r,i,o,a){var u,c,s,f,l,h,v,p,g,u=[],c=1===i;if(t&&r)for(s=0,f=a?c?r.rowCount:r.colCount:1;s<f;s++)for(l=0,h=c?r.colCount:r.rowCount;l<h;l++)v=c?s:l,p=c?l:s,g=n?n[v][p]:t.getValue(r.row+v,r.col+p),g=M.HCt(t,g,r,v,p,e,o),u.push(g);return u},M.HCt=function(n,t,e,r,i,o,a){var u="number";return t instanceof T.CalcError?C:(!o&&n.getRowHeight&&(n.getRowHeight(e.row+r)<=0||n.getColumnWidth(e.col+i)<=0)?t=NaN:O(t)||(a?t=typeof t==u?c.Common.ct.Y0(t):Date.parse(t):typeof t!=u&&(t=K)),t)},N=M,n.Sparkline=N},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine},CellTypes:function(n){n.exports=GC.Spread.Sheets.CellTypes}},r={},t=n={},Object.defineProperty(t,"__esModule",{value:!0}),t.Sparkline=t.DataOrientation=t.SparklineType=t.SparklineSetting=t.SparklineAxisMinMax=t.EmptyValueStyle=t.ImageSparkline=t.HistogramSparkline=t.SparklineExValue=t.SparklineEx=t.GaugeKPISparkline=t.RangeBlockSparkline=t.WinlossSparkline=t.ColumnSparkline=t.LineSparkline=t.YearSparkline=t.MonthSparkline=t.ParetoSparkline=t.CascadeSparkline=t.BoxPlotSparkline=t.VariSparkline=t.VBarSparkline=t.HBarSparkline=t.StackedSparkline=t.SpreadSparkline=t.BulletSparkline=t.ScatterSparkline=t.AreaSparkline=t.PieSparkline=t.jMt=void 0,i=a("./dist/plugins/sparkline/functions-sparkline.js"),Object.defineProperty(t,"jMt",{enumerable:!0,get:function(){return i.jMt}}),Object.defineProperty(t,"PieSparkline",{enumerable:!0,get:function(){return i.PieSparkline}}),Object.defineProperty(t,"AreaSparkline",{enumerable:!0,get:function(){return i.AreaSparkline}}),Object.defineProperty(t,"ScatterSparkline",{enumerable:!0,get:function(){return i.ScatterSparkline}}),Object.defineProperty(t,"BulletSparkline",{enumerable:!0,get:function(){return i.BulletSparkline}}),Object.defineProperty(t,"SpreadSparkline",{enumerable:!0,get:function(){return i.SpreadSparkline}}),Object.defineProperty(t,"StackedSparkline",{enumerable:!0,get:function(){return i.StackedSparkline}}),Object.defineProperty(t,"HBarSparkline",{enumerable:!0,get:function(){return i.HBarSparkline}}),Object.defineProperty(t,"VBarSparkline",{enumerable:!0,get:function(){return i.VBarSparkline}}),Object.defineProperty(t,"VariSparkline",{enumerable:!0,get:function(){return i.VariSparkline}}),Object.defineProperty(t,"BoxPlotSparkline",{enumerable:!0,get:function(){return i.BoxPlotSparkline}}),Object.defineProperty(t,"CascadeSparkline",{enumerable:!0,get:function(){return i.CascadeSparkline}}),Object.defineProperty(t,"ParetoSparkline",{enumerable:!0,get:function(){return i.ParetoSparkline}}),Object.defineProperty(t,"MonthSparkline",{enumerable:!0,get:function(){return i.MonthSparkline}}),Object.defineProperty(t,"YearSparkline",{enumerable:!0,get:function(){return i.YearSparkline}}),Object.defineProperty(t,"LineSparkline",{enumerable:!0,get:function(){return i.LineSparkline}}),Object.defineProperty(t,"ColumnSparkline",{enumerable:!0,get:function(){return i.ColumnSparkline}}),Object.defineProperty(t,"WinlossSparkline",{enumerable:!0,get:function(){return i.WinlossSparkline}}),Object.defineProperty(t,"RangeBlockSparkline",{enumerable:!0,get:function(){return i.RangeBlockSparkline}}),Object.defineProperty(t,"GaugeKPISparkline",{enumerable:!0,get:function(){return i.GaugeKPISparkline}}),Object.defineProperty(t,"SparklineEx",{enumerable:!0,get:function(){return i.SparklineEx}}),Object.defineProperty(t,"SparklineExValue",{enumerable:!0,get:function(){return i.SparklineExValue}}),Object.defineProperty(t,"HistogramSparkline",{enumerable:!0,get:function(){return i.HistogramSparkline}}),Object.defineProperty(t,"ImageSparkline",{enumerable:!0,get:function(){return i.ImageSparkline}}),o=a("./dist/plugins/sparkline/sparkline-wrapper.js"),Object.defineProperty(t,"EmptyValueStyle",{enumerable:!0,get:function(){return o.EmptyValueStyle}}),Object.defineProperty(t,"SparklineAxisMinMax",{enumerable:!0,get:function(){return o.SparklineAxisMinMax}}),Object.defineProperty(t,"SparklineSetting",{enumerable:!0,get:function(){return o.SparklineSetting}}),Object.defineProperty(t,"SparklineType",{enumerable:!0,get:function(){return o.SparklineType}}),Object.defineProperty(t,"DataOrientation",{enumerable:!0,get:function(){return o.DataOrientation}}),Object.defineProperty(t,"Sparkline",{enumerable:!0,get:function(){return o.Sparkline}}),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Sparklines=n}();