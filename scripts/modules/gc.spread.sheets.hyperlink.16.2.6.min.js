/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var e,i,n;function r(n){var t,t,t=i[n];return void 0!==t||(t=i[n]={exports:{}},e[n].call(t.exports,t,t.exports,r)),t.exports}e={"./dist/plugins/hyperlink/hyperlink.js":function(P,n,t){var e,k,c,f,o,i,m,u,t,r,x,l,h,E,p,F,s,a,b,T,d,w,v,$,I,R,V,W,q,B,D,J,K,Q,g,X,Y,y,C,z,_,H,j,Z,G,M,nn,tn,en,rn,on,un,ln,O,n,sn,an;function S(n,t){return sn.call(this,n,t)||this}function A(n,t){return an.call(this,n,t)||this}function U(n,t,e,i){return x(i)&&(i=3),!x(n.getHyperlink(t,e,i))}function cn(){var n=i(Y);return u(n).css(v,$).css(I,0).css(q,2).css(B,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(D,Q).css(K,X).css(R,"9pt Arial"),n}function fn(n,t,e){var i,r,o,i,r,o,e;e&&(r=(i=n&&n.qc()).getElementsByClassName(y)[0],o=!1,x(r)&&((r=cn()).className=y,i.insertBefore(r,s),o=!0),i=u(r),!o&&i.isVisible()||(i.text(e),o=(r=n.rt.it()).left+t.x,e=r.top+t.y+20,i.css(W,e).css(V,o),i.show()))}function L(n){var t,n,t,n=(n&&n.qc()).getElementsByClassName(y)[0];x(n)||u(n).hide()}function hn(n,t){x(t)||(t.drawUnderline&&(x(n.textDecoration)?n.textDecoration=1:0!==n.textDecoration&&1!=(1&n.textDecoration)&&(n.textDecoration+=1)),t.isVisited?t.visitedLinkColor===s?n.foreColor="rgba(0,0,0,0)":t.visitedLinkColor===p?n.foreColor=z:n.foreColor=t.visitedLinkColor:x(t.linkColor)?t.linkColor===p&&n.foreColor||(n.foreColor=C):n.foreColor=t.linkColor)}function N(n){if(n&&n.cellType){var n=n.cellType.typeName;if(!ln[n])return 1}}function pn(n,t,e,i,r,o,u){var l,s,a,n,u,l=0,s=0,a=n.width,n=n.height,u=dn(u);return u&&(a-=u),l=o=o||0,1===i?l=(a-t)/2:2===i&&(l=a-t-o),1===r?s=(n-e)/2:2===r&&(s=n-e),u&&(l+=u),{x:l,y:s}}function dn(n){var t={context:n,value:0};return r.et(n.sheet,"getOutlineColumnOffset",t),t.value}function wn(n,t){var e,i,r,e=o(t),i,r;return{x:0,y:0,width:a(0,k.q.Wt(n,t,!0)),height:n.split(/\r\n|\r|\n/).length*e}}function vn(n,t,e,i,r,o,u){var n,i,n=wn(n,i),i=pn(r,n.width,n.height,t,e,o,u);return n.x=i.x,n.y=i.y,n}function gn(n,t,e,i,r,o){var u,l,u,s,a,c,f,l,h,p,u,d,w,v,g,y,C,l=r.sheet,u=l.Dn;if(!x(e)){if(e.textOrientation)return!0;if(s=l.getValue(r.row,r.col,r.sheetArea),o=o||l.getText(r.row,r.col,r.sheetArea))for(o=o.replace(/\s+/g," "),a=e&&e.font?e.font:u.Nn(),a=u._n(a),c=[o],f=yn(e),l=null!=(u=l.outlineColumn.xme)?u:0,e.wordWrap&&(o=(c=k.q.un(o,i.width-3-f-l,a)).join("\r\n")),h=e.hAlign,p=e.vAlign,u=vn(o,h=3===h?m(h,s,e.formatter||e._autoFormatter):h,p,a,i,f,r),d=i.y+u.y,w=0;w<c.length;w++)if(v=vn(c[w],h,p,a,i,f,r),g=i.x+v.x,y=b(g+v.width,i.x+i.width),d=b((C=d)+v.height,i.y+i.height),g<=n&&n<y&&C<=t&&t<d)return!0}return!1}function yn(n){return 8*(n.textIndent||0)}e=this&&this.__extends||(O=function(n,t){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}O(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HyperlinkTargetType=void 0,k=t("Core"),c=t("Common"),f=t("SheetsCalc"),o=k.mt.vt,i=k.mt.En,m=k.mt.gt,u=k.GC$,t=k.Commands.ActionBase,r=k.CellTypes.Base,x=c.Common.lt.ht,l=c.Common.lt.tv,h=c.Common.zf.TY,E=c.Common.ft,p=void 0,F=16,s=null,a=Math.max,b=Math.min,T=Math.floor,d=window.open,w=c.Common.zf.fJ,v="position",$="absolute",I="margin",R="font",V="left",W="top",q="padding",B="border",D="box-sizing",J="pointer",K="background-color",Q="content-box",g="default",X="white",Y="div",y="gc-spread-hyperlink-tooltip",z="followedHyperlink",_=C="hyperlink",H="openUrl",j="generateHyperlink",Z=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,G=/^(mailto:\/\/)?([a-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([a-z0-9\-])+\.([a-z0-9\-]){2,63}(\?subject=.+)?$/gi,M=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|www\.[a-z0-9][a-z0-9-]+[a-z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-z0-9]+\.[^\s]{2,}|www\.[a-z0-9]+\.[^\s]{2,})/gi,(n=nn=n.HyperlinkTargetType||(n.HyperlinkTargetType={}))[n.blank=0]="blank",n[n.self=1]="self",n[n.parent=2]="parent",n[n.top=3]="top",k.GC$.extend(k.Y8.prototype,{getHyperlink:function(n,t,e){var i,e;return x(e)&&(e=3),(e=(i=this).W_(e).J_(n,t))&&!x(e.hyperlink)?e.hyperlink:s},setHyperlink:function(n,t,e,i){var r,o,u,l,l,s,o,a,r=this;if(x(i)&&(i=3),(o=e&&e.url)&&o.match(M)&&0<o.match(M).length?w(o,u="www.")&&(e.url="http://"+o):o&&o.match(G)&&0<o.match(G).length&&(w(o,l="mailto:")||(e.url=l+o)),l=0<r.P8?[["sheetModels",i],p]:p,s=r.W_(i).J_(n,t,!0,l?l[0]:p),x(s))l&&(l.length=0);else{if(o=s.hyperlink,x(e))s.hyperlink=null,delete s.hyperlink;else for(a in s.hyperlink={url:"",linkColor:p,visitedLinkColor:p,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)e[a]!==p&&(s.hyperlink[a]=e[a]);l&&(l[0].push("hyperlink"),l[1]=o,l[2]=s.hyperlink)}l&&0<l.length&&r.G8.push(l)}}),k.GC$.extend(k.Worksheet.prototype,{getHyperlink:function(n,t,e){var i,r;return 0===e?s:(x(e)&&(e=3),r=(i=this).Ut,l(r.getHyperlink(n,t,e)))},setHyperlink:function(n,t,e,i){var r,o,u,l;0===i||(x(i)&&(i=3),u=(o=(r=this).Ut).getRowCount(i),l=o.getColumnCount(i),n<0)||u<=n||t<0||l<=t||(o.do("setHyperlink",n,t,e,i),this.zw())}}),e(S,sn=t),S.prototype.execute=function(){var n,t,e,i,r,o,n,u,u,u,l,u,l,s,s,s,s,a,r,n=this,t=n.Mf,e=!1,i=t.parent,r=t,o=n.tT.url;if(!x(o))if(n=n.tT.target||0,0===o.indexOf(u="sjs://")||"#"===o[0]){if(u=u.length,u="#"===o[0]?o.substr(1):o.substr(u),(l=(l=(0,f.formulaToRanges)(t,u,0,0,!(l=void 0)))&&0===l.length?(0,f.formulaToRanges)(t,u,0,0,!1,!0):l)&&0<l.length){if(u=l[0].sheetName,l=l[0].ranges[0],u!==t.name()&&i.getSheetFromName(u).visible()===k.SheetTabVisible.visible){if(s=i.getSheetFromName(u),i.ki(k.Events.ActiveSheetChanging,s={oldSheet:r,newSheet:s,cancel:!1}),s.cancel)return;i.setActiveSheet(u),s=i.getActiveSheetIndex(),i.w2.Tg(s),r!==(t=i.getActiveSheet())&&i.ki(k.Events.ActiveSheetChanged,{oldSheet:r,newSheet:t})}i.getSheetFromName(u).visible()===k.SheetTabVisible.visible&&(t.OA(l.row+l.rowCount,l.col+l.colCount),t.setSelection(l.row,l.col,l.rowCount,l.colCount))}}else x(o)||(s="mailto:",o.match(M)&&0<o.match(M).length?w(o,a="www.")&&(o="http://"+o):o.match(G)&&0<o.match(G).length&&(w(o,s)||(o=s+o)),w(o,s)&&1<c.Common.zf.DU(o,"?")&&(o=(r=o.split("?"))[0]+"?"+r.slice(1).join("%3F")),d(h(o),["_blank","_self","_parent","_top"][n]));return!1},tn=S,k.Commands[H]={canUndo:!1,execute:function(n,t,e){return k.Commands.zA(n,tn,t,e)}},e(A,an=t),A.prototype.execute=function(){var n,t,e,i,r,o,e,u,l,l,n=this,t=n.Mf,e=n.tT,i=e.url,r=e.row,o=e.col,e=e.sheetArea;if(null===i)u=null;else{if("string"!=typeof i)return!1;if(!((l=(!(l=i.match(M))||l.length<1)&&(!(l=i.match(G))||l.length<1)?i.match(Z):l)&&0<l.length&&0===i.indexOf(l[0])&&i.length===l[0].length))return!1;u={url:i,linkColor:C,visitedLinkColor:z}}return t.Ut.startTransaction(),t.suspendPaint(),t.suspendEvent(),t.setHyperlink(r,o,u,e),t.resumeEvent(),t.resumePaint(),l=k.Commands.TI(t.name()),n.tT[l]=t.Ut.endTransaction(),!0},A.prototype.undo=function(){var n,t,e,n,t=this.Mf;return t.suspendPaint(),t.suspendEvent(),e=k.Commands.TI(t.name()),t.Ut.undo(this.tT[e]),t.resumeEvent(),t.resumePaint(),!0},en=A,k.Commands[j]={canUndo:!0,execute:function(n,t,e){return k.Commands.zA(n,en,t,e)}},k.Workbook.ch(_,rn={init:function(){this.commandManager().register(H,k.Commands[H]),this.commandManager().register(j,k.Commands[j])}}),k.Worksheet.ch(_,on={setHyperlinkWhenEditing:function(n){var t,e,i,n,r,o,t=n.url,e=n.row,i=n.col,n=n.sheetArea,r=this,o=r.getParent();o.options.allowAutoCreateHyperlink&&o.commandManager().execute({cmd:j,sheetName:r.name(),url:t,row:e,col:i,sheetArea:n})}}),r.ch(_,un={applyHyperlinkStyle:function(n){var t,e,i,r,t,t=n.sheet,e=n.row,i=n.col,r=n.style,t=t.getHyperlink(e,i,n.sheetArea);N(r)||hn(r,t)},getCellTextHitInfo:function(n){var t,e,i,r,o,u,l,s,a,c,f,c,t=n.context.sheetArea,e=n.cellStyle,i=n.context,r=i.sheet,o=i.row,u=i.col;U(r,o,u,t)&&!N(e)&&((l=n.cellRect)&&(s=r.C0(o),a=r.S0(u),c=r.Fi(),f=void 0,r.getSpan(o,u,t)||!x(t)&&3!==t?2===t?f=c.B1(s):1===t&&(f=c.L1(a)):f=c.c9(s,a),f)&&(l=l.getIntersectRect(f)),!x(t)||3===t)&&e&&l&&(c=r.getText(o,u,t),n.paddingHitInfo={row:o,col:u,x:n.x,y:n.y,sheetArea:t,sheet:r,isFocusAware:!0,isReservedLocation:gn(n.x,n.y,e,l,i,c)})},processMouseUpOnCellPadding:function(n){var t,e,i,r,o,e,n,e,n,e,t=n.sheet,e=n.cellStyle,i=n.row,r=n.col,o=n.sheetArea;t&&!t.isEditing()&&U(t,i,r,o)&&!N(e)&&n.isReservedLocation&&(e=t.Dg(),L(t),e&&(e.style.cursor=g),(n=t.Ut.getHyperlink(i,r,o)).isVisited=!0,e=n.command,x(e)||""===e||e===H?t.getParent().commandManager().execute({cmd:H,sheetName:t.name(),url:n.url,target:n.target}):"string"==typeof e?t.getParent().commandManager().execute({cmd:e,row:i,col:r,sheetName:t.name(),sheetArea:o}):"function"==typeof e&&e.call(s,t,i,r,o),n=t.getColumnCount(),e=new k.Range(i,-1,1,n),t.repaint(t.getRangeRect(1,1,e)))},processMouseMoveOnCellPadding:function(n){var t,e,i,r,o,r,t,t=n.row,e=n.col,i=n.sheet,r=n.cellStyle,o=n.sheetArea;!U(i,t,e,o)||N(r)||!i||i.isEditing()&&i.getActiveRowIndex()===t&&i.getActiveColumnIndex()===e||(r=i.Dg(),t=i.getHyperlink(t,e,o),n.isReservedLocation?r&&(fn(i,n,t.tooltip),r.style.cursor=J):(L(i),r&&(r.style.cursor=g)))},processMouseLeaveOnCellPadding:function(n){var t,e,i,n,e,t=n.sheet,e=n.row,i=n.col,n=n.sheetArea;L(t),U(t,e,i,n)&&t&&(e=t.Dg())&&(e.style.cursor=g)},onUpdateContainer:function(n){var t,e,i,n,t=n.cellStyle,e=n.context.row,i=n.context.col,n=n.context.sheet.getHyperlink(e,i);N(t)||hn(t,n)}}),ln={0:!0,1:!0,2:!0,3:!0,4:!0}},Common:function(n){n.exports=GC.Spread},Core:function(n){n.exports=GC.Spread.Sheets},SheetsCalc:function(n){n.exports=GC.Spread.Sheets.CalcEngine}},i={},n=r("./dist/plugins/hyperlink/hyperlink.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).Hyperlink=n}();