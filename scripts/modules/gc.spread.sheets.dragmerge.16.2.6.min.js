/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var r,t,e,n;function i(e){var n,n,n=t[e];return void 0!==n||(n=t[e]={exports:{}},r[e].call(n.exports,n,n.exports,i)),n.exports}r={"./dist/plugins/dragMerge/dragMerge-action.js":function(e,n,r){var t,c,r,i,o,g,a,u,s;function f(e,n){return e.JS(n)}function d(e,n){return s.call(this,e,n)||this}t=this&&this.__extends||(u=function(e,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,n){e.__proto__=n}:function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}))(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}u(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Commands=void 0,c=r("Core"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return c.Commands}}),r=c.Commands.ActionBase,i=c.Commands.zA,o="dragMerge",g=Math.max,t(d,s=r),d.prototype.canExecute=function(){var e,n,r,n,n,e=this.Mf,n=this.tT,r=f(e,n.oldSelection),n=f(e,n.newSelection);if(r.equals(n)){if((n=e.getSpan(r.row,r.col))&&r.equals(n))return!1;if(1===r.rowCount&&1===r.colCount)return!1}return!0},d.prototype.canUndo=function(){var e,e,e=c.Commands.TI(this.Mf.name()),e=this.tT[e];return c.Commands.AI(e)},d.prototype.undo=function(){var e,n,r,e=this;if(!e.canUndo())return!1;n=e.Mf,e.X5(n,!0),r=c.Commands.TI(n.name()),n.Ut.undo(e.tT[r]),e.q5(n,!0)},d.prototype.execute=function(){var e,n,r,t,i,t,o,a,i,u,e=this,n=e.Mf,r=e.tT,t=r.oldSelection,i=r.newSelection;if(!e.canExecute())return!1;n.Ut.startTransaction(),e.X5(n,!0),n.Ut.do("clearSpan",t.row,t.col,t.rowCount,t.colCount),t=i.row,o=i.col,a=i.rowCount,i=i.colCount,n.addSpan(t,o,a,i),n.setSelection(t,o,g(a,1),g(i,1)),e.q5(n,!0),r[u=c.Commands.TI(n.name())]=n.Ut.endTransaction()},a=d,c.Commands[o]={canUndo:!0,execute:function(e,n,r){return i(e,a,n,r)}},c.Commands.Ttt=function(e){e.register(o,c.Commands[o])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(e,n,r){var t,n,f,u,d,_;function c(e,n){e.ki(t.Events.DragMerging,n)}function g(e,n){e.ki(t.Events.DragMerged,n)}Object.defineProperty(n,"__esModule",{value:!0}),n=(t=r("Core")).GC$,f=null,u=void 0,d=Math.abs,_=t.Ec,n.extend(t.nk.prototype,{Att:function(e){var n,r,t,i,n,r,t=e,i=this.Mf.Ut.findSpan(e.row,e.col);return t=i&&i.containsRange(e)?i:t},zL:function(e,n,r){var t,i,o,a,u,c,g,s,i,o,t,a,i,t=this.Mf,i=t.parent,o=t.U5(),a=t.Dn,u=4,c=8,g=2,s=4;if(i&&i.options.allowUserDragMerge&&o&&!t.Oi&&a.Itt){if(o=(i=a.Itt).x,t=i.y,a=i.width,i=i.height,d(o+a-n)<=2&&d(t+i/2-r)<=4)return{right:!0};if(d(o+a/2-n)<=4&&d(t+i-r)<=2)return{bottom:!0}}return f},pk:function(e){var n,e,r,t,t,i,o,a,u,n=this;n.ab=!0,n.rb=!0,n.Uk=!0,n.Rk={e9:e.rowViewportIndex,r9:e.colViewportIndex,Bk:e.hitTestType},n.xtt=e.dragMergeInfo,r=(e=n.Mf).Ut,t=e.U5(),n.Ntt=n.Att(t),i=(t=e.JS(n.Ntt)).row,o=t.col,a=t.rowCount,u=t.colCount,r.GT(i,o,a,u)?(n.rb=!1,n.Uk=!1):(n.ktt=e.Ut.getSpans(t),e.suspendPaint(),r.do("clearSpan",i,o,a,u),e.resumePaint(),n.Dtt=t,n._tt(),n.Ett(t),n.Ok())},Hk:function(){var e,n,r,r,t,i,n,i,n,r,t,e=this,n=e.Mf,r=n.parent;r&&!r.options.allowUserDragMerge?e.ND():(r=e.Q9(),t=e.K9(),i=e.Dtt||e.Ntt,n=n.JS(i),0<=r&&0<=t&&(i=e.xtt,n=e.jtt(n,r,t,i),r=(e.Ott=n).rowCount,t=n.colCount,0<r)&&0<t&&(e._tt(),e.Ett(n),e.Dtt=n,e.a9()))},_tt:function(){var e,n,n,e=this.Mf,n=this.Dtt;n&&((n=e.j1(n)).x-=2,n.y-=2,n.width+=4,n.height+=4,e.Dn.O1(n))},jtt:function(e,n,r,t){var i,o,a,u,c,e,g,s,f,d,v,l,h,M,i,o=this.Mf,a=e.row,u=e.col,c=e.rowCount,e=e.colCount;return t.right?(d=r-(s=u)+1,v=g=a,l=u+e,h=f=c,M=r-u-e+1):t.bottom&&(f=n-(g=a)+1,v=a+c,l=s=u,h=n-a-c+1,M=d=e),o.Ut.eE(v,l,h,M)&&(g=a,s=u,f=c,d=e),_(g,s,f,d)},ND:function(){var e,n,r,t,i,o,a,e,r,e=this,n=e.Mf,r=n.parent,t=e.ktt,i=e.Ntt,o=e.Ott||i;e.ab=!1,e.rb=!1,e.Uk=!1,e.Ott=u,e.ktt=u,e.Dtt=u,e.Ntt=u,e.l9(),r&&r.options.allowUserDragMerge&&(a=n.Ut,n.suspendPaint(),0<t.length&&t.forEach(function(e){a.do("addSpan",e)}),n.resumePaint(),e={sheetName:n.name(),sheet:n,mergeRange:o,cancel:!1},c(n,e),e.cancel||(r={cmd:"dragMerge",sheetName:n.name(),oldSelection:i,newSelection:o},n.Qy().execute(r),g(n,{sheetName:n.name(),sheet:n,mergeRange:o})))},Ett:function(e){var n,r,t=this.Mf.Dn,i;(0,t.Rtt)(t,e)}})},"./dist/plugins/dragMerge/dragMerge.js":function(e,n,r){var C,n,t,s,r,i,o,a;function f(e){var e=e.parent;return e&&e.options.backColor||i}function u(e,n,r){var t,t,r,e,n,t=e.C0(r.row);if((1===t||t!==e.C0(r.row+r.rowCount-1))&&0<(t=e.dw(1)).length)return r=n.y+n.height/2,e=t[0],n=t[t.length-1],e.y<=r&&r<=e.y+e.height||n.y<=r&&r<=n.y+n.height?1:void 0}function c(e,n,r){var t,t,r,e,n,t=e.S0(r.col);if((1===t||t!==e.S0(r.col+r.colCount-1))&&0<(t=e.yw(1)).length)return r=n.x+n.width/2,e=t[0],n=t[t.length-1],e.x<=r&&r<=e.x+e.width||n.x<=r&&r<=n.x+n.width?1:void 0}function j(e,n,r){var n,t,i,o,a,e,t=e.Fi(),i=e.Gy(t),o=e.Sy(t),a=u(e,n,r),e=c(e,n,r),n=1===a&&1===e?t.c9(a,e):1===a?new C.Rect(t.b6,t.Cy,t.F6+i+t.zy,o):1===e?new C.Rect(t.Py,t.T6,i,t.L6+o+t.Iy):new C.Rect(t.b6,t.T6,t.F6+i+t.zy,t.L6+o+t.Iy);return n}Object.defineProperty(n,"__esModule",{value:!0}),C=r("Core"),n=r("Common"),t=r("./dist/plugins/dragMerge/dragMerge-action.js"),s=n.Common.ft,r=C.GC$,i="white",r.extend(C.g7.prototype,{Btt:function(e,n){var r,t,i,i,o,a,u,c,g,s,f,d,v,l,h,M,_,p,t,g,r=this,t=r.Mf,i=t.rt;(0,C.needPaintSelection)(t)&&(g=(i=t.j1(i.Att(n))).x,s=i.y,f=i.width,d=i.height,p=j(t,_=new C.Rect(v=g+f-(u=2),l=s+d/2-(c=o=4),h=4,M=a=8),n),g=j(t,t=new C.Rect(v=g+f/2-4,l=s+d-2,h=8,M=4),n),r.Itt=i,r.Ltt(e,_,t,p,g))},Ltt:function(e,n,r,t,i){var o,a=this.Mf,a=C.Pf.vl(a,a.getSelectionBorderColor());e.save(),e.fillStyle=a,t&&(e.rect(t.x,t.y,t.width,t.height),e.clip()),e.beginPath(),e.rect(n.x,n.y,n.width,n.height),e.fill(),e.restore(),e.save(),e.fillStyle=a,i&&(e.rect(i.x,i.y,i.width,i.height),e.clip()),e.beginPath(),e.rect(r.x,r.y,r.width,r.height),e.fill(),e.restore()},Rtt:function(e,n){var r,t,i,o,e,a,u,o,c,o,c,o,c,o,c,i,t,g,c,r=e,t=r.Mf,i=t.parent,o=t.rt,e=e.J(),a=2,u=1;i&&i.options.allowUserDragMerge&&o.Uk&&(o=t.getActiveRowIndex(),c=t.getActiveColumnIndex(),c=(o=t.getActualStyle(o,c))&&o.backColor,o=f(t),(c=s._(C.Pf.vl(t,c||o))).a*=.6/255,e.fillStyle=s.j(c),e.strokeStyle=C.Pf.vl(t,t.getSelectionBorderColor()),e.lineWidth=2,e.beginPath(),o=i.SC,i=(c=t.j1(n)).x,t=c.y,g=c.width,c=c.height,2007<o?(e.rect(i,t,g-1,c-1),e.strokeRect(i-1,t-1,g+1,c+1)):(e.rect(i+1,t+1,g-2-.5,c-2-.5),e.strokeRect(i-.5,t-.5,g,c)),e.fill(),e.restore(),r.Btt(e,n))}}),C.Workbook.ch("dragMerge",o={init:function(){t.Commands.Ttt(this.commandManager())}}),C.Worksheet.ch("dragMerge",a={paintAdornment:function(e){var e,n,r,t,t,e=e.ctx,n=this,r=n.Dn,t=n.Ut.getSelections();n.parent&&n.parent.options.allowUserDragMerge&&1===t.length&&!n.Oi&&(t=n.U5(),r.Btt(e,t))}})},Common:function(e){e.exports=GC.Spread},Core:function(e){e.exports=GC.Spread.Sheets}},t={},e={},Object.defineProperty(e,"__esModule",{value:!0}),i("./dist/plugins/dragMerge/dragMerge-action.js"),i("./dist/plugins/dragMerge/dragMerge.js"),i("./dist/plugins/dragMerge/dragMerge-event.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).DragMerge=e}();