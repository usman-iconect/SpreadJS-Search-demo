/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
var GC;!function(){"use strict";var i,r,n;function e(n){var t,t,t=r[n];return void 0!==t||(t=r[n]={exports:{}},i[n].call(t.exports,t,t.exports,e)),t.exports}i={"./dist/plugins/sheetsCalc/calc-extra-save.js":function(n,t,i){var u,s,e,r,a,c,h,l,v,d,w;function f(n){var t,i,r,e;if(Array.from)return Array.from(n.keys());for(t=[],i=0,r=n.keys();i<r.length;i++)e=r[i],t.push(e);return t}function o(f,o,s){for(var n,t,n=function(n){var t,n,e,i,r,t=o[n];if(t.l)for(n=m(t.k),e=f.oT(n[1],n[2],!0),t.v&&f.nbt(e),t.b,e.aT=t.l.map(function(n){return parseInt(n,10)}),i=function(n){var r=t.l[n];e[r]=(0,u.createMap)(),t[r].map(function(n){var t,i,i,t=m(n),i=t[0];"?"!==i[0]&&"!"!==i[0]||(i=i.slice(1)),i=s[i],e[r].set(n,i.oT(t[1],t[2],!0))})},r=0;r<t.l.length;r++)i(r)},t=0;t<o.length;t++)n(t)}function m(n){return n.split(",").map(function(n,t){return n=0<t?parseInt(n,10):n})}function C(n,t,i){var r,e,f,o,s,u,a,c,h,c,r=n.uT(!0);for(e in t.l)if(t.l.hasOwnProperty(e))for(o in f=t[e])if(f.hasOwnProperty(o))for(s=o.split(",").map(function(n,t){return"?"!==n[0]&&"!"!==n[0]||(n=n.slice(1)),parseInt(n,10)}),u=0;u<f[o].length;u++)c=(h=i[c="?"!==(c=(a=m(f[o][u]))[0])[0]&&"!"!==c[0]?c:c.slice(1)]).oT(a[1],a[2],!0),r.processListener(parseInt(e,10),s[0],s[1],s[2],s[3],c,!0)}function _(n){var t,i,t=null;return(n.isVolatile||n.ebt||n.aT&&0<n.aT.length)&&((t={}).k=n.getKey(),n.isVolatile&&(t.v=!0),n.ebt&&(t.b=!0),n.aT)&&n[0]&&(i="0",t[0]=f(n[0]),t.l=n.aT),t}function p(n){var t,i,r,e,f,o,r,n,t=[],i=n.dataTable;for(f in i)if(i.hasOwnProperty(f)&&(o=i[f]))for(e in o)o.hasOwnProperty(e)&&(r=o[e])&&(r=_(r.calc))&&t.push(r);return(n=g(n))&&t.push(n),t}function g(n){var n,t,i,r,e,n=n.uT();if(n)return t={k:"rangeCalc"},i="0",r=n[0],e={},r&&r.forEach(function(n,t){e[t]=f(n.content)}),t[0]=e,t.l=n.aT,t}function b(n,t){var i,r,e,f,o,s,i={};if(t&&t.idMap){for(f in e={},r=n.rO)r.hasOwnProperty(f)&&(e[r[f].getSource().getName()]=r[f]);for(f in o=t.idMap)o.hasOwnProperty(f)&&(s=o[f],i[f]=e[s])}return i}function x(n){var t,i,r,t=n.rO,i={};for(r in t)t.hasOwnProperty(r)&&(i[r]=t[r].getSource().getName());return i}function R(n,t){return y(n,t)}function y(n,t){var i,r,e,f,o,i,i,r=n.t;if(4===r||2===r||3===r||8===r||100===r)(e=new u.Expression(r)).value=n.v;else{if(5===r)(e=new u.Expression(5)).value=u.CalcError.ibt(n.v);else if(6===r)(e=new u.Expression(6)).value=new u.CalcArray(n.v);else if(9===r)e=(0,u.rbt)(n.o,y(n.v,t),n.w&&y(n.w,t));else if(10===r)(e=new u.Expression(10)).value=y(n.v,t);else if(11===r)e=new u.Expression(11);else if(7===r)for(e=new u.Expression(7),n.f&&(e.function=y(n,t)),n.n&&(e.function=t.getFunction(n.n),e.functionName=n.n),f=e.arguments=[],o=0;o<n.p.length;o++)n.p[o]&&(f[o]=y(n.p[o],t));else 1===r?(e=new u.ReferenceExpression(1),(i=n.v.split("*"))[0]&&(e.source=t.getExternalSource("",i[0])),i[1]&&(e.endSource=t.getExternalSource("",i[1])),i[2]&&(e.row=parseInt(i[2],10)),i[3]&&(e.column=parseInt(i[3],10)),i[4]&&(e.endRow=parseInt(i[4],10)),i[5]&&(e.endColumn=parseInt(i[5],10)),i=parseInt(i[6],10),e.rowRelative=!!(i&a),e.columnRelative=!!(i&c),e.endRowRelative=!!(i&h),e.endColumnRelative=!!(i&l),e.isFullRow=!!(i&v),e.isFullColumn=!!(i&d),e.isArrayReference=!!(i&w),e.isFullRow&&(e.column=e.endColumn=u.BAND_INDEX_CONST),e.isFullColumn&&(e.row=e.endRow=u.BAND_INDEX_CONST)):13===r?(e=new s.obt,i=n.v,e.abt=i[0],e.source=i[1],e.ubt=i[2],e.sbt=i[3],e.cbt=i[4],e.fbt=i[5],e.lbt=i[6],e.hbt=i[7],e.source=t.getExternalSource("",e.source),e.abt=t.getTableByName(e.abt)):e&&e.type;n.es&&(e.ensureSingle=!0)}return e}function j(n){return N(n)}function N(n){var t,i,r,r;if(!n)return n;if(t={t:n.type},n.ensureSingle&&(t.es=1),4===n.type||2===n.type||3===n.type||8===n.type||100===n.type)t.v=n.value;else if(5===n.type)t.v=n.value._code;else if(6===n.type)t.v=n.value.array;else if(9===n.type)t.o=n.operatorType,t.v=N(n.value),t.w=n.value2&&N(n.value2);else if(10===n.type)t.v=N(n.value);else if(7===n.type)for((0,u.isExpression)(n.function)?t.f=N(n.function):n.functionName&&(t.n=n.functionName),t.p=[],i=0;i<n.arguments.length;i++)t.p[i]=N(n.arguments[i]);else 1===n.type?(r=(n.rowRelative&&a)|(n.columnRelative&&c)|(n.endRowRelative&&h)|(n.endColumnRelative&&l)|(n.isFullRow&&v)|(n.isFullColumn&&d)|(n.isArrayReference&&w),r=[n.source&&n.source.getName(),n.endSource&&n.endSource.getName(),n.row,n.column,n.endRow,n.endColumn,r],n.isFullRow&&(r[3]=r[5]=e),n.isFullColumn&&(r[2]=r[4]=e),t.v=r.join("*")):13===n.type?t.v=[n.abt.name(),n.source.getName(),n.ubt,n.sbt,n.cbt,n.fbt,n.lbt,n.hbt]:n.type;return t}Object.defineProperty(t,"__esModule",{value:!0}),t.exprToJSON=t.exprFromJSON=t.dbt=t.vbt=t.mbt=t.gbt=t.pbt=void 0,u=i("CalcEngine"),s=i("./dist/plugins/sheetsCalc/parser-sheets.js"),e=null,r=void 0,a=1,c=2,h=4,l=8,v=16,d=32,w=64,t.pbt=o,t.gbt=C,t.mbt=p,t.vbt=b,t.dbt=x,t.exprFromJSON=R,t.exprToJSON=j},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(j,n,t){var i,Y,r,p,_,L,m,B,N,F,u,g,T,X,V,J,G,$,b,P,W,H,K,Q,k,x,I,A,O,E,t,t,e,S,s,a,c,M,D,Z,f,e,q,o,h,l,z;function nn(n,t){for(var i=t;i<n.length;i++)if("'"===n[i]||'"'===n[i])return i;return i}function tn(n,t){var i,r,e;if(n&&"string"==typeof n){for(i=[],r=0;r<n.length&&(e=nn(n,r),i.push(t(n.substring(r,e))),e<n.length);r++){if(-1===(r=n.indexOf(n[e],e+1))){i.push(n.substring(e));break}i.push(n.substring(e,r+1))}return i.join("")}return n}function rn(n){return tn(n,function(n){return 0<=n.toLowerCase().indexOf("_xl")?n.replace(/_xlfn\.|_xlws\.|_xll\./gi,""):n})}function en(n){if(n)return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function v(n,t,i,r,e,f){var o=this;o.Zc=n,o.FY=i,o.jpt=r,o.WK=t,P(e)||(o.TZ=e),o.t1e="boolean"==typeof f&&f}function d(n,t,i,r,e,f,o){var n,r,n=q.call(this,n,r,e,f,o)||this,r=n;return r.bbt=t,r.ybt=i,n}function fn(n){var t=o.call(this,X)||this;return t.references=n,t}function on(n){var t,i,r,e,f,o;if(!(n<0||(t=a[n]))){for(i=n,e=(r="").length,n+=1;0<n;n=Math.floor((n-1)/26))f=r.substring(0,e),o=r.substring(e),r=f+String.fromCharCode(65+(n-1)%26)+o;t=r.toString(),a[i]=t}}function w(n,t,i,r){var e,t,f,o;for(void 0===r&&(r={}),e=h.call(this,n&&n.Uw(r.sheetArea),t,i,r)||this,n||(n=w.wbt=w.wbt||new Y.Worksheet,e.source)||(e.source=n.Uw(r.sheetArea)),e.Mf=n,e.row=i&&i.row||0,e.column=i&&i.col||0,f=(t=n.getCalcService()).getResolvers(),o=0;o<f.length;o++)if(f[o]instanceof _.SheetReferenceResolver)return e;return t.addResolver(new _.SheetReferenceResolver(n)),t.addResolver(new _.StructureReferenceResolver(n)),e}function sn(n){n.indexOf("LET(")}function C(n,t){var i=l.call(this,X)||this;return i.getCalcSourceModel=function(){return this.Mbt},i.createSourceModel=function(n){return new L.CalcSourceModel(n,this)},i.getRangeKey=function(n,t){return n.id+","+t.row+","+t.col+","+t.rowCount+","+t.colCount},i.getSheetRangeReference=function(n){var t,t,i,r,e,f,o,t=this.Mf,t=t&&t.parent;if(n.endSource&&t&&t.sheets&&n.endSource instanceof C){for(i=t.sheets,r=!1,e=void 0,f=[],o=0;o<i.length;o++){if((e=i[o].Uw())===this)r=!0;else if(e===n.endSource){f.push(e.getReference(n));break}r&&f.push(e.getReference(n))}return new s(f)}},i.Mf=n,i.t8=new N.Z8(i),i.nT=t||3,i}function R(n){var t=z.call(this,X)||this;return t.createSourceModel=function(n){return new L.CalcSourceModel(n,this)},t.vpt=n,t.Cbt={},t}function un(n,t,i,r,e,f){var n,o,n,n=n&&n instanceof Y.Worksheet&&n,o=new L.Parser;return i=i===V?0:i,r=r===V?0:r,n=new c(n,!!e,(0,L.eV)(i,r)),f&&(n.culture=!0),o.parse(n,t)}function U(n,t,i,r,e,f){var n,o,e,n=n&&n instanceof Y.Worksheet&&n,o=new L.Parser;return i=i===V?0:i,r=r===V?0:r,(e=new c(n,!!e,(0,L.eV)(i,r))).Sbt=f,e.Nme=n&&n.vle,o.unparse(e,t)}function an(n,t,i,r,e){var f;return cn(n,un(n,t,i=i===V?0:i,r=r===V?0:r,e,!0),i,r)}function cn(n,t,i,r,e){var f,o,n,f=n.op();return i===V&&(i=n.getActiveRowIndex()),r===V&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==V&&(o=e.convertNullToZero),n=n.Uw(e&&e.sheetArea),f.BI(n,t,(0,L.eV)(i,r),!1,o)}function hn(n,t,i,r,e){var f,o,e,n,f=n.op();return i===V&&(i=n.getActiveRowIndex()),r===V&&(r=n.getActiveColumnIndex()),o=!0,e&&e.convertNullToZero!==V&&(o=e.convertNullToZero),e=n.Uw(),(n=(0,L.eV)(i,r)).Tbt=Math.random().toString(36).substring(2),f.Abt(e,t,n,o)}function y(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,f=n.row,o=n.col,s=n.row+n.rowCount-1,u=n.col+n.colCount-1,a=!1,c=!1,h=!1,l=!1;return 4<=arguments.length&&(f-=(a=0!=(1&r))?t:0,s-=(c=0!=(4&r))?t:0,o-=(h=0!=(2&r))?i:0,u-=(l=0!=(8&r))?i:0),e&&(d=vn(n,e,t),w=dn(n,e,t),d)&&w?_.StructureReferenceResolver.create(e,d,w,n.col-e.dataRange().col,n.col+n.colCount-e.dataRange().col-1):1===n.rowCount&&1===n.colCount?(0,L.knt)(X,X,f,o,a,h):(n.row<0&&(f=s=m.BAND_INDEX_CONST),n.col<0&&(o=u=m.BAND_INDEX_CONST),(0,L.lJ)(X,X,f,o,s,u,a,h,c,l,t,i))}function ln(n){return 0<=n.indexOf("[")&&1<n.indexOf("]")}function vn(n,t,i){if(1===n.rowCount){if(t.hasHeadersRow()&&n.row===t.startRow())return 2;if(t.hasTotalsRow()&&n.row===t.endRow())return 8;if(i===n.row)return 1}else{if(t.hasHeadersRow()&&n.row===t.startRow()){if(n.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1+1)return 14}if(n.row===t.dataRange().row){if(n.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&n.rowCount===t.dataRange().rowCount+1)return 12}}return V}function dn(n,t,i){return n.col===t.startColumn()&&n.colCount===t.dataRange().colCount?1:1===n.colCount?2:n.col>=t.startColumn()&&n.col+n.colCount-1<=t.endColumn()?4:V}function wn(n,t,i,r,e){var n,r,f,e,n=y(n,t,i,r),r=new c(X,!!e,(0,L.eV)(t,i)),f,e=(new L.Parser).unparse(r,n);return r.L0(),e}function mn(n,t,i,r,e,f,o){var t,e,s,t=y(t,i,r,e,o),e=new c(n,!!f,(0,L.eV)(i,r)),s;return(new L.Parser).unparse(e,t)}function Cn(n,t,i,r){var e,t,f,o,s,u,a,c,h,s,u;if(!t)return null;if(i=i||0,r=r||0,o=!1,(t=(e=n.op()).parse(n.Uw(),t,i,r,!0,!0))&&(7===t.type&&"ANCHORARRAY"===t.functionName&&(t=t.arguments[0],o=!0),!(f=t.source)||13!==t.type)&&1===t.type&&t.endSource){for(s=t.source,u=t.endSource,a=s.getSources(u),c=!1,h=0;h<a.length;h++)if(a[h]===n.Uw()){c=!0;break}t=c&&t}return t&&t.getRange&&(!f||f===n.Uw())&&(s=t.getRange(i,r))?(o&&(u=new L.CalcReference(n.qgt,[s]).getSpillRef())&&u.$gt&&(s=u.$gt[0]),new Y.Range(s.row,s.col,s.rowCount,s.colCount)):null}function _n(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,w,m,C,o=[],s=[];if(t)for(u={},i=i||0,r=r||0,a=new L.Parser,c=_.Vgt(a,t,n,i,r,V,e,f),h=0;h<c.length;h++)if((l=c[h].sheetRanges)&&!T(l))for(v=0;v<l.sheets.length;v++)for((s=u[d=l.sheets[v]])||(u[d]=s=[],o.push({sheetName:d,ranges:s})),w=l[d],m=0;m<w.length;m++)C=w[m],P(C)||s.push(new Y.Range(C.row,C.col,C.rowCount,C.colCount));return o}function pn(n,t,i,r,e){var f,e,f,f=new L.Parser,e=new c(X,!!e,(0,L.eV)(t,i)),f=gn(f,e,n,t,i,r);return e.L0(),f}function gn(n,t,i,r,e,f,o){for(var s,u,a,a,c,s="",u=0;u<i.length;u++)a=y(i[u],r,e,f),a=n.unparse(t,a),s+=0<u?(c=o&&p.Common.CultureManager.Fe().NumberFormat.listSeparator||",")+" "+a:a;return s}function bn(n,t,i,r,e,f,o){var s,u,a,c,h,l,v,d,w,m,C,_,s=r.getValue(t,i),v=!1,d=100,w=.001,m=.01,a=(x(s)?+s:0)-o,u=r.getValue(e,f),h=(x(u)?+u:0)-o;if(x(u)&&Math.abs(h)<w)v=!0;else if(b(u))v=!1;else for(c=a+(0===a?m:m*a),C=0;!v&&C<d;C++)c=p.Common.st.E8(c,13),n.setValue(t,i,c),u=r.getValue(e,f),l=(x(u)?+u:0)-o,x(u)&&Math.abs(l)<w?v=!0:c=b(u)?(a+c)/2:a-c==0?a+(0===a?m:m*a):h-l==0?a+2*(c-a):(_=c-l*(a-c)/(h-l),a=c,h=l,_);return v||n.setValue(t,i,s),v}i=this&&this.__extends||(f=function(n,t){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}f(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.goalSeek=n.RangeReferenceRelative=n.Ibt=n.rangesToFormula=n.formulaToRanges=n.formulaToRange=n.rangeToFormulaWithStructReference=n.rangeToFormula=n.isValidExternalReference=n.rangeToExpression=n.xbt=n.evaluateExpression=n.evaluateFormula=n.expressionToFormula=n.formulaToExpression=n.SpreadSource=n.SheetSource=n.SheetParserContext=n.SheetRangeReference=n.FormatterNameInfo=n.NameInfo=n.ReferenceStyle=n.encodeNameFormula=n.processFunctionPrefix=void 0,Y=t("Core"),r=t("Core"),p=t("Common"),_=t("./dist/plugins/sheetsCalc/parser-sheets.js"),L=t("CalcEngine"),m=t("./dist/plugins/sheetsCalc/calc.ns.js"),B=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),N=t("./dist/plugins/sheetsCalc/dynamic-array.js"),F=p.Common.lt,u=p.Common.zf,g=F.Dh,T=F._h,X=null,V=void 0,J=["v","n","s","b","d","sn"],G=L.Errors.Value,$=p.Formatter&&p.Formatter.GeneralFormatter,b=L.Convert.BJ,P=F.ht,W=Y.mt.xr,H=Y.range_parser.jc,K=Y.mt.vo,Q=Y.Util.addXLFNPrefix,k="=",x=function(n){return L.Convert.q8(n,!0)},I=Y.Range.prototype.contains,A=u.Gmt,O="number",E=Y.UsedRangeUtil.updateUsedRangeByData,n.processFunctionPrefix=rn,n.encodeNameFormula=en,(t=L.CalcSource.prototype).referenceToArray=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,u=this,h=1,l=1,m=[],w=n.getRangeCount();if(0===w)m.isError=!0;else{for(p=u.getRowCount(),g=u.getColumnCount(),i=i===V||i,b=0;b<w;b++){if(i||m.push(_=[]),0===(h=n.getRowCount(b)))return m.isError=!0,m;if(0===(l=n.getColumnCount(b)))return m.isError=!0,m;if(v=n.getRow(b),d=n.getColumn(b),2!==i){if(p<=v||g<=d)return(m=[X]).rowCount=1,m.colCount=1,m.rangeCount=1,m;g<d+l&&(l=g-d)}for(p<v+h&&(h=p-v),x=void 0,R=0;R<h;R++)for(a=v+R,i||_.push(x=[]),y=0;y<l;y++){if(C=u.getValue(a,c=d+y),r&&L.Convert.BJ(C))return(m=[C]).isError=!0,m;if(C=L.Convert.Nbt(C,t,!L.ExcelCompatibleCalcMode,f,s),e&&C===L.Convert.CalcConvertedError)return(m=[G]).isConvertError=!0,m;C===X&&f||(2===i?m[R*l+y]=C:(i?m:x).push(C))}}(m=i||1!==w?m:m[0]).rowCount=h,m.colCount=l,m.rangeCount=w}return m},t.getSheetReference=function(){var n=this;return n.kbt=n.kbt||new L.CalcReference(n),n.kbt},(e=t=n.ReferenceStyle||(n.ReferenceStyle={}))[e.a1=0]="a1",e[e.r1c1=1]="r1c1",r.ReferenceStyle=t,v.prototype.getName=function(){return this.Zc},v.prototype.getRow=function(){return this.FY},v.prototype.getColumn=function(){return this.jpt},v.prototype.getExpression=function(){return this.WK},v.prototype.getComment=function(){return this.TZ},v.prototype.SB=function(n,t){t&&t.push({type:"customName",nameInfo:this,expr:this.WK}),this.WK=n},v.prototype.isReadOnly=function(n){return"boolean"==typeof n&&(this.t1e=n),this.t1e},n.NameInfo=e=v,r.NameInfo=e,i(d,q=e),d.prototype.getFormatter=function(){return this.bbt},d.prototype.getSheetTabName=function(){return this.ybt},n.FormatterNameInfo=d,L.CalcSource.prototype.createSourceModel=function(n){return new L.CalcSourceModel(n,this)},o=L.CalcReference,i(fn,o),fn.prototype.toArray=function(n,t,i,r,e){for(var f,o,s,u,f=this.references,o=[],s=0;s<f.length;s++){if((u=f[s].rT.referenceToArray(f[s],n,t,i,r,e)).isError&&i)return u;t?Array.prototype.push.apply(o,u):o.push(u),s||(o.rowCount=u.rowCount,o.colCount=u.colCount)}return o.rangeCount=f.length,o},s=fn,n.SheetRangeReference=s,a=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],h=L.ParserContext,i(w,h),w.prototype.getExternalSource=function(n,t){var i,r,e,f,o,s,i=this,r=i.Mf.parent,e=i.Mf.Uw();if(n&&(!r||r.name!==n))return X;if(!r)return u.Dbt(i.Mf.name(),t)?e:X;if(ln(t))return r._p.parseSource(t,e.G3);if((f=r.sheets)&&0<f.length)for(o=0;o<f.length;o++)if(s=f[o],u.Dbt(s.name(),t))return s.Uw();return L.ParserContext.prototype.getExternalSource.call(this,n,t)},w.prototype.getExternalSourceToken=function(n){return n.getName(this)},w.prototype.getTableByName=function(n){var t,i,r,e,f,t=this.Mf.tables,i=!0,r=t?t._bt(n,!0):X;if(!r&&(e=this.Mf.parent&&this.Mf.parent.sheets))for(f=0;f<e.length&&(!(t=e[f].tables)||!(r=t._bt(n,!0)));f++);return r||this.Mf.parent&&this.Mf.parent.Ofe(n)},w.prototype.getTableByIndex=function(n,t){var i=this.Mf.tables;return i?i.Hq(n,t,!0):X},w.prototype.setSource=function(n){var n=this.source=n;n&&n.getSheet&&(this.Mf=n.getSheet())},w.prototype.L0=function(){this.Mf&&this.Mf!==w.wbt&&this.Mf.L0(),this.Mf=X},c=w,n.SheetParserContext=c,M=new p.Common.ResourceManager(Y.SR),l=L.CalcSource,i(C,l),C.prototype.getReferenceSheetNames=function(){return this.Ebt||{}},C.prototype.addReferenceSheetName=function(n){var t=this;t.Ebt||(t.Ebt={}),t.Ebt[n]=1},C.prototype.setReferenceSheetNames=function(n){this.Ebt=n},C.prototype.startCalculation=function(){this.jbt||(this.Obt(),this.K5=[])},C.prototype.endCalculation=function(n){this.jbt=X,this.Rbt=X,!1!==n&&this.Bbt(),this.K5=X;var n=this.Mbt.uT(!1);n&&n.clearListenersCache()},C.prototype._F=function(){var n=this;n.Fbt?n.K5&&(n.Pbt=n.Pbt.concat(n.K5),n.K5=[]):(n.Pbt=n.K5||[],n.Fbt=setTimeout(function(){n.Bbt(n.Pbt),delete n.Pbt,delete n.Fbt},0))},C.prototype.Bbt=function(n){var n,t,i,n=n||this.K5;n&&0<n.length&&(i=(t=this.Mf).Ut.W_(3).B8,t.ki(Y.Events.RangeChanged,{isUndo:!P(i&&i.vE),sheet:t,sheetName:t.name(),row:0,col:0,rowCount:t.getRowCount(),colCount:t.getColumnCount(),changedCells:n,action:6},t.QI))},C.prototype.clearValueCache=function(){this.Obt()},C.prototype.Obt=function(){var n=this.getRowCount(),t=this.getColumnCount();this.jbt={rowCount:n,colCount:t},this.Rbt={arrayInfo:[]}},C.prototype.Gw=function(){this.jbt=X,this.Rbt=X,this.K5=X},C.prototype.getValue=function(n,t){for(var i,r,e,f,o,s,u,n,a,c,h,l,v,d,w,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(f=(e=this).Mf,typeof n==O)o=n,s=arguments[1],t=arguments[2],u=arguments[3];else if(n.row!==V)o=n.row,s=n.col;else if(n.name)return null;return n=e.nT,o<0||s<0?G:f.Gbt&&f.Ubt===o&&f.Hbt===s?f.zbt:(a=e.jbt,c=J[t=t||0],a?(h=a.rowCount,l=a.colCount,w=d=v=void 0,h<=o||l<=s?X:((w=(d=(d=(v=(v=a[o])||(a[o]={}))[s])||(v[s]={v:u?f.getValueIgnoreDefault(o,s,n):f.getValue(o,s,n)}))[c])===V&&(w=L.Convert.Nbt(d.v,t,!L.ExcelCompatibleCalcMode),d[c]=w),Y.mt.V0(w))):o>=e.getRowCount()||s>=e.getColumnCount()?X:u?e.Mf.getValueIgnoreDefault(o,s,n):e.Mf.getValue(o,s,n))},C.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName()+"."+r+"."+e+"."+f+"."+t},C.prototype.getReference=function(n){var t=this,i=n.row,r=n.col;return-1===i&&(n.row=0,n.rowCount=t.getRowCount(),n.rowUndefine=!0),-1===r&&(n.col=0,n.colCount=t.getColumnCount(),n.colUndefine=!0),new L.CalcReference(t,[n])},C.prototype.getSources=function(n){var t,i,r,e,f;if(this.Mf&&this.Mf.parent&&this.Mf.parent.sheets&&n instanceof C){for(t=this.Mf.parent.sheets,i=!1,r=void 0,e=[],f=0;f<t.length;f++){if((r=t[f].Uw())===this&&(i=!0),r===n){e.push(r);break}i&&e.push(r)}return e}},C.prototype.Vbt=function(r,e){var n,f,o,s,n,f=this.Rbt,o=f&&f.arrayInfo;o&&(s=!1,o.forEach(function(n,t){var i,n;n&&(i=n.reference,n=n.key,I.call(i.$gt[0],r,e))&&(delete f[n],o[t]=V,s=!0)}),s)&&(f.arrayInfo=[],o.forEach(function(n){n&&f.arrayInfo.push(n)}))},C.prototype.referenceToArray=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,A,O,E,S,M,D,l=h=1,m=[],p=(u=this).Mf,g=u.jbt,b=u.Rbt,y=J[t=t||0];if(0===(w=n.getRangeCount()))m.isError=!0;else{if(b&&(C=b[R=n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i]))return C;for(j=this.getRowCount(),N=this.getColumnCount(),i=i===V||i,k=0;k<w;k++){if(i||m.push(_=[]),0===(h=n.getRowCount(k)))return m.isError=!0,m;if(0===(l=n.getColumnCount(k)))return m.isError=!0,m;if(v=n.getRow(k),d=n.getColumn(k),2!==i){if(j<=v||N<=d)return(m=i?[X]:[[X]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;N<d+l&&(l=N-d)}for(j<v+h&&(h=j-v),A=I=void 0,O=p.Gbt,E=0;E<h;E++)for(a=v+E,i||_.push(I=[]),g&&(g[a]||(g[a]={}),x=g[a]),S=0;S<l;S++){if(c=d+S,O&&p.Ubt===a&&p.Hbt===c)C=p.zbt,O=!1;else{if(g?(A=x[c])?C=A.v:(C=p.getValue(a,c,u.nT),A=x[c]={v:C}):C=p.getValue(a,c,u.nT),o&&(D=void 0,"@"===(D=(M=p.getFormatter())instanceof $?M.formatString():M)?C=p.getText(a,c):C instanceof Date&&(C=F.uJ(C)),T(A)||(A=x[c]={v:C})),r&&L.Convert.BJ(C))return(m=[C]).isError=!0,m;if(A&&A[y]!==V)C=A[y];else if(C=L.Convert.Nbt(C,t,!L.ExcelCompatibleCalcMode,f,s),A&&(A[y]=C),e&&A===C)return(m=[G]).isConvertError=!0,m}L.Convert.Ybt(C,f)||(2===i?m[E*l+S]=C:(i?m:I).push(C))}}(m=i||1!==w?m:m[0]).rowCount=h,m.colCount=l,m.rangeCount=w,b&&(n.Zbt&&b.arrayInfo.length<200||!isNaN(w)&&!isNaN(h)&&!isNaN(l)&&100<w*h*l&&w*h*l<1e6&&b.arrayInfo.length<50)&&(b[R]=m,b[R].rowCount=h,b[R].colCount=l,b[R].rangeCount=w,b.arrayInfo.push({reference:n,key:R}))}return m},C.prototype.getColumnCount=function(){var n=this.Mf;return n.xT?0:n.getColumnCount(this.nT)},C.prototype.getRowCount=function(){var n=this.Mf;return n.xT?0:n.getRowCount(this.nT)},C.prototype.isHiddenRow=function(n,t){var i=this.Mf,r;return!!(i.iA&&i.iA()||!t)&&0===i.getRowHeight(n)},C.prototype.getName=function(){var n,t,n=this.nT,t=P(this.Wbt)?this.Mf.name():this.Wbt;return n===Y.SheetArea.colHeader?t+"CH":n===Y.SheetArea.rowHeader?t+"RH":t},C.prototype.setArray=function(n,t,i,r,e){return this.t8.setArray(n,t,i,r,e)},C.prototype.updateItem=function(n,t,i){return this.t8.updateItem(this,n,t)},C.prototype.HE=function(n,t){this.t8.HE(n,t)},C.prototype.setValue=function(n){for(var t,i,r,e,f,o,s,u,n,a,r,c,c,c,h,l,v,v,d,w,d,v,w,m,r,r,m,d,C,t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(e=(r=this).Mf,s=r.nT,n.row!==V)f=n.row,o=n.col,u=1;else{if(n.name)return;f=n,o=arguments[1],u=2}n=arguments[u],a=arguments[u+1],(r=r.jbt)&&(c=r[f])&&(c=c[o])&&(c.v=n,c.b!==V&&(c.b=V),c.d!==V&&(c.d=V),c.n!==V&&(c.n=V),c.s!==V&&(c.s=V),c.sn=V),c=Y.mt.Z0(n),h=e.Ut,l=!1,v=(v=e.tables)&&v.find(f,o),3===s&&v&&(d=v.showHeader()&&f===v.headerIndex(),w=v.showFooter()&&f===v.footerIndex(),d||w||(l=v.Kbt(f,o,c))),d=e.H3,3===s&&!l&&d&&d._dataSource&&(w=!1,(v=d.getValue(f,o)).hasBinding&&(m=void 0,m=r?(m=(r=r.bindingRows=r.bindingRows||{})[f])||(r[f]=g({},e.getDataItem(f))):g({},e.getDataItem(f)),h.dE(f,o,{gE:m,d6:v.value}),w=d.setValue(f,o,c,h.G8)),l="dataManagerBindingSource"===d.K$?w:v.hasBinding),r=e.pivotTables,(l=3===s&&!l&&r?r.eJt(f,o,c):l)||(m="__hyperlink__",!P(c)&&c[m]&&(d=c[m],h.setHyperlink&&h.do("setHyperlink",f,o,C={url:d}),c=c.toString()),h.do("setValue",f,o,c,s,!0,!0,arguments[u+2],!0,!0)),e.iL=!0,this.K5?this.K5.push({row:f,col:o,sheetArea:s}):e.ki(Y.Events.CellChanged,{sheet:e,sheetName:e.name(),row:f,col:o,sheetArea:s,propertyName:"value",oldValue:a,newValue:n,KO:!0})},C.prototype.getCustomFunction=function(n){return this.Mf?this.Mf.Jbt(n):X},C.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():X},C.prototype.getCustomNameInfo=function(n){return n=A(n),this.Mf?this.Mf.getCustomName(n):X},C.prototype.getSheet=function(){return this.Mf},C.prototype.setFormula=function(n,t,i,r,e){var f,o,s,u,a,o,a,f=this;if(f.Mf.Ut.G8&&(u=f.Mf.Ut.G8.formulas,s=f.getCalcSourceModel(),u=u||(f.Mf.Ut.G8.formulas={}),-1<=n)&&-1<=t){if((a=f.getCalcService()).backupR1C1Formula&&(o=f.Mbt.pB(n,t),i=U(f.Mf,o,n,t,!0,!1)),!r&&a.allowDynamicArray&&(r=f.Mbt.sT(n,t)),o=(o=u[n])||(u[n]={}),i&&"="===i[0]&&(i=i.substring(1)),a=o[t]&&o[t].formula,e){if(o[t]&&o[t].oldFormula)return void delete o[t].formula;r=g({},r),o[t]=g({},o[t],{oldFormula:i,oldArrayInfo:r}),i||delete o[t].oldArrayInfo}else o[t]=g({},o[t],{formula:i,arrayInfo:r}),i||delete o[t].arrayInfo;s.usedRange&&E(s.usedRange,n,t,a,i)}},C.prototype.setArrayFormula=function(n,t,i,r,e){var f;this.setFormula(n,t,e,{row:n,col:t,rowCount:i,colCount:r})},C.prototype.setFormulaByName=function(n,t,i){var r,e,r,r=this;r.Mf.Ut.G8&&((r=(r=(e=(e=r.Mf.Ut.G8.formulas)||(r.Mf.Ut.G8.formulas={})).names)||(e.names={}))[n]=g({},r[n],{formula:t,oldFormula:i}))},C.prototype.refresh=function(){var n=this.Mf.parent;n&&n.repaint()},C.prototype.toJSON=function(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,c,R,y,j,N,k,I,A,O,E,E,S,o=t,h=this.Mf,l=n.data||{},v=!0,d=this.op(),w=this===h.qgt,_=0;for(w&&(m=(0,L.createMap)(),h.Xbt=C={}),p=d.forceR1C1Formula,g=0;g<=i;g++)if(f=l.dataTable||{},s=o[g]){for(v=!(a=f[g]),a=a||{},b=0;b<=r;b++)if(x=(u=s[b])&&u.WK,c=u&&u.calc&&u.calc.isDefault(),u&&!c&&(x||u.qbt)){c=a[b]||{};try{y=R=void 0,w&&x&&!u.$bt&&(j=x.tyt=x.tyt||U(h,x,g,b,!0,!1)).indexOf("!")<0&&(!(N=m.get(j))||N.baseColumn>b?(y=d.unparse(this,u.WK,g,b,!1,!0)).indexOf("[")<0&&(p&&(y=j),m.set(j,{formula:y,baseRow:g,baseColumn:b})):(R=N.obj)?((I=C[R.si]).lastRow=g,I.lastColumn=Math.max(b,I.lastColumn)):(R=N.obj={si:_},C[_]={formula:N.formula,baseRow:N.baseRow,baseColumn:N.baseColumn,lastRow:g,lastColumn:b},(k=g===N.baseRow?a:f[N.baseRow])[N.baseColumn].formula=N.obj,_++)),y=p&&x?R||x.tyt||U(h,x,g,b,!0,!1):u.qbt||R||y||d.unparse(this,x,g,b,!1,!0),u.$bt?u.$bt.row===g&&u.$bt.col===b&&(c.arrayInfo=u.$bt,c.formula=y):c.formula=y,v=!1,a[b]=c}catch(n){}}if(v){if(f!==l.dataTable)continue}else f[g]=a;l.dataTable=f}if(C&&(C.nextIndex=_),e){for(A=l.columnDataArray||[],O=0;O<e.length;O++)(E=e[O])&&E.WK&&(E=this.op().unparse(this,E.WK,0,O,!1,!0),(S=A[O]||{}).formula=E,A[O]=S);0<A.length&&(l.columnDataArray=A)}T(l)||(n.data=l)},C.prototype.wh=function(n,t,i,r,T,e){var f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,A,O,E,S,M,D,F,f=W(n,Y.XFileConstants.bo),o=this.op();for(o.nyt=!0,w=0,(l=this===(h=this.Mf).qgt)&&(v=(0,L.createMap)(),h.Xbt=d={}),m=n.lossless.exprs=[],C=[],_=0;_<=i;_++)if(s=t[_],a=f[_],s)for(a=a||(f[_]={}),p=0;p<=r;p++)if(u=s[p],c=a[p],g=u&&u.WK,b=u&&u.calc&&u.calc.isDefault(),u&&!b&&g){c=c||{};try{y=R=x=void 0,j=-1,(N=u.$bt)||(k=this.t8.Pme(_,p))&&(N={row:_,rowCount:k.maxX-_+1,col:p,colCount:k.maxY-p+1,isDynamicArray:!0},k.isValid||(N.isInvalid=!0)),l&&!N&&(I=g.tyt=g.tyt||U(h,g,_,p,!0,!1),(A=Y.Util.ko(e))||I.indexOf("!")<0)&&(!(O=v.get(I))||O.baseColumn>p?(R=o.unparse(this,u.WK,_,p,!1,!0)).indexOf("[")<0&&v.set(I,{formula:R,baseRow:_,baseColumn:p}):((x=O.obj)?((E=d[x.si]).lastRow=_,E.lastColumn=Math.max(p,E.lastColumn)):(x=O.obj={si:w},d[w]={formula:O.formula,baseRow:O.baseRow,baseColumn:O.baseColumn,lastRow:_,lastColumn:p},w++),y=x.si,R=void 0)),P(y)&&(R=u.qbt||R||o.unparse(this,g,_,p,!1,!0),e&&e.includeCalcModelCache&&(S=(0,B.exprToJSON)(g),u.eyt||(S.nw=1),m.push(S),j=m.length-1),R=K(Q(R))),N?(N.row===_&&N.col===p&&(M=H(N),(N.isInvalid||!N.rowCount)&&0<M.indexOf(":")&&(M=M.substring(0,M.indexOf(":"))),c.f=R,c.r=M),N.isDynamicArray&&(c.a="1",N.isInvalid||e.fileType!==Y.OpenSaveFileType.excel||C.push(N))):(c.f=R,c.d="shared",c.g=y,c.c=1),-1!==j&&(c.x=j)}catch(n){}a[p]=c}for(D in d)Object.prototype.hasOwnProperty.call(d,D)&&(F=d[D],M=H(new Y.Range(F.baseRow,F.baseColumn,F.lastRow-F.baseRow+1,F.lastColumn-F.baseColumn+1)),(c=f[F.baseRow][F.baseColumn]).r=M,c.g=parseInt(D,10));C.forEach(function(n){for(var t,i,t=n.row;t<n.row+n.rowCount;t++)for(i=n.col;i<n.col+n.colCount;i++)(c=f[t]&&f[t][i])&&(c.t2=!0)}),delete o.nyt},(n.SheetSource=D=C).prototype.getParserContext=function(n,t,i){return t=t||(0,L.eV)(0,0),new c(this.Mf,n,t,i)},z=L.CalcSource,i(R,z),R.prototype.addUsedCustomName=function(n){this.Cbt[n]=1},R.prototype.getUsedCustomNames=function(){return this.Cbt||{}},R.prototype.getCustomFunction=function(n){return this.vpt?this.vpt.getCustomFunction(n):X},R.prototype.getCustomName=function(n){var n=this.getCustomNameInfo(n);return n?n.getExpression():X},R.prototype.getCustomNameInfo=function(n){return this.vpt?this.vpt.getCustomName(n)||this.vpt.xO(n):X},n.SpreadSource=R,n.formulaToExpression=un,n.expressionToFormula=U,n.evaluateFormula=an,n.evaluateExpression=cn,n.xbt=hn,n.rangeToExpression=y,n.isValidExternalReference=ln,n.rangeToFormula=wn,n.rangeToFormulaWithStructReference=mn,n.formulaToRange=Cn,n.formulaToRanges=_n,n.rangesToFormula=pn,n.Ibt=gn,n.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},n.goalSeek=bn},"./dist/plugins/sheetsCalc/calc.ns.js":function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_COLUMN_COUNT=t.MAX_ROW_COUNT=t.BAND_INDEX_CONST=void 0;var i=i("Core");t.BAND_INDEX_CONST=-2147483648,t.MAX_ROW_COUNT=i.XmlConstants.Io,t.MAX_COLUMN_COUNT=i.XmlConstants.xo},"./dist/plugins/sheetsCalc/dynamic-array.js":function(n,t,i){var w,r,l,v,e,m,C,f;function a(n){return n.isValid}function o(n){return{row:n.minX,col:n.minY,rowCount:n.maxX-n.minX+1,colCount:n.maxY-n.minY+1,isValid:n.isValid}}function s(n){this.Gme=new r.Common.rbush,this.rT=n}Object.defineProperty(t,"__esModule",{value:!0}),t.Z8=void 0,w=i("Core"),r=i("Common"),l=i("CalcEngine"),v=i("CalcEngine"),e=null,m=void 0,C=r.Common.lt.ht,s.prototype.Ume=function(){return this.rT.Mf.Ut},s.prototype.L0=function(){this.rT=e,this.Gme=e},s.prototype.Fme=function(){var n=this.Gme.data;if(n&&isFinite(n.minX))return{minRow:n.minX,minCol:n.minY,maxRow:n.maxX,maxCol:n.maxY}},s.prototype.jme=function(n,t,i,r){return this.Gme.search({minX:n,minY:t,maxX:n+(i=void 0===i?1:i)-1,maxY:t+(r=void 0===r?1:r)-1})},s.prototype.Pme=function(t,i){return this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0]},s.prototype.Hme=function(n,t){return this.jme(n,t).filter(a)[0]},s.prototype.zme=function(){var n,n,n=this.Ume();return n.G8?(n.G8.calc=n.G8.calc||[],(n=n.G8.calc).Vme=n.Vme||[],n.Vme):[]},s.prototype.Fgt=function(t,i,r,e){var f,o,s,n,u,f=this;void 0===r&&(r=1),void 0===e&&(e=1),o=this.jme(t,i,r,e),s=this,n=o.filter(function(n){return n.minX>=t&&n.minX<t+r&&n.minY>=i&&n.minY<i+e}),u=this.b3(),n.forEach(function(n){n.isValid&&u.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1),s.Rme(n),s.Lme(n,!0)}),o.filter(a).forEach(function(n){s.Rme(n),o=o.concat(f.jme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1))}),o.forEach(function(n){n.isValid||s.Yme(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1)&&u.gF(n.minX,n.minY,n.maxX-n.minX+1,n.maxY-n.minY+1)})},s.prototype.getAnchorCell=function(t,i){var n=this.jme(t,i).filter(function(n){return n.minX===t&&n.minY===i})[0];return n&&o(n)},s.prototype.getAnchorInfo=function(t,i,n){var r,r,r=this.jme(t,i),r=r.filter(function(n){return n.minX===t&&n.minY===i})[0]||r.filter(a)[0];return r&&o(r)},s.prototype.setValue=function(n,t,i,r){r?this.Ume().setValue(n,t,i,3,!0,!0,!1,!1,!0):this.pBt().setValue(n,t,i)},s.prototype.b3=function(){return this.rT.Mbt},s.prototype.pBt=function(){return this.rT},s.prototype.Rme=function(n,t,i,r){var e,f;if(n){if(n.isValid){for(e=n.minX;e<=n.maxX;e++)for(f=n.minY+(e===n.minX?1:0);f<=n.maxY;f++)this.setValue(e,f,m,i);n.isValid=!1,i&&this.zme().push([n,"isValid",!0]),t||this.setValue(n.minX,n.minY,v.Errors.Spill,i)}t&&(this.Lme(n,i),r||this.setValue(n.minX,n.minY,m,i))}},s.prototype.Lme=function(n,t){this.Gme.remove(n),t&&this.zme().push([n])},s.prototype.Bme=function(n,t){this.Gme.insert(n),t&&this.zme().push([m,n])},s.prototype.HE=function(n,t){this.Pme(n,t).isValid=!1},s.prototype.Yme=function(n,t,i,r,e){for(var f,o,s,u,a,c,h,c,l,v,d,f=this.Gme.search({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1}),o=this.pBt(),s=this.b3(),u=0;u<f.length;u++)if((a=f[u]).isValid&&(a.minX!==n||a.minY!==t))return!1;if(t+r>o.getColumnCount()||n+i>o.getRowCount())return!1;if(c=(0,w.Ec)(n,t,i,r),(h=o.Mf).Ut.getSpans(c).length)return!1;if((c=h.tables)&&c.Pl&&c.Pl(n,t,i,r))return!1;for(l=n;l<n+i;l++)for(v=t+(l!==n||e?0:1);v<t+r;v++)if(d=o.getValue(l,v,m,!0),!C(d)||s.hasFormula(l,v,!0))return!1;return!0},s.prototype.Zme=function(n,t,i,r,e){var f;this.Gme.insert({minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:e})},s.prototype.setArray=function(n,t,i,r,e,f,o){var s,u,a,c,h,s=this,u=this.Pme(n,t);if(u&&u.maxX===n+i-1&&u.maxY===t+r-1&&u.isValid||(s.Rme(u,!0,o),u={minX:n,minY:t,maxX:n+i-1,maxY:t+r-1,isValid:!0},f||(u.isValid=s.Yme(n,t,i,r)),s.Bme(u,o)),u.isValid)for(a=n;a<n+i;a++)for(c=t;c<t+r;c++)e&&e[a-n]&&(h=e[a-n][c-t],C(h)?h=0:(l.Convert.Nh(h)||l.Convert.LE(h))&&(h=1===h.getRowCount()&&1===h.getColumnCount()?l.Convert.Nh(h)?h.getValue(0,0):h.getValue(0,0,0):v.Errors.Calc),this.setValue(a,c,h,o));else this.setValue(n,t,v.Errors.Spill,o);return u.isValid},s.prototype.updateItem=function(n,t,i){var t=this.Pme(t,i);if(t)return this.Rme(t,!0),!0},s.prototype.rE=function(r,e){var f=this,n;f.jme(r,-1,l.MAX_ROW_COUNT,-1).forEach(function(n){var t,i;if(n.minX>=r)f.Gme.remove(n),n.minX+=e,n.maxX+=e,f.Gme.insert(n);else if(n.maxX>=r&&n.isValid){for(t=r;t<=n.maxX;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t+e,i));for(t=n.maxX+1;t<=n.maxX+e;t++)for(i=n.minY;i<=n.maxY;i++)f.pBt().setValue(t,i,m)}})},s.prototype.aE=function(f,o,s){var u=this,n;u.jme(f,-1,l.MAX_ROW_COUNT,-1).forEach(function(n){var t,i,r,e;if(n.minX>=f+o)u.Gme.remove(n),n.minX-=o,n.maxX-=o,u.Gme.insert(n);else if(n.minX>=f)u.Rme(n,!0,s);else if(n.maxX>=f&&n.isValid)if(t=n.maxX>f+o-1?n.maxX+1:f+o,i=n.maxX>f+o-1?o:n.maxX-f+1,u.Yme(t,n.minY,i,n.maxY-n.minY+1,!0))for(r=n.maxX;f<=r;r--)for(e=n.minY;e<=n.maxY;e++)u.setValue(r+o,e,u.pBt().getValue(r,e),s);else u.Rme(n,!1,s)})},s.prototype.Eme=function(t,i){var r=this,n;r.jme(t,-1,l.MAX_ROW_COUNT,-1).forEach(function(n){n.minX>=t&&(r.Gme.remove(n),n.minX+=i,n.maxX+=i,r.Gme.insert(n))})},s.prototype.oE=function(r,e){var f=this,n;this.jme(-1,r,-1,l.MAX_COLUMN_COUNT).forEach(function(n){var t,i;if(n.minY>=r)f.Gme.remove(n),n.minY+=e,n.maxY+=e,f.Gme.insert(n);else if(n.maxY>=r&&n.isValid){for(t=n.minX;t<=n.maxX;t++)for(i=r;i<=n.maxY;i++)f.pBt().setValue(t,i,f.pBt().getValue(t,i+e));for(t=n.minX;t<=n.maxX;t++)for(i=n.maxY+1;i<=n.maxY+e;i++)f.pBt().setValue(t,i,m)}})},s.prototype.uE=function(f,o,s){var u=this,n;this.jme(-1,f,-1,l.MAX_COLUMN_COUNT).forEach(function(n){var t,i,r,e;if(n.minY>=f+o)u.Gme.remove(n),n.minY-=o,n.maxY-=o,u.Gme.insert(n);else if(n.minY>=f)u.Rme(n,!0,s);else if(n.maxY>=f&&n.isValid)if(t=n.maxY>f+o-1?n.maxY+1:f+o,i=n.maxY>f+o-1?o:n.maxY-f+1,u.Yme(n.minX,t,n.maxX-n.minX+1,i,!0))for(r=n.minX;r<=n.maxX;r++)for(e=n.maxY;f<=e;e--)u.setValue(r,e+o,u.pBt().getValue(r,e),s);else u.Rme(n,!1,s)})},s.prototype.Ome=function(t,i){var r=this,n;this.jme(-1,t,-1,l.MAX_COLUMN_COUNT).forEach(function(n){n.minY>=t&&(r.Gme.remove(n),n.minY+=i,n.maxY+=i,r.Gme.insert(n))})},s.prototype.Wme=function(n){for(var t,i,r,e,r,t=this,i=n.length-1;0<=i;i--)e=(r=n[i])[0],2<r.length?e[r[1]]=r[2]:1<r.length?t.Gme.remove(r[1]):(r=t.Pme(e.minX,e.minY),t.Rme(r,!0),t.Gme.insert(e))},t.Z8=s},"./dist/plugins/sheetsCalc/external-reference.js":function(n,t,i){var r,j,c,I,o,i,N,k,A,O,E,h,S,M,e,f,s,u,a;function l(n,t){var i,r;if(Array.isArray(n))n.forEach(t);else if("object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&t(r=n[i],i)}function v(n){return n}function d(n){var n,t,n=n.value;return n&&n.richText?(t="",n.richText.forEach(function(n){t+=n.text}),t):n}function w(n,t,i){var r,n,e,i,r=a.call(this,O)||this;return r.getSheetRangeReference=function(n){var t,i,r,e,f,t=this.rT.sheetNames;if(n.endSource&&t&&n.source instanceof w){for(i=!1,r=[],e=0;e<t.length&&((i=t[e]===n.source.oyt?!0:i)&&(f=new w("["+this.rT.i+"]"+t[e],this.ayt,!0),r.push(f.getReference(n))),t[e]!==n.endSource.oyt);e++);return new o.SheetRangeReference(r)}return I.Errors.Name},n=n.split("]"),i&&(e=n[0].substring(1)),t.iyt[e]?r.rT=t.iyt[e]:(i=n[0].indexOf("["),r.rT=t.ryt(n[0].substring(i+1),n[0].substring(0,i),!0)),r.oyt=n[1],r.ayt=t,r}function m(n,t){var i,r,e;if(n)for(i in n)E(n,i)&&(e=(r=n[i]).getExpression())&&e.forEachNodes(function(n){(1===n.type||5===n.type||8===n.type)&&n.source instanceof f&&(t[n.source.rT.i]=!0)})}function C(n,t){var t=n.getRange(t.row,t.column);return t.sheetName=n.source.oyt,t}function _(n){this.iyt=n||{},this.uyt={},this.syt()}r=this&&this.__extends||(u=function(n,t){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}u(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalReferenceManager=t.ExternalSource=void 0,j=i("Core"),c=i("Common"),I=i("CalcEngine"),o=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c.Common.lt,N=j.XFileConstants.Rr,k=j.XFileConstants.Lr,A=void 0,O=null,E=c.Common.kh,h=i.ht,S=j.Util.wr,M=j.Util.Mr,e=/^'?\[\d+\]/,a=I.CalcSource,r(w,a),w.prototype.cyt=function(n,t,i){var r,e,r=n.getKey();this.rT=this.ayt.fyt(this.rT),this.eme(),e=this.ayt.uyt[this.rT.i]=this.ayt.uyt[this.rT.i]||{},t?e[r]?e[r][1].push(i):e[r]=[n,[i]]:e[r]&&delete e[r]},w.prototype.eme=function(){this.rT.data=this.rT.data||{};var n=this.rT.data[this.oyt];return n||(this.rT.sheetNames.push(this.oyt),n=this.rT.data[this.oyt]={isNew:!0}),n},w.prototype.getValue=function(n,t){var i,n,i,i=this.eme(),n=i[n];return!n||h(n[t])?i.isNew?I.Errors.Reference:0:(i=n[t])&&i._code&&(i._error||i._calcError)?new I.CalcError(i._error||i._calcError):i},w.prototype.getRowCount=function(){return I.MAX_ROW_COUNT},w.prototype.getColumnCount=function(){return I.MAX_COLUMN_COUNT},w.prototype.createSourceModel=function(){return O},w.prototype.getCalcSourceModel=function(){return O},w.prototype.setCalcSourceModel=function(){},w.prototype.getPeerSource=function(n){return new w("["+this.rT.i+"]"+n,this.ayt,!0)},w.prototype.getSources=function(n){var t,i,r,e,f,t=this.rT.sheetNames,i=[];if(n&&t&&n.oyt)for(r=!1,e=0;e<t.length&&((r=t[e]===this.oyt?!0:r)&&(f=new w("["+this.rT.i+"]"+t[e],this.ayt,!0),i.push(f)),t[e]!==n.oyt);e++);return i},w.prototype.referenceToArray=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,u=this,h=1,l=1,m=[],p=u.rT.Rbt,g=u.oyt+n.getRangeCount()+"_"+n.getRow(0)+"_"+n.getColumn(0)+"_"+n.getRowCount(0)+"_"+n.getColumnCount(0)+"_"+t+"_"+i;if(p){if(p.has(g))return p.get(g)}else p=u.rT.Rbt=(0,I.createMap)();if(0===(w=n.getRangeCount()))m.isError=!0;else if(b=Math.max.apply(null,Object.keys(u.eme()))+1,x=u.getColumnCount(),isNaN(b))(m=[I.Errors.Reference]).isError=!0;else{for(i=i===A||i,R=0;R<w;R++){if(i||m.push(_=[]),v=n.getRow(R),d=n.getColumn(R),0===(h=n.getRowCount(R)))return m.isError=!0,m;if(-1===h&&(v=0,h=b),0===(l=n.getColumnCount(R)))return m.isError=!0,m;if(-1===l&&(d=0,l=x),b<=v||x<=d)return(m=i?[O]:[[O]]).rowCount=1,m.colCount=1,m.rangeCount=1,m;for(b<v+h&&(h=b-v),x<d+l&&(l=x-d),y=void 0,j=!1,N=0;N<h;N++)for(a=v+N,i||_.push(y=[]),k=0;k<l;k++)C=u.getValue(a,c=d+k),j||(C=I.Convert.Nbt(C,t,!I.ExcelCompatibleCalcMode,f,s),r&&I.Convert.BJ(C)&&(j=(m=[C]).isError=!0),I.Convert.Ybt(C,f))||(i?m:y).push(C);if(j)return m}(m=i||1!==w?m:m[0]).rowCount=h,m.colCount=l,m.rangeCount=w,p&&p.set(g,m)}return m},w.prototype.getName=function(n){var n,n=this.Dfe?"":this.ayt.uyt[this.rT.i]&&(!this.rT||n&&n.lyt)?"[".concat(this.rT.i,"]"):"".concat(this.rT.option.path,"[").concat(this.rT.option.name,"]");return n+this.oyt},w.prototype.getIdentity=function(n,t){var i,r,e,f,t,i=this,r=t.row,e=t.rowCount||1,f=t.column,t=t.columnCount||1;return-1===r&&(r=0,e=i.getRowCount()),-1===f&&(f=0,t=i.getColumnCount()),i.getName(n)+"."+r+"."+e+"."+f+"."+t},f=w,t.ExternalSource=f,_.prototype.parseSource=function(n,t){return new f(n,this,t)},_.prototype.ryt=function(n,t,i,r){var e,f;for(e in this.iyt)if(E(this.iyt,e)&&(f=this.iyt[e])&&f.option.name===n&&f.option.path===t)return f;if(!i)for(e in this.iyt)if(E(this.iyt,e)&&(f=this.iyt[e]).option.name===n&&""===t)return f;return r?A:{option:{name:n,path:t},sheetNames:[],data:{}}},_.prototype.syt=function(){for(var n in this.iyt)this.iyt[n]&&(this.iyt[n].i=n)},_.prototype.fyt=function(n){var t,t,t=this.ryt(n.option.name,n.option.path,!0,!0);return t||(t=Object.keys(this.iyt).length+1,(this.iyt[t]=n).i=t,n)},_.prototype.Ep=function(n){var t,i,r,e,f,o,i={},r={},e=1;for(f in this.iyt)E(this.iyt,f)&&(this.uyt[f]&&!j.GC$.isEmptyObject(this.uyt[f])||(t||(t={},m(n.hyt,t),n.sheets.forEach(function(n){m(n.hyt,t)})),t[f]))&&(i[(o=this.iyt[f]).i=e]=o,r[e]=this.uyt[f],e++);this.iyt=i,this.uyt=r},_.prototype.toJSON=function(){var n,t,i,n={};for(t in this.iyt)E(this.iyt,t)&&(i=this.iyt[t],n[t]={option:{name:i.option.name,path:i.option.path},sheetNames:i.sheetNames,data:i.data});return n},_.prototype.wh=function(n){var g,b,t,x,R,y,i,r,g=this.iyt,b=[],t={n_:"externalReferences",c_:b},x={},R=n.workbook.rels,y=0,i=function(n){var t,i,r,n,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p;if(E(g,n)){for(y++,i=(t=g[n]).option.id=N+S(R),R.c_.push({n_:k,Id:i,Type:j.RelationshipConstants.uc,Target:M(j.XFileConstants.nu+"/"+j.XFileConstants.tu+n)}),b.push({n_:"externalReference","r:id":i}),n={n_:"sheetNames",c_:r=[]},e={n_:"sheetDataSet",c_:[]},(f=t.sheetNames)&&f.forEach(function(n){r.push({n_:"sheetName",val:j.mt.Nfe(n)})}),o=t.data,s=0,u=f.length;s<u;s++){if(a=o[f[s]],c={n_:j.XFileConstants.bo,sheetId:s},a){for(l in a.isNew&&(c.refreshError=1),h=[],a)if(a.hasOwnProperty(l)&&(v=parseInt(l,10)+1,!isNaN(v))){for(C in m={n_:"row",r:v,c_:w=[]},d=a[l])d.hasOwnProperty(C)&&d[C]!==A&&(_=d[C],(p={n_:"cell"}).r=j.IndexHelper.nr(parseInt(C,10))+v,"string"==typeof _?p.t="str":"boolean"==typeof _?(p.t="b",_=_?"1":"0"):_&&_.code&&(p.t="e","#SPILL!"!==(_=_._calcError||_.error)&&"#CALC!"!==_||(_="#VALUE!")),p.c_=[{n_:"v",c_:[_]}],w.push(p));h.push(m)}c.c_=h}e.c_.push(c)}x[i]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[n,e]}],option:t.option}}};for(r in g)i(r);return{externalReferencesNode:t,externalLinks:x,count:y}},_.prototype.dyt=function(n,i,t){var r,e,f,r,n,o,s,u,a,r=i&&i.sheets&&Object.keys(i.sheets),e=r&&i.sheets[r[0]].data&&i.sheets[r[0]].data.dataTable,f=e?d:v,r=this.ryt(n,t||"",A,!0);if(!h(r)){for(a in n=r.i,delete(o=this.iyt[n]).Rbt,s=this.uyt[n]||{},o.ime=new c.Common.rbush,u=function(n){var t;E(s,n)&&((t=s[n][0]).vyt(),s[n][1].forEach(function(n){var n=n.getRange(t.row,t.column);o.ime.insert({minX:n.row,minY:n.col,maxX:n.row+n.rowCount-1,maxY:n.col+n.colCount-1})}))},s)u(a);o.sheetNames.forEach(function(n){var t,r,t=e?i.sheets[n]&&i.sheets[n].data.dataTable:i&&i[n];t&&(r=o.data[n]={},l(t,function(n,i){o.ime.collides({minX:i,minY:-1,maxX:i,maxY:-1})&&(r[i]=r[i]||{},l(n,function(n,t){o.ime.collides({minX:i,minY:t,maxX:i,maxY:t})&&(r[i][t]=f(n))}))}))})}},_.prototype._6=function(t,n,i){var r,e,r=this;"string"==typeof t?r.dyt(t,n,i):t&&(e=r.myt(!0)).forEach(function(n){t[n.filePath+n.name]&&r.dyt(n.name,t[n.filePath+n.name],n.filePath)})},_.prototype.myt=function(n){var t,i,r,e,f,o,s,t=[];for(i in this.iyt)if(E(this.iyt,i)){if(r=this.iyt[i],e={name:r.option.name,filePath:r.option.path},n)for(s in f=this.uyt[i]||{},e.items=[],o=function(n){var t,i,n,n;E(f,n)&&(i={row:(t=f[n][0]).row,col:t.column,sheetName:t.w3.rT.getName()},n=1===(n=f[n][1]).length?C(n[0],t):n.map(function(n){return C(n,t)}),e.items.push({target:i,source:n}))},f)o(s);t.push(e)}return t},t.ExternalReferenceManager=_},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(f,n,t){var K,i,j,R,Q,o,X,t,w,Z,m,q,z,C,g,S,Y,r,s,_,i;function a(n,t){var i,r,e,n,i=m(n.row,(t=t||this).row),r=m(n.column,t.column),e=Z(n.row+n.rowCount,t.row+t.rowCount),n=Z(n.column+n.columnCount,t.column+t.columnCount);return e<=i||n<=r?z:{row:i,column:r,rowCount:e-i,columnCount:n-r,intersectWith:a}}function e(n,t,i,r,e,f,o,s){var u=this;u.gyt=n,u.pyt=t,u.byt=i,u.yyt=r,u.wyt=e,u.Myt=f,u.Sx=o,u.Cyt=s}function M(n,t,i,r){return(!r||n<t)&&i}function P(n){return[n.row,n.col,n.rowCount,n.colCount].join(",")}function L(n,t,i,r){var e,e;(e=(e=n[t])||(n[t]={}))[i]=r}function V(n,t,i){var n=n[t];return n&&n[i]}function nn(){}function p(n,t,i,r,e,f,o,s,u,a,c,h){var l,v,d,n;return 0<=i||!e?(l=r+(e?i:0),v=f+(o?i:0),d=c&&b(s,n,c),n=!c&&b(s,n,c),h&&-1===f?e?u+a<=l&&u<=i&&i<u+a?i-u+u+a<=l&&(l+=a):u<=l&&!(u<=i&&i<u+a)&&(l+=a):u<=l&&(l+=a):((d||n)&&(!h&&u+a<=i||h&&u<=i)&&(l-=e?a:0,v-=o?a:0),d=c&&b(s,t,c),n=!c&&b(s,t,c),(d||n)&&(!h&&u<=l||h&&(e&&u<=i+r||!e&&u<=r)?(l+=a,v+=a):(!h&&u<=v||h&&(o&&u<=i+f||!o&&u<=f))&&(v+=a)),h&&u+a<=i&&(l+=e?a:0,v+=o?a:0)),{index:l-=e?i:0,endIndex:v-=o?i:0}):{index:r,endIndex:f}}function O(n,t,i,r,e,f,o,s,u,a,c,h,l){var l,v,d,w,m;if(t&&!l){if(l=u?e.row:e.column,v=u?e.rowRelative:e.columnRelative,d=void 0,w=e.row+(e.rowRelative&&i),m=e.column+(e.columnRelative&&r),h&&!h(w,m))return e;if(e.rowRelative&&e.columnRelative&&0===e.row&&0===e.column&&0===o&&c&&(u&&c.Tge||!u&&c.Age))return e;if(u&&0<=i||!u&&0<=r||!v){if(a)d=p(n,t,u?i:r,l,v,-1,!1,f,o,s,u,h).index;else if(d=B(n,t,u?i:r,l,v,f,o,s,u,h),C(d))return(0,K.Syt)(d);d!==l&&(e=e.offset(u?d-l:0,u?0:d-l,!0))}}return e}function E(n,t,i,r,e,f,o,s,u,a,c,h){var h,h,l,v,d,w,a,n;if(t&&!h){if(3===(h=e.Tyt())||u&&2===h||!u&&1===h)return e;if(h=u?e.rowRelative:e.columnRelative,l=u?e.endRowRelative:e.endColumnRelative,v=u?e.row:e.column,d=u?e.endRow:e.endColumn,w=void 0,u&&0<=i||!u&&0<=r||!h||!l){if(a)w=p(n,t,u?i:r,v,h,d,l,f,o,s,u,c);else if(w=$(n,t,u?i:r,v,h,d,l,f,o,s,u,c),C(w))return(0,K.Syt)(w);a=w.index,n=w.endIndex,a===v&&n===d||(e=e.offset2(u?a-v:0,u?0:a-v,u?n-d:0,u?0:n-d,i,r))}}return e}function F(n,t,i,r,e,f,o,s,u,a){if(t){var t=e;if(t&&f===t.source)return t.offsetWhenInsertRemoveColumn(o,s,u,a)}return e}function x(n,t,i,r,e,f,o,s,u,a,c,h){var l,v,d,w,m,C,_,p,g,b,l=x,v=r;if(r){if(1===r.type&&r.hmt())v=O(n,r.source||n,t,i,r,e,f,o,s,u,a,c,h);else if(1===r.type)v=E(n,r.source||n,t,i,r,e,f,o,s,u,c,h);else if(10===r.type)(d=l(n,t,i,r.value,e,f,o,s,u,a,c,h))!==r.value&&(v=(0,K.Ayt)(d));else if(9===r.type)w=l(n,t,i,r.value,e,f,o,s,u,a,c,h),m=r.value2&&l(n,t,i,r.value2,e,f,o,s,u,a,c,h),w===r.value&&m===r.value2||(v=(0,K.rbt)(r.operatorType,w,m));else if(7===r.type){for(C=z,p=_=void 0,b=(g=r).arguments.length,p=0;p<b;p++)if((d=l(n,t,i,_=g.arguments[p],e,f,o,s,u,a,c,h))!==_){(C=[])[p]=d;break}if(C){for(p=0;p<b;p++)_=g.arguments[p],C[p]!==q&&C[p]!==z||(C[p]=l(n,t,i,_,e,f,o,s,u,a,c,h));v=(0,K.YJ)(g,C)}}else c&&!n.Iyt||s||13!==r.type||(v=F(n,n,t,i,r,e,f,o,u,c));return v}}function h(f,o,s,u,n,t,i,r,a,c,h){var e,l,v,l,e=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,s,u,a,c,e,h)},l=f.getSheet();l&&(v=l.b8&&(l.parent||l).xyt(),l=l.Ut&&l.Ut.pj(),d(v,e,a,l))}function d(n,t,i,r){var e,e,f,o,s,u,a,c,h,l,v,d,w,s,m,C,_,p,g,b,x;if(n)for(u=0;u<n.length;u++){for(c=a=!0,h=R.maxRowCount-1,l=R.maxColumnCount-1,d=0,w=(v=(e=n[u].validator)._S).length;d<w&&(m=(s=v[d]).rowCount,C=s.colCount,o=s.row,s=s.col,-1!==m&&(c=!1,h=o<h?o:h),-1!==C&&(a=!1,l=s<l?s:l),a||c);d++);if(!(i&&c||!i&&a)&&(_=(f=n[u].sheet).Uw(),e=e.condition(),p=void 0,v&&v[0]&&(-1===v[0].row&&(p={Tge:1}),-1===v[0].col)&&(p={Age:1}),(g=e.getExpressions())&&0<g.length)){for(b=0;b<g.length;b++)x=g[b],g[b]=t(_,x,h,l,p);e.setExpressions(g,r)}}}function l(n){var i,t,r,i=[],t=n.parent,r;return(t&&t.sheets||[n]).forEach(function(t){var n=t.conditionalFormats,n=n&&n.getRules();n&&n.length&&n.forEach(function(n){n.KK&&i.push({rule:n,sheet:t})})}),i}function v(f,o,s,u,a,c){var n,t,i,r,n=function(n,t,i,r,e){return o.call(this,n,i,r,t,f,s,u,a,c,e)},t=f.getSheet();t&&T(i=l(t),n,r=t.Ut&&t.Ut.pj(),a,c)}function T(n,t,i,r,e){var f,o,s,u,a,c,h,a,l,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,y,I,A,O,E;if(n)for(f=0,o=n.length;f<o;f++){if(u=(s=n[f].rule).ranges(),c=(a=S(u)).r,h=a.c,l=(a=n[f].sheet).Uw(),v=s.condition(),(d=a.tables)&&u&&1===u.length&&(m=(w=u[0]).row,C=w.col,_=w.rowCount,p=w.colCount,g=void 0,e&&r?g=d.AJ(m,C,_,p):a.EB&&a.Nyt&&(g=[a.Nyt]),g)&&g.length){for(b=!1,x=0,R=g.length;x<R;x++)if(j=(y=g[x]).row,N=y.col,k=y.rowCount,y=y.colCount,m===j&&_===k&&N<=C&&C+p<=N+y){b=!0;break}if(b)continue}if(v||(s.initCondition(),v=s.condition()),I=v&&v.getExpressions(),A=void 0,u&&u[0]&&(-1===u[0].row&&(A={Tge:1}),-1===u[0].col)&&(A={Age:1}),I&&0<I.length){for(O=0;O<I.length;O++)E=I[O],I[O]=t(l,E,c,h,A);v.setExpressions(I,i)}}}function H(n,e,f){var t,n,i,t=function(n,t,i,r){return J.call(this,n,i,r,t,e,f)},n=n.getSheet(),i;T(l(n),t,n.Ut.pj())}function U(n,t,i,r,e,f,o){var s,u,o,a,c,h,l,v,d,w,m,C,_,v,_;if(!o&&(a=(o=(u=(s=n.getSheet()).Ut)&&u.yle())&&o.gle()))for(c in a)if(a.hasOwnProperty(c)&&(h=a[c]))for(l in h)h.hasOwnProperty(l)&&(d=+c,w=+l,v=h[l])&&v.expr&&!X(s.getValueIgnoreDefault(d,w))&&(m=s.op(),C=v.expr,_=v.oldRow,v=v.oldCol,m)&&_&&v&&C&&(C=t.call(self,n,d,w,C,n,i,r,e,f,q),_=m.unparse(n,C,d,w),u.setDefaultValue(d,w,_,z,Q.DefaultChangeValueType.Expression,z,!0))}function B(n,t,i,r,e,f,o,s,u,a){var c,h,n;if(0<=i||!e){if(c=r+(e?i:0),a&&c<i&&c<o)return r;if(h=u&&b(f,n,u),n=!u&&b(f,n,u),(h||n)&&o<=i&&(c+=e?s:0),h=u&&b(f,t,u),n=!u&&b(f,t,u),h||n)if(o+s<=c)c-=s;else if(o<=c)return g;return a&&o<=i&&e&&o<(c-=s)+s&&c<o?g:c-=e?i:0}return r}function b(n,t,i){var i=i?{2:!0}:{1:!0};return n===t||n.Mf===t.Mf&&(3===n.nT&&i[t.nT]||i[n.nT]&&3===t.nT)}function $(n,t,i,r,e,f,o,s,u,a,c,h){var l,v,d,w,n,s,t;if(0<=i||!e){if(l=r+(e?i:0),v=f+(o?i:0),d=u+a-1,w=c&&b(s,n,c),n=!c&&b(s,n,c),(w||n)&&u<=i&&(l+=e?a:0,v+=o?a:0),w=c&&b(s,t,c),n=!c&&b(s,t,c),w||n)if(s=i+r,t=i+f,!h&&d<l||h&&d<s)l-=a,v-=a;else{if(!h&&u<=l&&v<=d||h&&u<=s&&t<=d)return g;!h&&v<u||h&&t<u||(!h&&d<=v||h&&d<=t?(l=!h&&l<=u||h&&s<=u?l:u,v-=a):v=u-1)}return l-=e?i:0,v-=o?i:0,h&&u<=i&&(l-=e?a:0,v-=e?a:0),{index:l,endIndex:v}}return{index:r,endIndex:f}}function W(n,t,i){var r,e,f,o,s,u,a,c,a,a,c,a,h,l,c,a,v,d,r=W,e=t;if(t)if(t.source)if(u=t.source,(a=t.endSource)&&u!==a){if(!(c=u.Mf&&u.Mf.parent))return K.kyt;a===i?(a=i.S3,e.endSource=c.getSheet(a-1).Uw()):u===i&&(a=i.S3,e.source=c.getSheet(a).Uw()),delete i.S3,e.source===e.endSource&&delete e.endSource}else(n!==i&&u===i||n===i&&u!==i)&&(e=K.kyt);else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,K.Ayt)(f));else if(9===t.type)c=r(n,t.value,i),a=t.value2&&r(n,t.value2,i),c===t.value&&a===t.value2||(e=(0,K.rbt)(t.operatorType,c,a));else if(7===t.type){for(h=z,l=t.arguments.length,s=0;s<l;s++)if((f=r(n,o=t.arguments[s],i))!==o){(h=[])[s]=f;break}if(h){for(s=0;s<l;s++)o=t.arguments[s],h[s]!==q&&h[s]!==z||(h[s]=r(n,o,i));e=(0,K.YJ)(t,h)}}else 8===t.type&&(c=n||i,a=w(t.value),u=(v=c.getCustomName(a))&&v.source||(v=(d=c.Lbt.getGlobalSourceModel()||c.getCalcSourceModel()).getSource().getCustomName(a))&&v.source?v.source:u)&&(n!==i&&u===i||n===i&&u!==i)&&(e=K.kyt);return e}function D(n,t,i,r,e){return W(n,r,e)}function tn(n,t){return n.yyt===n.gyt&&t!==n.yyt}function rn(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,l,w,m,C,m,w,C,d,o=!!r.source,s=r.source||n,u=r.rowRelative,a=r.columnRelative,d=t,l=i,w=e.yyt.Mf;if(f&&f.isCustomName&&(m=r.row,C=r.column,d=e.wyt+(m-e.pyt)+w.lT(e.wyt,m-e.pyt+1,!0),l=e.Myt+(C-e.byt)+w.lT(e.Myt,C-e.byt+1)),m=e.Dyt(d),w=e._yt(l),(0<=t||!u)&&(0<=i||!a)){if(c=r.row+(u?t:0),h=r.column+(a?i:0),f&&f.isNameID||n===e.gyt&&(v=n===e.yyt?e.Eyt(e.yyt,t,i,1,1)&&!(f&&f.isCustomName):(C=t,d=i,f&&f.crossSheetMoved&&(C-=m,d-=w),e.jyt(e.gyt,C,d,1,1))),s===e.yyt&&e.Eyt(s,c,h,1,1)&&!e.jyt(s,c,h,1,1)&&(!u&&!a||!v))return K.kyt;if(l=(o&&s===e.gyt||!o&&n===e.gyt)&&(!v&&e.jyt(e.gyt,c,h,1,1)||v&&e.Eyt(e.yyt,u?c:c+m,a?h:h+w,1,1)),v&&(c-=u?m:0,h-=a?w:0),l&&(c+=m,h+=w),h-=a?i:0,s=r.source,e.gyt!==e.yyt&&(l&&v?o&&(s=e.yyt):l?s=e.yyt:v&&!o&&(s=e.gyt)),(c-=u?t:0)!==r.row||h!==r.column||s!==r.source)return(0,K.knt)(s,z,c,h,u,a)}else if((0<=t||!u)&&-1===i){if(c=r.row+(u?t:0),e.Eyt(n,t,i,1,1)&&(c-=u?m:0),e.jyt(s,c,-1,1,-1))c+=m;else if(e.Eyt(s,c,-1,1,-1))return K.kyt;if((c-=u?t:0)!==r.row)return(0,K.knt)(r.source,z,c,r.column,u,r.columnRelative)}else if(-1===t&&0<=i&&!a){if(h=r.column+(a?i:0),e.Eyt(n,t,i,1,1)&&(h-=a?w:0),e.jyt(s,c,h,1,1))h+=w;else if(e.Eyt(s,c,h,1,1))return K.kyt;if(h-=a?i:0,c!==r.row||h!==r.column)return(0,K.knt)(r.source,r.endSource,r.row,h,r.rowRelative,a)}return r}function y(n,t){var i,r,e,f;return(t=n.getIntersect(t,0,0))?(i=n.row,r=n.col,e=n.rowCount,f=n.colCount,n.rowCount===t.rowCount&&n.colCount===t.colCount||(n.rowCount===t.rowCount?(n.col===t.col&&(r=n.col+t.colCount),f=n.colCount-t.colCount):n.colCount===t.colCount&&(n.row===t.row&&(i=n.row+t.rowCount),e=n.rowCount-t.rowCount)),(0,Q.Ec)(i,r,e,f)):z}function en(n,t,i,r,e){var n,f;return t&&n&&(!(n=t.getIntersect(n,0,0))&&(f=t.getIntersect(i,0,0))||!!(n&&n.rowCount===t.rowCount&&0!==e||n.colCount===t.colCount&&0!==r))}function fn(n,t,i){var n=n.getRange(t,i);return(0,Q.Ec)(n.row,n.col,n.rowCount,n.colCount)}function N(n,t,i,r){var t,e,t=y(n,t);return t?(e=t.union(i),r?(e.col=n.col,e.colCount=n.colCount):(e.row=n.row,e.rowCount=n.rowCount)):e=i,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function k(n,t,i,r,e){var f,n,t,f=y(n,t),n=n.getIntersect(t,0,0);return n?(n.row+=r,n.col+=e,{startRow:(t=f?f.union(n):i).row,endRow:t.row+t.rowCount-1,startColumn:t.col,endColumn:t.col+t.colCount-1}):z}function on(n,t){var i,r,e,n,f,o,s,t,i=n.row,r=n.col,e=n.rowCount,n=n.colCount,f=t.row,o=t.col,s=t.rowCount,t=t.colCount;return 1===e&&1!==n?o<r&&r<=o+t-1||o<=r+n-1&&r+n-1<o+t-1:1!==n||1===e||f<i&&i<=f+s-1||f<=i+e-1&&i+e-1<f+s-1}function sn(n,t,i,r,e,f){var r,e,f,o,s,u,a,c,h,l,v,d,n,w,m,C,_,p,r=fn(r,e,f),e=r.row,f=r.row+r.rowCount-1,o=r.col,s=r.col+r.colCount-1,u=n.pyt,a=u+n.Sx-1,c=n.byt,h=c+n.Cyt-1,l=n.wyt,v=n.Myt,d=(0,Q.Ec)(u,c,n.Sx,n.Cyt),n=(0,Q.Ec)(l,v,n.Sx,n.Cyt),w=r.getIntersect(n,0,0);if(en(d,r,n,t,i))if(p=_=void 0,C=0!==t)if(p=u<=f&&f<=a,(_=u<=e&&e<=a)&&p)e+=t,f+=t;else if(_&&!p){if(t<=0)e+=t;else if(!(f<u+t)){if(!(a+t<f))return k(r,d,n,t,i);if(u===e)return N(r,d,n,C);e+=t}}else if(!_&&p){if(0<=t)f+=t;else if(!(a+t<e)){if(!(e<l))return k(r,d,n,t,i);if(a===f)return N(r,d,n,C);f+=t}}else w&&!w.equals(n)&&on(r,n)&&(e=(m=y(r,w)).row,f=m.row+m.rowCount-1,o=m.col,s=m.col+m.colCount-1);else if(p=c<=s&&s<=h,(_=c<=o&&o<=h)&&p)o+=i,s+=i;else if(_&&!p){if(i<0)o+=i;else if(!(s<c+i)){if(!(h+i<s))return k(r,d,n,t,i);if(c===o)return N(r,d,n,C);o+=i}}else if(!_&&p){if(0<i)s+=i;else if(!(h+i<o)){if(!(o<v))return k(r,d,n,t,i);if(h===s)return N(r,d,n,C);s+=i}}else w&&!w.equals(n)&&on(r,n)&&(e=(m=y(r,w)).row,f=m.row+m.rowCount-1,o=m.col,s=m.col+m.colCount-1);return{startRow:e,endRow:f,startColumn:o,endColumn:s}}function u(n,t,i,r){return t<i||i+r-1<n}function c(n,t,i,r){return i<=n&&t<=i+r-1}function un(n,t,i,r){return n<i&&i+r-1<t}function an(n,t,i,r){return i===n&&i+r-1<t||n<i&&i+r-1===t}function cn(n,t,i,r){return i<n&&n<=i+r-1&&i+r-1<t||n<i&&i<=t&&t<i+r-1}function I(n,t,i,r,e){return i<=n&&e<=n||t<=i+r-1&&t<=e+r-1}function hn(n,t,i,r,e){for(var f,o,s,f=[u,c,un,an,cn],s=0;s<f.length;s++)if(f[s](n,t,i,r)){o=s+"_";break}if(i===e)o+="9";else for(s=0;s<f.length;s++)if(i!==e&&f[s](n,t,e,r)){o+=s;break}return o}function ln(n,t,i,r,e){return{row:m(n.startRow,t),col:m(n.startColumn,i),endRow:Z(n.endRow,r),endCol:Z(n.endColumn,e)}}function vn(n,t,i,r,e){return n===e.yyt&&e.wyt<=t&&t<=e.Sx+e.wyt-1&&e.Myt<=i&&i<=e.Cyt+e.Myt-1&&(t=t+e.pyt-e.wyt,i=i+e.byt-e.Myt),{startRow:r.row+(r.rowRelative?t:0),endRow:r.endRow+(r.endRowRelative?t:0),startColumn:r.column+(r.columnRelative?i:0),endColumn:r.endColumn+(r.endColumnRelative?i:0)}}function A(n,t,i,r,e,f,o,s,u){return X(f)&&(f=t.startRow),X(o)&&(o=t.startColumn),X(s)&&(s=t.endRow),X(u)&&(u=t.endColumn),(0,K.lJ)(e||n.source,z,n.rowRelative?f-i:f,n.columnRelative?o-r:o,n.endRowRelative?s-i:s,n.endColumnRelative?u-r:u,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,i,r)}function dn(n,t,i,r,e){var f,n,o,s,n,u,a,c,h,l,v,d,f=vn(n,t,i,r,e),n=r.source||n;if(e.gyt===n&&e.yyt===n)switch(n=(o=hn(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))+"-"+(s=hn(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)),u=e.wyt-e.pyt,a=e.Myt-e.byt,c=ln(f,e.pyt,e.byt,e.pyt+e.Sx-1,e.byt+e.Cyt-1),d=v=l=h=void 0,n){case _.outToCover+"-"+_.outToCover:case _.crossToCover+"-"+_.outToCover:case _.outToCover+"-"+_.crossToCover:case _.crossToCover+"-"+_.crossToCover:case _.coverToCover+"-"+_.outToCover:case _.outToCover+"-"+_.coverToCover:case _.coverNoMove+"-"+_.outToCover:case _.outToCover+"-"+_.coverNoMove:return K.kyt;case _.outToCross+"-"+_.outToCover:case _.coverToCross+"-"+_.outToCover:case _.insideToCross+"-"+_.outToCover:case _.partToCross+"-"+_.outToCover:case _.crossToCross+"-"+_.outToCover:case _.crossNoMove+"-"+_.outToCover:case _.outToCross+"-"+_.coverNoMove:case _.outToCross+"-"+_.coverToCover:case _.outToCross+"-"+_.crossToCover:case _.insideToCross+"-"+_.coverNoMove:case _.insideToCross+"-"+_.coverToCover:case _.insideToCross+"-"+_.crossToCover:return e.wyt<=f.startRow?A(r,f,t,i,z,e.wyt+e.Sx):A(r,f,t,i,z,z,z,e.wyt-1);case _.outToCover+"-"+_.outToCross:case _.outToCover+"-"+_.coverToCross:case _.outToCover+"-"+_.insideToCross:case _.outToCover+"-"+_.partToCross:case _.outToCover+"-"+_.crossToCross:case _.outToCover+"-"+_.crossNoMove:case _.coverNoMove+"-"+_.outToCross:case _.coverToCover+"-"+_.outToCross:case _.crossToCover+"-"+_.outToCross:case _.coverNoMove+"-"+_.insideToCross:case _.coverToCover+"-"+_.insideToCross:case _.crossToCover+"-"+_.insideToCross:return e.Myt<f.startColumn?A(r,f,t,i,z,z,e.Myt+e.Cyt):A(r,f,t,i,z,z,z,z,e.Myt-1);case _.partToOut+"-"+_.coverNoMove:case _.crossToOut+"-"+_.coverNoMove:if(!I(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return A(r,f,t,i);case _.coverNoMove+"-"+_.partToOut:case _.coverNoMove+"-"+_.crossToOut:if(o===_.coverNoMove&&!I(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return A(r,f,t,i);case _.crossToInside+"-"+_.coverNoMove:case _.coverNoMove+"-"+_.crossToInside:return f.startRow>=e.pyt&&s===_.coverNoMove||f.startColumn>=e.byt&&o===_.coverNoMove?A(r,f,t,i,z,c.row+u,c.col+a):A(r,f,t,i,z,z,z,c.endRow+u,c.endCol+a);case _.partToInside+"-"+_.coverNoMove:return f.startRow>=e.pyt?A(r,f,t,i,z,Z(c.row+u,c.endRow+1)):A(r,f,t,i,z,z,z,m(c.endRow+u,c.row-1));case _.coverNoMove+"-"+_.partToInside:return f.startColumn>=e.byt&&o===_.coverNoMove?A(r,f,t,i,z,z,Z(c.col+a,c.endCol+1)):A(r,f,t,i,z,z,z,z,m(c.endCol+a,c.col-1));case _.partToCross+"-"+_.coverNoMove:case _.crossToPart+"-"+_.coverNoMove:case _.crossToCross+"-"+_.coverNoMove:if(I(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return f.startRow>=e.pyt?A(r,f,t,i,z,c.row+u):A(r,f,t,i,z,z,z,c.endRow+u);case _.crossToCover+"-"+_.coverNoMove:case _.partToPart+"-"+_.coverNoMove:return e.pyt<e.wyt?A(r,f,t,i,z,Z(c.row+u,c.endRow+1),z,c.endRow+u):A(r,f,t,i,z,c.row+u,z,m(c.endRow+u,c.row-1));case _.coverNoMove+"-"+_.partToCross:case _.coverNoMove+"-"+_.crossToPart:case _.coverNoMove+"-"+_.crossToCross:if(I(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return f.startColumn>=e.byt?A(r,f,t,i,z,z,c.col+a):A(r,f,t,i,z,z,z,z,c.endCol+a);case _.coverNoMove+"-"+_.crossToCover:case _.coverNoMove+"-"+_.partToPart:return e.byt<e.Myt?A(r,f,t,i,z,z,Z(c.col+a,c.endCol+1),z,c.endCol+a):A(r,f,t,i,z,z,c.col+a,z,m(c.endCol+a,c.col-1));case _.crossToCross+"-"+_.coverToCover:case _.crossToPart+"-"+_.coverToCover:case _.partToCross+"-"+_.coverToCover:if(I(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt))return A(r,f,t,i);case _.coverToCover+"-"+_.crossToCross:case _.coverToCover+"-"+_.crossToPart:case _.coverToCover+"-"+_.partToCross:if(o===_.coverToCover&&I(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt))return A(r,f,t,i);case _.coverToCover+"-"+_.partToPart:case _.partToPart+"-"+_.coverToCover:case _.coverToCover+"-"+_.crossToCover:case _.crossToCover+"-"+_.coverToCover:return A(r,f,t,i,z,c.row+u,c.col+a,c.endRow+u,c.endCol+a);case _.partToPart+"-"+_.crossToCover:case _.partToCross+"-"+_.crossToCover:case _.crossToPart+"-"+_.crossToCover:case _.crossToCross+"-"+_.crossToCover:return I(f.startRow,f.endRow,e.pyt,e.Sx,e.wyt)?A(r,f,t,i):(l=c.row===f.startRow?c.col===f.startColumn?(v=f.endColumn,d=c.col+a,h=c.endRow+u,c.row+u):(v=f.startColumn,d=c.endCol+a,h=o===_.partToCross||o===_.crossToCross?e.pyt+u-1:f.endRow,f.startRow):c.col===f.startColumn?(v=f.endColumn,d=c.col+a,h=f.endRow,o===_.partToCross||o===_.crossToCross?e.pyt+e.Sx-1+u+1:f.startRow):(v=f.startColumn,d=c.endCol+a,h=o===_.partToCross||o===_.crossToCross?c.row+u:f.startRow,c.endRow+u),A(r,f,t,i,z,Z(h,l),Z(v,d),m(h,l),m(v,d)));case _.crossToCover+"-"+_.partToPart:case _.crossToCover+"-"+_.partToCross:case _.crossToCover+"-"+_.crossToPart:case _.crossToCover+"-"+_.crossToCross:return I(f.startColumn,f.endColumn,e.byt,e.Cyt,e.Myt)?A(r,f,t,i):(l=c.row===f.startRow?(h=(d=c.col===f.startColumn?(v=c.endCol+a,c.col+a):(v=f.endColumn,s===_.partToCross||s===_.crossToCross?e.byt+e.Cyt-1+a+1:f.startColumn),f.endRow),c.row+u):c.col===f.startColumn?(v=f.startColumn,d=s===_.partToCross||s===_.crossToCross?e.byt+a-1:f.endColumn,h=c.endRow+u,f.startRow):(v=s===_.partToCross||s===_.crossToCross?c.col+a:f.startColumn,d=c.endCol+a,h=f.startRow,c.endRow+u),A(r,f,t,i,z,Z(h,l),Z(v,d),m(h,l),m(v,d)));case _.coverToOut+"-"+_.coverToOut:case _.coverToOut+"-"+_.coverToCross:case _.coverToOut+"-"+_.coverToCover:case _.coverToOut+"-"+_.coverNoMove:case _.coverToCross+"-"+_.coverToOut:case _.coverToCross+"-"+_.coverToCross:case _.coverToCross+"-"+_.coverToCover:case _.coverToCross+"-"+_.coverNoMove:case _.coverToCover+"-"+_.coverToOut:case _.coverToCover+"-"+_.coverToCross:case _.coverToCover+"-"+_.coverToCover:case _.coverToCover+"-"+_.coverNoMove:case _.coverNoMove+"-"+_.coverToOut:case _.coverNoMove+"-"+_.coverToCross:case _.coverNoMove+"-"+_.coverToCover:return A(r,f,t,i,z,f.startRow+u,f.startColumn+a,f.endRow+u,f.endColumn+a);default:return A(r,f,t,i)}}function wn(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,g,A,O,g,b,E,S,f,g,b,x,E,S,f,b,x,u=!!r.source,a=u?r.source:n,g=f&&f.isDataValidator,b=tn(e,n),x=!1,c=r.rowRelative,h=r.columnRelative,l=r.endRowRelative,v=r.endColumnRelative;if(0<=t||!c||!l||0<=i||!h||!v){if(d=r.row+(c?t:0),w=r.endRow+(l?t:0),m=r.column+(h?i:0),_=w-d+1,p=(C=r.endColumn+(v?i:0))-m+1,!g&&b){if(O=e.jyt(a,d,m,_,p))return r.offset(o,s,!0,t,i);if(e.Eyt(a,d,m,_,p))return K.kyt;if(a!==e.gyt||a!==e.yyt||0!==o&&0!==s)return r;x=!0}if(f&&f.isNameID||n===e.gyt&&(A=n===e.yyt?e.Eyt(e.yyt,t,i,1,1):(g=t,b=i,f&&f.crossSheetMoved&&(g-=o,b-=s),e.jyt(e.gyt,g,b,1,1))),(x||n===a&&n===e.gyt&&n===e.yyt)&&(E=t,S=i,A&&(E-=o,S-=s),0===o||0===s)){if(!(f=sn(e,o,s,r,E,S)))return K.kyt;if(0===s&&o&&f.endColumn>=C&&f.startColumn<=m||0===o&&s&&f.endRow>=w&&f.startRow<=d)return g=f.startRow,b=f.startColumn,x=f.endRow,E=f.endColumn,g===d&&x===w&&b===m&&E===C?r:(c&&(g-=t),l&&(x-=t),h&&(b-=i),v&&(E-=i),(0,K.lJ)(r.source,z,g,b,x,E,c,h,l,v,t,i))}if(A&&(S=e.wyt-e.pyt,f=e.Myt-e.byt,_+=(c?-S:0)+(l?S:0),p+=(h?-f:0)+(v?f:0)),a===e.yyt&&e.Eyt(a,d,m,_,p)&&!p&&(!c&&!h&&!l&&!v||!A))return K.kyt;if(g=(u&&a===e.gyt||!u&&n===e.gyt)&&(!A&&e.jyt(e.gyt,d,m,_,p)||A&&e.Eyt(e.yyt,c?d:d+o,h?m:m+s,_,p)),A&&(d-=j=c?o:0,w-=N=l?o:0,m-=k=h?s:0,C-=I=v?s:0),b=!1,g)d+=o,w+=o,m+=s,C+=s;else if(e.Eyt(a,d,m,_,p)){if(!(x=e.intersectWith(a,d,m,_,p))||x.rowCount!==_&&x.colCount!==p)return K.kyt;d=x.row+o,m=x.col+s,w=d+x.rowCount,C=m+x.colCount,b=!0}return w-=l?t:0,m-=h?i:0,C-=v?i:0,e.gyt===e.yyt?a=u?r.source:q:(a=r.source,g&&A&&u?a=e.yyt:g&&A||(g?a=e.yyt:A&&!u&&(a=e.gyt))),(d-=c?t:0)!==r.row||m!==r.column||w!==r.endRow||C!==r.endColumn||b||a!==r.source?(0,K.lJ)(a,z,d,m,w,C,c,h,l,v,t,i):void 0}}function mn(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,w,m,C,v,d,_,p,g,p,_,g,f,g,b,x,m,R,b,x,R,b,g,v,f,d,o,s=!!r.source?r.source:n,u=r.Tyt(),v=t,d=i,_=e.yyt.Mf;if(f&&f.isCustomName&&(p=r.row,g=r.column,v=e.wyt+(p-e.pyt)+_.lT(e.wyt,p-e.pyt+1,!0),d=e.Myt+(g-e.byt)+_.lT(e.Myt,g-e.byt+1)),p=e.Dyt(v),_=e._yt(d),0===u){if(g=!e.Oyt&&dn(n,t,i,r,e))return g;if(g=wn(n,t,i,r,e,f,p,_))return g}else if(1===u){if(a=r.rowRelative,h=r.endRowRelative,0<=t||!a||!h){if(v=r.row+(a?t:0),(d=r.endRow+(h?t:0))<v)return K.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),s===e.gyt&&s===e.yyt&&0===e.byt&&0===e.Myt&&e.Cyt===s.getColumnCount()){if(f=e.pyt,g=e.wyt,C&&(v-=p,d-=p),x=f+(b=e.Sx),R=f<=d&&d<x,(m=f<=v&&v<x)&&R)return C?r:r.offset(p,_,!0,t,i);if(b=g+b,m&&g<=d?(v+=p,d<b&&g<=d&&(d=b-1,v=x)):R&&v<=b&&(d+=p,g<=v)&&w<b&&(v=g,d=f-1),d-=h?t:0,(v-=a?t:0)!==r.row||d!==r.endRow)return(0,K.lJ)(r.source,r.endSource,v,j.BAND_INDEX_CONST,d,j.BAND_INDEX_CONST,a,c,h,l,t,i)}if(C)return r.offset(-p,_,!0,t,i)}}else if(2===u){if(c=r.columnRelative,l=r.endColumnRelative,w=r.column+(c?i:0),(m=r.endColumn+(l?i:0))<w)return K.kyt;if(C=n===e.gyt&&n===e.yyt&&e.Eyt(e.yyt,t,i,1,1),s!==e.gyt||s!==e.yyt)return r.offset(p,-_,!1,t,i);if(0===e.pyt&&0===e.wyt&&e.Sx===s.getRowCount()){if(x=e.byt,R=e.Myt,C&&(w-=c?_:0,m-=l?_:0),g=x+(b=e.Cyt),f=x<=m&&m<g,(v=x<=w&&w<g)&&f)return C&&c&&l?r:r.offset(p,_,!0,t,i);if(d=R+b,v&&R<=m)w+=_,m<d&&R<=m&&(m=d-1,w=g);else if(f&&w<=d)m+=_,R<=w&&w<d&&(w=R,m=x-1);else if(C)return r.offset(-p,-_,!1,t,i);if(m-=l?i:0,(w-=c?i:0)!==r.column||m!==r.endColumn)return(0,K.lJ)(r.source,r.endSource,j.BAND_INDEX_CONST,w,j.BAND_INDEX_CONST,m,a,c,h,l,t,i)}if(C)return r.offset(p,-_,!0,t,i)}return r}function J(n,t,i,r,e,f,o){var s,u,a,c,h,l,v,d,w,s=J,u=r;if(1===r.type&&r.hmt())u=f?rn(n,t,i,r,e,o):_n(n,t,i,r,e);else if(1===r.type)u=f?mn(n,t,i,r,e,o):pn(n,t,i,r,e);else if(10===r.type)(a=s(n,t,i,r.value,e,f,o))!==r.value&&(u=(0,K.Ayt)(a));else if(9===r.type)c=s(n,t,i,r.value,e,f,o),h=r.value2&&s(n,t,i,r.value2,e,f,o),c===r.value&&h===r.value2||(u=(0,K.rbt)(r.operatorType,c,h));else if(7===r.type){for(l=z,d=v=void 0,w=r.arguments.length,d=0;d<w;d++)if((a=s(n,t,i,v=r.arguments[d],e,f,o))!==v){(l=[])[d]=a;break}if(l){for(d=0;d<w;d++)v=r.arguments[d],l[d]!==q&&l[d]!==z||(l[d]=s(n,t,i,v,e,f,o));u=(0,K.YJ)(r,l)}(0,K.isExpression)(r.function)&&(u.function=s(n,t,i,r.function,e,f,o))}return u}function Cn(n,t,i){var r,e,f,o,s,s,u,a,c,h,s,l,v,d,r=t.gyt.getSheet();if(!0!==r.EB)for(e=r.Ut.pj(),f=0;f<n.length;f++)if(s=(o=n[f].validator)._S,u=(s=S(s)).r,a=s.c,h=(c=n[f].sheet).Uw(),(l=(s=o.condition()).getExpressions())&&0<l.length){for(v=0;v<l.length;v++)d=l[v],l[v]=J(h,u,a,d,t,i,{isDataValidator:!0});s.setExpressions(l,e)}}function _n(n,t,i,r,e){var f,o,s,u,a,c,h,f=r.source||n,o=r.rowRelative,s=r.columnRelative,c=e.Dyt(t),h=e._yt(i);if((0<=t||!o)&&(0<=i||!s)){if(u=r.row+(o?t:0),a=r.column+(s?i:0),e.Eyt(n,t,i,1,1)?(u-=o?c:0,a-=s?h:0):e.jyt(n,u,a,1,1)&&(u+=o?c:0,a+=s?h:0),e.jyt(f,u,a,1,1)?(u+=c,a+=h):e.Eyt(f,u,a,1,1)&&(u-=c,a-=h),a-=s?i:0,(u-=o?t:0)!==r.row||a!==r.column)return(0,K.knt)(r.source,z,u,a,o,s)}else if((0<=t||!o)&&-1===i){if(u=r.row+(o?t:0),e.Eyt(n,t,-1,1,-1)?u-=o?c:0:e.jyt(n,u,-1,1,-1)&&(u+=o?c:0),e.jyt(f,u,-1,1,-1)?u+=c:e.Eyt(f,u,-1,1,-1)&&(u-=c),(u-=o?t:0)!==r.row||a!==r.column)return(0,K.knt)(r.source,z,u,r.column,o,r.columnRelative)}else if(-1===t&&0<=i&&!s&&(a=r.column+0,e.Eyt(n,-1,i,-1,1)?a-=0:e.jyt(n,-1,a,-1,1)&&(a+=0),e.jyt(f,-1,a,-1,1)?a+=h:e.Eyt(f,-1,a,-1,1)&&(a-=h),a-=0,u!==r.row||a!==r.column))return(0,K.knt)(r.source,z,r.row,a,r.rowRelative,s);return r}function pn(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,f=r.source||n,o=r.Tyt(),R=e.Dyt(t),y=e._yt(i);if(0===o){if(v=r.rowRelative,d=r.columnRelative,w=r.endRowRelative,m=r.endColumnRelative,!(0<=t)&&v&&w||!(0<=i)&&d&&m)if(!(0<=t)&&v&&w||-1!==i){if(-1===t&&(0<=i||!d||!m)){if((a=r.column+(d?i:0))<(c=r.endColumn+(m?i:0)))return K.kyt;if(e.Eyt(n,-1,i,-1,1)?(a-=g=d?y:0,c-=x=m?y:0):e.jyt(n,-1,i,-1,1)&&(a+=g=d?y:0,c+=x=m?y:0),e.jyt(f,-1,a,-1,l=c-a)?(a+=_=y,c+=_):e.Eyt(f,-1,a,-1,l)&&(a-=_=y,c-=_),c-=m?i:0,(a-=d?i:0)!==r.column||c!==r.endColumn)return(0,K.lJ)(r.source,z,a,r.endRow,c,r.rowRelative,d,r.endRowRelative,m,t,i)}}else{if((s=r.row+(v?t:0))<(u=r.endRow+(w?t:0)))return K.kyt;if(e.Eyt(n,t,-1,1,-1)?(s-=p=v?R:0,u-=b=v?R:0):e.jyt(n,t,-1,1,-1)&&(s+=p=v?R:0,u+=b=v?R:0),e.jyt(f,s,-1,h=u-s,-1)?(s+=C=R,u+=C):e.Eyt(f,s,-1,h,-1)&&(s-=C=R,u-=C),u-=w?t:0,(s-=v?t:0)!==r.row||u!==r.endRow)return(0,K.lJ)(r.source,z,s,r.column,u,r.endColumn,v,r.columnRelative,w,r.endColumnRelative,t,i)}else if(s=r.row+(v?t:0),u=r.endRow+(w?t:0),a=r.column+(d?i:0),h=u-s,l=(c=r.endColumn+(m?i:0))-a,e.Eyt(n,t,i,1,1)?(s-=p=v?R:0,u-=b=w?R:0,a-=g=d?y:0,c-=x=m?y:0):e.jyt(n,s,a,h,l)&&(s+=p=v?R:0,u+=b=w?R:0,a+=g=d?y:0,c+=x=m?y:0),e.jyt(f,s,a,h,l)?(s+=C=R,u+=C,a+=_=y,c+=_):e.Eyt(f,s,a,h,l)&&(s-=C=R,u-=C,a-=_=y,c-=_),u-=w?t:0,a-=d?i:0,c-=m?i:0,(s-=v?t:0)!==r.row||a!==r.column||u!==r.endRow||c!==r.endColumn)return(0,K.lJ)(r.source,z,s,a,u,c,v,d,w,m,t,i)}else if(1===o){if(v=r.rowRelative,w=r.endRowRelative,0<=t||!v||!w){if((s=r.row+(v?t:0))<(u=r.endRow+(w?t:0)))return K.kyt;if(e.Eyt(n,t,-1,1,-1)?(s-=p=v?R:0,u-=b=w?R:0):e.jyt(n,t,-1,1,-1)&&(s+=p=v?R:0,u+=b=w?R:0),e.jyt(f,s,-1,h=u-s,-1)?(s+=C=R,u+=C):e.Eyt(f,s,-1,h,-1)&&(s-=C=R,u-=C),u-=w?t:0,(s-=v?t:0)!==r.row||u!==r.endRow)return(0,K.lJ)(r.source,z,s,j.BAND_INDEX_CONST,u,j.BAND_INDEX_CONST,v,!1,w,!1,t,i)}}else if(2===o){if(d=r.columnRelative,m=r.endColumnRelative,a=r.column+(d?i:0),(c=r.endColumn+(m?i:0))<a)return K.kyt;if(e.Eyt(n,-1,i,-1,1)?(a-=g=d?y:0,c-=x=m?y:0):e.jyt(n,-1,i,-1,1)&&(a+=g=d?y:0,c+=x=m?y:0),e.jyt(f,-1,a,-1,l=c-a)?(a+=_=y,c+=_):e.Eyt(f,-1,a,-1,l)&&(a-=_=y,c-=_),c-=m?i:0,(a-=d?i:0)!==r.column||c!==r.endColumn)return(0,K.lJ)(r.source,z,j.BAND_INDEX_CONST,a,j.BAND_INDEX_CONST,c,!1,d,!1,m,t,i)}return r}function G(n,t,i,r,e,f){n.Ryt(t,i,r,e,!0,!1,f)}function gn(n,t,i){var r,e,f,o,s,u,a,c,h,r=gn,e=t;if(8===t.type){if(t.value===i&&(!t.source||t.source===n.getSource()))return(0,K.Syt)(g,t.source)}else if(10===t.type)(f=r(n,t.value,i))!==t.value&&(e=(0,K.Ayt)(f));else if(9===t.type)u=r(n,t.value,i),a=t.value2&&r(n,t.value2,i),u===t.value&&a===t.value2||(e=(0,K.rbt)(t.operatorType,u,a));else if(7===t.type){for(c=z,h=t.arguments.length,s=0;s<h;s++)if((f=r(n,o=t.arguments[s],i))!==o){(c=[])[s]=f;break}if(c){for(s=0;s<h;s++)o=t.arguments[s],c[s]!==q&&c[s]!==z||(c[s]=r(n,o,i));e=(0,K.YJ)(t,c)}}return e}Object.defineProperty(n,"__esModule",{value:!0}),n.adjustFormulaOnMoveSwap=n.CalcOperatorAdjustor=n.MoveSwapInfo=void 0,K=t("CalcEngine"),i=t("Common"),j=t("./dist/plugins/sheetsCalc/calc.ns.js"),R=t("./dist/plugins/sheetsCalc/parser-sheets.js"),Q=t("Core"),o=i.Common.lt.Dh,X=i.Common.lt.ht,t=i.Common.zf,w=t.Gmt,Z=Math.min,m=Math.max,q=void 0,z=null,C=K.Convert.BJ,g=K.Errors.Reference,S=Q.util.z0,e.prototype.Dyt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.wyt+1,i=i.ix(t.wyt,n,!0),t.wyt-t.pyt+i):t.wyt-t.pyt},e.prototype._yt=function(n){var t,i,n,i,t=this,i=t.yyt.Mf;return t.Oyt=i&&i.o5(),t.Oyt&&0<=n?(n=n-t.Myt+1,i=i.ix(t.Myt,n),t.Myt-t.byt+i):t.Myt-t.byt},e.prototype.jyt=function(n,t,i,r,e){var f=this;return f.gyt===n&&(-1===f.pyt||f.pyt<=t&&t+r<=f.pyt+f.Sx)&&(-1===f.byt||f.byt<=i&&i+e<=f.byt+f.Cyt)},e.prototype.Eyt=function(n,t,i,r,e){var f,o,s,u,a,c,h,f=this,o=f.yyt.Mf,s=o&&o.o5(),u=f.wyt,a=f.Myt,c=f.Sx,h=f.Cyt;return s&&(c+=o.lT(u,c,!0),h+=o.lT(a,h)),f.yyt===n&&(-1===u||u<=t&&t+r<=u+c)&&(-1===a||a<=i&&i+e<=a+h)},e.prototype.intersectWith=function(n,t,i,r,e){var f,t,o,f=this;return f.yyt!==n?z:(t=f.Byt(n,t,i,r,e),(o=f.Byt(n,f.pyt,f.byt,r,e)).intersectWith(t))},e.prototype.Byt=function(n,t,i,r,e){var f,o,s,u,f,o,s,u;return{row:-1===t?0:t,column:-1===i?0:i,rowCount:-1===t||-1===r?n.rowCount:r,columnCount:-1===i||-1===e?n.colCount:e,intersectWith:a}},Y=e,n.MoveSwapInfo=Y,nn.gB=function(n,t,i,r,e,f,o,s,u,a,c){var h,l,v,d,w,m,C,_,p,h=i,l=nn,v=this.gB;if(i)if(10===(m=i.type))h=(0,K.Ayt)(v.call(l,n,t,i.value,r,e,f,o,s,u,a,c));else if(1===m&&i.hmt()){if(d=Z((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=Z((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&(i.row+r<0||i.row+r>=d)||i.columnRelative&&(i.column+e<0||i.column+e>=w))return(0,K.Syt)(g,i.source);h=i.offset(0,0,!1)}else if(1===m){if(d=Z((i.source||t).getRowCount(),j.MAX_ROW_COUNT),w=Z((i.source||t).getColumnCount(),j.MAX_COLUMN_COUNT),i.rowRelative&&!i.isFullColumn&&(i.row+r<0||i.row+r>d)||i.columnRelative&&!i.isFullRow&&(i.column+e<0||i.column+e>w)||i.endRowRelative&&!i.isFullColumn&&(i.endRow+r<0||i.endRow+r>d)||i.endColumnRelative&&!i.isFullRow&&(i.endColumn+e<0||i.endColumn+e>w))return(0,K.Syt)(g,i.source,i.endSource);h=i.offset(0,0,!1,r,e)}else if(9===i.type)h=(0,K.rbt)(i.operatorType,v.call(l,n,t,i.value,r,e,f,o,s,u,a,c),i.value2&&v.call(l,n,t,i.value2,r,e,f,o,s,u,a,c));else if(7===m){if(_=[],i.arguments&&0<i.arguments.length)for(p=0;p<i.arguments.length;p++)_[p]=v.call(l,n,t,i.arguments[p],r,e,f,o,s,u,a,c);h=(0,K.YJ)(i,_)}else 13===m&&(h=i.offsetWhenCopy(n,t,r,e,f,o,s,u,a,c));return h},nn.copyFormula=function(n,t,i,r,e,f,T,Y,L,X,V){var J,o,G,s,P,u,a,c,h,l,v,d,w,m,C,_,p,g,b,H,x,U,B,R,y,j,N,k,$,W,I,A,O,E,E,E,E,S,M,E,D,D,F,F,J=n,o=r,G=n.getSource(),s=r.getSource(),P=nn;if(J&&o){for(u=s&&s.getSheet().Ut.pj(),c=i,h=e,l=f,v=T,d=Y,(a=t)<0&&(a=0,v=Z(n.rC(),r.rC())),i<0&&(c=0,d=Z(n.cC(),r.cC())),e<0&&(h=0),f<0&&(l=0),w=new K.CalcSourceModel(n.op(),G),g=s.getSheet(),b=!X&&g.o5(),H=v,x=d,U=g.getRowCount(),B=g.getColumnCount(),m=0;m<v;m++)for(C=0;C<d;C++)J.Lyt(w,m+a,C+c,m,C);for(R={},y=r.op(),_=m=0;m<v&&m+h<U;m++)if(j=m+h,b&&0===g.getRowHeight(j))v++;else{if(!L||!s.isHiddenRow(j,!0))for(p=C=0,d=x;C<d&&C+l<B;C++)if(N=C+l,b&&0===g.getColumnWidth(N))d++;else{if(k=w.pB(_,p)){if(k===R)continue;if(k=P.gB(G,s,k,j,N,$=e+m-t-_,W=f+C-i-p,e,f,H,x),I=w.sT(_,p),s){if(b&&I)continue;if(I&&!I.isDynamicArray){for(A=I.rowCount,O=I.colCount,0<(E=a-I.row)&&(A-=E),(E=v-m)<A&&(A=E),0<(E=c-I.col)&&(O-=E),(E=d-C)<O&&(O=E),S=0;S<A;S++)for(M=0;M<O;M++)w.bB(m+S,C+M,R);r.setArrayFormula(j,N,A,O,y.unparse(s,k,j,N),q,u)}else E=w.Ile(_,p),V&&g&&E&&(g.vle=E),D=k?y.unparse(s,k,j,N):q,s.setFormula(j,N,D,q),E&&g.Ut.setDefaultValue(j,N,D,z,Q.DefaultChangeValueType.Expression,z,!0),(D=w.Fyt(_,p))&&(F=new K.EvaluateContext(s,(0,K.eV)(j,N),!1),D=(D=o.Lbt.allowDynamicArray?(0,K.h0t)(F,k,!1,0,0,!0,!0):(0,K.Pyt)(F,k,!1,0,0,!1,!1))===k?q:D),o.Gyt(j,N,k,D,I,u),E&&(delete g.vle,F=r.oT(j,N))&&F.isDefault(E)}else o.bB(j,N,k),o.Uyt(j,N,I)}else o&&o.pB(j,N)&&o.Gyt(j,N,q,q,q,u);p++}_++}}},nn.moveFormula=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,T,v,d,w,m,n,C,_,p,g,b,x,R,y,j,Y,N,k,I,A,O,L,E,S,M,D,F,D,m,n,u=n.b3(),a=r.b3(),c=u.op();if(u&&a){for(h=r.getRowCount(),l=r.getColumnCount(),T=u.pj(),v=a.pj(),d=c.Hyt(),t<0&&(t=0,o=Z(n.getRowCount(),h)),e<0&&(e=0),i<0&&(i=0,s=Z(n.getColumnCount(),l)),f<0&&(f=0),w=!(n===r&&n.name()===r.name()),n=s,C=m=o,(p=r.o5())&&(m+=r.lT(e,o,!0),n+=r.lT(f,s)),u.mF(t,i,o,s),G(u,t,i,o,s),a.mF(e,f,m,n),G(a,e,f,m,n),g=[],b=0;b<o;b++)for(A=b+t,x=0;x<s;x++)R=u.pB(A,O=x+i),y=u.sT(A,O),j=u.Fyt(A,O),N=(Y=u.oT(A,O))&&Y.isDefault(),R&&(g[b*s+x]={WK:R,$bt:y,eyt:j,xle:N},u.zyt(A,O,T),y&&(A!==y.row||O!==y.col)||u.rT.setFormula(A,O,z,q));for(E=w?{}:null,k=b=0;b<C&&b+e<h;b++)if(S=b+e,p&&0===r.getRowHeight(S))C++;else{for(I=x=0,_=s;x<_&&f+x<l;x++)if(M=x+f,p&&0===r.getColumnWidth(M))_++;else{if(D=g[k*s+I]){if(R=D.WK,y=D.$bt,p&&y){I++;continue}c&&y&&!y.isDynamicArray&&y.row===t+b&&y.col===i+x&&(L=(0,Q.Ec)(S,M,y.rowCount,y.colCount)),F=y&&!y.isDynamicArray?L:q,j=D.eyt,(N=D.xle)&&(r.vle=N),a.Vyt(v,S,M),a.bB(S,M,R),a.Uyt(S,M,F),a.Yyt(S,M,j),a.Nle(S,M,N),(!F||F.row===S&&F.col===M)&&(D=a.getFormula(S,M),a.rT.setFormula(S,M,D,F),N)&&r.Ut.setDefaultValue(S,M,D,z,Q.DefaultChangeValueType.Expression,z,!0),w&&(E[S+", "+M]=R),N&&delete r.vle}else X(a.pB(S,M))||(a.Vyt(v,S,M),a.bB(S,M,q),a.Uyt(S,M,q));I++}k++}d.Zyt(u,t,i,o,s),d.Zyt(a,e,f,m,n),n=(m=u.getSource().getSheet()).b8&&(m.parent||m).xyt(),d.Wyt(n,u.getSource(),t,i,a.getSource(),e,f,o,s,!0,E),!0==w&&d.Wyt(n,u.getSource(),t,i,a.getSource(),e,f,o,s,!0,E)}},nn.prototype.isAdjustCell=function(n){return n.preAdj||this.y3&&n===this.y3[0]},nn.prototype.isAdjust=function(n){return n.preAdj||this.y3&&n===this.y3[0]},nn.prototype.Qyt=function(n,t){var i=this,r,e;isNaN(t)||(i.y3||(i.y3={},i.Kyt={}),r=i.y3[t],e=i.Kyt[t],n&&!n.preAdj&&n!==r&&(r?e.nextAdj=n:i.y3[t]=n,n.preAdj=e,n.nextAdj=z,i.Kyt[t]=n))},nn.prototype.Jyt=function(n,t){var i,r,r,e,i=this;isNaN(t)||(r=i.y3&&i.y3[t],n&&(n.preAdj||n===r)&&(r=n.preAdj,e=n.nextAdj,r?r.nextAdj=e:i.y3[t]=e,e?e.preAdj=r:i.Kyt[t]=r,n.preAdj=z,n.nextAdj=z))},nn.prototype.Xyt=function(n,t,i,r,e,f,o){this.qyt(n,x,t,i,r,e,f,o);var s=0,u=0,a=0,c=0;0===t&&(r&&e?a=i:r?s=i:e?c=i:u=i),h(n,x,t,i,s,u,a,c,r,e,f),v(n,x,t,i,r,e),U(n,x,t,i,r,e,o)},nn.prototype.qyt=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,g,u,R,y,j,N,k,I,A,O,E,a=this,c=a.y3;if(c){for(_={};c[0];){if(C=(h=(w=c[0]).w3).pj(),m=h.getSource(),V(_,l=w.row,v=w.column));else{if(!(d=h.pB(l,v))||t===D&&m===n)(h.getRowExpression&&h.getRowExpression(l)||h.getColumnExpression&&h.getColumnExpression(v))&&h.gF(l,v,1,1);else if(d=t.call(a,m,l,v,d,n,i,r,e,f,q,o,s),p=h.sT(l,v)){if(m===n&&(g=f?r:-r,e?i<=p.row&&(p.row+=g):i<=p.col&&(p.col+=g)),l===p.row&&v===p.col)if(p.isDynamicArray)h.SB(l,v,d,p,!0,M(e?l:v,i,C,n.id===m.id));else for(b=l;b<l+p.rowCount;b++)for(_[b]||(_[b]={}),x=v;x<v+p.colCount;x++)h.SB(b,x,d,p,b===l&&x===v,M(e?b:x,i,C,n.id===m.id)),L(_,b,x,!0)}else g=m.Mf,(u=!s&&(null==(u=h.oT(l,v))?void 0:u.isDefault()))&&(g.vle=u),h.SB(l,v,d,p,!0,M(e?l:v,i,C,n.id===m.id),z,z,s),u&&(R=m.nT,y=h.op().unparse(m,d,l,v),g.Ut.setDefaultValue(l,v,y,R,Q.DefaultChangeValueType.Expression,z,!0),delete g.vle)}a.Jyt(w,0)}for(;c[1];)C=(h=(w=c[1]).w3).pj(),l=w.row,h.getRowExpression&&(d=h.getRowExpression(l))&&h.SB&&(m=h.getSource(),h.SB(l,-1,t.call(a,m,l,-1,d,n,i,r,e,f),q,!0,M(l,i,C,n.id===m.id))),a.Jyt(w,1);for(;c[2];)C=(h=(w=c[2]).w3).pj(),v=w.column,h.getColumnExpression&&(d=h.getColumnExpression(v))&&h.SB&&(m=h.getSource(),h.SB(-1,v,t.call(a,m,-1,v,d,n,i,r,e,f),q,!0,M(v,i,C,n.id===m.id))),a.Jyt(w,2);for(;c[3];)N=(j=c[3]).name,d=(h=j.w3).$yt(N),k=t.call(a,h.getSource(),0,0,d,n,i,r,e,f,{isNameID:!0}),h.twt(N,k),a.Jyt(j,3);for(I in c)if(3<(A=+I)&&c.hasOwnProperty(I))for(;c[I];)E=(O=c[I]).w3,d=t.call(a,E,0,0,O.expression,n,i,r,e,f),E.setExpression(O.id,O.name,d),a.Jyt(O,A)}},nn.prototype.nwt=function(n){var t=this,i,r,e;G(n.getCalcSourceModel(),0,0,n.getRowCount(),n.getColumnCount()),t.qyt(n,D),h(n,D,0,0,0,0,0,0,!0,!1),v(n,D,0,0,!0,!1)},nn.prototype.Wyt=function(n,t,i,r,e,f,o,s,T,u,a){var c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,j,y,N,k,y,c,I,A,O,E,S,M,D,F,h=this,l=J,v=new Y(t,i,r,e,f,o,s,T),p={};if(n&&Cn(n,v,u),H(t,v,u),R={},b=h.y3){for(;b[0];){if(d=(w=b[0]).w3,m=w.row,C=w.column,g=d.pj(),V(p,m,C));else{if(_=d.pB(m,C),x=d.getSource(),_)if(y=q,a&&a[m+", "+C]&&(x=t,y={crossSheetMoved:!0}),_=l.call(h,x,m,C,_,v,u,y),y=void 0,(j=d.sT(m,C))&&!j.isDynamicArray)if(y=P(j),m===j.row&&C===j.col)for(R[y]=!0,N=m;N<m+j.rowCount;N++)for(p[N]||(p[N]={}),k=C;k<C+j.colCount;k++)d.SB(N,k,_,j,N===m&&k===C,g),L(p,N,k,!0);else R[y]||(d.SB(m,C,_,j,!1,g),L(p,m,C,!0));else y=e.Mf,(c=null==(c=d.oT(m,C))?void 0:c.isDefault())&&(y.vle=c),d.SB(m,C,_,j,!0,g),c&&delete y.vle;else(d.getRowExpression&&d.getRowExpression(m)||d.getColumnExpression&&d.getColumnExpression(C))&&d.gF(m,C,1,1)}h.Jyt(w,0)}for(;b[1];)d=(w=b[1]).w3,m=w.row,g=d.pj(),d.getRowExpression&&(_=d.getRowExpression(m))&&d.ewt&&d.ewt(m,l.call(h,x,m,-1,_,v,u),q,g),h.Jyt(w,1);for(;b[2];)d=(w=b[2]).w3,C=w.column,g=d.pj(),d.getColumnExpression&&(_=d.getColumnExpression(C))&&d.iwt&&d.iwt(C,l.call(h,x,-1,C,_,v,u),q,g),h.Jyt(w,2);for(;b[3];)A=(I=b[3]).name,_=(d=I.w3).$yt(A),O=l.call(h,x,0,0,_,v,u),d.twt(A,O),h.Jyt(I,3);for(E in b)if(3<(S=+E)&&b.hasOwnProperty(E))for(;b[E];)F=(D=(M=b[E]).w3).getSource(),_=l.call(h,F,0,0,M.expression,v,u),D.setExpression(M.id,M.name,_),h.Jyt(M,S)}},nn.prototype.Zyt=function(n,t,i,r,e){for(var f,o,s,u,a,c,h,l,f=this,o=t+r,s=i+e,c=t;c<o;c++)if(n.dataTable[c])for(h=i;h<s;h++)u=n.rwt(c,h),a=n.pB(c,h),(u||a)&&(f.Jyt(u,0),n.owt(c,h,0),l=n.oT(c,h,!0),u&&a&&(u.row!==l.row||u.column!==l.column||u.isDefault())&&(l.oldRow=u.row,l.oldColumn=u.column,l.isDefault(u.isDefault())),f.Qyt(l,0))},nn.prototype.awt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(-1,e)||n.pB(-1,e))&&(n.owt(-1,e,2),f=n.uwt(e,!0),r.Qyt(f,2))},nn.prototype.swt=function(n,t,i){for(var r,e,f,r=this,e=t;-1!==e&&e<t+i;e++)(n.rwt(e,-1)||n.pB(e,-1))&&(n.owt(e,-1,1),f=n.cwt(e,!0),r.Qyt(f,1))},nn.prototype.fwt=function(n){for(var t,i,r,e,f,o,s,t=this,i=n.op().getAllSourceModels(),f=0;f<i.length;f++)if((o=i[f]).lwt)for(r=o.lwt(),s=0;s<r.length;s++)(e=r[s])&&e.isVolatile&&e instanceof K.CellCalc&&!t.isAdjustCell(e)&&t.Qyt(e,0)},nn.prototype.onBeforeAddRemoveRows=function(n,r,t){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),n.mF(r,0,t-r,i),n.hwt(r,t-r),G(n,r,-1,t-r,-1,!0))})},nn.prototype.onAfterAddRemoveRows=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(r,0,e,i):t+=e,o.Zyt(n,r,0,t-r,i),o.swt(n,r,t-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!0,f,q,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},nn.prototype.onAfterAddRemoveColumns=function(n,r,e,f,t,i){var o=this;[n,i].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),f?n.gF(0,r,t,e):i+=e,o.Zyt(n,0,r,t,i-r),o.awt(n,r,i-r),o.fwt(n))}),o.Xyt(n.getSource(),r,e,!1,f,q,t),1!==n.op().calculationMode&&n.op().recalculateAll(!1)},nn.prototype.onBeforeAddRemoveColumns=function(n,r,t){[n,t].forEach(function(n){var t,i;n&&(t=n.rC(),i=n.cC(),n.mF(0,r,t,i-r),n.dwt(r,i-r),G(n,-1,r,-1,i-r,!0))})},nn.prototype.onAfterRemoveName=function(n,t){var n=n.vwt(t,!1);n&&(n.updateListening(!0,!1),n.vyt(),n.updateListeningOnRemoved())},nn.prototype.adjustFormulaOnRemoveName=gn,nn.prototype.invalidName=function(n,t){var i,n;t&&(n=(i=n.getCalcSourceModel()).vwt(t.toUpperCase(),!0))&&n.mB()},nn.prototype.onAfterRemoveTable=function(n,t){for(var i,r,e,f,o,s,u,a,c,h,l,v,d,i=this,s=0;s<n.length;s++)G((u=n[s]).source().getCalcSourceModel(),u.startRow(),u.startColumn(),u.endRow()-u.startRow()+1,u.endColumn()-u.startColumn()+1);if(a=i.y3)for(c={};a[0];){if(r=(h=a[0]).w3,V(c,e=h.row,f=h.column));else{if(o=r.pB(e,f))if(o=nn.adjustExpressionOnRemoveTable(o,n,e,f,t),(l=r.sT(e,f))&&!l.isDynamicArray)for(l=(0,Q.Ec)(e,f,l.rowCount,l.colCount),v=e;v<e+l.rowCount;v++)for(c[v]||(c[v]={}),d=f;d<f+l.colCount;d++)r.SB(v,d,o,l,v===e&&d===f),L(c,v,d,!0);else r.SB(e,f,o,l,!0);else(r.getRowExpression&&r.getRowExpression(e)||r.getColumnExpression&&r.getColumnExpression(f))&&r.gF(e,f,1,1)}i.Jyt(h,0)}},nn.adjustExpressionOnRemoveTable=function(n,t,i,r,e){var f,o,s,u,a,c,h,l,v,d,w,o,s,m,C,_,p,g,f=nn.adjustExpressionOnRemoveTable;if(9===n.type){if(o=n.value,s=n.value2,u=f(o,t,i,r,e),a=s&&f(s,t,i,r,e),o!==u||s!==a)return(0,K.rbt)(n.operatorType,u,a)}else if(7===n.type){for(c=!1,h=[],l=0;l<n.arguments.length;l++)d=f(v=n.arguments[l],t,i,r,e),c=c||v!==d,h.push(d);if(c)return(0,K.YJ)(n,h)}else if(10===n.type){if((o=n.value)!==(s=f(o,t,i,r,e)))return(0,K.Ayt)(s)}else if(13===n.type)for(m=n,l=0;l<t.length;l++)if(m.baseTable===t[l])return e?K.kyt:(C=m.getRange(-1===i?0:i,-1===r?0:r,!0),_=-1===i||1===m.referencePortions(),p=1===C.rowCount&&1===C.columnCount,g=m.source,p?(0,K.knt)(g,z,C.row,C.col,_,!1):(0,K.lJ)(g,z,C.row,C.col,C.row+C.rowCount-1,C.col+C.colCount-1,_,!1,_,!1));return n},r=nn,n.CalcOperatorAdjustor=r,(s=K.CalcService.prototype).mwt=function(){return new r},(i=_=_||{}).outToOut="0_0",i.outToCover="0_1",i.outToInside="0_2",i.outToPart="0_3",i.outToCross="0_4",i.outNoMove="0_9",i.coverToOut="1_0",i.coverToCover="1_1",i.coverToCross="1_4",i.coverNoMove="1_9",i.insideToOut="2_0",i.insideToInside="2_2",i.insideToPart="2_3",i.insideToCross="2_4",i.insideNoMove="2_9",i.partToOut="3_0",i.partToInside="3_2",i.partToPart="3_3",i.partToCross="3_4",i.partNoMove="3_9",i.crossToOut="4_0",i.crossToCover="4_1",i.crossToInside="4_2",i.crossToPart="4_3",i.crossToCross="4_4",i.crossNoMove="4_9",n.adjustFormulaOnMoveSwap=J},"./dist/plugins/sheetsCalc/parser-sheets.js":function(T,d,n){var t,v,b,A,m,x,R,y,i,n,r,w,C,j,c,_,Y,o,s,a,L,h,e,f,n,n,u,l;function X(n){return i(n+1).split("")}function V(n,t){var i=t+1;return n<0?n%i+i:t<n?n%i:n}function J(n){return new A.ErrorSource(n)}function G(n,t,i,r,e,f,o){return 3===o||0<=i&&0<=r||1===o&&0<=i||2===o&&0<=r}function P(n,t,i,r,e){var f,f,o,o,o,f=x.BAND_INDEX_CONST,f={Ky:f,iw:f,gwt:!0,pwt:!0,bwt:!1,ywt:0,wwt:!0},o=t?$(n,i,r,0):B(n,0,e);if(o.DX?(f.Ky=o.Mwt,f.gwt=o.Cwt):(f.iw=o.Mwt,f.pwt=o.Cwt),f.ywt=o.ywt,f.bwt=o.bwt,o.bwt&&!(o.ywt>=n.length)){if(!t&&o.DX||t&&!o.DX)return{bwt:!1};if(o=n[f.ywt],(t||!(0,A.isNumber)(o)&&"$"!==o)&&(!t||"C"!==o&&"c"!==o))return{bwt:!1};o=t?$(n,i,r,f.ywt):B(n,f.ywt,e),f.ywt=o.ywt,!o.bwt||!t&&!o.DX||t&&o.DX?f.bwt=!1:(f.ywt<n.length&&(f.wwt=!1),t?(f.iw=o.Mwt,f.pwt=o.Cwt):(f.Ky=o.Mwt,f.gwt=o.Cwt),f.bwt=!0)}return f}function H(n){return(0,A.Swt)(n)||95===n.charCodeAt(0)}function U(n,t,i){for(var r=n,e=t[n],n=!1;r<i&&!H(e);)++r<i&&(e=t[r]);if(r<i){for(;r<i&&H(e);)++r<i&&(e=t[r]);r<i&&(n=!0)}return n}function B(n,t,i){var r,e,f,o,s,u,a,c,h,l,v,r={Cwt:!0,bwt:!1},e=n.length;if(!(e<=t||("$"===n[t]&&(r.Cwt=!1,t++),e<=t)))if(s=n[f=t],(o=0,A.isNumber)(s)&&"0"!==s){for(r.DX=!0;f<e&&(0,A.isNumber)(s);)++f<e&&(s=n[f]);if(7<f-t)return r;for(u=f-1,a=0;t<=u;u--,a++)o+=(n[u].charCodeAt(0)-48)*_[a];if(o<=d.maxRowCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}else if((0,A.Swt)(s)){for(r.DX=!1;f<e&&(0,A.Swt)(s);)++f<e&&(s=n[f]);if(3<(c=f-t)||U(f,n,e))return r;for(l=h=f-1;t<=l;l--){if(!(65<=(v=n[l].charCodeAt(0))&&v<=90||97<=v&&v<=122))return r;o+=((32|v)-96)*w[h-l]}if(o<=d.maxColumnCount)r.Mwt=o-1,r.ywt=f,r.bwt=!0}return r}function $(n,t,i,r){var e,f,o,s,u,a,t,i,e,f={ywt:r,Mwt:x.BAND_INDEX_CONST,DX:!0,Cwt:!1,bwt:!1},o=n.length;if(o<=r)return f;if("R"===(u=n[s=r])||"r"===u)f.DX=!0,a=t;else{if("C"!==u&&"c"!==u)return f;f.DX=!1,a=i}if(s++,o<=++r)return f.ywt=r,f.Mwt=a,f.Cwt=!0,f.bwt=!0,f;if("["===(u=n[s])&&(r++,s++,f.Cwt=!0),o<=r)return f;if(t=!1,u=n[s],f.Cwt&&"-"===u&&(r++,s++,t=!0),o<=r)return f;if(u=n[s],!(0,A.isNumber)(u))return f.Cwt||(f.ywt=r,f.Mwt=a,f.Cwt=!0,f.bwt=!0),f;for(;s<o&&(0,A.isNumber)(u);)++s<o&&(u=n[s]);if(i=parseInt(n.slice(r,s).join(""),10),f.Cwt){if(o<=s||"]"!==n[s])return f;s++}return i<(f.DX?d.maxRowCount:d.maxColumnCount)?(f.Mwt=f.Cwt?(i=t?-i:i)+a:i-1,f.ywt=s,f.bwt=!0,f):void 0}function W(n,t,i,r){var e,f,o,s,e=n.row||0,f=n.column||0;if(i.source===A.BangSource)r.push("!");else if(i.source&&!(o=g(n,r,i.source,i.endSource)))return void r.push("#","R","E","F","!");8===(s=i.type)||5===s||i.value&&i._error?r.push(i.value.toString()):i.hmt()?(!i.source&&n.addSheetName&&n.source&&g(n,r,n.source,C),p(n.useR1C1,e,f,i.row,i.column,i.rowRelative,i.columnRelative,r)):(!i.source&&n.addSheetName&&n.source&&g(n,r,n.source,C),K(n.source,n.useR1C1,e,f,i.row,i.column,i.endRow,i.endColumn,i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative,r,i.Tyt()))}function p(n,t,i,r,e,f,o,s,u){var a,a,a=d.maxRowCount-1;(0===(u=u||0)||1===u)&&-a<r&&r<=2*a&&(r=V(r+=f?t:0,a)),a=d.maxColumnCount-1,G(t,i,r,e=(0===u||2===u)&&-a<e&&e<=2*a?V(e+=o?i:0,a):e,f,o,u)?n?2!==u&&(s.push("R"),0<=r&&(t!==r||!f)&&(f?s.push("["+(r-t)+"]"):s.push(++r+"")),e<0)||1!==u&&(s.push("C"),i===e&&o||(o?s.push("["+(e-i)+"]"):s.push(++e+""))):(0<=e&&(o||s.push("$"),s.push.apply(s,X(e))),r<0||(r++,f||s.push("$"),s.push(r+""))):s.push(A.Errors.Reference.toString())}function K(n,t,i,r,e,f,o,s,u,a,c,h,l,v){3===(v=v||0)&&(e=0,o=d.maxRowCount-1,v=1),p(t,i,r,e,f,u,a,l,v);var u=x.BAND_INDEX_CONST;t&&e===o&&f===s&&(o===u||s===u)||o===u&&s===u||(l.push(":"),p(t,i,r,o,s,c,h,l,v))}function g(n,t,i,r){if(n.getExternalSourceToken){if(i!==A.BangSource){var i=(0,A.Mge)(n,n.getExternalSourceToken(i).split(""),r&&n.getExternalSourceToken(r).split(""));if(!(0<i.length))return!1;t.push.apply(t,i)}return t.push("!"),!0}return!1}function N(n){var t=new A.Expression(8);return t.value=n,t}function Q(n){var t=n;return t=n&&3<=n.length&&"["===n[0]&&"0"===n[1]&&"]"===n[2]?3===n.length?"":n.substring(3):t}function Z(n,t,i){var r,n,e,f,o,s,n=n.source;return r=n&&(e=n.G3,f=n.S8,o=n.T8,e)&&(s=0<=t&&t<f&&o<=i||f<=t&&0<=i&&i<o)?n:r}function k(n){var t=f.call(this,8e3)||this;return t.Mf=n,t}function q(n,t,i,r,e){return 0===t.uit&&0===t.Twt||!r&&0===t.uit&&4===t.Twt&&(!e||i<n.length-2&&":"===n[i+1].Awt&&0===n[i+2].uit&&4===n[i+2].Twt)}function z(n,t,i,r,e){return t<=n.startRow()&&i<=n.startColumn()&&t+r>n.endRow()&&i+e>n.endColumn()}function I(){return u.call(this,13)||this}function nn(n,t){this.abt.Iwt(n,this,t)}function O(n){var t=l.call(this,7900)||this;return t.Mf=n,t}function tn(n,t,i){var r,e,f,i,o,s,o,u,a,c,h,l,v,v,d,r=i,e=0,f=t[e],i=ln(n,t,e,f),o=i.nM;if(!o){if(s=n.keepUnknownFormulas)return;M()}for(r.baseTable=o,e=i.xwt,f=t[++e],o=e;" "===f;)f=t[++e];for("@"!==f&&"["!==f&&(f=t[e=o]),c=a=!(u=1),h=t.length;0!==u&&e<h;)if("["===f&&(u++,f=t[++e]),"#"===f)a&&u<=1&&M(),v=(l=hn(t,e,f,u)).Nwt,e=l.xwt,f=l.kwt,u=l.Dwt,a?2===r.hbt&&3===v||2===v&&3===r.hbt?r.hbt=6:3===r.hbt&&8===v||3===v&&8===r.hbt?r.hbt=12:M():r.hbt=v,a=!0;else if("@"===f){for((1<u||a)&&M(),a=!0,r.hbt=1,f=t[++e];" "===f;)f=t[++e];"["===f&&"#"===t[e+1]&&"this row"===E(t,e+2,e+10).toLowerCase()&&(a=!1),","===f&&M()}else{for(v=e;!y(f)&&"]"!==f&&"["!==f;)if("'"===f&&e++,","===f){for(f=t[++e],d=e;" "===f;)f=t[++e];if("["===f){e=d,f=",";break}}else f=t[++e];if(v<e&&((c||"["===f&&1<u)&&M(),e=(l=rn(r,t,e,f,u,v)).xwt,f=l.kwt,u=l.Dwt,c=!0),"]"===f){if(0===--u)break;e>=t.length&&M(),f=t[++e]}","===f&&(f=t[++e])}a||(r.hbt=n._wt?1:16),c||(r.cbt=0,r.fbt=r.abt.endColumn()-r.abt.startColumn(),r.lbt=1)}function E(n,t,i){return n.slice(t,i).join("")}function rn(n,t,i,r,e,f){var n,o,s,u,a,c,h,h,f,l,h,n=n,o=[],u=!1,a=!1;if(1<e)u=!0,e--,o=t.slice(f,i),":"===(r=t[++i])&&(a="["===(r=t[++i]),s=(h=an(t,i,r,e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt);else if("["===r){for(a=!0,r=t[c=i-1];" "===r;)r=t[--c];":"!==r&&M(),o=en(o=t.slice(f,c)),s=(h=an(t,i,r=t[i],e)).sbt,i=h.xwt,r=h.kwt,e=h.Dwt}else n.hbt!==C&&16!==n.hbt||(u=!0),0<(c=(h=t.slice(f,i)).indexOf(":"))?(o=h.slice(0,c),"["!==(s=h.slice(c+1))[0]&&M()):o=h;if(f=on(n,o,u),n.ubt=o.join(""),n.sbt=n.ubt,s?(l=on(n,s,a),n.lbt=4,n.sbt=s.join("")):(l=f,n.lbt=2),l<f&&(h=f,f=l,l=h),n.cbt=f,n.fbt=l,++i<t.length)for(r=t[i];" "===r;)r=t[++i];return{xwt:i,kwt:r,Dwt:e}}function en(n){for(var t=n.length-1;0<=t&&" "===n[t];)t--;for(;0<=t&&" "!==n[t];)t--;return 0<=t?n.slice(t+1,n.length-t-1):n}function fn(n){for(var t=0,i=n.length,r=0;t<i&&" "===n[t];)t++;for(r=t,t=i-1;r<t&&" "===n[t];)t++;return r<=t?n.slice(r,t+1):n}function on(n,t,i){var r,e,f,i;if(t&&sn(t,i)){for(r=[],e=0,f=t.length;e<f;e++)"'"===t[e]&&e<f-1&&e++,r.push(t[e]);return t=r,(i=n.abt.getColumnIndexInTable(t.join("")))<0&&M(),i}return-1}function sn(n,t){var i,r,e;if(t)return 1;if(i="","#"!==(r=i=n[0])&&"@"!==i&&" "!==i&&","!==i&&":"!==i&&"["!==i&&"]"!==i){for(e=1;e<n.length;e++){if(","===(i=n[e])||":"===i||"["===i&&"'"!==r||"]"===i&&"'"!==r||"@"===i&&"'"!==r||"#"===i&&"'"!==r)return;r=i}return 1}}function S(n){for(var t,i,r,t=[],r=0;r<n.length;r++)"["!==(i=n[r])&&"]"!==i&&"@"!==i&&"#"!==i&&"'"!==i||t.push("'"),t.push(i);return t.join("")}function un(n){var t,i,t="";if("#"===(t=n[0])||" "===t||"@"===t||" "===t||","===t||":"===t||"["===t||"]"===t)return 1;for(i=1;i<n.length;i++)if(" "===(t=n[i])||","===t||":"===t||"["===t||"]"===t||"@"===t||"#"===t)return 1}function an(n,t,i,r){var e,f,f,e=!1;if("["===i)for(e=!0,r++,i=n[++t];" "===i;)i=n[++t];for(f=t;"]"!==i&&(","!==i||1<r);)"'"===i&&t++,i=n[++t];return t<=f&&M(),f=n.slice(f,t),1<r&&r--,{sbt:f=e?f:fn(f),xwt:t,kwt:i,Dwt:r}}function cn(n){var t,i,t=(0,A.getMapping)()&&(0,A.getMapping)().tableFunctionsMapping;if(!y(t))for(i in t)if(t[i].toLowerCase()===n)return i.toLowerCase();return n}function hn(n,t,i,r){for(var e,f,o,s,u,a,e=14,f=t;"]"!==i;)"'"===i&&t++,i=n[++t];for(o=cn(o=E(n,f,t).toLowerCase().trim()),s=!1,u=0;u<c.length;u++)if(o===(a=c[u])){e=h[o],s=!0;break}if(s||M(),++t>=n.length)r--;else{for(i=n[t];" "===i;)i=n[++t];if(","===i){for(r<=1&&M(),i=n[++t];" "===i;)i=n[++t];"["===i&&(r++,i=n[++t])}1<r&&r--}return{Nwt:e,xwt:t,kwt:i,Dwt:r}}function ln(n,t,i,r){for(var e,f,o,s,f=0,o=t.length;"["!==r&&i<o;)r=t[++i];return{nM:e=0<i?(s=E(t,0,i),n.getTableByName(s)):n.getTableByIndex(n.row,n.column),xwt:i,kwt:r}}function M(){throw r().Exp_FormulaInvalid}function vn(n,t,i){var r,e,f,o,s,u,a,r=(0,A.getMapping)()&&(0,A.getMapping)().tableFunctionsMapping,e=(0,A.sR)().d2t,f=r?r["#All"]:e.All.name,o=r?r["#This row"]:e.thisRow.name,s=r?r["#Headers"]:e.Headers.name,u=r?r["#Data"]:e.Data.name,a=r?r["#Totals"]:e.Totals.name;switch(n){case 1:return i?"["+o+"]":"@";case 2:return t?"["+s+"]":s;case 3:return t?"["+u+"]":u;case 8:return t?"["+a+"]":a;case 6:return"["+s+"], ["+u+"]";case 12:return"["+u+"], ["+a+"]"}return t?"["+f+"]":f}function dn(n,t){var i,r,e,f,o,s,u,a,i,c,h;for(n.unshift(new A.FormulaToken("=",1,0,0,0)),f=[],o=0,e=n.length-1;0<e;e--)n[e].lp===n[e-1].lp&&n[e].Awt===n[e-1].Awt||(f[o]=n[e],o++);for(f[o]=n[e],f.reverse(),s=[],a=u=0;a<f.length;a++,u++)r=wn(f[a]),s[u]=f[a],(i=a+1<f.length?f[a+1].lp:t.length)>f[a].lp+r&&(i=new A.FormulaToken(t.slice(f[a].lp+r,i),7,f[a].lp+r),f[a].ywt=f[a].lp+r-1,s[++u]=i);for(c=0;c<s.length;c++)h=s[c].Awt.trim(),3===s[c].Twt?s[c].Awt='"'+s[c].Awt+'"':"("===h||"{"===h?(s[c].uit=1,s[c].Twt=1):")"!==h&&"}"!==h||(s[c].uit=1,s[c].Twt=2);return s}function wn(n){return 1===n.uit&&"ARRAY"===n.Awt?1:0===n.uit&&3===n.Twt?(n.Ewt||n.Awt).length+2:0===n.uit&&12===n.Twt?n.Awt.length+3:n.Awt.length}function D(n,t,i){var t,r;n&&t&&((r=n[t=t.getName&&t.getName()||"!"])||(r=n[t]=[],n.sheets||(n.sheets=[]),n.sheets.push(t)),r.push(i))}function F(n,t,i,r,e,f){var o,s,o,u;if(n){for(;10===n.type;)n=n.value;if(!(2<=(n=12===n.type?n.value:n).type&&n.type<=6))if(1===n.type)o=n.getRange(e,f),!r.source||n.source&&n.source!==r.source||t.push(o),D(i,n.source||r.source,o);else if(13===n.type)o=n.getRange(e,f),n.source===r.source&&o&&t.push(o),D(i,n.source||r.source,o);else if(8===n.type)n.jwt||(n.jwt=!0,o=j,n.source?n.source.op()&&(o=new A.EvaluateContext(n.source,(0,A.eV)(e,f))):o=r,F(o.getName(n.value),t,i,o,e,f),n.jwt=C);else if(9===n.type)F(n.value,t,i,r,e,f),n.value2&&F(n.value2,t,i,r,e,f);else if(7===n.type)for(u=0;u<n.arguments.length;u++)F(n.arguments[u],t,i,r,e,f)}}function mn(n,t,i,r,e,f,o,s,u){var f,t,a,c;n.setParserOption(f),f=[],t=t.split(""),y(u)&&(u=v.SheetArea.viewport);try{a=!!s||i.op().useR1C1,c=i.Uw(u).getParserContext(!o&&a,(0,A.eV)(r,e),{sheetArea:u}),f=n.parseToTokens(c,t,!1)}catch(n){}return Cn(n,f=dn(f,t),t,i,r,e,o,s,u)}function Cn(n,t,i,r,e,f,o,s,u){var a,c,h,l,s;return void 0===u&&(u=v.SheetArea.viewport),c=C,h=r.Uw(u),l=r.op(),s=!!s||l.useR1C1,l?(a=new m.SheetParserContext(r,!o&&s,(0,A.eV)(e,f),{sheetArea:u}),c=new A.EvaluateContext(h,(0,A.eV)(e,f),!1)):a=new A.ParserContext(j,!1,(0,A.eV)(0,0)),a.ignoreError=!0,_n(n,h,a,c,t,i,e,f)}function _n(n,t,i,r,e,f,o,s){for(var u,a,c,h,l,v,d,w,m,C,_,p,g,b,x,R,y,j,N,k,I,u=[],c=0;c<e.length;c++)try{if("["===(a=e[c]).Awt||"#"===a.y4[0]||3===a.Twt)u.push({index:a.lp,endIndex:a.ywt,text:a.Ewt||a.Awt,type:a.uit,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt});else if(c=pn(n,i,e,c,h=[]),d=v=l=void 0,0<h.length){for(w=0;w<h.length;w++)if((m=h[w])instanceof A.FormulaToken)u.push({index:m.lp,endIndex:m.ywt,text:f.slice(m.lp,m.ywt+1).join(""),type:m.uit,subType:m.Twt,canDrag:l,ranges:[],value:m.Awt});else if(m.WK){if(_=(C=m.WK).type,p=C.source,g=f.slice(m.lp,m.ywt+1).join(""),b=[],x={},l=!0,R=C.getRange&&C.getRange(o,s),8===_)d=v=!(l=!1),r&&(y=r,F(j=(y=C.source?new A.EvaluateContext(C.source,(0,A.eV)(o,s),!1):y).getName(C.value),b,x,r,o,s));else if(13===_||22===_)d=!(l=!1),p&&t&&p.Mf===t.Mf&&R?b.push(R):b=null,D(x,p,R);else if(1===_)if(d=!0,C.endSource)for(k=C.endSource,I=p.getSources(k),w=0;w<I.length;w++){if(I[w]===t){b.push(R);break}D(x,I[w],R)}else D(x,p||t,R),(!p||t&&p.Mf===t.Mf)&&b.push(R);else d=!1,b=null;b&&0<b.length||d?u.push({index:m.lp,endIndex:m.ywt,text:g,type:0,subType:7,canDrag:l,ranges:b,value:g,sheetRanges:x,sheetArea:p&&p.nT||t.nT,isName:v}):u.push({index:m.lp,endIndex:m.ywt,text:g,type:a.uit,subType:a.Twt,canDrag:l,ranges:b,value:g,sheetRanges:x,isName:v})}}else u.push({index:a.lp,endIndex:a.ywt,text:a.Awt,type:a.uit,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt})}catch(n){u.push({index:a.lp,endIndex:a.ywt,text:a.Awt,type:a.uit,subType:a.Twt,canDrag:!1,ranges:a.ranges,value:a.Awt})}return u}function pn(n,t,i,r,e){var f,n,t,n,o,o,i,f=i[r];return f&&"function"!=typeof f&&0===f.uit&&(t=n.resolveToken(t,i,n=[],r)-1,1===(o=(n=n[0]).type)||13===o||8===o||5===o||22===o&&n.source)?(o=i[t],i={lp:f.lp,ywt:o.ywt,WK:n},e.push(i),t):r}t=this&&this.__extends||(e=function(n,t){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}))(n,t)},function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Object.defineProperty(d,"__esModule",{value:!0}),d.getExpressTokenImp=d.Vgt=d.fillBlankToTokens=d.getValidaColumnName=d.StructureReferenceResolver=d.obt=d.StructReferenceColumnSpecifier=d.StructReferencePortions=d.SheetReferenceResolver=d.validateSheetName=d.maxColumnCount=d.maxRowCount=void 0,v=n("Core"),b=n("Common"),A=n("CalcEngine"),m=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),x=n("./dist/plugins/sheetsCalc/calc.ns.js"),R=n("./dist/plugins/sheetsCalc/external-reference.js"),y=b.Common.lt.ht,i=v.util.Vf,n=new b.Common.ResourceManager(v.SR),r=n.getResource.bind(n),d.maxRowCount=v.XmlConstants.Io,d.maxColumnCount=v.XmlConstants.xo,w=[1,26,676],C=void 0,j=null,c=["#all","#data","#headers","#totals","#this row"],_=[1,10,100,1e3,1e4,1e5,1e6,1e6],d.validateSheetName=A.Cmt,f=A.TokenResolver,t(k,f),k.prototype.resolveToken=function(n,t,i,r){var e,f,o,s,u,a,c,h,l,v,d,w,h,m,C,w,C,l,h,m,l,w,h,_,p,g,e=n.useR1C1,f=n.row||0,o=n.column||0,u=i.length,a=i[r],c=a.Awt,h=a.uit,l=a.Twt;if(0!==h&&6!==l)return!1;if(0===h&&0===l&&r<u-2&&":"===i[r+1].Awt&&12===i[r+2].Twt&&i[r+2].Awt.indexOf(":")<0||0===h&&12===l){if(m=h=void 0,C=c.lastIndexOf(":"),w=c.lastIndexOf("]"),(c=b.Common.zf.fJ(c,"'")&&b.Common.zf.dT(c,"'")?c.substring(1,c.length-1):c)&&(w<C?(h=c.substring(0,C-1),m=c.substring(C)):("'"===(h=c).charAt(0)&&(h=h.substring(1,h.length-1)),0===l&&(m=i[r+2].Awt,r+=2,"'"===m.charAt(0))&&(m=m.substring(1,m.length-1)))),r++,w=!!h,(h=Q(h))&&(v=(v=c?n.getExternalSource("",h):A.BangSource)||J(h),m=Q(m))&&(v instanceof R.ExternalSource?(d=v.getPeerSource(m)).Dfe=!0:d=(d=n.getExternalSource("",m))||J(m)),(a=i[r])&&"["===a.y4[0])return!1;if(!a)return N(c);c=a.Awt}if(C=r===u-1?j:i[r+1],q(i,a,r,e,!0)){if(l=n&&n.source&&n.source.Lbt&&n.source.Lbt.allowDynamicArray,!(h=P(a.y4,e,f,o,l)).bwt&&!w)return!1;if(a.Twt=7,h.bwt&&h.wwt){if(m=h.Ky,l=h.iw,w=h.gwt,h=h.pwt,r<u-2&&5===C.uit&&":"===C.Awt&&q(i,C=i[r+2],r+2,e,!1)&&(_=P(C.y4,e,f,o)).bwt&&m===x.BAND_INDEX_CONST==(_.Ky===x.BAND_INDEX_CONST)&&l===x.BAND_INDEX_CONST==(_.iw===x.BAND_INDEX_CONST))return f=m===x.BAND_INDEX_CONST?0:f,o=l===x.BAND_INDEX_CONST?0:o,{index:r+3,expr:(0,A.lJ)(v,d,m-(w?f:0),l-(h?o:0),_.Ky-(_.gwt?f:0),_.iw-(_.pwt?o:0),w,h,_.gwt,_.pwt,f,o)};if(m===x.BAND_INDEX_CONST||l===x.BAND_INDEX_CONST){if(e)return m-=m!==x.BAND_INDEX_CONST&&w?f:0,l-=l!==x.BAND_INDEX_CONST&&h?o:0,{index:r+1,expr:(0,A.lJ)(v,d,m,l,m,l,w,h,w,h,f,o)};if(!v)return!1;s=N(c)}if(!s)return y(v)&&(v=Z(n,f,o)),{index:r+1,expr:s=(0,A.knt)(v,d,p=m-(w?f:0),g=l-(h?o:0),w,h)}}else s=N(c)}else if(6===a.Twt)(s=new A.Expression(5)).value=A.CalcError.parse(a.Awt);else{if(!v||1===a.uit)return!1;s=N(c)}return v&&(s.source=v),d&&(s.endSource=d),{index:r+1,expr:s}},k.prototype.unparse=function(n,t,i,r){var e=i&&i.type;return(1===e||8===e||5===e)&&(W(n,t,i,r),!0)},d.SheetReferenceResolver=k,(n=o=d.StructReferencePortions||(d.StructReferencePortions={}))[n.ThisRow=1]="ThisRow",n[n.Headers=2]="Headers",n[n.Data=3]="Data",n[n.Totals=8]="Totals",n[n.HeadersAndData=6]="HeadersAndData",n[n.DataAndTotals=12]="DataAndTotals",n[n.All=14]="All",n[n.NotSpecific=16]="NotSpecific",(n=s=d.StructReferenceColumnSpecifier||(d.StructReferenceColumnSpecifier={}))[n.All=1]="All",n[n.NotSpecific=1]="NotSpecific",n[n.SingleColumn=2]="SingleColumn",n[n.ColumnRange=4]="ColumnRange",u=A.Expression,t(I,u),I.prototype.tableName=function(){return this.abt.tableName()},Object.defineProperty(I.prototype,"baseTable",{get:function(){return this.abt},set:function(n){this.abt=n,this.source=n.source()},enumerable:!1,configurable:!0}),I.prototype._K=function(){this.Owt=this.abt.startColumn()},I.prototype.columnReferenceStart=function(){return this.cbt+this.abt.startColumn()},I.prototype.columnReferenceEnd=function(){return this.fbt+this.abt.startColumn()},I.prototype.referencePortions=function(){return this.hbt},I.prototype.referenceColumnSpecifier=function(){return this.lbt},I.prototype.getRange=function(n,t,i){var r,e,f,o,s,u,a,c,h,l,v,d,e,r=this,e=r.abt;switch(r._K(),h=e.startRow(),l=e.endRow(),v=e.hasTotalsRow(),d=e.hasHeadersRow(),r.hbt){case 3:case 16:f=d?h+1:h,s=v?l-1:l;break;case 2:if(d)s=f=h;else{if(!i)return j;s=f=h-1}break;case 8:if(v)s=f=l;else{if(!i)return j;s=f=l+1}break;case 1:s=f=n;break;case 6:f=h+(i&&!d?-1:0),s=v?l-1:l;break;case 12:f=d?h+1:h,s=l+(i&&!v?1:0);break;default:f=h+(i&&!d?-1:0),s=l+(i&&!v?1:0)}if(22===r.type){if(o=r.abt.getColumnIndexInTable(r.ubt),u=r.abt.getColumnIndexInTable(r.sbt),-1===o||-1===u)return j}else o=r.columnReferenceStart(),u=r.columnReferenceEnd();return e=e.endColumn(),1===r.lbt&&(u=e),e<o||e<u?(r._error=!0,j):s<f||!i&&f<h||!i&&l<s?j:(0,A.Rwt)(f,o,a=s-f+1,c=u-o+1)},I.prototype.offsetWhenInsertRemoveColumn=function(n,t,i,r){var e,f,r,i,e=this,f=e.Owt;return y(f)&&(e._K(),f=e.Owt),y(f)||n<f||n===f&&i&&!r||n>e.fbt+f?e:(t=i?t:-t,r=n-f,(i=new I).baseTable=e.abt,i.fbt=e.fbt+t,i.cbt=e.cbt,n<=f+e.cbt&&(i.cbt+=t,i.cbt<r)&&(i.cbt=r),i.lbt=e.lbt,i.hbt=e.hbt,i.fbt<i.cbt?A.kyt:i)},I.prototype.offsetWhenCopy=function(n,t,i,r,e,f,o,s,u,a){var c,h,l,v,i,r,e,f,d,w,c=this,h=new m.SheetParserContext(t.Mf,t.Lbt.useR1C1,(0,A.eV)(i,r)),l=h.getTableByIndex(i,r),v=c.offset();return l&&(i=i-e,r=r-f,e=o-e,f=s-f,d=void 0,(d=(n===t?h:w=new m.SheetParserContext(n.Mf,n.Lbt.useR1C1,(0,A.eV)(i,r))).getTableByIndex(i,r))!==l)&&d===c.abt&&z(d,e,f,u,a)&&z(l,o,s,u,a)&&(v.baseTable=l),v},I.prototype.Bwt=function(n){var t,i,r,t=this,i=new I;return i.baseTable=t.abt,i.fbt=t.fbt,i.cbt=t.cbt,2===t.lbt&&n&&(r=t.abt.endColumn()-t.abt.startColumn()+1,i.cbt+=n%=r,i.cbt<0&&(i.cbt+=r),i.fbt=i.cbt),i.lbt=t.lbt,i.hbt=t.hbt,i},I.prototype.offset=function(n,t,i){var r,e,r=this,e=new I;return e.baseTable=r.baseTable,e.hbt=r.hbt,e.cbt=r.cbt,e.fbt=r.fbt,e.lbt=r.lbt,e},I.prototype.Lwt=function(n,t){var i=this.abt;return n>=i.startRow()&&t>=i.startColumn()&&n<=i.endRow()&&t<=i.endColumn()},I.prototype.Fwt=function(n,t,i){this.abt.Pwt(n,t,i)},a=I,d.obt=a,l=A.TokenResolver,t(O,l),O.prototype.resolveToken=function(n,t,i,r){var e,i,f,o,e,s,u,e,e=i[r],i=i[r+1];if(0===e.uit){if(o=f=void 0,0===e.Twt||7===e.Twt)f=e.Awt;else{if(12!==e.Twt||!i||0!==i.uit||0!==i.Twt||"["!==i.y4[0])return j;f=(e="'"===(e=e.Awt)[0]?e.substr(1,e.length-2):e)+i.Awt,o=!0}if("]"===f.charAt(f.length-1))try{return s=new a,tn(n,f.split(""),s),s.baseTable?(s.abt.Mf.NMi&&((u=s).type=22,u.Iwt=nn),o?{index:r+2,expr:s}:s):new A.Expression(0)}catch(n){}else if(e=n.getTableByName&&n.getTableByName(f))return O.create(e)}return j},O.prototype.unparse=function(n,t,i,r){var e,f,o,s,u,a,t,c,s,o,f,o,s;if(13!==i.type&&22!==i.type)return!1;if(f=(e=i).abt.Gwt,o=y(f)?e.abt.tableName():f,n.Sbt)s=e.getRange(n.row,n.column,!0),W(n,t,u=(0,A.lJ)(e.source,j,s.row,s.col,s.row+s.rowCount-1,s.col+s.colCount-1,!1,!1,!1,!1),r);else{if(t=r.length,22===e.type&&e.baseTable.Mf.xT)a=!0;else if(16===e.hbt&&1===e.lbt)return r.push(o),void(n.lyt&&r.push("[]"));(c=n.source===e.abt.source()&&e.Lwt(n.row,n.column))&&!n.lyt&&!e.abt.Mf.NMi||(s=y(f)?e.abt.tableName():f,(o=e.abt.Mf)&&o.NMi&&!(0,A.Cmt)(s.split(""))&&(s=(0,A.Mge)(n,s.split(""),null).join("")+"!"),r.push(s)),r.push("["),16!==e.hbt&&(f=vn(e.hbt,1!==e.lbt,n.lyt),r.push(f)),1!==e.lbt&&(1===e.hbt&&!n.lyt||16===e.hbt||r.push(", "),(o=22===i.type?e.abt.getColumnName(e.cbt)||e.ubt:e.abt.getColumnName(e.cbt))?o=S(o):a=!0,a||(4===e.lbt?(s=22===i.type?e.abt.getColumnName(e.fbt)||e.sbt:e.abt.getColumnName(e.fbt))?(s=S(s),r.push("[",o,"]:[",s,"]")):a=!0:1===e.hbt&&!n.lyt&&!un(o)||16===e.hbt?r.push(o):r.push("[",o,"]"))),a?(r.length=t,r.push("#REF!")):r.push("]")}return!0},O.create=function(n,t,i,r,e){void 0===t&&(t=o.NotSpecific),void 0===i&&(i=s.NotSpecific),void 0===r&&(r=0),void 0===e&&(e=n.endColumn()-n.startColumn());var f=new a;return f.baseTable=n,f.hbt=t,f.cbt=r,f.fbt=e,f.lbt=i,f},d.StructureReferenceResolver=O,d.getValidaColumnName=S,h={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},d.fillBlankToTokens=dn,d.Vgt=mn,d.getExpressTokenImp=_n},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(n,t,i){var r,e,r=this&&this.__createBinding||(Object.create?function(n,t,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(t,i);e&&("get"in e?t.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,r,e)}:function(n,t,i,r){n[r=void 0===r?i:r]=t[i]}),e=this&&this.__exportStar||function(n,t){for(var i in n)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),e(i("./dist/plugins/sheetsCalc/calc.ns.js"),t),e(i("./dist/plugins/sheetsCalc/parser-sheets.js"),t),e(i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),t),e(i("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),t),e(i("./dist/plugins/sheetsCalc/worksheet-formula.js"),t),i("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(n,t,i){var V,t,r,w,x,J,R,y,e,h,i,j,N,k,f,I,s,A,G,P,O,H,m,E,o,S,M,U,i;function D(n){n.forEach(function(n){var t;delete n.Uw().G3})}function C(n,a,c,h){V.GC$.each(n,function(n,t){var i,r,e,f,o,s,t,u,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.getComment(),s=t.getFormatter&&t.getFormatter(),t=t.getSheetTabName&&t.getSheetTabName();f&&(i={name:i,formula:u=s||a.unparse(c,f,r,e,!1,!0),sheetTabName:t,row:r,col:e},o&&(i.comment=o),h.push(i))})}function B(n,t){var n,i,r,n=A(n);if("str"===t)i=n;else if("b"===t)i="1"===n;else if("e"===t){switch(r=k,n){case"#DIV/0!":r=7;break;case"#N/A":r=42;break;case"#NAME?":r=29;break;case"#NULL!":r=0;break;case"#NUM!":r=36;break;case"#REF!":r=23;break;case"#VALUE!":r=15}i=r!==k?{error:n,code:r}:k}else i=parseFloat(n);return i}Object.defineProperty(t,"__esModule",{value:!0}),V=i("Core"),t=i("Common"),r=i("CalcEngine"),w=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),x=i("./dist/plugins/sheetsCalc/calc-spreadjs.js"),J=i("./dist/plugins/sheetsCalc/external-reference.js"),R=i("./dist/plugins/sheetsCalc/calc-extra-save.js"),y=i("./dist/plugins/sheetsCalc/worksheet-formula.js"),e=w.SpreadSource,h=t.Common.zf.Gmt,i=new t.Common.ResourceManager(V.SR),j=i.getResource.bind(i),N=void 0,k=null,f=t.Common.kh,I=t.Common.lt.ht,s=V.mt.o1,A=V.mt.c1,G=V.mt.xr,P=V.mt.go,O=V.Util.Sr,H=V.IndexHelper.$i,m=V.Util.addXLFNPrefix,E=V.mt.n1,o=V.mt.vo,S=V.Util.io,M=V.XFileConstants.mo,U=V.XFileConstants.Ki,(i=V.Workbook.prototype).Qp=function(n){var t,i,t=this,i=t.Lp;t.Lp=new r.CalcService,t.Lp.useR1C1=1===t.options.referenceStyle,t.Lp.allowDynamicArray=t.options.allowDynamicArray,t.Lp.iterativeCalculation=t.options.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=t.options.iterativeCalculationMaximumIterations,t.Lp.calculationMode=t.options.calculationMode,t.Lp.iterativeCalculationMaximumChange=t.options.iterativeCalculationMaximumChange,n&&i&&t.Lp.cloneFrom(i),t.yC=new e(t),t.wC=t.Lp.getGlobalSourceModel(t.yC)},i.addCustomFunction=function(n){this.Uwt(n)},i.Uwt=function(n){if(!(n&&n instanceof r.Functions.Function))throw new Error(j().Exp_InvalidCustomFunction);n.name=h(n.name),this.Amt[n.name]=n},i.getCustomFunction=function(n){return n?this.Amt[h(n)]:N},i.removeCustomFunction=function(n){n&&delete this.Amt[h(n)]},i.clearCustomFunctions=function(){this.Amt={}},i.addCustomName=function(n,t,i,r,e,f){this.zwt(this.hyt,n,t,i,r,!1,e,f)},i.Vwt=function(n){return!this.hyt[h(n)]},i.isValidCustomName=function(n){return n&&V.mt.P0(n)&&this.Vwt(n)},i.pp=function(n,t,i,r,e,f,o,s){var u,a,u=this;if(!t||!i)throw new Error(j().Exp_InvalidCustomName);s&&u.Lp?(a=s.Ywt(i,r,e),n[h(t)]=new x.FormatterNameInfo(t,i,s.name(),a,r,e)):u.zwt(n,t,i,r,e,f,o)},i.zwt=function(n,t,i,r,e,f,o,s){var u,a,a,c,u,u=this;if(!t||!i||!f&&!u.isValidCustomName(t))throw new Error(j().Exp_InvalidCustomName);if(u.Lp){if(a=(a=(0,V.jf)(this))?a.Uw():k,c=void 0,f)try{c=u.Lp.parse(a,i,r,e,!1,!0,!0)}catch(n){}else c=u.Lp.parse(a,i,r,e);n[h(t)]=new x.NameInfo(t,c,r,e,o,s),f||((u={})[t]=t,this.Zwt(u,!0))}},i.Wwt=function(n,t,i,r,e,f,o,s){var u,i,u=this;if(!t||!i||!o&&!u.isValidCustomName(t))throw new Error(j().Exp_InvalidCustomName);u.Lp&&(n[h(t)]=new x.NameInfo(t,r,e,f,s),o||((i={})[t]=t,this.Zwt(i,!0)))},i.getCustomName=function(n){return n?this.hyt[h(n)]:N},i.xO=function(n){return n?this.bp[h(n)]:N},i.getCustomNames=function(){var i=[];return V.GC$.each(this.hyt,function(n,t){i.push(t)}),i},i.Qwt=function(){var i=[];return V.GC$.each(this.bp,function(n,t){i.push(t)}),i},i.removeCustomName=function(n){var t;n&&(delete this.hyt[h(n)],(t={})[n]=n,this.Zwt(t,!1))},i.o3=function(n){var t;n&&(delete this.bp[h(n)],(t={})[n]=n,this.Zwt(t,!1))},i.clearCustomNames=function(){var n=this.hyt;this.hyt={},this.Zwt(n,!1)},i.getNameInfos=function(){return this.hyt},i.setNameInfos=function(n){I(n)||(this.hyt=n)},i.Kwt=function(){var n=this.bp;this.bp={},this.Zwt(n,!1)},i.Zwt=function(n,t){var i,r,n;if(n){for(r in i=this.wC,n)i&&i.updateNameCalc(r,t);this.Lp&&!this.Lp.IsSuspended()&&(n=this.getActiveSheet())&&(n.suspendPaint(),this.Lp.recalculateAll(!1),n.resumePaint()),this.ki(V.Events.CustomNameChangedInternal,{})}},i.calculate=function(n,t){var i,r,e,f,o,s,u,a,c,h,l,v,d,n,i=this,r=i.op();if(r){switch(e=N,f=!1,n){case V.CalculationType.rebuild:e=!0;break;case V.CalculationType.minimal:e=!1;break;case V.CalculationType.regular:f=!(e=!1)}if(this.suspendPaint(),I(t)){if(r.suspend(!0),e)for(o=void 0,o=i.sheets||[],(0,y.resetCustomName)(i&&i.hyt,k,r),s=0;s<o.length;s++)for(a=(u=o[s]).Uw(),(0,y.resetCustomName)(u.hyt,a,r),h=(c=a.getCalcSourceModel()).getAllNodes(),l=0;l<h.length;l++)(d=(v=h[l]).calc)&&v.WK&&(0,y.adjustOneFormula)(r,d);r.resume(e,!f,!0)}else(u=i.getSheetFromName(t))?u.c3n(e,f):0<i.sheets.length&&(n=w.formulaToRanges(i.sheets[0],t,0,0,!0)[0]||w.formulaToRanges(i.sheets[0],t,0,0)[0])&&(u=i.getSheetFromName(n.sheetName)).c3n(e,f,n.ranges[0]);this.resumePaint()}},i.getCalcService=function(){return this.Lp},i.op=function(){return this.Lp},i.suspendCalcService=function(n){this.Lp&&this.Lp.suspend(n)},i.resumeCalcService=function(n){this.Lp&&this.Lp.resume(n)},i.getCircularReference=function(){var n,t,i,r,n=this.Jwt(),t=[];for(i in n=this.Xwt(n))f(n,i)&&(r=i.split("\\"),t.push({row:+r[1],col:+r[2],rowCount:1,colCount:1,sheetName:r[0]}));return t},i.updateExternalReference=function(n,t,i){this.suspendPaint(),this.suspendCalcService(),this._p._6(n,t,i),this.resumeCalcService(!1),this.resumePaint()},i.getExternalReferences=function(n){return this._p.myt(n)},i.Jwt=function(){var h={};return this.sheets.forEach(function(n){var t,i,r,e,f,o,s,u,a,c,c,t=n.b3(),i=n.getRowCount(),r=n.getColumnCount(),e=n.name();if(t)for(f=0;f<i;f++)for(o=0;o<r;o++)for(s=e+"\\"+f+"\\"+o,u=n.qwt(f,o),!h[s]&&0<u.length&&(h[s]={from:[],to:[]}),a=0;a<u.length;a++)c=(c=u[a]).sheetName+"\\"+c.row+"\\"+c.col,h[c]||(h[c]={from:[],to:[]}),h[c].from.push(s),h[s].to.push(c)}),h},i.Xwt=function(i){var r,n,t;function e(n,t){n.splice(n.indexOf(t),1)}for(r=!0;0<Object.keys(i).length&&r;)for(t in r=!1,n=function(t){var n;f(i,t)&&(0===(n=i[t]).from.length?(n.to.forEach(function(n){e(i[n].from,t)}),delete i[t],r=!0):0===n.to.length&&(n.from.forEach(function(n){e(i[n].to,t)}),delete i[t],r=!0))},i)n(t);return i},V.Workbook.ch("calc",{priority:1e3,init:function(){this.Amt={},this.hyt={},this.bp={},this._p=new J.ExternalReferenceManager},toJson:function(n){var t,i,i,u,i,r,e,a,t,c,t=this,i=t.Amt;V.GC$.isEmptyObject(i)||(n.customFunctions=i),i=t._p.toJSON(t),V.GC$.isEmptyObject(i)||(n.externalReference=i),u=[],i=[],r=t.getCustomNames(),e=t.Qwt(),a=t.Lp,t=this.getActiveSheet(),c=t?t.Uw():k,r&&a&&(V.GC$.each(r,function(n,t){var i,r,e,f,o,t,s,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:s=a.unparse(c,f,r,e,!1,!0),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),u.push(i))}),C(e,a,c,i),0<u.length&&(n.names=u),0<i.length)&&(n.formatStringNames=i)},wh:function(n,t,u){var i,r,r,e,f,o,a,r,e,c,f,h,f,l,v,d,f,r,i=this,r=i.Amt;V.GC$.isEmptyObject(r)||(n.workbook.lossless.customFunctions=r),i._p&&(e=(r=i._p.wh(n)).externalReferencesNode,f=r.externalLinks,0<(o=r.count))&&(n.workbook.c_.push(e),n.externalLinks=f),a=[],r=s(n.workbook,"definedNames"),e=i.getCustomNames(),c=i.Lp,f=this.getActiveSheet(),h=f?f.Uw():k,f=i.yC,l=f&&f.getUsedCustomNames()||{},e&&0<e.length&&c&&(r||n.workbook.c_.push(r={n_:"definedNames",c_:[]}),v=r.c_,d=!u||!1!==u.includeUnusedNames,V.GC$.each(e,function(n,t){var i,r,e,f,o,t,s,i,t,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(d||l[i])&&(i={n_:"definedName",name:i,comment:t,isReadOnly:o,c_:[s=m((0,x.encodeNameFormula)(c.unparse(h,f,r,e,!1,!0)))]},u&&u.includeCalcModelCache&&(t=(0,R.exprToJSON)(f),a.push(t),i.e=a.length-1),v.push(i))})),0<a.length&&(n.workbook.lossless.exprs=a),f=[],(r=i.Qwt())&&0<r.length&&c&&(C(r,c,h,f),0<f.length)&&(n.workbook.lossless.formatStringNames=f),n.workbook.lossless.idMap=(0,R.dbt)(c)},preFromSJSFormat:function(n,T,Y){var t,i,r,e,f,o,s,u,a,c,h,l,v,s,d,w,m,C,_,p,g,b,x,R,y,j,L,N,k,I,A,O,E,S,S,O,M,D,F,X,t=G(n.workbook,"externalReferences"),i=n.externalLinks;if(t&&i&&t.c_&&0<t.c_.length){for(e in r={},i)if(i.hasOwnProperty(e)){if(f=i[e],o={},s=G(f,"externalBook")){if(a=[],(u=G(s,"sheetNames"))&&u.c_&&u.c_.length){for(c=0,h=u.c_.length;c<h;c++)(l=u.c_[c])&&(v=l.val)&&(v=V.mt.kfe(v),a.push(v));o.sheetNames=a}if(s=G(s,"sheetDataSet")){if(d={},w=P(s,V.XFileConstants.bo))for(m=0,C=w.length;m<C;m++)if(p=+(_=w[m]).sheetId,g="1"===_.refreshError,b=d[v=a[p]]={},g&&(b.isNew=!0),x=P(_,"row"))for(R=0,y=x.length;R<y;R++)if((j=x[R])&&(N=b[L=j.r-1]={},k=P(j,"cell")))for(I=0,A=k.length;I<A;I++)E=void 0,(O=k[I])&&((S=O.r)&&(E=H(S)),S=O.t,M=void 0,(O=G(O,"v"))&&(M=B(O,S)),N[E]=M);o.data=d}}o.option=f.option,r[e]=o}for(D={},X=(F=t.c_).length,c=0;c<X;c++)D[c+1]=r[F[c][U]];this._p=new J.ExternalReferenceManager(D)}},yh:function(e,i,r){var f,t,o,s,n,u,a,c,h,l,v,d,w,m,C,C,_,p,g;function b(){var n,n;return t||(n=(n=(0,V.jf)(f)||f.sheets[0])?n.Uw():k,t=n&&n.getParserContext(!1)),t}if(o=(f=this).Lp,s=r&&!r.fullRecalc,n=V.Util.wo(r,f.v2),o&&(o.suspend(),o.lb=s),f.clearCustomNames(),(u=f.sheets).forEach(function(n){n.Uw().G3=!0}),a=e.workbook.lossless,r&&(r.$wt=(0,R.vbt)(o,a)),(c=i.workbookNames)&&0<c.length&&c.forEach(function(n){var t=n.name,i=A(n),r=n.comment,e=n.isReadOnly;a&&a.exprs&&a.exprs[n.e]?f.Wwt(f.hyt,(0,y.convertBuiltInNameToDisplayName)(t),""+(0,x.processFunctionPrefix)(V.mt.n1(i)),(0,R.exprFromJSON)(a.exprs[n.e],b()),0,0,!0,r,!0):i&&f.zwt(f.hyt,(0,y.convertBuiltInNameToDisplayName)(t),""+(0,x.processFunctionPrefix)(V.mt.n1(i)),0,0,!0,r,e)}),f.Kwt(),h=a&&a.formatStringNames)for(l=0;l<h.length;l++)v=h[l],I(v.sheetTabName)&&f.pp(this.bp,v.name,v.formula,v.row,v.col,!0,v.comment,N,!0);if(f.clearCustomFunctions(),d=a&&a.customFunctions)for(w in d)d.hasOwnProperty(w)&&(m=d[w],C=(0,V.getTypeFromString)(m.typeName))&&((C=new C).fromJSON(m),f.Uwt(C));n||(_=[],p=e.workbook.rels&&e.workbook.rels.c_,(g=G(e.workbook,M).c_).forEach(function(n){var t,t,n,n,n,i,r,t=S(E(n.name)),t=f.getSheetFromName(t),n=n[U],n=O(p,n),n=n&&n.Target;n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],_.push({sheet:t,sheetData:r}))}),_.forEach(function(n){n.sheet&&n.sheet.nameFunctionFromSJSFormat(n.sheetData,i,r)}),_.forEach(function(n,t){n.sheet&&n.sheet.formulaFromSJSFormat(n.sheetData,i,r)})),r.incrementLoadTask.addTask(function(n,t,i){o&&(s?o.resumeWithoutCalc():o.resume(!1,!1,!o.calcOnDemand),delete o.lb),D(u)},[o,e,r],s?N:j().STEP.startCalc,function(){return s?V.STEP_RATE.end:V.STEP_RATE.loadFileData+V.STEP_RATE.parseFile+V.STEP_RATE.loadSheetDataWithCalc+V.STEP_RATE.loadSheetFormulaWithCalc})},Mb:function(e,t,i){var f,o,s,n,u,r,a,c,h,l,v,d,w,m,m,C,_,p,f=this,o=f.Lp,s=i&&!i.fullRecalc,n=V.Util.wo(i,f.v2);if(o&&(o.suspend(),o.lb=s),f.clearCustomNames(),(u=f.sheets).forEach(function(n){n.Uw().G3=!0}),r=e.workbook.lossless,(a=t.workbookNames)&&0<a.length&&a.forEach(function(n){var t=n.name,i=A(n),r=n.comment,n=n.isReadOnly;i&&f.zwt(f.hyt,(0,y.convertBuiltInNameToDisplayName)(t),""+(0,x.processFunctionPrefix)(V.mt.n1(i)),0,0,!0,r,n)}),f.Kwt(),c=r&&r.formatStringNames)for(h=0;h<c.length;h++)l=c[h],I(l.sheetTabName)&&f.pp(this.bp,l.name,l.formula,l.row,l.col,!0,l.comment,N,!0);if(f.clearCustomFunctions(),v=r&&r.customFunctions)for(d in v)v.hasOwnProperty(d)&&(w=v[d],m=(0,V.getTypeFromString)(w.typeName))&&((m=new m).fromJSON(w),f.Uwt(m));n||(C=[],_=e.workbook.rels&&e.workbook.rels.c_,(p=G(e.workbook,M).c_).forEach(function(n){var t,t,n,n,n,i,r,t=S(E(n.name)),t=f.getSheetFromName(t),n=n[U],n=O(_,n),n=n&&n.Target;n&&(i=f.getSheetRelsName(n),r=void 0,r=(-1<n.indexOf("xl/chartsheets")?e.chartsheets:e.sheets)[i],C.push({sheet:t,sheetData:r}))}),C.forEach(function(n){n.sheet&&n.sheet.nameFunctionFromSJSFormat(n.sheetData,t,i)}),C.forEach(function(n){n.sheet&&n.sheet.formulaFromSJSFormat(n.sheetData,t,i)})),i.incrementLoadTask.addTask(function(n,t,i){var r;o&&(s?o.resumeWithoutCalc():(o.resume(!1,!1,!o.calcOnDemand),delete o.tMt,(r=f.getActiveSheet())&&r.zw()),delete o.lb),D(u)},[o,e,i])},preFromJson:function(n,t,i){this._p=new J.ExternalReferenceManager(n.externalReference)},fromJson:function(n,t,i){var r,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,g,g,b,x,R,r=this,e=r.Lp,f=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(e&&(e.suspend(),e.lb=f),r.clearCustomNames(),a=[],u=n.sheets)for(h in u)"string"==typeof h&&(l=u[h],s=r.getSheetFromName(l.name||h))&&(s.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],r.zwt(this.hyt,(0,y.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(r.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],I(w.sheetTabName)&&r.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(r.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,V.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),r.Uwt(g));if(u){for(h in o=0,u)"string"==typeof h&&(l=u[h],s=r.getSheetFromName(l.name||h))&&(a.push(s),s.nameFunctionsFromJSON(l,t,i),o++);for(c=a.length,o=0;o<c;o++)(s=a[o]).formulaFromJSON(u[s.name()],t,i)}for(e&&(f?e.resumeWithoutCalc():(e.resume(!1,!1,!e.calcOnDemand),delete e.tMt),delete e.lb),b=0,x=a;b<x.length;b++)delete(R=(s=x[b]).Uw()).G3},Yp:function(n,t,i){var s,u,a,r,c,e,h,f,o,l,v,d,w,m,C,_,p,g,g,s=this,u=s.Lp,a=n.noRecalc||i&&i.doNotRecalculateAfterLoad;if(u&&(u.suspend(),u.lb=a),s.clearCustomNames(),e=n.sheets,h=[],e)for(o in e)"string"==typeof o&&(l=e[o],c=s.getSheetFromName(l.name||o))&&(c.Uw().G3=!0);if(v=n.names)for(d=0;d<v.length;d++)w=v[d],s.zwt(this.hyt,(0,y.convertBuiltInNameToDisplayName)(w.name),w.formula,w.row,w.col,!0,w.comment,w.isReadOnly);if(s.Kwt(),m=n.formatStringNames)for(d=0;d<m.length;d++)w=m[d],I(w.sheetTabName)&&s.pp(this.bp,w.name,w.formula,w.row,w.col,!0,w.comment);if(s.clearCustomFunctions(),C=n.customFunctions)for(_ in C)C.hasOwnProperty(_)&&(p=C[_],g=(0,V.getTypeFromString)(p.typeName))&&((g=new g).fromJSON(p,t),s.Uwt(g));if(e){for(o in r=0,e)"string"==typeof o&&(l=e[o],c=s.getSheetFromName(l.name||o))&&(h.push(c),c.nameFunctionsFromJSON(l,t,i),r++);for(f=h.length,r=0;r<f;r++)(c=h[r]).formulaFromJSON(e[c.name()],t,i)}i.incrementLoadTask.addTask(function(n,t,i){var r,e,f,o;for(u&&(a?u.resumeWithoutCalc():(u.resume(!1,!1,!u.calcOnDemand),delete u.tMt,(r=s.getActiveSheet())&&r.zw()),delete u.lb),e=0,f=h;e<f.length;e++)delete(o=(c=f[e]).Uw()).G3},[u,n,i])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(f,n,t){var g,i,A,w,b,m,O,x,C,h,p,t,R,y,r,_,e,l,j,N,V,k,I,t;function o(n){return"="===n.charAt(0)}function s(n){var t,i;return{left:n.indexOf("["),right:n.indexOf("]")}}function c(n){var n=s(n),t=n.left,n=n.right;return 0<=t&&t<n}function J(n){var t=s(n),i=t.left,t=t.right,n=n.indexOf("@");return i<n&&n<t}function G(n){return o(n)&&J(n)}function P(n){return o(n)&&c(n)}function H(n,t){var i,r;if(n.NMi){if(P(t=t.trim()))return 1;if(0<=t.indexOf("{{")&&0<=t.indexOf("}}"))for(i=t.split(/{{|}}/),r=0;r<i.length;r++)if(P(i[r].trim()))return 1}}function U(n,t,i,r){return i===x&&(i=n.getActiveRowIndex()),n.NMi.nMt(t,i,r)}function B(n){return n.columnRelative}function $(n){return n.endColumnRelative}function W(n){return n.rowRelative}function K(n){return n.endRowRelative}function E(n){return n.op()}function Q(n){n.column}function v(n){return n.toUpperCase()===r?e:n}function Z(){var n=this;n.eMt?n.eMt=!1:(n.Amt={},n.hyt={},n.iMt?n.iMt.clearAll():n.T3=new w.SheetSource(n,g.SheetArea.colHeader),n.rMt?n.rMt.clearAll():n.A3=new w.SheetSource(n,g.SheetArea.rowHeader),n.oMt?n.oMt.clearAll():n.qgt=new w.SheetSource(n,g.SheetArea.viewport))}function q(n,t){var n,i,n=n.Uw(),i;(n&&n.t8.jme(-1,-1,-1,-1)).forEach(function(n){n.isValid||(t.spillCells=t.spillCells||{},t.spillCells[n.minX+","+n.minY]=1)})}function u(n,t,i,r,e,f){var n=n.iT(t,i,r,e,f),t=n&&n.formulas;return t&&0<t.length}function z(n,t,i,r,e,f,o){var s=u(n,t,i,r,e,3);return!s&&f&&(e=n.getColumnCount(2),s=u(n,t,0,r,e,2)),!s&&o&&(r=n.getRowCount(1),s=u(n,0,i,r,e,1)),s}function nn(n){for(var t,i,r,e,f,t=[],i=[],r=0;r<n.length;r++)f=""+(e=n[r]).row+e.col+e.rowCount+e.colCount+e.sheetName,t.indexOf(f)<0&&(t.push(f),i.push(e));return i}function tn(n,t){var n=n.formulaLoad/n.total;return t?.4*n+.5:.3*n+.4}function rn(n,t,i,r,e,f){var o,s,u,a,c,a,c,o=r.Uw(),s=n&&n.formula;s&&(u=void 0,"object"==typeof s&&(a=r.b3(f),(c=r.Xbt[s.si]).baseRow===t&&c.baseColumn===i?(s=c.formula,c.$fe=!0):c.$fe?(u=a.pB(c.baseRow,c.baseColumn))?(u.aMt=s.si,r.Lp.tMt&&r.Lp.tMt[o.id+","+c.baseRow+","+c.baseColumn]&&(r.Lp.tMt[o.id+","+t+","+i]={id:o.id,row:t,col:i})):(s=c.formula,c.baseRow=t,c.baseColumn=i):(s=c.formula,c.$fe=!0,c.baseRow=t,c.baseColumn=i)),(a=n.arrayInfo)&&!a.isDynamicArray?r.uMt(t,i,k(a.rowCount,10),k(a.colCount,10),s,!0,f):(c=o.getCalcSourceModel(),a&&o.t8.Zme(a.row,a.col,a.rowCount,a.colCount,!a.isInvalid),r.zI(t,i,s,u,!0,f,!0,!a,x,!0),a&&c.Uyt(t,i,a)))}function S(n,t,i,r,e,f,o){var s,u,a,c,h,l,v,d,s,f,s=e&&e.incrementLoadTask;if(s&&!s.isTerminated){for(u=s.isBusyFunc,a=f=f||0,n.suspendPaint(),c=30,h=new Date;a<i;){if(l=t[a])for(v=0;v<r;v++)rn(l[v],a,v,n,!0,o);if(a++,u&&u())break;if(30<(d=new Date)-h)break}n.resumePaint(),(s=(e=e||{})&&e.incrementalLoading)&&(s.loadStatus.formulaLoad+=a-f,f=tn(s.loadStatus,e.doNotRecalculateAfterLoad),n.parent&&n.parent.ki(g.Events.ProgressChanged,{loadStatus:s.loadStatus,progress:f,sheet:n}),s.loading)&&s.loading(f,{sheet:n}),a<i&&e.incrementLoadTask.pushTask(S,[n,t,i,r,e,a])}}function a(n,t,i,r,e){for(var f,o,s,f=0;f<i;f++)if(o=t[f])for(s=0;s<r;s++)rn(o[s],f,s,n,!0,e)}function en(n,t){var i,r,e,f,o,s;if(t)for(i in t)if(t.hasOwnProperty(i))for(e in r=t[i])r.hasOwnProperty(e)&&(o=+i,s=+e,(f=r[e]).f)&&y(n.getValueIgnoreDefault(o,s))&&!n.getFormula(o,s)&&!n.getBindingPath(o,s)&&n.Ut.setDefaultValue(o,s,N(f.f),x,g.DefaultChangeValueType.Expression)}function fn(n,t,i,r,e,f,o){var s,u,a,u,c,h,l,v,d,l,l,s=n.Uw(),u=n.Ut,a=u.ap||0,u=u.fp||0;t===x||(c=N(t.f),h=t.g,(l=t.r)!==x&&(v=j(l).toJSON()),"shared"===t.d&&0<=h&&(c=(c&&(l={formula:c},v&&(l.lastRow=v.rowCount+v.row-1,l.lastColumn=v.colCount+v.col-1,l.baseRow=v.row,l.baseColumn=v.col,v=O),f[h]||(f[h]=l,f.nextIndex=Math.max(f.nextIndex,h+1))),{si:h}),(l=n.Xbt[c.si]).baseRow===i&&l.baseColumn===r?(c=l.formula,l.$fe=!0):l.$fe?(d=e.pB(l.baseRow,l.baseColumn))?(d.aMt=c.si,n.Lp.tMt&&n.Lp.tMt[s.id+","+l.baseRow+","+l.baseColumn]&&(n.Lp.tMt[s.id+","+i+","+r]={id:s.id,row:i,col:r})):(c=l.formula,l.baseRow=i,l.baseColumn=r):(c=l.formula,l.$fe=!0,l.baseRow=i,l.baseColumn=r)),y(c))||(1==+t.a&&v&&(v.isDynamicArray=!0,o)&&o.spillCells&&o.spillCells[i+","+r]&&(v.isInvalid=!0),c=(0,w.processFunctionPrefix)(c),v&&!v.isDynamicArray?a<=i&&r<u?n.uMt(i,r,k(v.rowCount,10),k(v.colCount,10),c,!0,2):i<a&&u<=r?n.uMt(i,r,k(v.rowCount,10),k(v.colCount,10),c,!0,1):a<=i&&u<=r&&n.uMt(i,r,k(v.rowCount,10),k(v.colCount,10),c,!0,3):(v&&s.t8.Zme(v.row,v.col,v.rowCount,v.colCount,!v.isInvalid),!d&&o&&o.exprs&&o.exprs[t.x]&&(d=(0,m.exprFromJSON)(o.exprs[t.x],s.getParserContext(!1)),o.exprs[t.x].nw)&&(d.sMt=!0),a<=i&&r<u?n.zI(i,r,c,d,!0,2,!0,!v):i<a&&u<=r?n.zI(i,r,c,d,!0,1,!0,!v):a<=i&&u<=r&&n.zI(i,r,c,d,!0,3,!0,!v,x,!0),v&&e.Uyt(i,r,v)))}function M(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,o,o,u,a=(f&&f.incrementLoadTask).isBusyFunc,c=o=o||0;for(n.suspendPaint(),n.suspendCalcService(),l=30,(h=f.openMode===g.OpenMode.incremental)&&(v=new Date),d=n.Xbt=n.Xbt||{nextIndex:0},w=n.b3(3);c<i;){if(m=t[c])for(C=0;C<r;C++)fn(n,m[C],c,C,w,d,e);if(c++,!s&&a&&a())break;if(h&&(_=new Date,!s)&&30<_-v)break}n.resumeCalcService(),n.resumePaint(),f.loadStatus.formulaLoad+=c-o,h&&(o=f.loadStatus.formulaLoad/f.loadStatus.total,o=+(f.fullRecalc?.3*o+.5:.4*o+.6).toFixed(5),f.incrementLoadTask.progress)&&f.incrementLoadTask.progress({progress:o,sheetName:n.name(),step:p.I5(R().STEP.loadSheetFormula,[n.name()])}),c<i&&f.incrementLoadTask.pushTask(M,[n,t,i,r,e,f,c])}function on(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterFormula;t&&t.call(i,r,e,f)})}function sn(i,r,e,f){var n=g.Worksheet.fh;n&&C(n,function(n,t){var t=t.fromJsonAfterSJSFormula;t&&t.call(i,r,e,f)})}function un(t,i,r,n,e,f){var o,s,u,a,c,h,l,o=g.Worksheet.fh,s=!1,u=[],a=n.getReferenceSheetNames(),c=t&&t.v2,h=function(n){var r;a.hasOwnProperty(n)&&(s=!0,r=(0,g._f)(t,n),c.sheetsState[n]||c.refSheetsState[n]||!r||(c.refSheetsState[n]=1,c.getSheet(n,function(i){var n,n,n=r.NMi;n?(n.yh(i,e,f),y(i.order)||(n.E0i=i.order),(n=(0,g.Ip)(n,i.lossless.addition,t.dataManager()))&&u.push(n)):(r.yh(i,e,f,!0),y(i.order)||(r.E0i=i.order)),o&&C(o,function(n,t){t.refSheetLazyLoaded&&t.refSheetLazyLoaded.call(r,i,e,f)})})))};for(l in a)h(l);s&&o&&C(o,function(n,t){t.afterRefSheetLazyLoaded&&t.afterRefSheetLazyLoaded.call(i,r,e,f)}),0<u.length&&f&&f.fullRecalc&&Promise.all(u).then(function(){t.suspendPaint(),t.mp[0].Mf.recalcAll(!0),t.resumePaint()})}function d(n,t,i){var r,e,f,f;if(n)for(r in n)(f=(e=n[r]).WK)!==x&&(f=i.unparse(t,f,0,0),e.WK=i.parse(t,f,0,0))}function an(r,e){return function(n){var t,i,t,t=n.w3.rT;t&&t.Mf.xT||(i=(t?t.Mf:e).name(),t=(t?t.Mf:e)._id,r[t+" "+n.row+" "+n.column]={row:n.row,col:n.column,rowCount:1,colCount:1,sheetName:i})}}function cn(n){var t,i,t=[];for(i in n)n.hasOwnProperty(i)&&t.push(n[i]);return t}function D(n,e,t,i,f,r,o){var r,t;r&&n.lossless&&([n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){var t,n,i,r;n&&n.dataTable&&(n=n.dataTable,i=e.getRowCount(t=t+1),r=e.getColumnCount(t),o?S(e,n,i,r,f,0,t):a(e,n,i,r,t))}),n.lossless.defaultData)&&en(e,n.lossless.defaultData),r&&t.cMt&&n.lossless.tree&&0<n.lossless.tree.length&&(delete t.cMt,r=null,"rangeCalc"===(t=n.lossless.tree)[t.length-1].k&&(r=t.pop()),(0,m.pbt)(e.b3(),t,f.$wt),r)&&(0,m.gbt)(e.b3(),r,f.$wt),o?f.incrementLoadTask.pushTask(sn,[e,n,i,f]):sn(e,n,i,f),g.Util.ume(e,i)}function F(n,t){var i,r,e,n;return!t||(i=n.getRow(),r=n.getColumn(),(n=n.getExpression().getRange(i,r))&&!(n=n instanceof g.Range?n:new g.Range(n.row,n.col,n.rowCount,n.colCount)).containsRange(t))}function T(r,e,f,o,s,u){var n,a,c,h,l,v,t,i,d,w,m,h=!o&&r.Ut.pj(),l=!!u;if(r.parent&&r.parent.sheets)for(v=r.parent.sheets,t=r.parent.getCustomNames(),i=r.parent.Qwt(),d=!y(r.parent.fMt)&&r.parent.wJt(),t&&C(t,function(n,t){F(t,u)&&(a=t.getExpression(),(c=Y(null,r,e,f,o,s,a,l))!==a)&&t.SB(c,h)}),i&&C(i,function(n,t){F(t,u)&&(a=t.getExpression(),(c=Y(null,r,e,f,o,s,a,l))!==a)&&t.SB(c,h)}),d&&C(d,function(n,t){F(t,u)&&(a=t.getExpression(),(c=Y(null,r,e,f,o,s,a,l))!==a)&&t.SB(c,h)}),w=function(i){(n=v[i].getCustomNames())&&C(n,function(n,t){F(t,u)&&(a=t.getExpression(),(c=Y(v[i],r,e,f,o,s,a,l))!==a)&&t.SB(c,h)})},m=0;m<v.length;m++)w(m);else(n=r.getCustomNames())&&C(n,function(n,t){F(t,u)&&(a=t.getExpression(),(c=Y(r,r,e,f,o,s,a,l))!==a)&&t.SB(c,h)})}function Y(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,w,m,C,_,p,h,v,l,d,l,d,h,v,g,b,x,R,y,j,N,k,a,j,I;if(o){if(u=t.Uw(),a=(0,A.Syt)(A.Errors.Reference,u),9===o.type){if(h=o.value,l=o.value2,v=Y(n,t,i,r,e,f,h,s),d=l&&Y(n,t,i,r,e,f,l,s),h!==v||l!==d)return(0,A.rbt)(o.operatorType,v,d)}else if(7===o.type){for(w=!1,m=[],C=void 0,_=0;_<o.arguments.length;_++)p=Y(n,t,i,r,e,f,C=o.arguments[_],s),w=w||C!==p,m.push(p);if(w)return(0,A.YJ)(o,m)}else if(1===o.type&&o.hmt()){if(c=o.source||n&&n.Uw(),l=h=o.row,d=v=o.column,c&&c===u&&(f&&!o.rowRelative||!f&&!o.columnRelative)){if(f&&e)h+=i<=h?r:0;else if(!f&&e)v+=i<=v?r:0;else if(f){if(i+r<=h)h-=r;else if(i<=h)return a}else if(i+r<=v)v-=r;else if(i<=v)return a;if(h!==l||v!==d)return(0,A.knt)(u,O,h,v,o.rowRelative,o.columnRelative)}}else if(1===o.type){if(c=o.source||n&&n.Uw(),l=o.row,d=o.column,h=o.endRow,v=o.endColumn,g=o.rowRelative,b=o.columnRelative,x=o.endRowRelative,R=o.endColumnRelative,y=l,j=d,N=h,k=v,c&&c===u){if(f&&e)l+=!g&&i<=l?r:0,h+=!x&&i<=h?r:0;else if(!f&&e)d+=!b&&i<=d?r:0,v+=!R&&i<=v?r:0;else if(f&&!e){if(!g&&i<=l&&!x&&h<i+r)return a;if(g&&x||h<i)return o;if(!g)if(i+r<=l)l-=r;else if(!(l<i)){if(x)return a;i<l&&(l=i)}if(!x)if(i+r<=h)h-=r;else{if(g)return a;h<i+r&&(h=i-1)}}else{if(!b&&i<=d&&!R&&v<i+r)return a;if(b&&R||v<i)return o;if(!b)if(i+r<=d)d-=r;else if(!(d<i)){if(R)return a;i<d&&(d=i)}if(!R)if(i+r<=v)v-=r;else{if(b)return a;v<i+r&&(v=i-1)}}if(d!==j||v!==k||l!==y||h!==N)return(0,A.lJ)(u,O,l,d,h,v,g,b,x,R)}}else if(10===o.type){if((a=o.value)!==(j=Y(n,t,i,r,e,f,a,s)))return(0,A.Ayt)(j)}else 13===o.type&&(c=o.source||n&&n.Uw())&&c===u&&!f&&(o=o.offsetWhenInsertRemoveColumn(i,r,e,s));return o}}function L(n,t){var i,r,e,f,o,s,u,a,t,c,r,i=t.w3,r=i.getSource(),o=-1,s=-1;t.name?(f=t.name,a=t.id,y(a)?e=i.getNodeByName(f):(e={WK:t.expression},u=!0)):(o=t.row,s=t.column,e=i.getNode(o=void 0===o?-1:o,s=void 0===s?-1:s)),t=e.WK,c=e.$bt,r=n.unparse(r,t,o<0?0:o,s<0?0:s),c&&(!0!==n.allowDynamicArray||!0===n.allowDynamicArray&&!c.isDynamicArray)?o===c.row&&s===c.col&&i.setArrayFormula(c.row,c.col,c.rowCount,c.colCount,r):f?u?i.setFormula(a,f,r):i.setFormulaByName(f,r):i.setFormula(o,s,r,null,!0,!0),e.WK.lMt=t.lMt}function hn(n){for(var t,i,r,e,f,o,s,u,a,c,h,l,v,d,w,t=E(n),i,r,e,f=[n.b3(g.SheetArea.colHeader),n.b3(g.SheetArea.rowHeader),n.b3(g.SheetArea.viewport)],o=0;o<f.length;o++){if(!(s=f[o]))return;for(u=s.getAllNodes(),a=0;a<u.length;a++)if(h=(c=u[a]).calc)for(l=h.aT,v=void 0,d=0;d<l.length;d++)(w=h[l[d]])&&w.forEach(function(n){n&&n instanceof A.PathCalc&&L(t,n)})}}function ln(n,t,i,r,e,f,o,s,u,a,c){b.CalcOperatorAdjustor.copyFormula(n.b3(),t,i,r.b3(),e,f,o,s,u,a,c)}function vn(n,t){var n=n.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=t,n}function X(n,t,i,r,e,f,o,s,u,a){var c,h,l,v,d,w,m,C,_,c,h,l,v,c,h,p,v,l,c;if(a){if(9===a.type){if(c=a.value,h=a.value2,l=X(n,t,i,r,e,f,o,s,u,c),v=h&&X(n,t,i,r,e,f,o,s,u,h),c!==l||h!==v)return(0,A.rbt)(a.operatorType,l,v)}else if(7===a.type){for(d=!1,w=[],m=void 0,C=0;C<a.arguments.length;C++)_=X(n,t,i,r,e,f,o,s,u,m=a.arguments[C]),d=d||m!==_,w.push(_);if(d)return(0,A.YJ)(a,w)}else if(1===a.type){if(c=!W(a)&&!B(a),h=!K(a)&&!$(a),l=t.Uw(),(!a.source||a.source===l)&&c&&h)return v=e.Uw(),c=new b.MoveSwapInfo(l,i,r,v,f,o,s,u),h=vn(a,!0),(v=(0,b.adjustFormulaOnMoveSwap)(l,0,0,h,c,!0,p={isCustomName:!0}))===h?a:1===v.type&&vn(v,!1)||v}else if(10===a.type&&(l=a.value)!==(c=X(n,t,i,r,e,f,o,s,u,l)))return(0,A.Ayt)(c);return a}}function dn(n,t){var i,r,e,f,o,s,u,a,i=n.printInfo&&n.printInfo();if(i)for(r=t.split(","),e=0;e<r.length;e++)for(f=(0,w.formulaToRanges)(n,r[e],0,0),o=0;o<f.length;o++)for(s=f[o].ranges,u=0;u<s.length;u++)-1===(a=s[u]).col||-1===a.colCount?(i.repeatRowStart(a.row),i.repeatRowEnd(a.row+a.rowCount-1)):-1!==a.row&&-1!==a.rowCount||(i.repeatColumnStart(a.col),i.repeatColumnEnd(a.col+a.colCount-1))}function wn(n,t,i,r,e){var n=n[t];n&&(r=n.rT,y(e)||(r.Wbt=e),n.toJSON({data:i}),delete r.Wbt)}function mn(n,t,i,r,e,f){n&&(t&&!t.fullRecalc?n.resumeWithoutCalc():n.resume(!1,!1,!n.calcOnDemand),delete n.lb),delete i.G3,f.resumePaint()}Object.defineProperty(n,"__esModule",{value:!0}),n.QB=n.XB=n.adjustOneFormula=n.hMt=n.resetCustomName=n.dMt=n.convertBuiltInNameToDisplayName=void 0,g=t("Core"),i=t("Common"),A=t("CalcEngine"),w=t("./dist/plugins/sheetsCalc/calc-spreadjs.js"),b=t("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),m=t("./dist/plugins/sheetsCalc/calc-extra-save.js"),O=null,x=void 0,C=g.GC$.each,h=i.Common.zf.Gmt,p=i.Common.zf,t=new i.Common.ResourceManager(g.SR),R=t.getResource.bind(t),y=i.Common.lt.ht,r="_XLNM.PRINT_AREA",_="PRINT_AREA",e="Print_Area",l=g.mt.xr,j=g.range_parser._c,N=g.mt.n1,V=g.Util.addXLFNPrefix,k=parseInt,I=g.UsedRangeUtil.updateUsedRangeByData,n.convertBuiltInNameToDisplayName=v,n.dMt=a,(t=g.Worksheet.prototype).resetCalc=function(){Z.call(this),this.eMt=!0},t.c3n=function(n,t,i){var r,e,f,o,s,u,a,c,h,l,r=this,e=E(r);if(e){if(this.suspendPaint(),e.suspend(!0),f=this.Uw().getCalcSourceModel(),y(i)){if(n)for(d(r.hyt,r.Uw(),e),o=f.getAllNodes(),s=0;s<o.length;s++)(a=(u=o[s]).calc)&&u.WK&&L(e,a);r.oMt.Bde(n,!t),r.iMt.Bde(n,!t),r.rMt.Bde(n,!t)}else if(!1!==n||t)for(-1===i.row&&(i.row=0,i.rowCount=r.getRowCount()),-1===i.col&&(i.col=0,i.colCount=r.getColumnCount()),c=0;c<i.rowCount;c++)for(h=0;h<i.colCount;h++)(a=(u=f.getNode(c+i.row,h+i.col))&&u.calc)&&u.WK&&(n&&L(e,a),!1!==n||t&&a.isVolatile)&&a.vyt();l=!1,1===e.calculationMode&&(l=i?function(n){return n.w3===r.oMt&&i.contains(n.row,n.column)}:function(n){return n.w3===r.oMt||n.w3===r.iMt||n.w3===r.rMt}),e.resume(!1,!0,l),this.resumePaint()}},t.recalcAll=function(n){var t,i,r,e,f,o,s,u,a,c,h,t=E(this);if(t){if(this.suspendPaint(),t.suspend(!0),n)for(r=void 0,r=(i=this.parent)&&i.sheets||[this],d(i&&i.hyt,this.Uw(),t),e=0;e<r.length;e++)for(o=(f=r[e]).Uw(),d(f.hyt,o,t),u=(s=o.getCalcSourceModel()).getAllNodes(),a=0;a<u.length;a++)(h=(c=u[a]).calc)&&c.WK&&L(t,h);t.resume(n),this.resumePaint()}},n.resetCustomName=d,t.recalcRange=function(n,t,i,r){var e=E(this);e&&e.recalcRange(this.Uw(),n,t,i,r)},t.recalcRows=function(n){var t,i,t=E(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,n[i],-1);t.resume(!1)}},t.recalcCols=function(n){var t,i,t=E(this);if(t&&!t.ignoreDirty()){for(t.suspend(),i=0;i<n.length;i++)t.recalculate(this.qgt,-1,n[i]);t.resume(!1)}},t.gL=function(n,t,i){var r,e,r=E(this);r&&!r.ignoreDirty()&&(e=this.qgt,1===i?e=this.T3:2===i&&(e=this.A3),r.recalculate(e,n,t))},t.getCalcService=function(){return this.Lp||(this.Lp=new A.CalcService,this.Uw(g.SheetArea.colHeader).setCalcService(this.Lp),this.Uw(g.SheetArea.rowHeader).setCalcService(this.Lp),this.Uw().setCalcService(this.Lp),this.Lp.initParserContext(this.Uw())),this.Lp},t.op=function(){return this.getCalcService()},t.suspendCalcService=function(n){var t=E(this);t&&t.suspend(n)},t.resumeCalcService=function(n){var t=E(this);t&&t.resume(n)},t.Uw=function(n){return y(n)||3===n?this.qgt:1===n?this.T3:2===n?this.A3:O},t.b3=function(n){var t=this;return 1===n?(!t.iMt&&t.T3&&(t.iMt=t.op().getSourceModel(t.T3)),t.iMt):2===n?(!t.rMt&&t.A3&&(t.rMt=t.op().getSourceModel(t.A3)),t.rMt):(!t.oMt&&t.qgt&&(t.oMt=t.op().getSourceModel(t.qgt)),t.oMt)},t.vMt=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!0,!0)},t.KT=function(n,t,i,r,e,f){var o=this.vMt(n,t,i,r,3);return!o&&e&&(r=this.getColumnCount(2),o=this.vMt(n,0,i,r,2)),!o&&f&&(i=this.getRowCount(1),o=this.vMt(0,t,i,r,1)),o},t.iT=function(n,t,i,r,e){var e=this.b3(e);return e&&e.mMt(n,t,i,r,!1,!0)},t.mT=function(n,t,i,r,e,f,o){var s,e,s=(e=void 0===e?!0:e)&&this.KT(n,t,i,r,f,o),e=!e&&z(this,n,t,i,r,f,o);return!s&&!e||(this.jT(4,R().Exp_ChangePartOfArray),!1)},t.addCustomFunction=function(n){this.Uwt(n),this.recalcAll()},t.Uwt=function(n){if(!(n&&n instanceof A.Functions.Function))throw new Error(R().Exp_InvalidCustomFunction);n.name=h(n.name),this.Amt[n.name]=n},t.getCustomFunction=function(n){return n?this.Amt[h(n)]:O},t.removeCustomFunction=function(n){n&&(delete this.Amt[h(n)],this.recalcAll())},t.clearCustomFunctions=function(){this.Amt={},this.recalcAll()},t.Jbt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomFunction(n))&&i&&i.getCustomFunction?i.getCustomFunction(n):t):O},t.addCustomName=function(n,t,i,r,e,f){this.zwt(n,t,i,r,!1,e,f)},t.getCustomName=function(n){return n?this.hyt[h(n)]:x},t.getCustomNames=function(){var i=[];return C(this.hyt,function(n,t){i.push(t)}),i},t.removeCustomName=function(n){var n,t;n&&(n=h(n),delete this.hyt[n],(t={})[n]=n,this.Zwt(t,!1))},t.clearCustomNames=function(){var n,t,n=this,t=n.hyt;n.hyt={},this.Zwt(t,!1)},t.createNameInfo=function(n,t,i,r,e){var f,o,f,o,f=this,o=E(f),f=f.Uw();return o&&f?(o=o.parse(f,t,r,e),new w.NameInfo(n,o,r,e,i)):O},t.getNameInfos=function(){return this.hyt},t.setNameInfos=function(n){y(n)||(this.hyt=n)},t.Vwt=function(n){var t,i,t,t=this,i=!t.hyt[h(n)];return i=i&&(t=t.tables)?!t.findByName(n):i},t.isValidCustomName=function(n){return n&&g.mt.P0(n)&&this.Vwt(n)},t.zwt=function(n,t,i,r,e,f,o){var s,u,a,c,u,s=this;if(!n||!t||!e&&!s.isValidCustomName(n))throw new Error(R().Exp_InvalidCustomName);if(u=E(s),a=s.Uw(),u&&a){if(c=void 0,e)try{c=u.parse(a,t,i,r,!1,!0,!0)}catch(n){}else c=u.parse(a,t,i,r);s.hyt[h(n)]=new w.NameInfo(n,c,i,r,f,o),e||((u={})[n]=n,this.Zwt(u,!0))}},t.Wwt=function(n,t,i,r,e,f,o,s){var u,t,a,t,u=this;if(!n||!t||!f&&!u.isValidCustomName(n))throw new Error(R().Exp_InvalidCustomName);t=E(u),a=u.Uw(),t&&a&&(u.hyt[h(n)]=new w.NameInfo(n,i,r,e,o),f||((t={})[n]=n,this.Zwt(t,!0)))},t.Zwt=function(n,t){var i,r,i=this.b3();if(i){for(r in n)i.updateNameCalc(r,t);this.recalcAll(!1)}this.ki(g.Events.CustomNameChangedInternal,{})},t.gMt=function(n){var t,i,t;return n?(i=(t=this).parent,!(t=t.getCustomName(n))&&i&&i.getCustomName?i.getCustomName(n):t):O},t.setFormula=function(n,t,i,r){this.zI(n,t,i,O,!1,r)},t.zI=function(n,t,i,r,e,f,o,s,u,a){var c,h,l,v,d,w,m,m,C,w,h,l,s,m,a,v,r,c=this;y(f)&&(f=3),n<0||n>=c.getRowCount(f)||t<0||t>=c.getColumnCount(f)?c.jT(0,R().Exp_IndexOutOfRange):(h=0<=n?n:0,l=0<=t?t:0,v=c.Uw(f),d=c.options.keepUnknownFormulas,(w=c.Lp).forceR1C1Formula?(m=w.useR1C1,w.useR1C1=!0,r=r||(i&&w?w.parse(v,i,h,l,!1,e,!1,d):O),w.useR1C1=m):r=r||(i&&w?w.parse(v,i,h,l,!1,e,e,d):O),r&&s&&(r.ensureSingle=!0),m=c.tables,3===f&&0<=n&&0<=t&&m&&!(C=m.pMt(n,t,1,1,i,r))||(w=d&&i&&!r,h=c.b3(f),l=c.conditionalFormats,h&&(s=h.getFormula(n,t,x,!0),m=c.Ut,a||v.t8.Fgt(n,t),(a=y(c.vle)&&!i)&&(c.vle=!(i||c.Sge&&c.Sge(n,t))),h.FE=!0,v=c.vle&&i===O,h.setFormula(n,t,i,r,e,v,m.pj(),u,d),a&&delete h.FE,delete c.vle,h.usedRange&&I(h.usedRange,n,t,s,i),w&&(r=h.getNode(n,t,!0))&&(r.qbt=i),l&&l.dl(),c.hasFormula(n,t,f)&&m.JE(n,t,f),o?c.Lj(c,[{row:n,col:t}],0):(c.Rj("formula",n,t,f,s,i),c.ki(g.Events.WorksheetDataChanged,{type:"formula"}))),c.Q1i&&c.Q1i(n,t,1,1,f),c.zw()))},t.eL=function(n,t,i,r,e,f,o,s){var u,a,c,h,l,v,d,u=this,a=this.op();if(n<0||n>=u.getRowCount()||t<0||t>=u.getColumnCount())u.jT(0,R().Exp_IndexOutOfRange);else if(h=u.b3(o))for(l=n;l<i+n;l++)for(v=t;v<r+t;v++)l===n&&v===t&&(u.zI(n,t,e,O,!1,o),c=h.pB(n,t),u.Xbt=u.Xbt||{nextIndex:0},d=u.Xbt.nextIndex,u.Xbt[d]={formula:a.unparse(this.qgt,c,n,t,!1,!0),baseRow:n,baseColumn:t,lastRow:n+i-1,lastColumn:t+r-1},u.Xbt.nextIndex++,c.aMt=d),u.zI(l,v," ",c,!0,o,!0,!0)},t.setArrayFormula=function(n,t,i,r,e,f){this.uMt(n,t,i,r,e,!1,f)},t.uMt=function(n,t,i,r,e,f,o,s){var u,a,c,h,a,l,v,d,w;if(void 0===o&&(o=3),u=this,n<0||n+i>u.getRowCount()||t<0||t+r>u.getColumnCount())u.jT(0,R().Exp_IndexOutOfRange);else if(u.Ut.eE(n,t,i,r))u.jT(0,R().Exp_ArrayFormulaSpan);else if(a=u.tables,!(3===o&&0<=n&&0<=t&&a)||(c=a.pMt(n,t,i,r,e))){if(h=u.b3(o),a=u.conditionalFormats,h){for(l=[],v=n;v<n+i;v++)for(l[v]=[],d=t;d<t+r;d++)l[v][d]=h.getFormula(v,d);for(h.setArrayFormula(n,t,i,r,e,f,u.Ut.pj(),s,!1),v=n;v<n+i;v++)for(d=t;d<t+r;d++)h.usedRange&&I(h.usedRange,v,d,l[v][d],e);if(a&&a.dl(),u.vf<1){for(w=[],v=n;v<n+i;v++)for(d=t;d<t+r;d++)w.push({row:v,col:d});u.SI(n,t,i,r,w,5,o,e)}}u.zw()}},t.getFormula=function(n,t,i,r){var i,e,i=this.b3(i);return!i||(e=i.oT(n,t))&&e.isDefault()?O:i.getFormula(n,t,r)},t.bMt=function(n,t,i){var i=this.b3(i);return i?i.pB(n,t):O},t.getFormulaInformation=function(n,t,i,r){var e,i,f,o,f,s,s,u,a,e={},i=this.b3(i);if(i){if(o=(f=i.oT(n,t))&&f.isDefault())return e;(f=i.pB(n,t))?(s=i.sT(n,t),e.hasFormula=!0,s&&(e.baseRange=new g.Range(s.row,s.col,s.rowCount,s.colCount)),e.isArrayFormula=s&&!s.isDynamicArray,n=s?s.row:n,t=s?s.col:t,r||(e.formula=this.Lp.unparse(this.qgt,f,n,t),e.formulaWithCulture=this.Lp.unparse(this.qgt,f,n,t,!0)),e.hasFormula=!!e.formula):(s=this.Uw().t8.getAnchorInfo(n,t))&&s.isValid&&(u=s.row,a=s.col,e.baseRange=new g.Range(s.row,s.col,s.rowCount,s.colCount),n===u&&t===a||(f=i.pB(u,a),r||(e.formulaWithCulture=this.Lp.unparse(this.qgt,f,u,a,!0)),e.hasFormula=!0,e.isDynamicArray=!0))}return e},t.VI=function(n,t,i,r,e,f){var o,s,u,a,c,h,l,v,d,w,m,C;for(i||(i=this,r=n,e=t,f=[]),o=i.qwt(r,e),s=this.name(),u=0;u<o.length;u++){if(f[c=(a=o[u]).sheetName+"_"+a.row+"_"+a.col+"_"+a.rowCount+"_"+a.colCount])return!1;if(f[c]=!0,(a.row<=n&&n<a.row+a.rowCount||-1===a.rowCount)&&(a.col<=t&&t<a.col+a.colCount||-1===a.colCount)&&s===a.sheetName)return!0;for(h=a.sheetName===s?i:i.parent.getSheetFromName(a.sheetName),l=a.rowCount,v=a.row,d=a.colCount,w=a.col,-1===l&&(l=h.getRowCount(),v=0),-1===d&&(d=h.getColumnCount(),w=0),m=v;m<l+v;m++)for(C=w;C<d+w;C++)if(this.VI(n,t,h,v,w,f))return!0}return!1},t.getCrossSheetReferences=function(r){for(var n,e,t,i,f,o,s,u,a,c,h,l,v,d,n=this,e=(0,A.createMap)(),t=n.getRowCount(),i=n.getColumnCount(),f=n.b3(),o=f.rT.id,u=function(n,t){var i,i,i=n.w3.getSource();i&&i.id!==o&&(r?(i=i.getName())&&0<i.length&&e.set(i,!0):e.set(t,n))},a=0;a<t;a++)for(c=0;c<i;c++)if((h=f.oT(a,c))&&h.aT)for(s=h.aT,l=0;l<s.length;l++)(v=h[s[l]])&&v.forEach(u);if((d=f.uT())&&d.aT)for(s=d.aT,l=0;l<s.length;l++)(v=d[s[l]])&&v.forEach(function(n){n&&n.content.forEach(u)});return e},t.getPrecedents=function(n,t){var i,r,r,e,f,n,f,i=[],r=this.b3();return r&&(r=r.Fyt(n,t)||r.pB(n,t),n=(f=(e=this.getFormulaInformation(n,t,3,!0)).baseRange)?f.row:n,f=f?f.col:t,this.yMt(r,n,f,i),i=nn(i)),i},t.getDependents=function(a,c){var h,n,l,h=[],n=this.parent&&this.parent.sheets||[this],l=this.name();return n.forEach(function(n){for(var t,i,r,e,f,o,s,u,t=n.getRowCount(),i=n.getColumnCount(),r=n.name(),e=0;e<t;e++)for(f=0;f<i;f++)for(o=n.getPrecedents(e,f),s=0;s<o.length;s++)if((u=o[s]).sheetName===l&&(-1===u.row||u.row<=a&&a+1<=u.row+u.rowCount)&&(-1===u.col||u.col<=c&&c+1<=u.col+u.colCount)){h.push({row:e,col:f,rowCount:1,colCount:1,sheetName:r});break}}),h},t.qwt=function(i,r){var e,n,t,n,n,e={},n=this.b3().oT(i,r),t=this.b3().uT();return n&&(n=n[0])&&n.forEach(an(e,this)),t&&(n=t[0])&&n.forEach(function(n){var t;(-1===n.row||n.row<=i&&i+1<=n.row+n.rowCount)&&(-1===n.col||n.col<=r&&r+1<=n.col+n.colCount)&&n.content.forEach(an(e,this))}),cn(e)},t.yMt=function(n,t,i,r){var e,f,f,o,s,u;if(n)switch(e=n.type){case A.ExpressionType.reference:case A.ExpressionType.structReference:f=n.getRange(t,i),r.push({row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:(n.source&&n.source.Mf?n.source.Mf:this).name()});break;case A.ExpressionType.operator:this.yMt(n.value,t,i,r),this.yMt(n.value2,t,i,r);break;case A.ExpressionType.expand:case A.ExpressionType.parentheses:this.yMt(n.value,t,i,r);break;case A.ExpressionType.name:f=this.gMt(n.value),this.yMt(f.getExpression(),t,i,r);break;case A.ExpressionType.function:for(o=n.arguments,s=0;s<o.length;s++)u=o[s],this.yMt(u,t,i,r)}},t.hasFormula=function(n,t,i,r){var i=this.b3(i);return!!i&&i.hasFormula(n,t,r)},t.wMt=function(){var n=this.b3();n&&n.MMt(function(n){n.CMt(),n.yB()})},t.clearFormula=function(n,t,i,r,e){var f,o,s,f=this;for(n<0&&(n=0,i=f.getRowCount()),t<0&&(t=0,r=f.getColumnCount()),o=0;o<i;o++)if(e(f,o+n))for(s=0;s<r;s++)f.setFormula(o+n,s+t,O)},t.nameFunctionsFromJSON=function(n,t,i,r){var e,f,o,s,u,u,a,c,h;if(n){if(e=this,f=n.customFunctions)for(o in f)f.hasOwnProperty(o)&&(s=f[o],u=(0,g.getTypeFromString)(s.typeName))&&((u=new u).fromJSON(s,t),e.Uwt(u));if((a=n.names)&&0<a.length){for(c=0;c<a.length;c++)h=a[c],e.zwt(v(h.name),h.formula,h.row,h.col,!0,h.comment,h.isReadOnly);e.wMt()}r&&r()}},t.formulaFromJSON=function(n,t,e){var f,o,s;n&&((f=this).Xbt=n.sharedFormulas,o=e&&e.ignoreFormula,s=e&&e.incrementalLoading,[n.colHeaderData,n.rowHeaderData,n.data].forEach(function(n,t){var t,n,i,r;n&&!o&&n.dataTable&&(n=n.dataTable,i=f.getRowCount(t=t+1),r=f.getColumnCount(t),s?S(f,n,i,r,e,0,t):a(f,n,i,r,t))}),n.defaultData&&en(f,n.defaultData),s?e.incrementLoadTask.pushTask(on,[f,n,t,e]):on(f,n,t,e))},t.formulaFromSJSFormat=function(n,t,i,r){var e,f,o,s,u,a,f,c,h,e=this,f=e.Uw(),o=!i||!1!==i.includeFormulas,s=g.Util.Mo(i),u=g.Util.wo(i,e.parent&&e.parent.v2),a=e.b3(3);f.G3=!0,o&&n.lossless&&n.lossless.tree&&i.$wt&&(a.cMt=!0,f.setReferenceSheetNames(n.lossless.referenceSheetNames)),(f=l(n,g.XFileConstants.bo))?(c=f.rowCount,h=f.colCount,r?(o&&M(e,f,c,h,n.lossless,i,0,r),D(n,e,a,t,i,o,s)):(o&&i.incrementLoadTask.addTask(M,[e,f,c,h,n.lossless,i,0],p.I5(R().STEP.loadSheetFormula,[e.name()]),function(){var n=i.loadStatus.formulaLoad/i.loadStatus.total;return i.fullRecalc?u?.5:n*g.STEP_RATE.loadSheetFormulaWithCalc+g.STEP_RATE.loadSheetDataWithCalc+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData:u?.6:n*g.STEP_RATE.loadSheetFormula+g.STEP_RATE.loadSheetData+g.STEP_RATE.parseFile+g.STEP_RATE.loadFileData},e.name()),i.incrementLoadTask.addTask(D,[n,e,a,t,i,o,s]))):r?D(n,e,a,t,i,o,s):i.incrementLoadTask.addTask(D,[n,e,a,t,i,o,s])},t.nameFunctionFromSJSFormat=function(n,t,i){var r,e,f,o,s,u,u,a,c,r=this,e=r?r.Uw():O,f=n.lossless&&n.lossless.customFunctions;if(f)for(o in f)f.hasOwnProperty(o)&&(s=f[o],u=(0,g.getTypeFromString)(s.typeName))&&((u=new u).fromJSON(s),r.Uwt(u));a=n.lossless&&n.lossless.definedNames,c=n.lossless&&n.lossless.nExpr,a&&0<a.length&&(a.forEach(function(n){var t=""+n.c_[0];"_xlnm.Print_Titles"===n.name?dn(r,t):c&&c[n.e]?r.Wwt(v(n.name),(0,w.processFunctionPrefix)(g.mt.n1(t)),(0,m.exprFromJSON)(c[n.e],e.getParserContext(!1)),0,0,!0,n.comment,"_xlnm.Print_Area"!==n.name):r.zwt(v(n.name),(0,w.processFunctionPrefix)(g.mt.n1(t)),0,0,!0,n.comment,n.isReadOnly)}),r.wMt())},t.SMt=function(n){var t=this,i=t.Lp;i&&!n||(t.Lp=n||new A.CalcService,t.Uw(g.SheetArea.colHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.rowHeader).setCalcService(t.Lp),t.Uw(g.SheetArea.viewport).setCalcService(t.Lp),t.Lp.initParserContext(t.Uw()),i?(n.setSourceModel(t.T3,i.getSourceModel(t.T3)),n.setSourceModel(t.A3,i.getSourceModel(t.A3)),n.setSourceModel(t.qgt,i.getSourceModel(t.qgt))):(t.iMt=t.Lp.getSourceModel(t.T3),t.rMt=t.Lp.getSourceModel(t.A3),t.oMt=t.Lp.getSourceModel(t.qgt)),t.oMt.usedRange=new g.BaseUsedRange)},t.setCalc=function(n,t){this.Lp=n,this.qgt=t||this.qgt,this.oMt=n.getSourceModel(this.qgt),this.parent&&(this.parent.Lp=n)},t.YA=function(){this.ol(!1,1)},t.TMt=function(n,t){var i,r,e,f,o,s,u,a,c,h,l,v,d,w,m,C,_,p,i=this,r=n.changeType,e=n.row,f=n.rowCount,o=n.col,s=n.colCount,u=n.sheetArea,a=y(u)||u===g.SheetArea.viewport,c=i.b3(u),h=c.usedRange;c&&(v=(l=i.Ut).pj(),d=E(c),w=c.rT,m=d.Hyt(),C=d.MX.asyncManager,"addingRows"===r?i.mT(e,0,0,i.getColumnCount(),void 0,!0,!1)?(_=a?i.b3(2):x,m.onBeforeAddRemoveRows(c,e,_),T(i,e,f,!0,!0),[c,_].forEach(function(n){n&&n.addRows(e,f)}),C.addRows(w,e,f)):n.canAdd=!1:"addRows"===r?(d.suspend(),_=a?i.b3(2):x,m.onAfterAddRemoveRows(c,e,f,!0,t,_),d.resume(!1),v&&v.push({type:"addRows",row:e,rowCount:f,sheetArea:u}),h&&h.addHeadInfo(e,f,!0)):"deletingRows"===r?i.mT(e,0,f,i.getColumnCount(),void 0,!0,!1)?(_=a?i.b3(2):x,m.onBeforeAddRemoveRows(c,e,_),T(i,e,f,!1,!0),[c,_].forEach(function(n){n&&n.deleteRows(e,f,t)}),C.deleteRows(w,e,f)):n.canDelete=!1:"setRowCount"===r&&f!==e?(d.suspend(),_=i.b3(2),e<f?(c.gF(e+1,0,f-e,i.getColumnCount()),_.gF(e+1,0,f-e,i.getColumnCount()),c.rT.t8.Fgt(e+1,-1,f-e,-1)):(c.gF(f+1,0,e-f,i.getColumnCount()),_.gF(f+1,0,e-f,i.getColumnCount()),c.rge(f,e),_.rge(f,e)),d.AMt(r),d.resume(!1)):"setColumnCount"===r&&s!==o?(d.suspend(),p=i.b3(1),o<s?(c.gF(0,o+1,i.getRowCount(),s-o),p.gF(0,o+1,i.getRowCount(),s-o),c.rT.t8.Fgt(-1,o+1,-1,s-o)):(c.gF(0,s+1,i.getRowCount(),o-s),p.gF(0,s+1,i.getRowCount(),o-s),c.oge(s,o),p.oge(s,o)),d.AMt(r),d.resume(!1)):"deleteRows"===r?(d.suspend(),_=a?i.b3(2):x,m.onAfterAddRemoveRows(c,e,f,!1,t,_),d.resume(!1),v&&v.push({type:"deleteRows",row:e,rowCount:f,sheetArea:u}),h&&h.removeHeadInfo(e,f,!0)):"addingColumns"===r?i.mT(0,o,i.getRowCount(),0,void 0,!1,!0)?(p=a?i.b3(1):x,m.onBeforeAddRemoveColumns(c,o,p),T(i,o,s,!0,!1),[c,p].forEach(function(n){n&&n.addColumns(o,s)}),C.addColumns(w,e,f)):n.canAdd=!1:"addColumns"===r?(d.suspend(),p=a?i.b3(1):x,m.onAfterAddRemoveColumns(c,o,s,!0,t,p),d.resume(!1),v&&v.push({type:"addColumns",col:o,colCount:s}),h&&h.addHeadInfo(o,s,!1)):"deletingColumns"===r?i.mT(0,o,i.getRowCount(),s,void 0,!1,!0)?(p=a?i.b3(1):x,m.onBeforeAddRemoveColumns(c,o,p),T(i,o,s,!1,!1),[c,p].forEach(function(n){n&&n.deleteColumns(o,s,t)}),C.deleteColumns(w,e,f)):n.canDelete=!1:"deleteColumns"===r&&(d.suspend(),p=a?i.b3(1):x,m.onAfterAddRemoveColumns(c,o,s,!1,t,p),d.resume(!1),v&&v.push({type:"deleteColumns",col:o,colCount:s,sheetArea:u}),h)&&h.removeHeadInfo(o,s,!1))},t.IMt=function(n,t,i,r){var e,f,o,s,u,e=i.type,f=this;if(r){if("addRows"===e)i.changeType="addingRows",f.TMt(i),i.changeType="addRows",f.TMt(i);else if("deleteRows"===e)i.changeType="deletingRows",f.TMt(i),i.changeType="deleteRows",f.TMt(i);else if("addColumns"===e)i.changeType="addingColumns",f.TMt(i),i.changeType="addColumns",f.TMt(i);else if("deleteColumns"===e)i.changeType="deletingColumns",f.TMt(i),i.changeType="deleteColumns",f.TMt(i);else if("customName"===e)o=n.parse(f,i.newFormula,0,0),i.nameInfo.SB(o);else if("condition"===e){for(s=[],u=0;u<i.newFormulas.length;u++)o=n.parse(f,i.newFormulas[u],0,0),s.push(o);i.condition.setExpressions(s)}}else if("addRows"===e)i.changeType="deletingRows",f.TMt(i,!0),i.changeType="deleteRows",f.TMt(i,!0);else if("deleteRows"===e)i.changeType="addingRows",f.TMt(i,!0),i.changeType="addRows",f.TMt(i,!0);else if("addColumns"===e)i.changeType="deletingColumns",f.TMt(i,!0),i.changeType="deleteColumns",f.TMt(i,!0);else if("deleteColumns"===e)i.changeType="addingColumns",f.TMt(i,!0),i.changeType="addColumns",f.TMt(i,!0);else if("customName"===e)o=n.parse(f,i.formula,0,0),i.nameInfo.SB(o);else if("condition"===e){for(s=[],u=0;u<i.formulas.length;u++)o=n.parse(f,i.formulas[u],0,0),s.push(o);i.condition.setExpressions(s)}},t.xMt=function(n,t,i){var r=i.type,e=this;"addRows"===r?(i.changeType="deletingRows",e.TMt(i,!0),i.changeType="deleteRows",e.TMt(i,!0)):"deleteRows"===r?(i.changeType="addingRows",e.TMt(i,!0),i.changeType="addRows",e.TMt(i,!0)):"addColumns"===r?(i.changeType="deletingColumns",e.TMt(i,!0),i.changeType="deleteColumns",e.TMt(i,!0)):"deleteColumns"===r?(i.changeType="addingColumns",e.TMt(i,!0),i.changeType="addColumns",e.TMt(i,!0)):"customName"===r?i.nameInfo.SB(i.expr):"condition"===r&&i.condition.setExpressions(i.expressions)},t.NMt=function(n,t){var i,r,e,f,o,i=this,r=E(i),e=i.b3();if(r.suspend(),t)for(f=0;f<n.length;f++)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue&&i.setFormula(o[0],o[1],o.formula);else for(f=n.length-1;0<=f;f--)(o=n[f]).type?i.IMt(r,e,o,t):o.newValue||i.setFormula(o[0],o[1],o.formula);r.resume(!1)},t.xj=function(n){var t,t,i,r,e,f,o,s,u,a,c,h,l,v,d,t=n[n.length-1],t=t&&t.sheetArea,i=y(t)||t===g.SheetArea.viewport,r=E(this),e=this.b3(t),f=this.Uw(t);for(r.suspend();n.length;){if(s=(o=n.pop())[0],u=o[1],a=e.pB(s,u),h=[],c=i&&f.t8.getAnchorInfo(s,u)){for(l=c.row;l<c.row+c.rowCount;l++)for(h[l]=[],v=c.col;v<c.col+c.colCount;v++)h[l][v]=this.getValue(l,v);!c.isValid||o[2]||o[3]||f.t8.Rme(f.t8.Pme(s,u),!0,!1,!0)}if(o.type?this.xMt(r,e,o):e.kMt.apply(e,o),(d=i&&e&&e.usedRange)&&(I(d,o[0],o[1],a,o[2]),c))for(l=c.row;l<c.row+c.rowCount;l++)for(v=c.col;v<c.col+c.colCount;v++)l===o[0]&&v===o[1]||I(d,l,v,h[l][v],o[2])}n&&n.Vme&&f.t8.Wme(n.Vme),r.resume(!1)},t.getReferenceRange=function(n){var t,i,r,e,f,o,n,s,t=this.Uw(),i=this.getCalcService(),r=i.parse(t,n,0,0),o=r.baseTable;return r&&o&&n===o.name()?(e=o.range(),f=o.Mf&&o.Mf.name()):(n=i.MX.evaluateExpression(r,t.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0))instanceof A.CalcReference&&(f=n.getSource().getName(),0<n.getRangeCount())&&(e=(0,g.Ec)(n.getRow(s=0),n.getColumn(0),n.getRowCount(0),n.getColumnCount(0))),{sheetName:f,range:e}},t.dL=function(n,t,i,r){var e,f,f,e=this,f="string"==typeof r&&e.parent&&e.parent.xO(r);return f&&-1!==n&&-1!==t?(f=f.getExpression(),H(e,r)?U(e,f,n,t):(0,w.evaluateExpression)(e,f,n,t,{sheetArea:i})):x},t.TL=function(n,t,i){var r,e,f,o,f,s,u,a,c,r=this,e=!!r.NMi,f=r.getCell(n=-1===n?0:n,t=-1===t?0:t,3),o=(0,w.rangeToFormula)(f,n,t,3);if(0<=(f="="===(f=i.trim()).charAt(0)&&0<=f.indexOf("@")&&!G(f)?f.replace(/@/g,o):f).indexOf("{{")&&0<=f.indexOf("}}")){for(""===(s=f.split(/{{|}}/))[0]&&s.shift(),""===s[s.length-1]&&s.pop(),u=0;u<s.length;u++)-1===s[u].indexOf("=")?s[u]='"'+s[u]+'"':(!e||!G(s[u]))&&(0<=s[u].indexOf("@")&&(s[u]=s[u].replace(/@/g,o)),(a=(0,w.evaluateFormula)(r,s[u]))instanceof A.CalcError)?s[u]='"'+a.toString()+'"':s[u]=s[u].replace(/=/g,"");f="=CONCAT("+s.join(",")+")"}(c=r.parent).xO(i)||c.pp(c.bp,i,f,n,t,!0,"",r.NMi)},t.NO=function(n,t,i,r){var e=this;return(H(e,n)?U:(0,w.evaluateExpression))(e,t,i,r)},n.hMt=T,n.adjustOneFormula=L,n.XB=ln,n.QB=X,g.Worksheet.ch("calc",{priority:1e3,init:Z,dispose:function(n){var t,i,i,i,t=this;!1!==n.clearCache&&(t.qgt=O,t.A3=O,t.T3=O,t.Lp=O,(i=t.oMt)&&(!0===n.isSheetDestroy?i.DMt():i._Mt(),t.oMt=O),(i=t.rMt)&&(!0===n.isSheetDestroy?i.DMt():i._Mt(),t.rMt=O),i=t.iMt)&&(!0===n.isSheetDestroy?i.DMt():i._Mt(),t.iMt=O)},attach:function(n){var t=this;n instanceof g.Workbook?t.SMt(n.Lp):t.SMt()},onLayoutChanged:function(n){this.op().isAdjustSuspended()||this.TMt(n)},toJson:function(n,t){var u,i,r,a,i,c,e,f,o,s,u=this,i=u.Amt;g.GC$.isEmptyObject(i)||(n.customFunctions=i),r=t&&t.newWorkSheetName,a=[],i=u.getCustomNames(),c=E(u),e=u.b3(),f=e.rT,i&&c&&(!y(r)&&e&&f&&(f.Wbt=r),C(i,function(n,t){var i,r,e,f,o,t,s,i,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();f&&(i={name:i,formula:s=c.unparse(u.Uw(),f,r,e,!1,!0,!0),row:r,col:e},t&&(i.comment=t),"boolean"==typeof o&&(i.isReadOnly=o),a.push(i))}),0<a.length&&(n.names=a),delete f.Wbt),(o=t&&t.ignoreFormula)||(s=[u.oMt,u.iMt,u.rMt],[n.data,n.colHeaderData,n.rowHeaderData].forEach(function(n,t){wn(s,t,n,f,r)}),u.Xbt&&0<u.Xbt.nextIndex&&(n.sharedFormulas=u.Xbt))},fromJson:function(n,t,i,r){var e,f,e=this,f;i&&i.incrementalLoading||(e.clearCustomFunctions(),e.clearCustomNames()),r&&(e.nameFunctionsFromJSON(n,t,i),e.formulaFromJSON(n,t,i))},wh:function(n,t,u){var a,i,r,c,h,i,l,e,f,v,o,d,o,e,s,a=this,i=a.Amt;g.GC$.isEmptyObject(i)||(n.lossless.customFunctions=i),r=u&&u.newWorkSheetName,c=[],h=[],i=a.getCustomNames(),l=E(a),e=a.b3(),f=e.rT,v={},a.parent&&(o=a.parent.yC,v=o&&o.getUsedCustomNames()||{}),i&&l&&!a.NMi&&(!y(r)&&e&&f&&(f.Wbt=r),d=!u||!1!==u.includeUnusedNames,C(i,function(n,t){var i,r,e,f,o,t,s,i,t,i=t.getName(),r=t.getRow(),e=t.getColumn(),f=t.getExpression(),o=t.isReadOnly(),t=t.getComment();i.toUpperCase()!==_&&f&&(d||v[i])&&(i={name:i,comment:t,isReadOnly:o,formula:s=V((0,w.encodeNameFormula)(l.unparse(a.Uw(),f,r,e,!1,!0,!0)))},u&&u.includeCalcModelCache&&(t=(0,m.exprToJSON)(f),c.push(t),i.e=c.length-1),h.push(i))}),0<h.length&&(n.lossless.definedNames=h),0<c.length&&(n.lossless.nExpr=c),delete f.Wbt),(o=u&&!1===u.includeFormulas)||((e=a.oMt)&&(f=e.rT,y(r)||(f.Wbt=r),e.wh(n,u),delete f.Wbt),s=[a.iMt,a.rMt],n.lossless&&[n.lossless.colHeaderData,n.lossless.rowHeaderData].forEach(function(n,t){wn(s,t,n,f,r)})),!o&&g.Util.ko(u)&&(u&&u.includeCalcModelCache&&(n.lossless.tree=(0,m.mbt)(a.b3())),f=a.Uw(),n.lossless.referenceSheetNames=f&&f.getReferenceSheetNames(),q(a,n.lossless))},yh:function(n,t,i,r){var e,f,o,s,u,a,c,e=this,f=e.parent,s=g.Util.wo(i,e.parent&&e.parent.v2),u=i&&!i.fullRecalc,a=e.Uw();e.suspendPaint(),f&&f.Lp&&((o=f.Lp).suspend(),o.lb=u),(c=g.Util.Mo(i))||(e.clearCustomFunctions(),e.clearCustomNames()),s&&(a.G3=!0,e.nameFunctionFromSJSFormat(n,t,i),e.formulaFromSJSFormat(n,t,i,r),r?un(f,e,n,a,t,i):i.incrementLoadTask.addTask(un,[f,e,n,a,t,i])),r?mn(o,i,a,s,u,e):i.incrementLoadTask.addTask(function(n,t,i,r,e,f){mn(n,t,i,r,e,f)},[o,i,a,s,u,e])},setName:function(n){var t,i,r;hn(this),(r=(i=E(t=this.b3())).MX.asyncManager).changeSourceName(n.oldName,n.newName)},beforeSetName:function(){this.b8&&(this.parent||this).xyt()}}),g.Y8.ch("calc",{isInvalidFormula:function(t){var n,i,n=O,i=x;try{t.allowDynamicArray&&(y(w.SheetParserContext.wbt)&&(w.SheetParserContext.wbt=new g.Worksheet),(n=w.SheetParserContext.wbt).getCalcService())&&(i=n.getCalcService().allowDynamicArray,n.getCalcService().allowDynamicArray=!0),(0,w.formulaToExpression)(n,t.value)}catch(n){t.isInvalid=!0}finally{y(n)||y(i)||!n.getCalcService()||n.getCalcService().allowDynamicArray===i||(n.getCalcService().allowDynamicArray=i)}}})},Common:function(n){n.exports=GC.Spread},CalcEngine:function(n){n.exports=GC.Spread.CalcEngine},Core:function(n){n.exports=GC.Spread.Sheets}},r={},n=e("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),(((GC=void 0===GC?{}:GC).Spread=GC.Spread||{}).Sheets=GC.Spread.Sheets||{}).CalcEngine=n}();